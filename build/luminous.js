(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
(function (global){
/*
 * tmlib.js 0.5.0
 * http://github.com/phi-jp/tmlib.js
 * MIT Licensed
 * 
 * Copyright (C) 2010 phi, http://tmlife.net
 */

(function() { "use strict"; })();

/*
 * tm namespace
 */
var tm = tm || {};
tm.global = window || global || this;
tm.global.tm = tm;

// node.js
if (typeof module !== 'undefined' && module.exports) {
    module.exports = tm;
}


(function() {

    /**
     * バージョン
     */
    tm.VERSION = '0.5.0';

    /**
     * tmlib.js のルートパス
     */
    tm.LIB_ROOT = (function(){
        if (!window.document) return ;

        var scripts = document.getElementsByTagName("script");
        for (var i=0, len=scripts.length; i<len; ++i) {

        }
    })();

    /**
     * ブラウザ
     */
    tm.BROWSER = (function() {
        if (!window.navigator) return ;

        if      (/chrome/i.test(navigator.userAgent))   { return "Chrome";  }
        else if (/safari/i.test(navigator.userAgent))   { return "Safari";  }
        else if (/firefox/i.test(navigator.userAgent))  { return "Firefox"; }
        else if (/opera/i.test(navigator.userAgent))    { return "Opera";   }
        else if (/getcko/i.test(navigator.userAgent))   { return "Getcko";  }
        else if (/msie/i.test(navigator.userAgent))     { return "IE";      }
        else { return ''; }
    })();

    /**
     * ベンダープレフィックス
     */
    tm.VENDER_PREFIX = (function() {
        if (!window) return ;

        var map = {
            "Chrome"    : "webkit",
            "Safari"    : "webkit",
            "Firefox"   : "moz",
            "Opera"     : "o",
            "IE"        : "ms"
        };

        return map[tm.BROWSER] || "";
    })();


    /**
     * モバイルかどうかの判定フラグ
     */
    tm.isMobile = (function() {
        if (!window.navigator) return ;

        var ua = navigator.userAgent;
        return (ua.indexOf("iPhone") > 0 || ua.indexOf("iPad") > 0 || ua.indexOf("Android") > 0);
    })();
    
    tm.isLocal = (function() {
        var flag = (location.protocol == "file:");
        return function() { return flag; };
    })();
    
    /**
     * クラス定義
     */
    tm.createClass = function(prop) {
        // デフォルト値
        prop.init = prop.init || function() {};
        prop.superClass = prop.superClass || null;

        // クラス作成
        var tm_class = function() {
            var temp = new tm_class.prototype.creator();
            tm_class.prototype.init.apply(temp, arguments);
            return temp
        };

        // 継承
        if (prop.superClass) {
            prop.init.owner = tm_class;
            tm_class.prototype = Object.create(prop.superClass.prototype);
            tm_class.prototype.superInit = function() {
                var caller    = this.superInit.caller; // 呼び出しもと
                var subclass  = caller.owner; // 呼び出しもとを持っているクラス
                var superclass= subclass.prototype.superClass; // 呼び出しもとクラスの親クラス
                var superInit = superclass.prototype.init; // 呼び出しもとクラスの親クラスの init
//                var superMethod = this.superInit.caller.owner.prototype.superClass.prototype.init;

                superInit.apply(this, arguments);
            };
            tm_class.prototype.constructor = tm_class;
        }

        tm_class.prototype.selfClass = tm_class;

        // プロパティを追加
        for (var key in prop) {
            tm_class.prototype[key] = prop[key];
        }

        // クリエイタの生成
        tm_class.prototype.creator = function() { return this; };
        // クリエイタの継承
        tm_class.prototype.creator.prototype = tm_class.prototype;

        tm_class._class = true;

        return tm_class;
    };

    tm.classes = {};
    var _calssDefinedCallback = {};

    /**
     * クラス定義
     * phi クラス定義 <http://jsdo.it/phi/eEmj>
     * new と apply を同時に使う <http://stackoverflow.com/questions/1606797/use-of-apply-with-new-operator-is-this-possible>
     */
    tm.define = function(path, prop) {
        var index       = path.lastIndexOf(".");
        var nsName      = path.substring(0, index);
        var ns          = (nsName) ? tm.using(nsName) : tm.global;
        var className   = (nsName) ? path.substring(index+1) : path;
        var bind        = Function.prototype.bind;
        var unshift     = Array.prototype.unshift;

        prop._path      = path;
        prop._className = className;

        var _class = null;
        var superClass = prop.superClass;

        if (superClass && typeof superClass == "string") {
            var superClassName = superClass;
            superClass = tm.using(superClass);

            if (superClass._class) {
                prop.superClass = superClass;
                _class = tm.createClass(prop);
            }
            else {
                // 親クラスが呼ばれた際に再度実行する
                if (!_calssDefinedCallback[superClassName]) {
                    _calssDefinedCallback[superClassName] = [];
                }

                _calssDefinedCallback[superClassName].push(function() {
                    tm.define(path, prop);
                });

                return ;
            }
        }
        else {
            _class = tm.createClass(prop);
        }

        // キャッシュしておく
        ns[className] = tm.classes[path] = _class;

        if (_calssDefinedCallback[path]) {
            var list = _calssDefinedCallback[path];
            for (var i=0,len=list.length; i<len; ++i) {
                list[i]();
            }
            delete _calssDefinedCallback[path];
        }

        return _class;
    };


    /**
     * 名前空間
     * typescript の mudle 機能を参考
     * https://sites.google.com/site/jun1sboardgames/programming/typescript
     */
    tm.namespace = function(ns, fn) {
        var ns = tm.using(ns);

        fn.call(ns, ns);
    };

    /**
     * 使用
     */
    tm.using = function(ns) {
        if (tm.classes[ns]) return tm.classes[ns];

        var path = ns.split(/[,.\/ ]|::/);
        var current = tm.global;

        for (var i=0,len=path.length; i<len; ++i) {
            var dir = path[i];
            current = current[dir] || (current[dir]={});
        }

        // キャッシュ
        tm.classes[ns] = current;

        return current;
    };
    
    tm.globalize = function(obj) {
        tm.$forIn(function(key, value) {
            if (typeof value !== 'object') {
                return ;
            }
            else if (key === "classes") {
                return ;
            }
            else if (key === "global") {
                return ;
            }
            else if (key === "event") {
                return ;
            }
            else if (key === "dom") {
                return ;
            }

            // console.log("#### " + key + " ###########");
            value.$forIn(function(key, value) {
                if (!window[key]) {
                    // console.log(key);
                    window[key] = value;
                }
                else {
                    // TODO: 名前を考えなおす
                    // console.log(key);
                }
            });
        });

        return this;
    };
    
    tm["import"] = function(namespace) {
        var target = tm[namespace];
        tm.global.$strict(target);
        
        return this;
    };

    /**
     * ループ
     */
    tm.setLoop = function(fn, delay) {
        var temp = function() {
            // 開始時間
            var start = (new Date()).getTime();

            // 実行
            fn();

            // 経過時間
            var progress = (new Date()).getTime() - start;
            // 次回までの待ち時間を計算
            var newDelay = delay-progress;
            newDelay = (newDelay > 0) ? newDelay : 0;

            // 次回呼び出し登録
            setTimeout(arguments.callee, newDelay);
        };
        setTimeout(temp, delay);
    };

    tm.inform = function(parent){
        parent = parent || document.body;

        var eInfo = document.createElement("div");
        eInfo.setAttribute("class", "tm-info");
        eInfo.addEventListener("mouseover", function(){
            this.style.opacity = 0.9;
        }, false);
        eInfo.addEventListener("mouseout", function(){
            this.style.opacity = 0.25;
        }, false);

        with(eInfo.style) {
            position    = "absolute";
            width       = "100%";
            // top         = "0px";
            bottom      = "0px";
            left        = "0px";
            right       = "0px";
            margin      = "0px";
            padding     = "10px 0px";
            zIndex      = "0";
            textAlign   = "center";
            fontFamily  = '"Meiryo", "メイリオ", "ヒラギノ角ゴ Pro W3", sans-serif';
            fontSize    = "13px";
            opacity     = "0.25";
            backgroundColor = "rgb(230,230,255)";
            background  = "-webkit-linear-gradient(top, hsla(0, 100%, 100%, 0.8) 0%, hsla(0, 100%, 100%, 0.3) 50%, hsla(0, 100%, 100%, 0.1) 51%, hsla(0, 100%, 100%, 0.2) 100%), rgb(190,190,210)";
            background  = "-moz-linear-gradient(top, hsla(0, 100%, 100%, 0.8) 0%, hsla(0, 100%, 100%, 0.3) 50%, hsla(0, 100%, 100%, 0.1) 51%, hsla(0, 100%, 100%, 0.2) 100%), rgb(190,190,210)";
            WebkitTransition = "1s";
            MozTransition = "1s";
        }

        /*
        eInfo.innerHTML = "このプログラムで利用している JavaScript ライブラリ 『tmlib.js』 は<a href='{tmlibLink}'>こちら</a>からダウンロードできます. 詳しくは<a href='{blogLink}'>Blog</a>に書いています.".format({
            "tmlibLink": "http://code.google.com/p/tmlib-js/downloads/list",
            "blogLink" : "http://tmlife.net/tmlib"
        });
        */
        eInfo.innerHTML = "このプログラムで利用している JavaScript ライブラリ 『tmlib.js』 については<a href='{projectLink}'>こちら</a>.".format({
            "projectLink" : "https://github.com/phi1618/tmlib.js"
        });
        parent.appendChild(eInfo);
    };

})();


(function() {

    if (!window) return ;

    if (!window.requestAnimationFrame) {
        window.requestAnimationFrame = window[tm.VENDER_PREFIX + "RequestAnimationFrame"] || function(callback) {
            window.setTimeout(callback, 1000/60);
        };
    }

    if (!window.cancelRequestAnimationFrame) {
        window.cancelRequestAnimationFrame = window[tm.VENDER_PREFIX + "CancelRequestAnimationFrame"] || window.clearTimeout;
    }

})();



(function() {
    if (!window.document) return ;

    var _mainListeners = [];

    tm.main    = function(fn) {
        if (fn) {
            _mainListeners.push(fn);
        }
        else {
            _main();
        }
    };

    var _main = function() {
        for (var i=0,len=_mainListeners.length; i<len; ++i) {
            _mainListeners[i]();
        }

        _mainListeners = [];
    };

    window.addEventListener("load", function() {
        _main();
    }, false);

})();
/*
 * object.js
 */

(function() {
    
    /**
     * @class global.Object
     * Objectの拡張
     */
    
    /**
     * @method defineVariable
     * 変数を追加
     * @param   {String} key name
     * @param   {Object} param
     */
    Object.defineProperty(Object.prototype, "defineVariable", {
        value: function(name, val) {
            Object.defineProperty(this, name, {
                value: val,
                enumerable: true,
                writable: true
            });
        }
    });
    
    /**
     * @method defineFunction
     * 関数を追加
     * @param   {String} key name
     * @param   {Function} function
     */
    Object.defineProperty(Object.prototype, "defineFunction", {
        value: function(name, fn) {
            Object.defineProperty(this, name, {
                value: fn,
                enumerable: false,
                writable: true
            });
        }
    });
    
    /**
     * @method defineInstanceVariable
     * インスタンス変数を定義する
     */
    Object.prototype.defineFunction("defineInstanceVariable", function(name, val){
        Object.defineProperty(this.prototype, name, {
            value: val,
            enumerable: true,
            writable: true
        });
    });
    
    /**
     * @method defineInstanceMethod
     * インスタンスメソッドを定義する
     */
    Object.prototype.defineFunction("defineInstanceMethod", function(name, fn){
        Object.defineProperty(this.prototype, name, {
            value: fn,
            enumerable: false,
            writable: true
        });
    });
    
    /**
     * @method setter
     * セッターを定義する
     */
    Object.defineInstanceMethod("setter", function(name, fn){
        Object.defineProperty(this, name, {
            set: fn,
            enumerable: false,
            configurable: true
        });
    });
    
    /**
     * @method getter
     * ゲッターを定義する
     */
    Object.defineInstanceMethod("getter", function(name, fn){
        Object.defineProperty(this, name, {
            get: fn,
            enumerable: false,
            configurable: true
        });
    });
    
    /**
     * @method accessor
     * アクセッサ(セッター/ゲッター)を定義する
     */
    Object.defineInstanceMethod("accessor", function(name, param) {
        Object.defineProperty(this, name, {
            set: param["set"],
            get: param["get"],
            enumerable: false,
            configurable: true
        });
    });
    
    /**
     * @method $forIn
     * オブジェクト用ループ処理
     */
    Object.defineInstanceMethod("$forIn", function(fn, self) {
        self = self || this;

        Object.keys(this).forEach(function(key, index) {
            var value = this[key];

            fn.call(self, key, value, index);
        }, this);

        return this;
    });

    /**
     * @method  $has
     * そのプロパティを持っているかを判定する
     */
    Object.defineInstanceMethod("$has", function(key) {
        return this.hasOwnProperty(key);
    });

    /**
     * @method  $extend
     * 他のライブラリと競合しちゃうので extend -> $extend としました
     */
    Object.defineInstanceMethod("$extend", function() {
        Array.prototype.forEach.call(arguments, function(source) {
            for (var property in source) {
                this[property] = source[property];
            }
        }, this);
        return this;
    });
    
    /**
     * @method  $safe
     * 安全拡張
     * 上書きしない
     */
    Object.defineInstanceMethod("$safe", function(source) {
        Array.prototype.forEach.call(arguments, function(source) {
            for (var property in source) {
                if (this[property] === undefined) this[property] = source[property];
            }
        }, this);
        return this;
    });
    
    
    /**
     * @method  $strict
     * 厳格拡張
     * すでにあった場合は警告
     */
    Object.defineInstanceMethod("$strict", function(source) {
        Array.prototype.forEach.call(arguments, function(source) {
            for (var property in source) {
                console.assert(!this[property], "tm error: {0} is Already".format(property));
                this[property] = source[property];
            }
        }, this);
        return this;
    });

    /**
     * @method  $pick
     * ピック
     */
    Object.defineInstanceMethod("$pick", function() {
        var temp = {};

        Array.prototype.forEach.call(arguments, function(key) {
            if (key in this) temp[key] = this[key];
        }, this);

        return temp;
    });

    /**
     * @method  $omit
     * オミット
     */
    Object.defineInstanceMethod("$omit", function() {
        var temp = {};

        for (var key in this) {
            if (Array.prototype.indexOf.call(arguments, key) == -1) {
                temp[key] = this[key];
            }
        }

        return temp;
    });
    
})();


/*
 * array.js
 */

(function() {
    
    /**
     * @class   global.Array
     * Arrayの拡張
     * 
     *      @example display
     *      [1, 2, 3].first;
     */
    
    /**
     * @property    first
     * 最初の要素
     */
    Array.prototype.accessor("first", {
        "get": function()   { return this[0]; },
        "set": function(v)  { this[0] = v; }
    });
    
    /**
     * @property    last
     * 最後の要素
     */
    Array.prototype.accessor("last", {
        "get": function()   { return this[this.length-1]; },
        "set": function(v)  { this[this.length-1] = v; }
    });

    /**
     * @method  equals
     * 渡された配列と等しいかどうかをチェック
     */
    Array.defineInstanceMethod("equals", function(arr) {
        // 長さチェック
        if (this.length !== arr.length) return false;
        
        for (var i=0,len=this.length; i<len; ++i) {
            if (this[i] !== arr[i]) {
                return false;
            }
        }
        return true;
    });
    
    /**
     * @method  deepEquals
     * ネストされている配列含め渡された配列と等しいかどうかをチェック
     * equalsDeep にするか検討. (Java では deepEquals なのでとりあえず合わせとく)
     */
    Array.defineInstanceMethod("deepEquals", function(arr) {
        // 長さチェック
        if (this.length !== arr.length) return false;
        
        for (var i=0,len=this.length; i<len; ++i) {
            var result = (this[i].deepEquals) ? this[i].deepEquals(arr[i]) : (this[i] === arr[i]);
            if (result === false) {
                return false;
            }
        }
        return true;
    });

    /**
     * @property    contains
     * 要素が含まれいるかをチェック
     */
    Array.defineInstanceMethod("contains", function(item, fromIndex) {
        return this.indexOf(item, fromIndex) != -1;
    });
    
    /**
     * @method  at
     * ループ添字アクセス(Ruby っぽいやつ)
     */
    Array.defineInstanceMethod("at", function(i) {
        i%=this.length;
        i+=this.length;
        i%=this.length;
        return this[i];
    });
    
    
    /**
     * @method  swap
     * a番目 と b番目 を入れ替える
     */
    Array.defineInstanceMethod("swap", function(a, b) {
        var temp = this[a];
        this[a] = this[b];
        this[b] = temp;
        
        return this;
    });
    
    
    /**
     * @method  erase
     * elm と一致する要素を削除
     */
    Array.defineInstanceMethod("erase", function(elm) {
        var index  = this.indexOf(elm);
        if (index >= 0) {
            this.splice(index, 1);
        }
        return this;
    });
    
    /**
     * @method  eraseAll
     * elm と一致する要素を全て削除
     */
    Array.defineInstanceMethod("eraseAll", function(elm) {
        for (var i=0,len=this.length; i<len; ++i) {
            if (this[i] == elm) {
                this.splice(i--, 1);
            }
        }
        return this;
    });
    
    /**
     * @method  eraseIf
     * 条件にマッチした要素を削除
     */
    Array.defineInstanceMethod("eraseIf", function(fn) {
        for (var i=0,len=this.length; i<len; ++i) {
            if ( fn(this[i], i, this) ) {
                this.splice(i, 1);
                break;
            }
            // if ( fn(this[i], i, this) ) { this.splice(i--, 1); }
        }
        return this;
    });
    
    /**
     * @method  eraseIfAll
     * 条件にマッチした要素を削除
     */
    Array.defineInstanceMethod("eraseIfAll", function(fn) {
        for (var i=0,len=this.length; i<len; ++i) {
            if ( fn(this[i], i, this) ) {
                this.splice(i, 1);
            }
        }
        return this;
    });
    
    /**
     * @method  random
     * 要素の中からランダムで取り出す
     */
    Array.defineInstanceMethod("random", function(min, max) {
        min = min || 0;
        max = max || this.length-1;
        return this[ Math.rand(min, max) ];
    });
    
    /**
     * @method  pickup
     * 要素の中からランダムで取り出す
     */
    Array.defineInstanceMethod("pickup", function(min, max) {
        min = min || 0;
        max = max || this.length-1;
        return this[ Math.rand(min, max) ];
    });
    
    /**
     * @method  uniq
     * 重複削除
     */
    Array.defineInstanceMethod("uniq", function(deep) {
        return this.filter(function(value, index, self) {
            return self.indexOf(value) === index;
        });
    });
    

    /**
     * @method  flatten
     * フラット.
     * Ruby のやつ.
     */
    Array.defineInstanceMethod("flatten", function(level) {
        var arr = null;

        if (level) {
            arr = this;
            for (var i=0; i<level; ++i) {
                arr = Array.prototype.concat.apply([], arr);
            }
        }
        else {
            // 完全フラット
            arr = this.reduce(function (previousValue, curentValue) {
                return Array.isArray(curentValue) ?
                    previousValue.concat(curentValue.flatten()) : previousValue.concat(curentValue);
            }, []);
        }

        return arr;
    });
    
    /**
     * @method  clone
     * 配列をクローン
     */
    Array.defineInstanceMethod("clone", function(deep) {
        if (deep == true) {
            var a = Array(this.length);
            for (var i=0,len=this.length; i<len; ++i) {
                a[i] = (this[i].clone) ? this[i].clone(deep) : this[i];
            }
            return a;
        };
        
        return Array.prototype.slice.apply(this);
    });
    
    /**
     * @method  clear
     * クリア
     */
    Array.defineInstanceMethod("clear", function() {
        this.length = 0;
        return this;
    });
    
    /**
     * @method  fill
     * 特定の値で満たす
     */
    Array.defineInstanceMethod("fill", function(value, start, end) {
        start = start || 0;
        end   = end   || (this.length);
        
        for (var i=start; i<end; ++i) {
            this[i] = value;
        }
        
        return this;
    });
    

    /**
     * @method  range
     * python のやつ
     */
    Array.defineInstanceMethod("range", function(start, end, step) {
        if (arguments.length == 1) {
            this.clear();
            for (var i=0; i<start; ++i) this[i] = i;
        }
        else if (start < end){
            step  = step || 1;
            this.clear();
            for (var i=start, index=0; i<end; i+=step, ++index) {
                this[index] = i;
            }
        }
        else {
            step  = step || -1;
            this.clear();
            for (var i=start, index=0; i>end; i+=step, ++index) {
                this[index] = i;
            }
        }
        
        return this;
    });
    
    /**
     * @method  shuffle
     * シャッフル
     */
    Array.defineInstanceMethod("shuffle", function() {
        for (var i=0,len=this.length; i<len; ++i) {
            var j = Math.rand(0, len-1);
            
            if (i != j) {
                this.swap(i, j);
            }
        }
        
        return this;
    });

    /**
     * @method  sum
     * 合計
     */
    Array.defineInstanceMethod("sum", function() {
        var sum = 0;
        for (var i=0,len=this.length; i<len; ++i) {
            sum += this[i];
        }
        return sum;
    });

    /**
     * @method  average
     * 平均
     */
    Array.defineInstanceMethod("average", function() {
        var sum = 0;
        var len = this.length;
        for (var i=0; i<len; ++i) {
            sum += this[i];
        }
        return sum/len;
    });

    /**
     * @method  each
     * 繰り返し
     * チェーンメソッド対応
     */
    Array.defineInstanceMethod("each", function() {
        this.forEach.apply(this, arguments);
        return this;
    });

    
    /**
     * @method  toULElement
     * ULElement に変換
     */
    Array.defineInstanceMethod("toULElement", function(){
        // TODO: 
    });

    /**
     * @method  toOLElement
     * OLElement に変換
     */
    Array.defineInstanceMethod("toOLElement", function(){
        // TODO:
    });

    
    /**
     * @static
     * @method  range
     * range
     */
    Array.defineFunction("range", function(start, end, step) {
        return Array.prototype.range.apply([], arguments);
    });
    
})();


/*
 * date.js
 */

(function() {
    
    /**
     * @class   global.Date
     * Date(日付)の拡張
     */
    
    var MONTH = [
        "January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"
    ];
    
    var WEEK = [
        "Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"
    ];
    
    /**
     * @method  format
     * 日付フォーマットに合わせた文字列を返す
     */
    Date.defineInstanceMethod("format", function(pattern) {
        /*
        var str = "{y}/{m}/{d}".format({
            y: this.getYear()+1900,
            m: this.getMonth()+1,
            d: this.getDate(),
        });
        
        return str;
        */
        
        var year    = this.getFullYear();
        var month   = this.getMonth();
        var date    = this.getDate();
        var day     = this.getDay();
        var hours   = this.getHours();
        var minutes = this.getMinutes();
        var seconds = this.getSeconds();
        var millseconds = this.getMilliseconds();
        var str = "";
        
        for (var i=0,len=pattern.length; i<len; ++i) {
            var ch = pattern.charAt(i);
            var temp = "";
            switch(ch) {
                // 日
                case "d": temp = date.padding(2, '0'); break;
                case "D": temp = WEEK[day].substr(0, 3); break;
                case "j": temp = date; break;
                case "l": temp = WEEK[day]; break;
                // case "N": temp = ; break;
                // case "S": temp = ; break;
                // case "w": temp = ; break;
                // case "z": temp = ; break;
                
                // 月
                case "F": temp = MONTH[month]; break;
                case "m": temp = (month+1).padding(2, '0'); break;
                case "M": temp = MONTH[month].substr(0, 3); break;
                case "n": temp = (month+1); break;
                // case "t": temp = (month+1); break;
                
                // 年
                // case "L": temp = ; break;
                // case "o": temp = ; break;
                case "Y": temp = year; break;
                case "y": temp = year.toString().substr(2, 2); break;
                
                
                // 時間
                // case "a": temp = ; break;
                // case "A": temp = ; break;
                // case "B": temp = ; break;
                // case "g": temp = ; break;
                case "G": temp = hours; break;
                // case "h": temp = ; break;
                case "H": temp = hours.padding(2, '0'); break;
                case "i": temp = minutes.padding(2, '0'); break;
                case "s": temp = seconds.padding(2, '0'); break;
                case "S": temp = millseconds.padding(3, '0'); break;
                
                default : temp = ch; break;
            }
            str += temp;
        }
        return str;
    });
    
})();


/*
 * function.js
 */

(function() {
    
    /**
     * @class   global.Function
     * Functionの拡張
     */
    if (!Function.prototype.bind) {
        /**
         * @member  global.Function
         * @method  bind
         * バインド
         */
        Function.defineInstanceMethod("bind", function(obj) {
            var self = this;
            
            return function() {
                self.apply(obj, arguments);
            };
        });
    }


    // 関数名（無名関数は空文字列）を取得 (IE用パッチ)
    if (!Function.prototype.$has("name")) {
        Function.prototype.getter("name", function() {
            return (''+this).replace(/^\s*function\s*([^\(]*)[\S\s]+$/im, '$1');
        });
    }
    

    /**
     * @method  toArrayFunction
     * 関数を配列対応関数に変換.
     * forEach の逆アプローチ的な感じ.
     * 配列を継承したクラスなどに使用する.
     * ## Example
     *      var hoge = function(n) { console.log(this*n); return this*n; };
     *      var arr = [5, 10, 15];
     *      arr.hogeArray = hoge.toArrayFunction();
     *      var result = arr.hogeArray(100);
     *      console.log(result);
     */
    Function.defineInstanceMethod("toArrayFunction", function() {
        var self = this;
        return function() {
            var resultList = [];
            for (var i=0,len=this.length; i<len; ++i) {
                resultList.push( self.apply(this[i], arguments) );
            }
            return resultList;
        }
    });
    
    // forEach や map はもう標準化されてきてるので実装しないよん♪
    
})();


/*
 * math.js
 */

(function() {
    
    /**
     * @class global.Math
     * Mathの拡張
     */

    
    /**
     * @property    DEG_TO_RAD
     * Degree to Radian.
     */
    Math.DEG_TO_RAD = Math.PI/180;
    
    /**
     * @property    RAD_TO_DEG
     * Radian to Degree.
     */
    Math.RAD_TO_DEG = 180/Math.PI;
    
    /**
     * @method
     * Degree を Radian に変換
     */
    Math.degToRad = function(deg) {
        return deg * Math.DEG_TO_RAD;
    };
    
    /**
     * @method
     * Radian を Degree に変換
     */
    Math.radToDeg = function(rad) {
        return rad * Math.RAD_TO_DEG;
    };
    

    
    /**
     * @method
     * クランプ
     */
    Math.defineFunction("clamp", function(value, min, max) {
        return (value < min) ? min : ( (value > max) ? max : value );
    });
    
    /**
     * @method
     * min <= value <= max のとき true を返す
     */
    Math.defineFunction("inside", function(value, min, max) {
        return (value >= min) && (value) <= max;
    });
    
    /**
     * @method
     * ランダムな値を指定された範囲内で生成
     */
    Math.defineFunction("rand", function(min, max) {
        return window.Math.floor( Math.random()*(max-min+1) ) + min;
    });
    
    /**
     * @method
     * ランダムな値を指定された範囲内で生成
     */
    Math.defineFunction("randf", function(min, max) {
        return window.Math.random()*(max-min)+min;
    });
    
})();


/*
 * number.js
 */

(function() {
    
    /**
     * @class global.Number
     * Numberの拡張
     */
    
    /**
     * @method  round
     * 四捨五入
     * 桁数指定版
     */
    Number.defineInstanceMethod("round", function(figure) {
        figure = figure || 0;
        var base = Math.pow(10, figure);
        var temp = this * base;
        temp = Math.round(temp);
        return temp/base;
    });
    
    /**
     * @method  ceil
     * 切り上げ.
     * 桁数指定版
     */
    Number.defineInstanceMethod("ceil",  function(figure) {
        figure = figure || 0;
        var base = Math.pow(10, figure);
        var temp = this * base;
        temp = Math.ceil(temp);
        return temp/base;
    });
    /**
     * @method  floor
     * 切り捨て
     * 桁数指定版
     */
    Number.defineInstanceMethod("floor",  function(figure) {
        figure = figure || 0;
        var base = Math.pow(10, figure);
        var temp = this * base;
        temp = Math.floor(temp);
        
        // ~~this
        // this|0
        
        return temp/base;
    });
    
    /**
     * @method  toInt
     * integer 型に変換する
     */
    Number.defineInstanceMethod("toInt",  function() {
        return (this | 0);
    });
    
    /**
     * @method  toHex
     * 16進数化
     */
    Number.defineInstanceMethod("toHex",  function() {
        return this.toString(16);
    });
    
    /**
     * @method  toBin
     * 2進数化
     */
    Number.defineInstanceMethod("toBin",  function() {
        return this.toString(2);
    });
    
    
    /**
     * @method  toUnsigned
     * unsigned 型に変換する
     */
    Number.defineInstanceMethod("toUnsigned",  function() {
        return this >>> 0;
    });
    
    /**
     * @method  padding
     * 文字埋め
     */
    Number.defineInstanceMethod("padding",  function(n, ch) {
        var str = this+'';
        n  = n-str.length;
        ch = ch || '0';
        
        while(n-- > 0) { str = ch + str; }
        
        return str;
    });
    
    /**
     * @method  times
     * 数値分繰り返す
     */
    Number.defineInstanceMethod("times",  function(fn, self) {
        self = self || this;
        for (var i=0; i<this; ++i) {
            fn.call(self, i);
        }
        return this;
    });
    
    /**
     * @method  upto
     * インクリメント繰り返し
     */
    Number.defineInstanceMethod("upto",  function(t, fn, self) {
        self = self || this;
        for (var i=+this; i<=t; ++i) {
            fn.call(self, i);
        }
        return this;
    });
    
    /**
     * @method  upto
     * デクリメント繰り返し
     */
    Number.defineInstanceMethod("downto",  function(t, fn, self) {
        self = self || this;
        for (var i=+this; i>=t; --i) {
            fn.call(self, i);
        }
        return this;
    });

    /**
     * @method step
     * ステップ繰り返し(float対応)
     */
    Number.defineInstanceMethod("step",  function(limit, step, fn, self) {
        self = self || this;
        for (var i=+this; i<=limit; i+=step) {
            fn.call(self, i);
        }
        return this;
    });

    
})();


/*
 * string.js
 */

(function() {
    
    /**
     * @class global.String
     * Stringの拡張
     * `String` is a global object that may be used to construct String instances.
     */
    
    
    /**
     * @method  format
     * 
     * フォーマット
     * 
     * ## example
     * 
     *      document.write("{0} + {1} = {2}".format(5, 10, 5+10));   // "5 + 10 = 15"
     *      document.write("rgb({r}, {g}, {b})".format({             // "rgb(128, 0, 255)"
     *          r: 128,
     *          g: 0,
     *          b: 255
     *      }));
     */
    String.defineInstanceMethod("format", function(arg) {
        // 置換ファンク
        var rep_fn = undefined;
        
        // オブジェクトの場合
        if (typeof arg == "object") {
            /** @ignore */
            rep_fn = function(m, k) {
                if (arg[k] === undefined) {
                    return '';
                }
                else {
                    return arg[k];
                }
            }
        }
        // 複数引数だった場合
        else {
            var args = arguments;
            /** @ignore */
            rep_fn = function(m, k) { return args[ parseInt(k) ]; }
        }
        
        return this.replace( /\{(\w+)\}/g, rep_fn );
    });
    
    /**
     * @method  trim
     * トリム
     * 
     * <a href="http://jamesroberts.name/blog/2010/02/22/string-functions-for-javascript-trim-to-camel-case-to-dashed-and-to-underscore/">Reference</a>
     * 
     */
    String.defineInstanceMethod("trim", function() {
        return this.replace(/^\s+|\s+$/g, "");
    });
    
    /**
     * @method  capitalize
     * キャピタライズ
     * 
     * ## Reference
     * 
     * - [キャピタライズ(単語の先頭の大文字化)を行う - oct inaodu](http://d.hatena.ne.jp/brazil/20051212/1134369083)
     * - [デザインとプログラムの狭間で: javascriptでキャピタライズ（一文字目を大文字にする）](http://design-program.blogspot.com/2011/02/javascript.html)
     * 
     */
    String.defineInstanceMethod("capitalize", function() {
        return this.replace(/\w+/g, function(word){
            return word.capitalizeFirstLetter();
        });
    });
    
    /**
     * @method  capitalizeFirstLetter
     * 先頭文字のみキャピタライズ
     */
    String.defineInstanceMethod("capitalizeFirstLetter", function() {
        return this.charAt(0).toUpperCase() + this.substr(1).toLowerCase();
    });
    
    /**
     * @method  toDash
     * ダッシュ
     */
    String.defineInstanceMethod("toDash", function() {
        return this.replace(/([A-Z])/g, function(m){ return '-'+m.toLowerCase(); });
    });
    
    
    /**
     * @method toHash
     * ハッシュ値に変換
     */
    String.defineInstanceMethod("toHash", function() {
        return this.toCRC32();
    });
    
    /**
     * @method  padding
     * 左側に指定された文字を詰めて右寄せにする
     */
    String.defineInstanceMethod("padding", function(n, ch) {
        var str = this.toString();
        n  = n-str.length;
        ch = ch || ' ';
        
        while(n-- > 0) { str = ch + str; }
        
        return str;
    });
    
    /**
     * @method  paddingLeft
     * 左側に指定された文字を詰めて右寄せにする
     */
    String.defineInstanceMethod("paddingLeft", function(n, ch) {
        var str = this.toString();
        n  = n-str.length;
        ch = ch || ' ';
        
        while(n-- > 0) { str = ch + str; }
        
        return str;
    });
    
    /**
     * @method  paddingRight
     * 右側に指定された文字を詰めて左寄せにする
     */
    String.defineInstanceMethod("paddingRight", function(n, ch) {
        var str = this.toString();
        n  = n-str.length;
        ch = ch || ' ';
        
        while(n-- > 0) { str = str + ch; }
        
        return str;
    });
    
    /**
     * @method  quotemeta
     * メタ文字をクォート
     */
    String.defineInstanceMethod("quotemeta", function(n) {
        return this.replace(/([^0-9A-Za-z_])/g, '\\$1');
    });
    
    /**
     * @method  repeat
     * リピート
     */
    String.defineInstanceMethod("repeat", function(n) {
        // TODO: 確認する
        var arr = Array(n);
        for (var i=0; i<n; ++i) arr[i] = this;
        return arr.join('');
    });
    
    /**
     * @method  count
     * リピート
     */
    String.defineInstanceMethod("count", function(str) {
        var re = new RegExp(str, 'gm');
        return this.match(re).length;
    });
    
    /**
     * @method  toString
     * 配列に変換
     */
    String.defineInstanceMethod("toArray", function() {
        var arr = [];
        for (var i=0,len=this.length; i<len; ++i) {
            arr.push(this[i]);
        }
        return arr;
    });
    
    
    var table = "00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D".split(' ');
    
    /**
     * @method  toCRC32
     * CRC32 変換
     */
    String.defineInstanceMethod("toCRC32", function() {
        var crc = 0, x=0, y=0;
        
        crc = crc ^ (-1);
        for (var i=0, iTop=this.length; i<iTop; ++i) {
            y = (crc ^ this.charCodeAt(i)) & 0xff;
            x = "0x" + table[y];
            crc = (crc >>> 8) ^ x;
        }
        
        return (crc ^ (-1)) >>> 0;
    });
    
    
})();

/*
 * event/event.js
 */

tm.event = tm.event || {};

(function() {
    
    /**
     * @class tm.event.Event
     * イベントクラス
     */
    tm.event.Event = tm.createClass({
        
        /** タイプ */
        type: null,
        
        /**
         * @constructor
         */
        init: function(type) {
            this.type = type;
        },
        
    });
    
})();


(function() {
    
    /**
     * @class tm.event.TweenEvent
     * Tween Event
     * @extends tm.event.Event
     */
    tm.event.TweenEvent = tm.createClass({
        
        superClass: tm.event.Event,

        /** time */
        time: null,
        /** now */
        now: null,

        /**
         * @constructor
         */
        init: function(type, time, now) {
            this.superInit(type);
            
            this.time = time;
            this.now  = now;
        }
        
    });
    
    /**
     * @static
     * チェンジ
     */
    tm.event.TweenEvent.CHANGE    = "change";
    /**
     * @static
     * フィニッシュ
     */
    tm.event.TweenEvent.FINISH    = "finish";
    /**
     * @static
     * ループ
     */
    tm.event.TweenEvent.LOOP      = "loop";
    /**
     * @static
     * レジューム
     */
    tm.event.TweenEvent.RESUME    = "resume";
    /**
     * @static
     * スタート
     */
    tm.event.TweenEvent.START     = "start";
    /**
     * @static
     * ストップ
     */
    tm.event.TweenEvent.STOP      = "stop";
    
})();




(function() {
    
    /**
     * @class tm.event.MouseEvent
     * Pointing Event
     * @extends tm.event.Event
     */
    tm.event.MouseEvent = tm.createClass({
        
        superClass: tm.event.Event,

        /**
         * app
         */
        app: null,

        /**
         * pointing
         */
        pointing: null,

        /**
         * @constructor
         */
        init: function(type, app, pointing) {
            this.superInit(type);
            
            this.app = app;
            this.pointing = pointing;
        }
        
    });
    
})();




(function() {
    
    /**
     * @class tm.event.TouchEvent
     * Pointing Event
     * @extends tm.event.Event
     */
    tm.event.TouchEvent = tm.createClass({
        
        superClass: tm.event.Event,

        /**
         * app
         */
        app: null,

        /**
         * pointing
         */
        pointing: null,

        /**
         * @constructor
         */
        init: function(type, app, pointing) {
            this.superInit(type);
            
            this.app = app;
            this.pointing = pointing;
        }
        
    });
    
})();



(function() {
    
    /**
     * @class tm.event.PointingEvent
     * Pointing Event
     * @extends tm.event.Event
     */
    tm.event.PointingEvent = tm.createClass({
        
        superClass: tm.event.Event,

        /**
         * app
         */
        app: null,
        
        /**
         * pointing
         */
        pointing: null,
        
        /**
         * @constructor
         */
        init: function(type, app, pointing) {
            this.superInit(type);
            
            this.app = app;
            this.pointing = pointing;
        }
        
    });
    
    // tm.event.PointingEvent.CHANGE    = "change";
    // tm.event.PointingEvent.FINISH    = "finish";
    // tm.event.PointingEvent.LOOP      = "loop";
    // tm.event.PointingEvent.RESUME    = "resume";
    // tm.event.PointingEvent.START     = "start";
    // tm.event.PointingEvent.STOP      = "stop";
    
})();



/*
 * eventdispatcher.js
 */

tm.event = tm.event || {};

(function() {
    
    /**
     * @class tm.event.EventDispatcher
     * Event Dispatcher
     * ### Reference
     * -(EventDispatcher - ActionScript 3.0 コンポーネントリファレンスガイド)[http://livedocs.adobe.com/flash/9.0_jp/ActionScriptLangRefV3/flash/events/EventDispatcher.html]
     */
    tm.define("tm.event.EventDispatcher", {

        /** @private @property _listeners */

        /**
         * @constructor
         */
        init: function() {
            this._listeners = {};
        },

        /**
         * イベントリスナー追加
         */
        on: function(type, listener) {
            if (this._listeners[type] === undefined) {
                this._listeners[type] = [];
            }
            
            this._listeners[type].push(listener);
            return this;
        },
        
        /**
         * リスナーを削除
         */
        off: function(type, listener) {
            var listeners = this._listeners[type];
            var index = listeners.indexOf(listener);
            if (index != -1) {
                listeners.splice(index,1);
            }
            return this;
        },
        
        /**
         * イベント発火
         */
        fire: function(e) {
            e.target = this;
            var oldEventName = 'on' + e.type;
            if (this[oldEventName]) this[oldEventName](e);
            
            var listeners = this._listeners[e.type];
            if (listeners) {
                var temp = listeners.clone();
                for (var i=0,len=temp.length; i<len; ++i) {
                    temp[i].call(this, e);
                }
            }
            
            return this;
        },

        /*
         * イベント名でイベント発火
         */
        flare: function(eventName, param) {
            var e = tm.event.Event(eventName);
            if (param) {
                e.$extend(param);
            }
            this.fire(e);

            return this;
        },
        
        one: function(type, listener) {
            var self = this;
            
            var func = function() {
                var result = listener.apply(self, arguments);
                self.off(type, func);
                return result;
            };
            
            this.on(type, func);
            
            return this;
        },

        /**
         * type に登録されたイベントがあるかをチェック
         */
        hasEventListener: function(type) {
            if (this._listeners[type] === undefined && !this["on" + type]) return false;
            return true;
        },
        
        /**
         * type に登録されているリスナーを全てクリア
         */
        clearEventListener: function(type) {
            var oldEventName = 'on' + type;
            if (this[oldEventName]) delete this[oldEventName];

            this._listeners[type] = [];
            return this;
        },
    });

    var proto = tm.event.EventDispatcher.prototype;
    
    /**
     * @member  tm.event.EventDispatcher
     * @method  addEventListener
     * on と同じ
     */
    proto.addEventListener      = proto.on;
    
    /**
     * @member  tm.event.EventDispatcher
     * @method  removeEventListener
     * off と同じ
     */
    proto.removeEventListener   = proto.off;
    
    /**
     * @member  tm.event.EventDispatcher
     * @method  dispatchEvent
     * fire と同じ
     */
    proto.dispatchEvent         = proto.fire;
    
    /**
     * @member  tm.event.EventDispatcher
     * @method  trigger
     * fire と同じ
     */
    proto.trigger = proto.fire;
    
})();

/*
 * random.js
 */

tm.util = tm.util || {};


(function() {
    
    /**
     * @class tm.util.Random
     * ランダムクラス
     * 
     * ## Reference
     * - <http://www.python.jp/doc/2.5/lib/module-random.html>
     * - <http://www.yukun.info/blog/2008/06/python-random.html>
     * - <http://www.python-izm.com/contents/application/random.shtml>
     * - <http://libcinder.org/docs/v0.8.3/classcinder_1_1_rand.html>
     * - <http://libcinder.org/docs/v0.8.3/_rand_8h_source.html>
     */
    tm.util.Random = {
        
        /**
         * Dummy
         */
        randint: function(min, max) {
            return window.Math.floor( Math.random()*(max-min+1) ) + min;
        },
        
        /**
         * Dummy
         */
        randfloat: function(min, max) {
            return window.Math.random()*(max-min)+min;
        },
        
        /**
         * Dummy
         */
        randbool: function() {
            return this.randint(0, 1) === 1;
        },
    };
    
})();

/*
 * ajax.js
 */

tm.util = tm.util || {};


(function() {

    /*
     * @enum
     * @private
     */
    var AJAX_DEFAULT_SETTINGS = {
        /* @property type */
        type :"GET",
        /* @property async */
        async: true,
        /* @property data */
        data: null,
        /* @property contentType */
        contentType: 'application/x-www-form-urlencoded',
        /* @property dataType */
        dataType: 'text',
        /* @property dataType */
        responseType: '', // or 'arraybuffer'
        /* @property username */
        username: null,
        /* @property password */
        password: null,
        /* @property success */
        success : function(data){ alert("success!!\n"+data); },
        /* @property error */
        error   : function(data){ alert("error!!"); },
        /* @property beforeSend */
        beforeSend: null,
    };

    /**
     * @class tm.util.Ajax
     * Ajax クラス
     */
    tm.util.Ajax = {
        /**
         * load
         */
        load: function(params) {
            for (var key in AJAX_DEFAULT_SETTINGS) {
                params[key] = params[key] || AJAX_DEFAULT_SETTINGS[key];
            }

            var httpRequest = new XMLHttpRequest();
            var ajax_params = "";
            var conv_func = tm.util.Ajax.DATA_CONVERTE_TABLE[params.dataType];

            var url = params.url;
            if (params.data) {
                var query = "";
                if (typeof params.data == 'string') {
                    query = params.data;
                    // query = encodeURIComponent(params.data);
                }
                else {
                    query = tm.util.QueryString.stringify(params.data);
                }

                if (params.type == 'GET') {
                    params.url += '?' + query;
                    params.data = null;
                }
                else if (params.type == 'POST') {
                    params.data = query;
                }
            }

            // httpRequest.withCredentials = true;

            // コールバック
            httpRequest.onreadystatechange = function() {
                if (httpRequest.readyState == 4) {
                    // 成功(status === 0 はローカルファイル用)
                    if (httpRequest.status === 200 || httpRequest.status === 201 || httpRequest.status === 0) {
                        if (params.responseType !== "arraybuffer") {
                            // タイプ別に変換をかける
                            var data = conv_func(httpRequest.responseText);
                            params.success(data);
                        }
                        else {
                            // バイナリデータ
                            params.success(this.response);
                        }
                    }
                    else {
                        params.error(httpRequest.responseText);
                    }
                }
                else {
                    //console.log("通信中");
                }
            };


            httpRequest.open(params.type, params.url, params.async, params.username, params.password);   // オープン
            if (params.type === "POST") {
                httpRequest.setRequestHeader('Content-Type', params.contentType);        // ヘッダをセット
            }

            if (params.responseType) {
                httpRequest.responseType = params.responseType;
            }

            if (params.beforeSend) {
                params.beforeSend(httpRequest);
            }

            if (params.password) {
                httpRequest.withCredentials = true;
            }

            httpRequest.send(params.data);
        },

        /**
         * loadJSONP
         */
        loadJSONP: function(url, callback) {
            var g = tm.global;
            g.tmlib_js_dummy_func_count = tm.global.tmlib_js_dummy_func || 0;
            var dummy_func_name = "tmlib_js_dummy_func" + (g.tmlib_js_dummy_func_count++);
            g[dummy_func_name]  = callback;

            var elm = document.createElement("script");
            elm.type = "text/javascript";
            elm.charset = "UTF-8";
            elm.src = url + (url.indexOf("?") < 0 ? "?" : "&") + "callback=" + dummy_func_name;
            elm.setAttribute("defer", true);
            document.getElementsByTagName("head")[0].appendChild(elm);
        }
    };

    /*
     * @enum tm.util.Ajax.DATA_CONVERTE_TABLE
     * データコンバータテーブル
     */
    tm.util.Ajax.DATA_CONVERTE_TABLE = {
        /* @method */
        undefined: function(data) {
            return data;
        },

        /* @method */
        text: function(data) {
            return data;
        },

        /* @method */
        xml: function(data) {
            var parser = new DOMParser();
            var xml = parser.parseFromString(data, 'text/xml');

            return xml;
        },

        /* @method */
        dom: function(data) {
            var div = document.createElement("div");
            div.innerHTML = data;
            return tm.dom.Element(div);
        },

        /* @method */
        json: function(data) {
            try {
                return JSON.parse(data);
            }
            catch(e) {
                console.dir(e);
                console.dir(data);
            }
        },

        /* @method */
        script: function(data) {
            eval(data);
            return data;
        },

        /*
         * @method
         * ### Reference
         * - <http://efcl.info/adiary/Javascript/treat-binary>
         * @param {Object} data
         */
        bin: function(data) {
            var bytearray = [];
            for (var i=0, len=data.length; i<len; ++i) {
                bytearray[i] = data.charCodeAt(i) & 0xff;
            }
            return bytearray;
        },

    };


    tm.util.Ajax.DEFAULT_SETTINGS = AJAX_DEFAULT_SETTINGS;

})();

/*
 * file.js
 */

tm.util = tm.util || {};


(function() {
    
    /**
     * @class tm.util.File
     * ファイルクラス
     */
    tm.define("tm.util.File", {
        superClass: "tm.event.EventDispatcher",

        /** deta */
        data: null,
        /** deta */
        loaded: false,

        /**
         * @constructor
         */
        init: function(params) {
            this.superInit();

            this.loaded = false;
            if (arguments.length == 1) {
                this.load(params);
            }
        },
        
        /**
         * ロード
         */
        load: function(params) {
            if (typeof params == "string") {
                var url = params;
                params = { url: url, };
            }
            
            var self = this;
            params.success = function(data) {
                self.setData(data);
                var e = tm.event.Event("load");
                self.dispatchEvent( e );
            };
            tm.util.Ajax.load(params);
        },

        /**
         * setData
         */
        setData: function(data) {
            this.data = data;
            this.loaded = true;
        },
        
        /**
         * ローカルストレージからロード
         */
        loadLocalStorage: function() {
            
        },
        

    });
    
    
})();



/*
 * tmline.js
 */

tm.util = tm.util || {};


(function() {
    
    /**
     * @class tm.util.Timeline
     * タイムラインクラス
     */
    tm.util.Timeline = tm.createClass({
        
        /** target */
        target  : null,
        /** tasks */
        tasks   : null,
        /** fps */
        fps     : 30,
        
        /**
         * @constructor
         */
        init: function() {
            this.tasks = [];
            this.time = 0;
        },
        
        /**
         * アット
         */
        at: function(time, action) {
            this.tasks.push({
                time: time,
                action: action,
            });
            return this;
        },

        /**
         * アフター
         */
        after: function(time, action) {
            this.at(this.time + time, action);
            return this;
        },

        /**
         * クリア
         */
        clear: function() {
            this.tasks = [];
            return this;
        },

        /**
         * リムーブタイム
         */
        removeTime: function(time) {
            // TODO: 
        },

        /**
         * リムーブアクション
         */
        removeAction: function(action) {
            // TODO: 
        },
        
        /**
         * スタート
         */
        start: function() {
            this.isPlaying = true;
            this._startTime();
            this._updateTime();
        },

        /**
         * レジューム
         */
        resume: function() {
            this.isPlaying = true;
            this._resumeTime();
            this._updateTime();
        },

        /**
         * ストップ
         */
        stop: function() {
            this.isPlaying = false;
        },

        /**
         * レウィンド
         */
        rewind: function() {
            this.time = 0;
        },

        /**
         * 更新
         */
        update: function() {
            // タスク更新
            if (this.tasks.length > 0) {
                for (var i=0,len=this.tasks.length; i<len; ++i) {
                    var task = this.tasks[i];
                    if (this.prev <= task.time && task.time < this.time) {
                        task.action();
                        // this.tasks.erase(task);
                        // break;
                    }
                }
            }
        },
        
        /**
         * @private
         */
        _startTime: function() {
            this.startTime = (new Date()).getTime();
        },

        /**
         * @private
         */
        _resumeTime: function() {
            this.startTime = (new Date()).getTime() - this.time;
        },

        /**
         * @private
         */
        _updateTime: function() {
            if (this.isPlaying) {
                this._nextTime();
                setTimeout(arguments.callee.bind(this), 1000/this.fps);
            }
        },
        
        /**
         * @private
         */
        _nextTime: function() {
            // 前回の時間
            this.prev = this.time;
            // 今回の時間
            this.time = (new Date()).getTime() - this.startTime;
            // 更新
            this.update();
        },
        
    });
    
})();


/*
 * util/data.js
 */

tm.util = tm.util || {};


(function() {
    
    /**
     * @class tm.util.DataManager
     * データマネージャ
     */
    tm.util.DataManager = {
        data: {}
    };

    /**
     * @static
     * @method
     * セーブ
     */
    tm.util.DataManager.save = function() {
        // TODO: ローカルストレージ?
        for (var key in this.data) {
            var data = this.data[key];
            localStorage[key] = JSON.stringify( data );
        }
    };

    /**
     * @static
     * @method
     * ロード
     */
    tm.util.DataManager.load = function(key) {
        // TODO: ローカルストレージ?
        for (var key in localStorage) {
            this.data[key] = JSON.parse(localStorage[key]);
        }
    };

    /**
     * @static
     * @method
     * セット
     */
    tm.util.DataManager.set = function(key, value) {
        this.data[key] = value;
        return this;
    };

    /**
     * @static
     * @method
     * ゲット
     */
    tm.util.DataManager.get = function(key) {
        return this.data[key];
    };
    
    
    // tm.addLoadCheckList(tm.util.DataManager);
    
})();
/*
 * querystring.js
 */

tm.util = tm.util || {};


(function() {
    
    /**
     * @class tm.util.QueryString
     * クエリ文字列クラス
     */
    tm.util.QueryString = {
        /**
         * パース
         */
        parse: function(str, sep, eq) {
            sep = sep || '&';
            eq  = eq  || '=';
            
            var obj = {};
            var params = str.split(sep);
            for (var i=0,len=params.length; i<len; ++i) {
                var param = params[i];
                var pos = param.indexOf(eq);
                if (pos>0) {
                    var key = param.substring(0, pos);
                    var val = param.substring(pos+1);
                    obj[key] = val;
                }
            }
            
            return obj;
        },
        
        /**
         * ストリングファイ
         */
        stringify: function(obj, sep, eq) {
            sep = sep || '&';
            eq  = eq  || '=';
            
            
            var strList = [];
            for (var key in obj) {
                var value = encodeURIComponent(obj[key]);
                strList.push(key + eq + value);
            }
            
            return strList.join(sep);
        },
    };
    
})();




/*
 * type.js
 */

/**
 * @class tm.util.Type
 * 型チェック
 */
tm.namespace("tm.util.Type", function() {
    var self = this;
    var toString = Object.prototype.toString;

    /**
     * @static
     * @method  isObject
     * is object
     */
    this.defineFunction("isObject", function(obj) {
        return obj === Object(obj);
    });

    /**
     * @static
     * @method  isArray
     * is array
     */
    this.defineFunction("isArray", function(obj) {
        return toString.call(obj) == '[object Array]';
    });

    /**
     * @static
     * @method  isArguments
     * is arguments
     */
    this.defineFunction("isArguments", function(obj) {
        return toString.call(obj) == '[object Arguments]';
    });

    /**
     * @static
     * @method  isFunction
     * is function
     */
    this.defineFunction("isFunction", function(obj) {
        return toString.call(obj) == '[object Function]';
    });

    /**
     * @static
     * @method  isString
     * is string
     */
    this.defineFunction("isString", function(obj) {
        return toString.call(obj) == '[object String]';
    });

    /**
     * @static
     * @method  isNumber
     * is number
     */
    this.defineFunction("isNumber", function(obj) {
        return toString.call(obj) == '[object Number]';
    });

    /**
     * @static
     * @method  isDate
     * is date
     */
    this.defineFunction("isDate", function(obj) {
        return toString.call(obj) == '[object Date]';
    });

    /**
     * @static
     * @method  isRegExp
     * is RegExp
     */
    this.defineFunction("isRegExp", function(obj) {
        return toString.call(obj) == '[object RegExp]';
    });

    /**
     * @static
     * @method  isEmpty
     * is empty
     */
    this.defineFunction("isEmpty", function(obj) {
        if (!obj) return true;
        if (self.isArray(obj) || self.isString(obj) || self.isArguments(obj)) return obj.length === 0;
        for (var key in obj) {
            if (key) return false;
        }
        return true;
    });

});

/*
 * flow.js
 */

    
/**
 * @class tm.util.Flow
 * @extends tm.event.EventDispatcher
 * it is inspire in made flow.js of `@uupaa`
 */
tm.define("tm.util.Flow", {
    superClass: "tm.event.EventDispatcher",
    
    /** waits */
    waits: 0,
    /** counter */
    counter: 0,
    /** args */
    args: null,
    
    /**
     * @constructor
     */
    init: function(waits, callback) {
        this.superInit();
        
        waits = waits || 0;
        callback = callback || null;
        
        this.setup(waits, callback);
    },
    
    /**
     * セットアップ
     */
    setup: function(waits, callback) {
        this.waits = waits;
        this.callback = callback;
        this.counter = 0;
        this.args = {};

        this._check();

        return this;
    },
    
    /**
     * パス
     */
    pass: function(key, value) {
        ++this.counter;
        
        if (arguments.length >= 2) {
            this.args[key] = value;
        }
        
        this._check();
    },
    
    /**
     * 終了チェック
     */
    isFinish: function() {
        return (this.counter === this.waits);
    },
    
    _check: function() {
        if (this.isFinish()) {
            var args = this.args;
            
            if (this.callback) {
                this.callback(args);
                
                this.args = null;
                this.callback = null;
            }
            
            var e = tm.event.Event("flowfinish");
            e.args = args;
            this.fire(e);
        }
    }
});


/*
 * グリッドシステム
 */
tm.define("tm.util.GridSystem", {
    width: 640, // 幅
    col: 12,    // 列数
    
    init: function(width, col) {
        if (typeof arguments[0] === 'object') {
            var param = arguments[0];
            width = param.width;
            col = param.col;
        }
        
        this.width = width;
        this.col = col;
        this.unitWidth = this.width/this.col;
    },
    
    // スパン指定で値を取得(負数もok)
    span: function(index) {
        index += this.col;
        index %= this.col;

        return this.unitWidth * index;
    },
    
    // 真ん中
    center: function() {
        return this.unitWidth * (this.col/2);
    },
});

/*
 * vector2.js
 */

/*
 * 幾何学
 */
tm.geom = tm.geom || {};


(function() {
    
    /**
     * @class tm.geom.Vector2
     * 2次元ベクトル
     */
    tm.geom.Vector2 = tm.createClass({
        /** x座標 */
        x: 0,
        /** y座標 */
        y: 0,
        
        /**
         * @constructor
         */
        init: function(x, y) {
            this.set(x, y);
        },
        
        
        /**
         * 複製
         */
        clone: function() {
            return tm.geom.Vector2(this.x, this.y);
        },
        
        
        /**
         * 等しいかどうかをチェック
         * @param   {tm.geom.Vector2}   v   比較対象となる２次元ベクトル
         */
        equals: function(v) {
            return (this.x === v.x && this.y === v.y) ? true : false;
        },
        
        /**
         * 数値と等しいかどうかをチェック
         * @param   {Number}   x    比較対象となる x 値
         * @param   {Number}   y    比較対象となる y 値
         */
        equalsNumber: function(x, y) {
            return (this.x === x && this.y === y) ? true : false;
        },
        
        /**
         * 配列と等しいかどうかをチェック
         * @param   {Number}   arr  比較対象となる配列
         */
        equalsArray: function(arr) {
            return (this.x === arr[0] && this.y === arr[1]) ? true : false;
        },
        
        
        /**
         * セッター
         */
        set: function(x, y) {
            this.x = x;
            this.y = y;
        },
        
        /**
         * 数値からセット
         */
        setNumber: function(x, y) {
            this.x = x;
            this.y = y;
            
            return this;
        },
        
        /**
         * 配列からセット
         */
        setArray: function(arr) {
            this.x = arr[0];
            this.y = arr[1];
            
            return this;
        },
        
        /**
         * オブジェクトからセット
         */
        setObject: function(obj) {
            this.x = obj.x;
            this.y = obj.y;
            
            return this;
        },
        
        /**
         * 文字列からセット
         */
        setString: function(str) {
            var m = str.match(/(-?\d+(\.{1}\d+)?),\s*(-?\d+(\.{1}\d+)?)/);
            this.x = parseFloat(m[1]);
            this.y = parseFloat(m[3]);
            
            return this;
        },
        
        /**
         * 賢いセット
         */
        setSmart: function(x, y) {
            var v = arguments[0];
            // xyz
            if (arguments.length === 2) {
                this.x = x;
                this.y = y;
            }
            // Array
            else if (v instanceof Array) {
                this.x = v[0];
                this.y = v[1];
            }
            // Object
            else if (v instanceof Object) {
                this.x = v.x;
                this.y = v.y;
            }
            // String
            else if (typeof(v) == "string") {
                var m = v.match(/(-?\d+(\.{1}\d+)?),\s*(-?\d+(\.{1}\d+)?)/);
                this.x = parseFloat(m[1]);
                this.y = parseFloat(m[3]);
            }
            
            return this;
        },
        
        /**
         * 角度と長さでベクトルをセット
         * Angle は Degree 値で指定
         */
        setAngle: function(angle, len) {
            var rad = angle*Math.DEG_TO_RAD;
            
            len = len || 1;
            this.x = Math.cos(rad)*len;
            this.y = Math.sin(rad)*len;
            
            return this;
        },
        
        /**
         * 角度(radian)と長さでベクトルをセット
         */
        setRadian: function(radian, len) {
            len = len || 1;
            this.x = Math.cos(radian)*len;
            this.y = Math.sin(radian)*len;
            
            return this;
        },
        
        /**
         * 角度(degree)と長さでベクトルをセット
         */
        setDegree: function(degree, len) {
            var rad = degree*Math.DEG_TO_RAD;
            
            len = len || 1;
            this.x = Math.cos(rad)*len;
            this.y = Math.sin(rad)*len;
            
            return this;
        },
        
        /**
         * ランダムベクトルをセット
         */
        setRandom: function(min, max, len) {
            min = min || 0;
            max = max || 360;
            len = len || 1;
            this.setDegree(Math.randf(min, max), len);
            return this;
        },
        
        /**
         * 加算
         */
        add: function(v) {
            this.x += v.x;
            this.y += v.y;
            
            return this;
        },
        
        /**
         * 減算
         */
        sub: function(v) {
            this.x -= v.x;
            this.y -= v.y;
            
            return this;
        },
        
        /**
         * 乗算
         */
        mul: function(n) {
            this.x *= n;
            this.y *= n;
            
            return this;
        },
        
        /**
         * 除算
         */
        div: function(n) {
            //console.assert(n != 0, "0 division!!");
            n = n || 0.01;
            this.x /= n;
            this.y /= n;
            
            return this;
        },
        
        /**
         * 反転
         */
        negate: function() {
            this.x = -this.x;
            this.y = -this.y;
            
            return this;
        },

        /**
         * @method
         * 内積.
         * 投影ベクトルを求めたり, 類似度に使ったり.
         */
        dot: function(v) {
            return this.x * v.x + this.y * v.y;
        },

        /**
         * @method
         * 外積
         */
        cross: function(v) {
            return (this.x*v.y) - (this.y*v.x);
        },
        
        /**
         * 長さを取得
         * ### memo
         * magnitude って名前の方が良いかも. 検討中.
         */
        length: function() {
            return Math.sqrt(this.x*this.x + this.y*this.y);
        },
        
        /**
         * 2乗された長さを取得
         * C# の名前を引用
         * or lengthSquare or lengthSqrt
         */
        lengthSquared: function() {
            return this.x*this.x + this.y*this.y;
        },
        
        /**
         * ２点間の距離を返す
         */
        distance: function(v) {
            return Math.sqrt( Math.pow(this.x-v.x, 2) + Math.pow(this.y-v.y, 2) );
        },
        
        /**
         * ２点間の距離を返す
         */
        distanceSquared: function(v) {
            return Math.pow(this.x-v.x, 2) + Math.pow(this.y-v.y, 2);
        },
        
        /**
         * 正規化
         */
        normalize: function() {
            var length = this.length();
            this.div(length);
            
            return this;
        },
        
        /**
         * 角度(radian)に変換
         */
        toAngle: function() {
            return Math.atan2(this.y, this.x);
        },

        /**
         * スタイル文字列に変換
         */
        toStyleString: function() {
            return "{x:{x}, y:{y}}".format(this);
        },

        /**
         * 文字列に変換
         */
        toString: function() {
            return "{x:{x}, y:{y}}".format(this);
        },
        
        /**
         * X値をセット
         * チェーンメソッド用セッター
         */
        setX: function(x) {
            this.x = x;
            return this;
        },
        
        /**
         * Y値をセット
         * チェーンメソッド用セッター
         */
        setY: function(y) {
            this.y = y;
            return this;
        },
        
    });
    
    
    /**
     * @method
     * @static
     * min
     */
    tm.geom.Vector2.min = function(lhs, rhs) {
        return tm.geom.Vector2(
            (lhs.x < rhs.x) ? lhs.x : rhs.x,
            (lhs.y < rhs.y) ? lhs.y : rhs.y
        );
    };
    
    /**
     * @method
     * @static
     * max
     */
    tm.geom.Vector2.max = function(lhs, rhs) {
        return tm.geom.Vector2(
            (lhs.x > rhs.x) ? lhs.x : rhs.x,
            (lhs.y > rhs.y) ? lhs.y : rhs.y
        );
    };
    
    /**
     * @method
     * @static
     * 加算
     */
    tm.geom.Vector2.add = function(lhs, rhs) {
        return tm.geom.Vector2(lhs.x+rhs.x, lhs.y+rhs.y);
    };
    
    /**
     * @method
     * @static
     * 減算
     */
    tm.geom.Vector2.sub = function(lhs, rhs) {
        return tm.geom.Vector2(lhs.x-rhs.x, lhs.y-rhs.y);
    };
    
    /**
     * @method
     * @static
     * 乗算
     */
    tm.geom.Vector2.mul = function(v, n) {
        return tm.geom.Vector2(v.x*n, v.y*n);
    };
    
    /**
     * @method
     * @static
     * 割算
     */
    tm.geom.Vector2.div = function(v, n) {
        return tm.geom.Vector2(v.x/n, v.y/n);
    };
    
    /**
     * @method
     * @static
     * 反転
     */
    tm.geom.Vector2.negate = function(v) {
        return tm.geom.Vector2(-v.x, -v.y);
    };
    
    /**
     * @method
     * @static
     * 内積.
     * 投影ベクトルを求めたり, 類似度に使ったり.
     */
    tm.geom.Vector2.dot = function(lhs, rhs) {
        return lhs.x * rhs.x + lhs.y * rhs.y;
    };
    

    /**
     * @method
     * @static
     * 外積
     */
    tm.geom.Vector2.cross = function(lhs, rhs) {
        return (lhs.x*rhs.y) - (lhs.y*rhs.x);
    };
    
    /**
     * @method
     * @static
     * ２点間の距離を返す
     */
    tm.geom.Vector2.distance = function(lhs, rhs) {
        return Math.sqrt( Math.pow(lhs.x-rhs.x, 2) + Math.pow(lhs.y-rhs.y, 2) );
    };
    
    /**
     * @method
     * @static
     * ２点間の距離を返す
     */
    tm.geom.Vector2.distanceSquared = function(lhs, rhs) {
        return Math.pow(lhs.x-rhs.x, 2) + Math.pow(lhs.y-rhs.y, 2);
    };

    /**
     * @method
     * @static
     * マンハッタン距離
     */
    tm.geom.Vector2.manhattanDistance = function(lhs, rhs) {
        return Math.abs(lhs.x-rhs.x) + Math.abs(lhs.y-rhs.y);
    };
    
    /**
     * @method
     * @static
     * 反射ベクトル
     */
    tm.geom.Vector2.reflect = function(v, normal) {
        var len = Vector2.dot(v, normal);
        var temp= Vector2.mul(normal, 2*len);
        
        return tm.geom.Vector2.sub(v, temp);
    };

    /**
     * @method
     * @static
     * 補間.
     * 0.5 で lhs と rhs の中間ベクトルを求めることができます.
     */
    tm.geom.Vector2.lerp = function(lhs, rhs, t) {
        // TODO: 
        return tm.geom.Vector2(
            lhs.x + (rhs.x-lhs.x)*t,
            lhs.y + (rhs.y-lhs.y)*t
        );
    };
    
    
    /**
     * @method
     * @static
     * 補間
     */
    tm.geom.Vector2.slerp = function(lhs, rhs, t) {
        // TODO:
        // cos...
    };
    

    /**
     * @method
     * @static
     * min ~ max の間でランダムな方向のベクトルを生成する. len で長さ指定.
     */
    tm.geom.Vector2.random = function(min, max, len) {
        min = min || 0;
        max = max || 360;
        len = len || 1;
        return tm.geom.Vector2().setDegree(Math.randf(min, max), len);
    };
    
    
    /**
     * @property
     * @static
     * zero
     */
    tm.geom.Vector2.ZERO    = tm.geom.Vector2( 0, 0);
    
    /**
     * @property
     * @static
     * left
     */
    tm.geom.Vector2.LEFT    = tm.geom.Vector2(-1, 0);
    
    
    /**
     * @property
     * @static
     * right
     */
    tm.geom.Vector2.RIGHT   = tm.geom.Vector2( 1, 0);
    
    /**
     * @property
     * @static
     * up
     */
    tm.geom.Vector2.UP      = tm.geom.Vector2( 0, 1);
    
    /**
     * @property
     * @static
     * down
     */
    tm.geom.Vector2.DOWN    = tm.geom.Vector2( 0,-1);
    
})();


/*
 * vector3.js
 */

/*
 * 幾何学
 */
tm.geom = tm.geom || {};


(function() {
    
    /**
     * @class tm.geom.Vector3
     * 3次元ベクトル
     */
    tm.geom.Vector3 = tm.createClass({
        /** x 座標 */
        x: 0,
        /** y 座標 */
        y: 0,
        /** z 座標 */
        z: 0,
        

        /**
         * @constructor
         * - [Test Program](http://tmlib-js.googlecode.com/svn/trunk/test/geom/vector-test.html)
         */
        init: function(x, y, z) {
            this.set(x, y, z);
        },
        
        /**
         * セット
         */
        set: function(x, y, z) {
            this.x = x;
            this.y = y;
            this.z = z;
            
            return this;
        },
        
        /**
         * 数値からセット
         */
        setNumber: function(x, y, z) {
            this.x = x;
            this.y = y;
            this.z = z;
            
            return this;
        },
        
        /**
         * 配列からセット
         */
        setArray: function(arr) {
            this.x = arr[0];
            this.y = arr[1];
            this.z = arr[2];
            
            return this;
        },
        
        /**
         * オブジェクトからセット
         */
        setObject: function(obj) {
            this.x = obj.x;
            this.y = obj.y;
            this.z = obj.z;
            
            return this;
        },
        
        /**
         * 文字列からセット
         */
        setString: function(str) {
            var m = str.match(/(-?\d+(\.{1}\d+)?),\s*(-?\d+(\.{1}\d+)?),\s*(-?\d+(\.{1}\d+)?)/);
            this.x = parseFloat(m[1]);
            this.y = parseFloat(m[3]);
            this.z = parseFloat(m[5]);
            
            return this;
        },
        
        /**
         * 角度(radian)と長さでベクトルをセット
         */
        setAngle: function(thetaRad, phiRad, len) {
            len = len || 1;
            
            this.x = len * Math.cos(thetaRad) * Math.sin(phiRad);
            this.y = len * Math.sin(thetaRad);
            this.z = len * Math.cos(thetaRad) * Math.cos(phiRad);
            
            return this;
        },
        
        /**
         * 角度(radian)と長さでベクトルをセット
         */
        setRadian: function(thetaRad, phiRad, len) {
            return this.setAngle(thetaRad, phiRad, len);
        },
        
        /**
         * 角度(degree)と長さでベクトルをセット
         */
        setDegree: function(thetaDegree, phiDegree, len) {
            return this.setAngle(thetaDegree*Math.DEG_TO_RAD, phiDegree*Math.DEG_TO_RAD, len);
        },
        
        /**
         * 賢いセット
         */
        setSmart: function(x, y, z) {
            var v = arguments[0];
            // xyz
            if (arguments.length === 3) {
                this.x = x;
                this.y = y;
                this.z = z;
            }
            // Array
            else if (v instanceof Array) {
                this.x = v[0];
                this.y = v[1];
                this.z = v[2];
            }
            // Object
            else if (v instanceof Object) {
                this.x = v.x;
                this.y = v.y;
                this.z = v.z;
            }
            // String
            else if (typeof(v) == "string") {
                var m = v.match(/(-?\d+(\.{1}\d+)?),\s*(-?\d+(\.{1}\d+)?),\s*(-?\d+(\.{1}\d+)?)/);
                this.x = parseFloat(m[1]);
                this.y = parseFloat(m[3]);
                this.z = parseFloat(m[5]);
            }
            
            return this;
        },
        
        /**
         * 加算
         */
        add: function(v) {
            this.x += v.x;
            this.y += v.y;
            this.z += v.z;
            
            return this;
        },
        
        /**
         * 減算
         */
        sub: function(v) {
            this.x -= v.x;
            this.y -= v.y;
            this.z -= v.z;
            
            return this;
        },
        
        /**
         * 乗算
         */
        mul: function(n) {
            this.x *= n;
            this.y *= n;
            this.z *= n;
            
            return this;
        },
        
        /**
         * 除算
         */
        div: function(n) {
            console.assert(n != 0, "0 division!!");
            this.x /= n;
            this.y /= n;
            this.z /= n;
            
            return this;
        },
        
        /**
         * 反転
         */
        negate: function() {
            this.x = -this.x;
            this.y = -this.y;
            this.z = -this.z;
            
            return this;
        },

        /**
         * 内積.
         * 投影ベクトルを求めたり, 類似度に使ったり.
         */
        dot: function(v) {
            return this.x * v.x + this.y * v.y + this.z * v.z;
        },

        /**
         * 外積
         */
        cross: function(v) {
            var x = this.y*v.z - this.z*v.y;
            var y = this.z*v.x - this.x*v.z;
            var z = this.x*v.y - this.y*v.x;

            this.set(x, y, z);

            return this;
        },
        
        /**
         * 長さを取得
         * or magnitude
         */
        length: function() {
            return Math.sqrt(this.x*this.x + this.y*this.y + this.z*this.z);
        },
        
        /**
         * 2乗された長さを取得
         * C# の名前を引用
         * or lengthSquare or lengthSqrt
         */
        lengthSquared: function() {
            return this.x*this.x + this.y*this.y + this.z*this.z;
        },
        
        /**
         * 正規化
         */
        normalize: function() {
            var length = this.length();
            this.div(length);
            
            return this;
        },
        
        /**
         * ２次元ベクトルに変換
         */
        toVector2: function() {
            // TODO:
        },
        

        /**
         * 角度(radian)に変換
         */
        toAngleXY: function() {
            return Math.atan2(this.y, this.x);
        },
        
        
        /**
         * 3D化する
         */
        to3D: function() {
            // TODO: 3d化する
        },
        
        /**
         * 等しいか
         */
        equals: function(x, y, z) {
            return ( (this.x === x) && (this.y === y) && (this.z === z) );
        },
        // equals: function(obj) {
            // return this.equals(obj.x, obj.y, obj.z);
        // },
        
        /**
         * 配列と等しいか
         */
        equalsArray: function(arr) {
            return this.equals(arr[0], arr[1], arr[2]);
        },
        
        /**
         * オブジェクトと等しいか
         */
        equalsObject: function(obj) {
            return this.equals(obj.x, obj.y, obj.z);
        },
        
        /**
         * 賢い比較
         */
        equalsSmart: function() {
            // TODO: 
        },

        /**
         * スタイル文字列に変換
         */
        toStyleString: function() {
            return "{x:{x}, y:{y}, z:{z}}".format(this);
        },

        /**
         * 文字列に変換
         */
        toString: function() {
            return "{x:{x}, y:{y}, z:{z}}".format(this);
        },
        
        
        /**
         * X値をセット
         * チェーンメソッド用セッター
         */
        setX: function(x) {
            this.x = x;
            return this;
        },
        
        /**
         * Y値をセット
         * チェーンメソッド用セッター
         */
        setY: function(y) {
            this.y = y;
            return this;
        },
        
        /**
         * Z値をセット
         * チェーンメソッド用セッター
         */
        setZ: function(z) {
            this.z = z;
            return this;
        }
    });
    
    
    
    /**
     * @method
     * @static
     * min
     */
    tm.geom.Vector3.min = function(lhs, rhs) {
        return Vector3(
            (lhs.x < rhs.x) ? lhs.x : rhs.x,
            (lhs.y < rhs.y) ? lhs.y : rhs.y,
            (lhs.z < rhs.z) ? lhs.z : rhs.z
        );
    };
    
    /**
     * @method
     * @static
     * max
     */
    tm.geom.Vector3.max = function(lhs, rhs) {
        return Vector3(
            (lhs.x > rhs.x) ? lhs.x : rhs.x,
            (lhs.y > rhs.y) ? lhs.y : rhs.y,
            (lhs.z > rhs.z) ? lhs.z : rhs.z
        );
    };
    
    /**
     * @method
     * @static
     * 加算
     */
    tm.geom.Vector3.add = function(lhs, rhs) {
        return tm.geom.Vector3(lhs.x+rhs.x, lhs.y+rhs.y, lhs.z+rhs.z);
    };
    
    /**
     * @method
     * @static
     * 減算
     */
    tm.geom.Vector3.sub = function(lhs, rhs) {
        return tm.geom.Vector3(lhs.x-rhs.x, lhs.y-rhs.y, lhs.z-rhs.z);
    };
    
    /**
     * @method
     * @static
     * 乗算
     */
    tm.geom.Vector3.mul = function(v, n) {
        return tm.geom.Vector3(v.x*n, v.y*n, v.z*n);
    };
    
    /**
     * @method
     * @static
     * 割算
     */
    tm.geom.Vector3.div = function(v, n) {
        return tm.geom.Vector3(v.x/n, v.y/n, v.z/n);
    };
    
    /**
     * @method
     * @static
     * 内積.
     * 投影ベクトルを求めたり, 類似度に使ったり.
     */
    tm.geom.Vector3.dot = function(lhs, rhs) {
        return lhs.x * rhs.x + lhs.y * rhs.y + lhs.z * rhs.z;
    };
    

    /**
     * @method
     * @static
     * 外積
     */
    tm.geom.Vector3.cross = function(lhs, rhs) {
        return tm.geom.Vector3(
            lhs.y*rhs.z - lhs.z*rhs.y,
            lhs.z*rhs.x - lhs.x*rhs.z,
            lhs.x*rhs.y - lhs.y*rhs.x
        );
    };
    
    /**
     * @method
     * @static
     * 反転
     */
    tm.geom.Vector3.negate = function(v) {
        return tm.geom.Vector3(-v.x, -v.y, -v.z);
    };
    
    /**
     * @method
     * @static
     * ２点間の距離を返す
     */
    tm.geom.Vector3.distance = function(lhs, rhs) {
        return Math.sqrt( Math.pow(lhs.x-rhs.x, 2) + Math.pow(lhs.y-rhs.y, 2) + Math.pow(lhs.z-rhs.z, 2) );
    };
    
    /**
     * @method
     * @static
     * ２点間の距離を返す
     */
    tm.geom.Vector3.distanceSquared = function(lhs, rhs) {
        return Math.pow(lhs.x-rhs.x, 2) + Math.pow(lhs.y-rhs.y, 2) + Math.pow(lhs.z-rhs.z, 2);
    };

    /**
     * @method
     * @static
     * マンハッタン距離
     */
    tm.geom.Vector3.manhattanDistance = function(lhs, rhs) {
        return Math.abs(lhs.x-rhs.x) + Math.abs(lhs.y-rhs.y) + Math.abs(lhs.z-rhs.z);
    };
    
    /**
     * @method
     * @static
     * 反射ベクトル
     */
    tm.geom.Vector3.reflect = function(v, normal) {
        var len = Vector3.dot(v, normal);
        var temp= Vector3.mul(normal, 2*len);
        
        return Vector3.sub(v, temp);
    };

    /**
     * @method
     * @static
     * 補間.
     * 0.5 で lhs と rhs の中間ベクトルを求めることができます.
     */
    tm.geom.Vector3.lerp = function(lhs, rhs, t) {
        return tm.geom.Vector3(
            lhs.x + (rhs.x-lhs.x)*t,
            lhs.y + (rhs.y-lhs.y)*t,
            lhs.z + (rhs.z-lhs.z)*t
        );
    };
    
    
    /**
     * @method
     * @static
     * 補間
     */
    tm.geom.Vector3.slerp = function(lhs, rhs, t) {
        // TODO:
        // cos...
    };
    
    /**
     * @method
     * @static
     * min ~ max の間でランダムな方向のベクトルを生成する. len で長さ指定.
     */
    tm.geom.Vector3.random = function(thetaMin, thetaMax, phiMin, phiMax, len) {
        thetaMin= thetaMin || 0;
        thetaMax= thetaMax || 360;
        phiMin  = phiMin || 0;
        phiMax  = phiMax || 360;
        len = len || 1;
        return TM.Geom.Vector3().setFromDegree(TM.randomf(thetaMin, thetaMax), TM.randomf(phiMin, phiMax), len);
    };
    
    
    
    /*
    Vector3.prototype.accessor("length", {
        "get": function()    { return this.length(); },
        "set": function(len) { this.normalize().mul(len); }
    });
    */
    
    
    /**
     * @property
     * @static
     * zero
     */
    tm.geom.Vector3.ZERO    = tm.geom.Vector3( 0, 0, 0);
    
    /**
     * @property
     * @static
     * left
     */
    tm.geom.Vector3.LEFT    = tm.geom.Vector3(-1, 0, 0);
    
    /**
     * @property
     * @static
     * right
     */
    tm.geom.Vector3.RIGHT   = tm.geom.Vector3( 1, 0, 0);
    
    /**
     * @property
     * @static
     * up
     */
    tm.geom.Vector3.UP      = tm.geom.Vector3( 0, 1, 0);
    
    /**
     * @property
     * @static
     * down
     */
    tm.geom.Vector3.DOWN    = tm.geom.Vector3( 0,-1, 0);
    
    /**
     * @property
     * @static
     * forward
     */
    tm.geom.Vector3.FORWARD = tm.geom.Vector3( 0, 0,-1);
    
    /**
     * @property
     * @static
     * backward
     */
    tm.geom.Vector3.BACKWARD= tm.geom.Vector3( 0, 0, 1);
    
})();


/*
 * matrix33.js
 */

tm.geom = tm.geom || {};

(function() {
    
    /**
     * @class   tm.geom.Matrix33
     * 3*3 マトリックスクラス
     */
    tm.define("tm.geom.Matrix33", {
        /**
         * 要素
         */
        m: null,
        
        /**
         * @constructor
         */
        init: function() {
            this.m = [];
            if (arguments.length >= 9) {
                this.set.apply(this, arguments);
            }
            else {
                this.identity();
            }
        },
        
        /**
         * クローン
         */
        clone: function() {
            var m = this.m;
            return tm.geom.Matrix33(
                m[0], m[3], m[6],
                m[1], m[4], m[7],
                m[2], m[5], m[8]
            );
        },
        
        /**
         * セッター
         */
        set: function(m00, m01, m02, m10, m11, m12, m20, m21, m22) {
            console.assert(arguments.length>=9, "");
            
            // |m00, m01, m02|
            // |m10, m11, m12|
            // |m20, m21, m22|
            
            // |m[0], m[3], m[6]|
            // |m[1], m[4], m[7]|
            // |m[2], m[5], m[8]|
            
            // |a, b, tx|
            // |c, d, ty|
            // |0, 0,  1|
            
            this.m00 = m00; this.m01 = m01; this.m02 = m02;
            this.m10 = m10; this.m11 = m11; this.m12 = m12;
            this.m20 = m20; this.m21 = m21; this.m22 = m22;
            
            return this;
        },
        
        /**
         * 配列からセット
         */
        setArray: function(arr) {
            this.set(
                arr[0], arr[3], arr[6],
                arr[1], arr[4], arr[7],
                arr[2], arr[5], arr[8]
            );
            
            return this;
        },
        
        /**
         * オブジェクトからセット
         */
        setObject: function(obj) {
            this.set(
                obj.m00, obj.m01, obj.m02,
                obj.m10, obj.m11, obj.m12,
                obj.m20, obj.m21, obj.m22
            );
            
            return this;
        },
        
        /**
         * 単位行列
         */
        identity: function() {
            var m = this.m;
            
            m[0] = 1; m[3] = 0; m[6] = 0;
            m[1] = 0; m[4] = 1; m[7] = 0;
            m[2] = 0; m[5] = 0; m[8] = 1;
            
            return this;
        },
        
        /**
         * 転置
         */
        transpose: function() {
            this.m.swap(1, 3);
            this.m.swap(2, 6);
            this.m.swap(5, 7);
            
            return this;
        },
        
        /**
         * 逆行列
         */
        invert: function() {
            var m = this.m;
            var m00 = m[0], m01 = m[3], m02 = m[6];
            var m10 = m[1], m11 = m[4], m12 = m[7];
            var m20 = m[2], m21 = m[5], m22 = m[8];
            var det = this.determinant();
            
            // |m00, m01, m02|
            // |m10, m11, m12|
            // |m20, m21, m22|
            
            this.m00 = (m11*m22-m12*m21)/det;
            this.m01 = (m10*m22-m12*m20)/det*-1;
            this.m02 = (m10*m21-m11*m20)/det;
            
            this.m10 = (m01*m22-m02*m21)/det*-1;
            this.m11 = (m00*m22-m02*m20)/det;
            this.m12 = (m00*m21-m01*m20)/det*-1;
            
            this.m20 = (m01*m12-m02*m11)/det;
            this.m21 = (m00*m12-m02*m10)/det*-1;
            this.m22 = (m00*m11-m01*m10)/det;
            
            this.transpose();
            
            return this;
        },

        /**
         * 行列式
         */
        determinant: function() {
            var m = this.m;
            
            var m00 = m[0], m01 = m[3], m02 = m[6];
            var m10 = m[1], m11 = m[4], m12 = m[7];
            var m20 = m[2], m21 = m[5], m22 = m[8];
            
            return m00*m11*m22 + m10*m21*m02 + m01*m12*m20 - m02*m11*m20 - m01*m10*m22 - m12*m21*m00;
        },
        
        /**
         * ゼロクリア
         */
        zero: function() {
            this.set(
                0, 0, 0,
                0, 0, 0,
                0, 0, 0
            );
            
            return this;
        },
        
        /**
         * 移動
         */
        translate: function(x, y) {
            var m = this.m;
            
            m[6] = m[0] * x + m[3] * y + m[6];
            m[7] = m[1] * x + m[4] * y + m[7];
            m[8] = m[2] * x + m[5] * y + m[8];
            
            return this;
            
            return this.multiply( tm.geom.Matrix33.translate(x, y) );
        },
        
        /**
         * X軸回転
         */
        rotateX: function(rad) {
            return this.multiply( tm.geom.Matrix33.rotateX(rad) );
        },
        
        /**
         * Y軸回転
         */
        rotateY: function(rad) {
            return this.multiply( tm.geom.Matrix33.rotateY(rad) );
        },
        
        /**
         * Z軸回転
         */
        rotateZ: function(rad) {
            var s = Math.sin(rad);
            var c = Math.cos(rad);
            var m = this.m;
            
            var m00 = m[0];
            var m10 = m[1];
            var m20 = m[2];
            var m01 = m[3];
            var m11 = m[4];
            var m21 = m[5];
            
            
            return this.multiply( tm.geom.Matrix33.rotateZ(rad) );
        },
        
        /**
         * スケーリング
         */
        scale: function(x, y) {
            var m = this.m;
            
            m[0] *= x; m[3] *= y;
            m[1] *= x; m[4] *= y;
            m[2] *= x; m[5] *= y;
            
            return this;
            return this.multiply( tm.geom.Matrix33.scale(x, y) );
        },
        
        /**
         * 掛け算
         */
        multiply: function(mat) {
            var tm = this.m;
            var om = mat.m;
            
            var a00 = tm[0], a01 = tm[3], a02 = tm[6];
            var a10 = tm[1], a11 = tm[4], a12 = tm[7];
            var a20 = tm[2], a21 = tm[5], a22 = tm[8];
            var b00 = om[0], b01 = om[3], b02 = om[6];
            var b10 = om[1], b11 = om[4], b12 = om[7];
            var b20 = om[2], b21 = om[5], b22 = om[8];
            
            
            tm[0] = a00*b00 + a01*b10 + a02*b20;
            tm[3] = a00*b01 + a01*b11 + a02*b21;
            tm[6] = a00*b02 + a01*b12 + a02*b22;
            
            tm[1] = a10*b00 + a11*b10 + a12*b20;
            tm[4] = a10*b01 + a11*b11 + a12*b21;
            tm[7] = a10*b02 + a11*b12 + a12*b22;
            
            tm[2] = a20*b00 + a21*b10 + a22*b20;
            tm[5] = a20*b01 + a21*b11 + a22*b21;
            tm[8] = a20*b02 + a21*b12 + a22*b22;
            
            return this;
        },
        
        /**
         * ベクトルとの掛け算
         */
        multiplyVector2: function(v) {
            var vx = this.m00*v.x + this.m01*v.y + this.m02;
            var vy = this.m10*v.x + this.m11*v.y + this.m12;
            
            return tm.geom.Vector2(vx, vy);
        },
        
        /**
         * ベクトルとの掛け算
         */
        multiplyVector3: function(v) {
            var vx = this.m00*v.x + this.m01*v.y + this.m02*v.z;
            var vy = this.m10*v.x + this.m11*v.y + this.m12*v.z;
            var vz = this.m20*v.x + this.m21*v.y + this.m22*v.z;
            
            return tm.geom.Vector3(vx, vy, vz);
        },
        
        /**
         * 配列に変換
         */
        toArray: function() {
            return this.m.slice();
        },
        
        /**
         * 文字列化
         */
        toString: function() {
            return "|{m00}, {m01}, {m02}|\n|{m10}, {m11}, {m12}|\n|{m20}, {m21}, {m22}|".format(this);
        },
        
    });
    
    
    
    /**
     * @property    m00
     * 要素
     */
    tm.geom.Matrix33.prototype.accessor("m00", {
        "get": function()   { return this.m[0]; },
        "set": function(v)  { this.m[0] = v;    }
    });
    /**
     * @property    m10
     * 要素
     */
    tm.geom.Matrix33.prototype.accessor("m10", {
        "get": function()   { return this.m[1]; },
        "set": function(v)  { this.m[1] = v;    }
    });
    /**
     * @property    m20
     * 要素
     */
    tm.geom.Matrix33.prototype.accessor("m20", {
        "get": function()   { return this.m[2]; },
        "set": function(v)  { this.m[2] = v;    }
    });
    
    /**
     * @property    m01
     * 要素
     */
    tm.geom.Matrix33.prototype.accessor("m01", {
        "get": function()   { return this.m[3]; },
        "set": function(v)  { this.m[3] = v;    }
    });
    /**
     * @property    m11
     * 要素
     */
    tm.geom.Matrix33.prototype.accessor("m11", {
        "get": function()   { return this.m[4]; },
        "set": function(v)  { this.m[4] = v;    }
    });
    /**
     * @property    m21
     * 要素
     */
    tm.geom.Matrix33.prototype.accessor("m21", {
        "get": function()   { return this.m[5]; },
        "set": function(v)  { this.m[5] = v;    }
    });
    
    /**
     * @property    m02
     * 要素
     */
    tm.geom.Matrix33.prototype.accessor("m02", {
        "get": function()   { return this.m[6]; },
        "set": function(v)  { this.m[6] = v;    }
    });
    /**
     * @property    m12
     * 要素
     */
    tm.geom.Matrix33.prototype.accessor("m12", {
        "get": function()   { return this.m[7]; },
        "set": function(v)  { this.m[7] = v;    }
    });
    /**
     * @property    m22
     * 要素
     */
    tm.geom.Matrix33.prototype.accessor("m22", {
        "get": function()   { return this.m[8]; },
        "set": function(v)  { this.m[8] = v;    }
    });

    /**
     * @property    a
     * 要素
     */
    tm.geom.Matrix33.prototype.accessor("a", {
        "get": function()   { return this.m[0]; },
        "set": function(v)  { this.m[0] = v;    }
    });
    /**
     * @property    b
     * 要素
     */
    tm.geom.Matrix33.prototype.accessor("b", {
        "get": function()   { return this.m[3]; },
        "set": function(v)  { this.m[3] = v;    }
    });
    /**
     * @property    c
     * 要素
     */
    tm.geom.Matrix33.prototype.accessor("c", {
        "get": function()   { return this.m[1]; },
        "set": function(v)  { this.m[1] = v;    }
    });
    /**
     * @property    d
     * 要素
     */
    tm.geom.Matrix33.prototype.accessor("d", {
        "get": function()   { return this.m[4]; },
        "set": function(v)  { this.m[4] = v;    }
    });
    /**
     * @property    tx
     * 要素
     */
    tm.geom.Matrix33.prototype.accessor("tx", {
        "get": function()   { return this.m[6]; },
        "set": function(v)  { this.m[6] = v;    }
    });
    /**
     * @property    ty
     * 要素
     */
    tm.geom.Matrix33.prototype.accessor("ty", {
        "get": function()   { return this.m[7]; },
        "set": function(v)  { this.m[7] = v;    }
    });
    

    /**
     * @static
     * @method
     * 移動
     */
    tm.geom.Matrix33.translate = function(x, y) {
        return tm.geom.Matrix33(
            1, 0, x,
            0, 1, y,
            0, 0, 1
        );
    };
    
    /**
     * @static
     * @method
     * X軸回転
     */
    tm.geom.Matrix33.rotateX = function(rad) {
        var c = Math.cos(rad);
        var s = Math.sin(rad);
        
        return tm.geom.Matrix33(
            1, 0, 0,
            0, c,-s,
            0, s, c
        );
    };
    
    /**
     * @static
     * @method
     * Y軸回転
     */
    tm.geom.Matrix33.rotateY = function(rad) {
        var c = Math.cos(rad);
        var s = Math.sin(rad);
        
        return tm.geom.Matrix33(
             c, 0, s,
             0, 1, 0,
            -s, 0, c
        );
    };
    
    /**
     * @static
     * @method
     * Z軸回転
     */
    tm.geom.Matrix33.rotateZ = function(rad) {
        var c = Math.cos(rad);
        var s = Math.sin(rad);
        
        return tm.geom.Matrix33(
            c,-s, 0,
            s, c, 0,
            0, 0, 1
        );
    };
    
    /**
     * @static
     * @method
     * スケーリング
     */
    tm.geom.Matrix33.scale = function(x, y) {
        var mat = tm.geom.Matrix33();
        
        if (y == undefined) y = x;
        
        mat.set(
            x, 0, 0,
            0, y, 0,
            0, 0, 1
        );
        
        return mat;
    };
    
})();










/*
 * matrix44.js
 */

tm.geom = tm.geom || {};

(function() {
    
    /**
     * @class
     * 4*4 マトリックスクラス
     */
    tm.geom.Matrix44 = tm.createClass({
        /** 要素 */
        m: null,

        /**
         * @constructor
         */
        init: function() {
            this.m = [];
            if (arguments.length >= 16) {
                this.set.apply(this, arguments);
            }
            else {
                this.identity();
            }
        },
        
        /**
         * セット
         */
        set: function(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {
            console.assert(arguments.length>=16, "");
            
            // |m00, m01, m02, m03|
            // |m10, m11, m12, m13|
            // |m20, m21, m22, m23|
            // |m30, m31, m32, m33|
            
            this.m00 = m00; this.m01 = m01; this.m02 = m02; this.m03 = m03;
            this.m10 = m10; this.m11 = m11; this.m12 = m12; this.m13 = m13;
            this.m20 = m20; this.m21 = m21; this.m22 = m22; this.m23 = m23;
            this.m30 = m30; this.m31 = m31; this.m32 = m32; this.m33 = m33;
            
            return this;
        },
        
        /**
         * 配列からセット
         */
        setArray: function(arr) {
            this.set(
                arr[0], arr[4],  arr[8], arr[12],
                arr[1], arr[5],  arr[9], arr[13],
                arr[2], arr[6], arr[10], arr[14],
                arr[3], arr[7], arr[11], arr[15]
            );
            
            return this;
        },
        
        /**
         * オブジェクトからセット.
         * Matrix44 もこいつでいける!!
         */
        setObject: function(obj) {
            this.set(
                obj.m00, obj.m01, obj.m02, obj.m03,
                obj.m10, obj.m11, obj.m12, obj.m13,
                obj.m20, obj.m21, obj.m22, obj.m23,
                obj.m30, obj.m31, obj.m32, obj.m33
            );
            
            return this;
        },
        
        
        /**
         * 単位行列
         */
        identity: function() {
            this.set(
                1, 0, 0, 0,
                0, 1, 0, 0,
                0, 0, 1, 0,
                0, 0, 0, 1
            );
            return this;
        },
        
        /**
         * 転置
         */
        transpose: function() {
            this.m.swap(1, 4);
            this.m.swap(2, 8);
            this.m.swap(3, 12);
            this.m.swap(6, 9);
            this.m.swap(7, 13);
            this.m.swap(11, 14);
            
            return this;
        },
        
        /**
         * 移動
         */
        translate: function(x, y, z) {
            return this.multiply( tm.geom.Matrix44.translate(x, y, z) );
        },
        
        /**
         * 回転
         */
        rotate: function(angle) {
            // TODO: いつか実装する
            console.error("Unimplemented");
        },
        
        /**
         * X軸を基軸に回転する
         */
        rotateX: function(rad) {
            return this.multiply( tm.geom.Matrix44.rotateX(rad) );
        },
        
        /**
         * Y軸を基軸に回転する
         */
        rotateY: function(rad) {
            return this.multiply( tm.geom.Matrix44.rotateY(rad) );
        },
        
        /**
         * Z軸を基軸に回転する
         */
        rotateZ: function(rad) {
            return this.multiply( tm.geom.Matrix44.rotateZ(rad) );
        },
        
        /**
         * スケーリング
         */
        scale: function(x, y, z) {
            return this.multiply( tm.geom.Matrix44.scale(x, y, z) );
        },
        
        /**
         * ゼロ
         */
        zero: function() {
            this.set(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
            return this;
        },
        
        /**
         * 乗算
         * this * mat
         */
        multiply: function(mat) {
            var m00 = this.m00*mat.m00 + this.m01*mat.m10 + this.m02*mat.m20 + this.m03*mat.m30;
            var m01 = this.m00*mat.m01 + this.m01*mat.m11 + this.m02*mat.m21 + this.m03*mat.m31;
            var m02 = this.m00*mat.m02 + this.m01*mat.m12 + this.m02*mat.m22 + this.m03*mat.m32;
            var m03 = this.m00*mat.m03 + this.m01*mat.m13 + this.m02*mat.m23 + this.m03*mat.m33;
            
            var m10 = this.m10*mat.m00 + this.m11*mat.m10 + this.m12*mat.m20 + this.m13*mat.m30;
            var m11 = this.m10*mat.m01 + this.m11*mat.m11 + this.m12*mat.m21 + this.m13*mat.m31;
            var m12 = this.m10*mat.m02 + this.m11*mat.m12 + this.m12*mat.m22 + this.m13*mat.m32;
            var m13 = this.m10*mat.m03 + this.m11*mat.m13 + this.m12*mat.m23 + this.m13*mat.m33;
            
            var m20 = this.m20*mat.m00 + this.m21*mat.m10 + this.m22*mat.m20 + this.m23*mat.m30;
            var m21 = this.m20*mat.m01 + this.m21*mat.m11 + this.m22*mat.m21 + this.m23*mat.m31;
            var m22 = this.m20*mat.m02 + this.m21*mat.m12 + this.m22*mat.m22 + this.m23*mat.m32;
            var m23 = this.m20*mat.m03 + this.m21*mat.m13 + this.m22*mat.m23 + this.m23*mat.m33;
            
            var m30 = this.m30*mat.m00 + this.m31*mat.m10 + this.m32*mat.m20 + this.m33*mat.m30;
            var m31 = this.m30*mat.m01 + this.m31*mat.m11 + this.m32*mat.m21 + this.m33*mat.m31;
            var m32 = this.m30*mat.m02 + this.m31*mat.m12 + this.m32*mat.m22 + this.m33*mat.m32;
            var m33 = this.m30*mat.m03 + this.m31*mat.m13 + this.m32*mat.m23 + this.m33*mat.m33;
            
            return this.set(
                m00, m01, m02, m03,
                m10, m11, m12, m13,
                m20, m21, m22, m23,
                m30, m31, m32, m33
            );
        },
        
        /*
        getAxisX: function() { return TM.Geom.Vector3(this.m00, this.m10, this.m20); },
        getAxisY: function() { return TM.Geom.Vector3(this.m01, this.m11, this.m21); },
        getAxisZ: function() { return TM.Geom.Vector3(this.m02, this.m12, this.m22); },
        */
        
        /**
         * X軸ベクトルをゲット
         */
        getAxisX: function() { return TM.Geom.Vector3(this.m00, this.m01, this.m02); },
        /**
         * Y軸ベクトルをゲット
         */
        getAxisY: function() { return TM.Geom.Vector3(this.m10, this.m11, this.m12); },
        /**
         * Z軸ベクトルをゲット
         */
        getAxisZ: function() { return TM.Geom.Vector3(this.m20, this.m21, this.m22); },

        /**
         * X軸ベクトルをセット
         */
        setAxisX: function(v) { this.m00=v.x, this.m01=v.y, this.m02=v.z; },
        /**
         * Y軸ベクトルをセット
         */
        setAxisY: function(v) { this.m10=v.x, this.m11=v.y, this.m12=v.z; },
        /**
         * Z軸ベクトルをセット
         */
        setAxisZ: function(v) { this.m20=v.x, this.m21=v.y, this.m22=v.z; },
        
        /**
         * Matrix33 に変換
         */
        toMatrix33: function() {
            // TODO:
        },
        
        /**
         * 配列に変換
         */
        toArray: function() {
            return this.m.slice();
        },
        
        /**
         * 文字列化
         */
        toString: function() {
            return "|{m00}, {m01}, {m02}, {m03}|\n|{m10}, {m11}, {m12}, {m13}|\n|{m20}, {m21}, {m22}, {m23}|\n|{m30}, {m31}, {m32}, {m33}|".format(this);
        }
        
    });
    
    
    /**
     * @property    m00
     * 要素
     */
    tm.geom.Matrix44.prototype.accessor("m00", {
        "get": function()   { return this.m[0]; },
        "set": function(v)  { this.m[0] = v;    }
    });
    /**
     * @property    m01
     * 要素
     */
    tm.geom.Matrix44.prototype.accessor("m10", {
        "get": function()   { return this.m[1]; },
        "set": function(v)  { this.m[1] = v;    }
    });
    /**
     * @property    m02
     * 要素
     */
    tm.geom.Matrix44.prototype.accessor("m20", {
        "get": function()   { return this.m[2]; },
        "set": function(v)  { this.m[2] = v;    }
    });
    /**
     * @property    m03
     * 要素
     */
    tm.geom.Matrix44.prototype.accessor("m30", {
        "get": function()   { return this.m[3]; },
        "set": function(v)  { this.m[3] = v;    }
    });
    
    /**
     * @property    m10
     * 要素
     */
    tm.geom.Matrix44.prototype.accessor("m01", {
        "get": function()   { return this.m[4]; },
        "set": function(v)  { this.m[4] = v;    }
    });
    /**
     * @property    m11
     * 要素
     */
    tm.geom.Matrix44.prototype.accessor("m11", {
        "get": function()   { return this.m[5]; },
        "set": function(v)  { this.m[5] = v;    }
    });
    /**
     * @property    m12
     * 要素
     */
    tm.geom.Matrix44.prototype.accessor("m21", {
        "get": function()   { return this.m[6]; },
        "set": function(v)  { this.m[6] = v;    }
    });
    /**
     * @property    m13
     * 要素
     */
    tm.geom.Matrix44.prototype.accessor("m31", {
        "get": function()   { return this.m[7]; },
        "set": function(v)  { this.m[7] = v;    }
    });
    
    /**
     * @property    m20
     * 要素
     */
    tm.geom.Matrix44.prototype.accessor("m02", {
        "get": function()   { return this.m[8]; },
        "set": function(v)  { this.m[8] = v;    }
    });
    /**
     * @property    m21
     * 要素
     */
    tm.geom.Matrix44.prototype.accessor("m12", {
        "get": function()   { return this.m[9]; },
        "set": function(v)  { this.m[9] = v;    }
    });
    /**
     * @property    m22
     * 要素
     */
    tm.geom.Matrix44.prototype.accessor("m22", {
        "get": function()   { return this.m[10]; },
        "set": function(v)  { this.m[10] = v;    }
    });
    /**
     * @property    m23
     * 要素
     */
    tm.geom.Matrix44.prototype.accessor("m32", {
        "get": function()   { return this.m[11]; },
        "set": function(v)  { this.m[11] = v;    }
    });
        
    /**
     * @property    m30
     * 要素
     */
    tm.geom.Matrix44.prototype.accessor("m03", {
        "get": function()   { return this.m[12]; },
        "set": function(v)  { this.m[12] = v;    }
    });
    /**
     * @property    m31
     * 要素
     */
    tm.geom.Matrix44.prototype.accessor("m13", {
        "get": function()   { return this.m[13]; },
        "set": function(v)  { this.m[13] = v;    }
    });
    /**
     * @property    m32
     * 要素
     */
    tm.geom.Matrix44.prototype.accessor("m23", {
        "get": function()   { return this.m[14]; },
        "set": function(v)  { this.m[14] = v;    }
    });
    /**
     * @property    m33
     * 要素
     */
    tm.geom.Matrix44.prototype.accessor("m33", {
        "get": function()   { return this.m[15]; },
        "set": function(v)  { this.m[15] = v;    }
    });
    
    
    
    

    /**
     * @static
     * @method
     * 移動
     */
    tm.geom.Matrix44.translate = function(x, y, z) {
        return tm.geom.Matrix44(
            1, 0, 0, x,
            0, 1, 0, y,
            0, 0, 1, z,
            0, 0, 0, 1
        );
    };
    
    /**
     * @static
     * @method
     * X軸回転
     */
    tm.geom.Matrix44.rotateX = function(rad) {
        var c = Math.cos(rad);
        var s = Math.sin(rad);
        
        return tm.geom.Matrix44(
            1, 0, 0, 0,
            0, c,-s, 0,
            0, s, c, 0,
            0, 0, 0, 1
        );
    };
    
    /**
     * @static
     * @method
     * Y軸回転
     */
    tm.geom.Matrix44.rotateY = function(rad) {
        var c = Math.cos(rad);
        var s = Math.sin(rad);
        
        return tm.geom.Matrix44(
             c, 0, s, 0,
             0, 1, 0, 0,
            -s, 0, c, 0,
             0, 0, 0, 1
        );
    };
    
    /**
     * @static
     * @method
     * Z軸回転
     */
    tm.geom.Matrix44.rotateZ = function(rad) {
        var c = Math.cos(rad);
        var s = Math.sin(rad);
        
        return tm.geom.Matrix44(
            c,-s, 0, 0,
            s, c, 0, 0,
            0, 0, 1, 0,
            0, 0, 0, 1
        );
    };
    
    /**
     * @static
     * @method
     * スケーリング
     */
    tm.geom.Matrix44.scale = function(x, y, z) {
        var mat = tm.geom.Matrix44();
        
        if (y == undefined) y = x;
        if (z == undefined) z = x;
        
        mat.set(
            x, 0, 0, 0,
            0, y, 0, 0,
            0, 0, z, 0,
            0, 0, 0, 1
        );
        
        return mat;
    };

    /**
     * @static
     * @method
     * perspective
     */
    tm.geom.Matrix44.perspective = function(fovy, aspect, znear, zfar) {
        var yscale = 1.0 / Math.tan(0.5*fovy*Math.PI/180);
        var xscale = yscale / aspect;

        return tm.geom.Matrix44(
            xscale, 0.0, 0.0, 0.0,
            0.0, yscale, 0.0, 0.0,
            0.0, 0.0, zfar/(zfar-znear), znear*zfar/(znear-zfar),
            0.0, 0.0, 1.0, 0.0
        );
    };
    
    /**
     * @static
     * @method
     * ortho
     */
    tm.geom.Matrix44.ortho = function(left, right, bottom, top, near, far) {
        /*
        var lr = 1 / (left - right),
            bt = 1 / (bottom - top),
            nf = 1 / (near - far);
        
        return tm.geom.Matrix44(
            -2*lr, 0, 0, 0,
            0, -2*bt, 0, 0,
            0, 0, 2*nf, 0,
            (left+right)*lr, (top+bottom)*bt, (far+near)*nf, 1
        );
        */
        
        var rl = (right - left),
            tb = (top - bottom),
            fn = (far - near);
        return tm.geom.Matrix44(
            2.0/rl,      0,     0, 0,
               0.0, 2.0/tb,     0, 0,
                 0,      0, -2.0/fn, 0,
            -(left+right)/rl, -(top+bottom)/tb, -(far+near)/fn, 1
        ).transpose();
    };

    
    /**
     * @static
     * @method
     * lookAt
     */
    tm.geom.Matrix44.lookAt = function(eye, target, up) {
        var axis_z = tm.geom.Vector3.sub(eye, target).normalize();
        var axis_x = tm.geom.Vector3.cross(up, axis_z).normalize();
        var axis_y = tm.geom.Vector3.cross(axis_z, axis_x).normalize();
        
        /*
        return tm.geom.Matrix44(
            axis_x.x, axis_x.y, axis_x.z, -tm.geom.Vector3.dot(eye, axis_x),
            axis_y.x, axis_y.y, axis_y.z, -tm.geom.Vector3.dot(eye, axis_y),
            axis_z.x, axis_z.y, axis_z.z, -tm.geom.Vector3.dot(eye, axis_z),
            0, 0, 0, 1
        );
        */
        
        /*
        return tm.geom.Matrix44(
            axis_x.x, axis_y.x, axis_z.x, 0,
            axis_x.y, axis_y.y, axis_z.y, 0,
            axis_x.z, axis_y.z, axis_z.z, 0,
            -tm.geom.Vector3.dot(eye, axis_x), -tm.geom.Vector3.dot(eye, axis_y), -tm.geom.Vector3.dot(eye, axis_z), 1
        );
        */
        
        var orientation = tm.geom.Matrix44(
            axis_x.x, axis_y.x, axis_z.x, 0,
            axis_x.y, axis_y.y, axis_z.y, 0,
            axis_x.z, axis_y.z, axis_z.z, 0,
            0, 0, 0, 1
        );
        var translation = tm.geom.Matrix44(
            1, 0, 0, 0,
            0, 1, 0, 0,
            0, 0, 1, 0,
            -eye.x, -eye.y, -eye.z, 1
        );

        return translation.multiply(orientation);
    };
    
})();


























/*
 * rect.js
 */

tm.geom = tm.geom || {};

(function() {
    
    /**
     * @class tm.geom.Rect
     * 四角形クラス
     */
    tm.geom.Rect = tm.createClass({
        /** x */
        x: 0,
        /** y */
        y: 0,
        /** 幅 */
        width: 0,
        /** 高さ */
        height: 0,
        
        /**
         * @constructor
         */
        init: function(x, y, width, height) {
            this.set(x, y, width, height);
        },
        
        /**
         * セッター
         */
        set: function(x, y, width, height) {
            this.x = x;
            this.y = y;
            this.width = width;
            this.height = height;
            
            return this;
        },
        

        /**
         * 移動
         */
        move: function(x, y) {
            this.x = x;
            this.y = y;
            return this;
        },
        
        /**
         * 現在位置を基準に移動
         */
        moveBy: function(x, y) {
            this.x += x;
            this.y += y;
            return this;
        },
        
        /**
         * リサイズ
         */
        resize: function(w, h) {
            this.width = w;
            this.height= h;
            return this;
        },
        
        /**
         * 現在のサイズを基準にリサイズ
         */
        resizeBy: function(w, h) {
            this.width += w;
            this.height+= h;
            return this;
        },
        
        /**
         * パディング.
         * 縮めたりなど. 画面ハミ出しチェック時などに便利
         * ## example
         *     var circle = TM.$Circle(10, 10, 10);
         *     var windowRect = TM.$Rect(0, 0, window.innerWidth, window.innerHiehgt);
         *     windowRect.padding(circle.radius);
         *     if (circle.x < windowRect.left) {
         *         // 左にはみ出した時の処理
         *     }
         */
        padding: function(top, right, bottom, left) {
            // css の padding に合わせて時計回りにパラメータ調整
            switch (arguments.length) {
                case 1:
                    top = right = bottom = left = arguments[0];
                    break;
                case 2:
                    top     = bottom = arguments[0];
                    right   = left   = arguments[1];
                    break;
                case 3:
                    top     = arguments[0];
                    right   = left = arguments[1];
                    bottom  = arguments[2];
                    break;
            }
            
            this.x += left;
            this.y += top;
            this.width -= left+right;
            this.height-= top +bottom;
            
            return this;
        },

        contains: function(x, y) {
            return this.left <= x && x <= this.right && this.top <= y && y <= this.bottom;
        },

        /**
         * クローン
         */
        clone: function() {
            return tm.geom.Rect(this.x, this.y, this.width, this.height);
        },
        
        /**
         * 円に変換
         */
        toCircle: function() {
            return tm.geom.Circle(
                this.centerX,
                this.centerY,
                ((this.width < this.height) ? this.width : this.height)/2
                );
        },

        /**
         * 配列に変換
         */
        toArray: function() {
            return [this.x, this.y, this.width, this.height];
        },
        
    });
    
    
    /**
     * @property    left
     * left
     */
    tm.geom.Rect.prototype.accessor("left", {
        "get": function()   { return this.x; },
        "set": function(v)  { this.width -= v-this.x; this.x = v; }
    });
    
    /**
     * @property    top
     * top
     */
    tm.geom.Rect.prototype.accessor("top", {
        "get": function()   { return this.y; },
        "set": function(v)  { this.height -= v-this.y; this.y = v; }
    });
    
    /**
     * @property    right
     * right
     */
    tm.geom.Rect.prototype.accessor("right", {
        "get": function()   { return this.x + this.width; },
        "set": function(v)  { this.width += v-this.right; }
    });
    
    /**
     * @property    bottom
     * bottom
     */
    tm.geom.Rect.prototype.accessor("bottom", {
        "get": function()   { return this.y + this.height; },
        "set": function(v)  { this.height += v-this.bottom; }
    });
    
    /**
     * @property    centerX
     * centerX
     */
    tm.geom.Rect.prototype.accessor("centerX", {
        "get": function()   { return this.x + this.width/2; },
        "set": function(v)  {
            // TODO: どうしようかな??
        }
    });
    
    /**
     * @property    centerY
     * centerY
     */
    tm.geom.Rect.prototype.accessor("centerY", {
        "get": function()   { return this.y + this.height/2; },
        "set": function(v)  {
            // TODO: どうしようかな??
        }
    });
    
})();


/*
 * circle.js
 */

tm.geom = tm.geom || {};

(function() {
    
    /**
     * @class tm.geom.Circle
     * 円クラス
     */
    tm.define("tm.geom.Circle", {
        /** x */
        x: 0,
        /** y */
        y: 0,
        /** 半径 */
        radius: 0,
        
        /**
         * @constructor
         */
        init: function(x, y, radius) {
            this.set(x, y, radius);
        },
        
        /**
         * セッター
         */
        set: function(x, y, radius) {
            this.x = x;
            this.y = y;
            this.radius = radius;
            
            return this;
        },
        
        /**
         * 移動
         */
        move: function(x, y) {
            this.x = x;
            this.y = y;
            return this;
        },
        
        /**
         * 現在位置を基準に移動
         */
        moveBy: function(x, y) {
            this.x += x;
            this.y += y;
            return this;
        },
        
        /**
         * リサイズ
         */
        resize: function(size) {
            this.radius = size;
            return this;
        },
        
        /**
         * 現在のサイズを基準にリサイズ
         */
        resizeBy: function(size) {
            this.radius += size;
            return this;
        },

        /**
         * 
         */
        contains: function(x, y) {
            var lenX = this.x-x;
            var lenY = this.y-y;
            var lenSquared = (lenX*lenX)+(lenY*lenY);

            return lenSquared <= this.radius*this.radius;
        },

        /**
         * クローン作成
         */
        clone: function() {
            return tm.geom.Circle(this.x, this.y, this.radius);
        },
        
        /**
         * 四角形に変換
         */
        toRect: function() {
            return tm.geom.Rect(
                this.x - this.radius,
                this.y - this.radius,
                this.radius*2, this.radius*2
                );
        },
        
        /**
         * 配列に変換
         */
        toArray: function() {
            return [this.x, this.y, this.radius];
        }
    });
    
    /**
     * @property    left
     * left
     */
    tm.geom.Circle.prototype.getter("left", function() {
        return this.x - this.radius;
    });
    
    /**
     * @property    top
     * top
     */
    tm.geom.Circle.prototype.getter("top", function() {
        return this.y - this.radius;
    });
    
    /**
     * @property    right
     * right
     */
    tm.geom.Circle.prototype.getter("right", function() {
        return this.x + this.radius;
    });
    
    /**
     * @property    bottom
     * bottom
     */
    tm.geom.Circle.prototype.getter("bottom", function() {
        return this.y + this.radius;
    });
    
})();


/*
 * collision.js
 */

tm.collision = tm.collision || {};
 
(function() {

    /**
     * @class tm.collision
     * 衝突判定
     */
    tm.collision;
    
    /**
     * @method testCircleCircle
     * 円同士の衝突判定
     */
    tm.collision.testCircleCircle = function(circle0, circle1) {
        var distanceSquared = tm.geom.Vector2.distanceSquared(circle0, circle1);
        return distanceSquared <= Math.pow(circle0.radius + circle1.radius, 2);
    };
    
    /**
     * @method testRectRect
     * 矩形同士の衝突判定
     */
    tm.collision.testRectRect = function(rect0, rect1) {
        return (rect0.left < rect1.right) && (rect0.right > rect1.left) &&
               (rect0.top < rect1.bottom) && (rect0.bottom > rect1.top);
    };

    tm.collision.testCircleRect = function(circle, rect) {
        // まずは大きな矩形で判定(高速化)
        var bigRect = tm.geom.Rect(rect.left-circle.radius, rect.top-circle.radius, rect.width+circle.radius*2, rect.height+circle.radius*2);
        if (bigRect.contains(circle.x, circle.y) == false) {
            return false;
        }
        
        // 2種類の矩形と衝突判定
        var r = tm.geom.Rect(rect.left-circle.radius, rect.top, rect.width+circle.radius*2, rect.height);
        if (r.contains(circle.x, circle.y)) {
            return true;
        }
        r.set(rect.left, rect.top-circle.radius, rect.width, rect.height+circle.radius*2);
        if (r.contains(circle.x, circle.y)) {
            return true;
        }
        
        // 円と矩形の４点の判定
        var c = tm.geom.Circle(circle.x, circle.y, circle.radius);
        // left top
        if (c.contains(rect.left, rect.top)) {
            return true;
        }
        // right top
        if (c.contains(rect.right, rect.top)) {
            return true;
        }
        // right bottom
        if (c.contains(rect.right, rect.bottom)) {
            return true;
        }
        // left bottom
        if (c.contains(rect.left, rect.bottom)) {
            return true;
        }
        
        return false;
    };

    tm.collision.testRectCircle = function(rect, circle) {
        return this.testCircleRect(circle, rect);
    };
 
})();














/*
 * element.js
 */


tm.dom = tm.dom || {};

(function() {
    
    /**
     * @class
     * Element クラス
     */
    tm.dom.Element = tm.createClass({
        
        /** エレメント */
        element: null,
        
        /**
         * @constructor
         */
        init: function() {
            this.set.apply(this, arguments);
        },
        
        /**
         * セッター
         */
        set: function(q) {
            if (typeof q === "string") {
                this.element = document.querySelector(q);
            }
            else if (q != undefined) {
                this.element = q;
            }
            else {
                // デフォルトはドキュメント
                this.element = document;
            }
        },
        

        /**
         * 子供の最後尾に追加
         */
        append: function(child) {
            this.element.appendChild(child.element);
            return this;
        },
        
        /**
         * 子供の先頭に追加
         */
        prepend: function(child) {
            this.element.insertBefore(child.element, this.element.firstChild);
            return this;
        },
        
        /**
         * 自分の後に追加
         */
        after: function(child) {
            this.element.parentNode.insertBefore(child.element, this.element.nextSibling);
            return this;
        },
        
        /**
         * 自分の前に追加
         */
        before: function(child) {
            this.element.parentNode.insertBefore(child.element, this.element);
            return this;
        },
        
        /**
         * 引数に渡された要素に自分を append
         */
        appendTo: function(parent) {
            parent.append(this);
            return this;
        },
        
        /**
         * 引数に渡された要素に自分を prepend
         */
        prependTo: function(parent) {
            parent.prepend(this);
            return this;
        },
        
        /**
         * 複製
         */
        clone: function() {
            return tm.dom.Element(this.element.cloneNode(true));
        },
        
        /**
         * 親から自分を引っぺがす
         */
        remove: function() {
            this.element.parentNode.removeChild(this.element);
            return this;
        },
        
        /**
         * 要素生成
         */
        create: function(tag, addFuncName) {
            // 要素を生成
            var element = tm.dom.Element(document.createElement(tag));
            // デフォルトの追加方法は append
            if (!addFuncName) { addFuncName="append"; }
            // 自分の子供として追加
            this[addFuncName](element);
            
            return element;
        },
        
        /**
         * query
         */
        query: function(query, index) {
            var elm = (index) ?
                this.element.querySelectorAll(query)[index] : 
                this.element.querySelector(query);
            
            return tm.dom.Element(elm);
        },
        
        /**
         * queryAll
         */
        queryAll: function(query) {
            var list = this.element.querySelectorAll(query);
            return tm.dom.ElementList(list);
        },
        
        /**
         * 固定化
         */
        fixed: function(x, y, width, height) {
            this.style.set("position", "fixed");
            if (x) this.x = x;
            if (y) this.y = y;
            if (width) this.width = width;
            if (height) this.height = height;
            return this;
        },
        
        /**
         * absolute 化
         */
        absolute: function(x, y, width, height) {
            this.style.set("position", "absolute");
            if (x) this.x = x;
            if (y) this.y = y;
            if (width) this.width = width;
            if (height) this.height = height;
            return this;
        },
        
        /**
         * フルスクリーン化
         */
        fullScreen: function() {
            this.element.webkitRequestFullScreen();
        },

        /**
         * 表示
         */
        show: function() {
            this.visible = true;
        },

        /**
         * 非表示
         */
        hide: function() {
            this.visible = false;
        },
        
        /**
         * 文字列に変換
         */
        toString: function() {
            return "tm.dom.element";
        },
        
        /**
         * 要素を取得
         */
        getElement: function() {
            return this.element;
        },
        
    });
    
    
    
    /** @property html  html の値 */
    tm.dom.Element.prototype.accessor("html", {
        "get": function()       { return this.element.innerHTML; },
        "set": function(html)   { this.element.innerHTML = html; }
    });
    /** @property value  value の値 */
    tm.dom.Element.prototype.accessor("value", {
        "get": function()       { return this.element.value; },
        "set": function(value)   { this.element.value = value; }
    });
    /** @property x  x値 */
    tm.dom.Element.prototype.accessor("x", {
        "get": function()   { return Number( this.element.style.left.replace("px", '') ); },
        "set": function(x)  { this.element.style.left = x+"px"; }
    });
    /** @property y  y値 */
    tm.dom.Element.prototype.accessor("y", {
        "get": function()   { return Number( this.element.style.top.replace("px", '') ); },
        "set": function(y)  { this.element.style.top = y+"px"; }
    });
    /** @property width  幅 */
    tm.dom.Element.prototype.accessor("width", {
        "get": function()   { return Number( this.element.style.width.replace("px", '') ); },
        "set": function(w)  { this.element.style.width = w+"px"; }
    });
    /** @property height  高さ */
    tm.dom.Element.prototype.accessor("height", {
        "get": function()   { return Number( this.element.style.height.replace("px", '') ); },
        "set": function(h)  { this.element.style.height = h+"px"; }
    });
    /** @property color  色 */
    tm.dom.Element.prototype.accessor("color", {
        "get": function()       { return this.element.style.color; },
        "set": function(color)  { this.element.style.color = color; }
    });
    /** @property backgroundColor  背景色 */
    tm.dom.Element.prototype.accessor("backgroundColor", {
        "get": function()       { return this.element.style.backgroundColor; },
        "set": function(color)  { this.element.style.backgroundColor = color; }
    });
    /** @property visible  表示/非表示 */
    tm.dom.Element.prototype.accessor("visible", {
        "get": function()   { return this.element.style.visibility != "hidden"; },
        "set": function(v)  { this.element.style.visibility = (v==true) ? "visible" : "hidden"; }
    });
    /** @property text  テキスト */
    tm.dom.Element.prototype.accessor("text", {
        "get": function()   { return this.element.innerText || this.element.textContent; },
        "set": function(v)  {
            if (this.element.innerText) {
                this.element.innerText = v;
            } else {
                this.element.textContent = v;
            }
        }
    });
    /** @property classList  クラスリスト */
    tm.dom.Element.prototype.getter("classList", function()   { return this.element.classList; });
    /** @property parent */
    tm.dom.Element.prototype.getter("parent", function(){
        return (this.element.parentNode != undefined) ? tm.dom.Element(this.element.parentNode) : null;
    });
    /** @property prev */
    tm.dom.Element.prototype.getter("prev", function(){
        return (this.element.previousSibling != undefined) ? tm.dom.Element(this.element.previousSibling) : null;
    });
    /** @property next */
    tm.dom.Element.prototype.getter("next", function(){
        return (this.element.nextSibling != undefined) ? tm.dom.Element(this.element.nextSibling) : null;
    });
    /** @property children */
    tm.dom.Element.prototype.getter("children", function(){
        return tm.dom.ElementList(this.element.children);
    });
    
    
})();





(function(){
    
    /**
     * @class tm.dom.ElementList
     * エレメントリスト
     * @extends global.Array
     */
    tm.dom.ElementList = tm.createClass({
        superClass: Array,
        
        /**
         * @constructor
         * TM.DOM.Element 用配列
         */
        init: function(arr) {
            if (typeof arguments[0] == "string") {
                var query = arguments[0];
                arr = document.querySelectorAll(query);
            }
            else if (arr == undefined) {
                return ;
            }
            
            for (var i=0,len=arr.length; i<len; ++i) {
                this.push( tm.dom.Element(arr[i]) );
            }
        },
        
        /**
         * 文字列に変換
         */
        toString: function() {
            return "";
        }
    });
    
})();


/*
 * dom/evnet.js
 */

tm.dom = tm.dom || {};

(function() {
    
    /**
     * @class global.Event
     * 既存のEventオブジェクト拡張
     */
    
    // 仕方なしの IE 対応(これ引っかかったら他のもダメだから必要ないかも)
    if (!Event.prototype.stopPropagation) {
        /** @method */
        Event.prototype.stopPropagation = function() {
            this.cancelBubble = true;
        };
    }
    if (!Event.prototype.preventDefault) {
        /** @method */
        Event.prototype.preventDefault = function() {
            this.returnValue = false;
        };
    }
    
    /**
     * @method stop
     * イベントのデフォルト処理 & 伝達を止める
     */
    Event.prototype.stop = function() {
        // イベントキャンセル
        this.preventDefault();
        // イベント伝達を止める
        this.stopPropagation();
    };
    
})();


(function() {
    
    /**
     * @class global.KeyboardEvent
     * KeyboardEvent クラス
     */
    
    /**
     * @method    character
     * 押したキーの文字を取得
     */
    KeyboardEvent.prototype.getter("character", function(){
        return String.fromCharCode(this.keyCode);
    });
    
})();


(function() {
    
    /**
     * @class global.MouseEvent
     * MouseEvent クラス
     */
    
    /**
     * @method    pointX
     * マウスのX座標.
     */
    MouseEvent.prototype.getter("pointX", function() {
        return this.clientX - this.target.getBoundingClientRect().left;
//        return this.pageX - this.target.getBoundingClientRect().left - window.scrollX;
    });
    
    /**
     * @method    pointY
     * マウスのY座標.
     */
    MouseEvent.prototype.getter("pointY", function() {
        return this.clientY - this.target.getBoundingClientRect().top;
//        return this.pageY - this.target.getBoundingClientRect().top - window.scrollY;
    });
    
})();




(function() {
    
    if (window.TouchEvent === undefined) { return ; }
    
    
    /**
     * @class global.TouchEvent
     * TouchEvent クラス
     */
    
    /**
     * @method    pointX
     * タッチイベント.
     */
    TouchEvent.prototype.getter("pointX", function() {
        return this.touches[0].clientX - this.target.getBoundingClientRect().left;
//        return this.touches[0].pageX - this.target.getBoundingClientRect().left - tm.global.scrollX;
    });
    
    /**
     * @method    pointY
     * タッチイベント.
     */
    TouchEvent.prototype.getter("pointY", function() {
        return this.touches[0].clientY - this.target.getBoundingClientRect().top;
//        return this.touches[0].pageY - this.target.getBoundingClientRect().top - tm.global.scrollY;
    });
    
    
})();


(function() {
    
    /**
     * @class tm.dom.Event
     * Event クラス
     */
    tm.dom.Event = tm.createClass({

        /** DOMエレメント */
        element     : null,
        /** イベント発火時に実行する関数リスト */
        funcList    : null,
        /** 関数リストのインデックス　未使用？ */
        funcIndex   : 0,
        /** @property domElement */
        
        /**
         * @constructor
         */
        init: function(element) {
            this.element = element;
            this.domElement = element.element;
            this.funcList = {};
        },
        
        /**
         * イベントを追加
         */
        add: function(type, fn, id) {
            var self = this;
            var elm  = this.element;
            
            var temp_fn = function(e) {
                // return fn.apply(self, arguments);
                var result = fn.apply(elm, arguments);
                
                if (result === false) {
                    // デフォルトイベントをキャンセル
                    e.preventDefault();
                    e.returnValue = false;  // IE
                    // イベント伝達をキャンセル
                    e.stopPropagation();
                }
                
                return result;
            }
            
            this._funcIndex = this._funcIndex || 0;
            id = id || this._funcIndex++;
            this.funcList[type] = this.funcList[type] || {};
            this.funcList[type][id] = temp_fn;
            fn._id = id;    // しれっと記録
            
            this.domElement.addEventListener(type, temp_fn, false);
            return this;
        },
        
        /**
         * イベントを解除
         */
        remove: function(type, fn_or_id) {
            var id = (typeof(fn_or_id) === "function") ? fn_or_id._id : fn_or_id;
            var fn = this.getFunc(type, id);
            
            this.domElement.removeEventListener(type, fn, false);
            delete this.funcList[type][id];
        },
        
        /**
         * クリックイベント
         */
        click: function(fn, id) {
            this.add("click", fn, id);
            return this;
        },
        
        /**
         * ミドルクリックイベント
         */
        mdlclick: function(fn, id) {
            var temp_fn = function(e) {
                if (e.button == 1) {
                    fn(e);
                }
            }
            this.add("click", temp_fn, id);
        },
        
        /**
         * ポインティングスタート
         */
        pointstart: function(fn, id) {
            this.add(tm.dom.Event.POINT_START, fn, id);
        },
        /**
         * ポインティング中
         */
        pointmove: function(fn, id) {
            this.add(tm.dom.Event.POINT_MOVE, fn, id);
        },
        /**
         * ポインティングエンド
         */
        pointend: function(fn, id) {
            this.add(tm.dom.Event.POINT_END, fn, id);
        },
        
        /**
         * ホバーイベント
         */
        hover: function(fn, id) {
            this.add("mouseover", fn, id);
            return this;
        },
        
        /**
         * 一度だけ呼ばれるイベントを登録
         */
        one: function(type, fn, id) {
            var self = this;
            var elm  = this.element;
            
            var temp_fn = function() {
                var result = fn.apply(elm, arguments);
                self.remove(type, temp_fn);
                return result;
            };
            
            this.add(type, temp_fn, id);
            
            return this;
        },
        
        /**
         * トグルイベント登録
         */
        toggle: function(type, fn_list) {
            var self = this;
            var elm  = this.element;
            var temp_list = [];
            
            for (var i=0; i<fn_list.length; ++i) {
                var temp_fn = (function(i){
                    return function(){
                        var result = fn_list[i].apply(elm, arguments);
                        
                        if (result !== false) {
                            var index = (i+1)%fn_list.length;
                            self.one(type, temp_list[index]);
                        }
                    }
                })(i);
                temp_list.push(temp_fn);
            }
            
            this.one(type, temp_list[0]);
            
            return this;
        },
        
        /**
         * 指定したイベントタイプ & id の関数を取得
         */
        getFunc: function(type, id) {
            return this.funcList[type][id];
        },
        
    });
    
    /** @static @property */
    tm.dom.Event.POINT_START    = (tm.isMobile) ? "touchstart" : "mousedown";
    /** @static @property */
    tm.dom.Event.POINT_MOVE     = (tm.isMobile) ? "touchmove" : "mousemove";
    /** @static @property */
    tm.dom.Event.POINT_END      = (tm.isMobile) ? "touchend" : "mouseup";
    
    
    /**
     * @member      tm.dom.Element
     * @property    event
     * スタイルクラス
     */
    tm.dom.Element.prototype.getter("event", function(){
        return this._event || ( this._event = tm.dom.Event(this) );
    });
    
})();




/*
 * attr.js
 */

tm.dom = tm.dom || {};

(function(){
    
    /**
     * @class tm.dom.Attr
     * 属性クラス
     */
    tm.dom.Attr = tm.createClass({
        
        /**
         * エレメント
         */
        element: null,
        
        /**
         * @constructor
         */
        init: function(element) {
            this.element = element;
        },
        
        /**
         * 属性をセット
         */
        set: function(name, value) {
            this.element.setAttribute(name, value);
            return this;
        },
        
        /**
         * 属性を追加
         */
        add: function(name, value) {
            var now = this.get(name);
            value = (now) ? now + ' ' + value : value;
            this.element.setAttribute(name, value);
            return this;
        },
        
        /**
         * 属性を削除
         */
        remove: function(name, value) {
            // value があるときはそれのみを削除する
            if (value) {
                var now = this.get(name);
                var next= (now) ? now.replace(value, '').replace('  ', ' ') : '';
                this.element.setAttribute(name, next.trim());
            }
            // ないときは属性そのものを削除する
            else {
                this.element.removeAttribute(name);
            }
            return this;
        },
        
        /**
         * 属性を取得
         */
        get: function(name) {
            return this.element.getAttribute(name);
        },

        /**
         * 属性の存在チェック
         */
        contains: function(name, value) {
            var now = this.get(name);
            if (arguments.length == 1) {
                return now != null;
            }
            else if (arguments.length == 2) {
                return (' '+now+' ').indexOf(' '+value+' ') > -1;
            }

            return false;
        },

        /**
         * トグル
         */
        toggle: function(name, value) {
            if (this.contains(name, value)) {
                this.remove(name, value);
            } else {
                this.add(name, value);
            }
            return this;
        }
    });
    
    /**
     * Attr クラス
     * @property    attr
     */
    tm.dom.Element.prototype.getter("attr", function(){
        return this._attr || ( this._attr = tm.dom.Attr(this.element) );
    });
    
})();


/*
 * style.js
 */

tm.dom = tm.dom || {};

(function(){
    
    /**
     * @class tm.dom.Style
     * スタイル
     */
    tm.dom.Style = tm.createClass({
        
        /** エレメント */
        element: null,
        
        /**
         * @constructor
         */
        init: function(element) {
            this.element = element;
        },
        
        /**
         * セット
         */
        set: function(name, value) {
            this.element.style[name] = value;
            return this;
        },
        
        /**
         * 削除
         */
        remove: function(name) {
            this.element.style.removeProperty(name);
            // delete this.element.style[name];
            return this;
        },
        
        /**
         * クリア
         */
        clear: function(name) {
            
            return this;
        },
        
        /**
         * 取得
         */
        get: function(name) {
            return this.element.style[name];
        },
        
        /**
         * CSS の値も考慮した上での値を取得
         */
        getPropValue: function(prop_name) {
            return document.defaultView.getComputedStyle(this.element, '').getPropertyValue(prop_name);
        },
    });
    
    /**
     * スタイルクラス
     * @member      tm.dom.Element
     * @property    style
     */
    tm.dom.Element.prototype.getter("style", function(){
        return this._style || ( this._style = tm.dom.Style(this.element) );
    });
    
})();


/*
 * anim.js
 */

tm.dom = tm.dom || {};

(function() {
    
    var prefix = tm.VENDER_PREFIX;
    
    var ANIMATION                   = prefix + "Animation";
    var ANIMATION_END               = prefix + "AnimationEnd";
    var ANIMATION_PLAY_STATE        = prefix + "AnimationPlayState";
    var ANIMATION_NAME              = prefix + "AnimationName";
    var ANIMATION_DURATION          = prefix + "AnimationDuration";
    var ANIMATION_TIMING_FUNCTION   = prefix + "AnimationTimingFunction";
    var ANIMATION_DELAY             = prefix + "AnimationDelay";
    var ANIMATION_DIRECTION         = prefix + "AnimationDirection";
    var ANIMATION_ITERATION_COUNT   = prefix + "AnimationIterationCount";
    
    /**
     * @class tm.dom.Anim
     * アニメーションクラス
     */
    tm.dom.Anim = tm.createClass({
        
        /** @property element */

        /**
         * @constructor
         */
        init: function(element) {
            this.element = element;
            
            // アニメーションが終了したらステートを "paused" にする(何度も再生できるようにする為)
            var self = this;
            this.element.addEventListener(ANIMATION_END, function() {
                self.stop();
            }, false);
        },
        
        /**
         * アニメーション開始
         */
        start: function() {
            this.element.style[ANIMATION_PLAY_STATE] = "running";
            return this;
        },
        
        /**
         * アニメーション終了
         */
        stop: function() {
            this.element.style[ANIMATION_PLAY_STATE] = "paused";
            return this;
        },
        
        /**
         * プロパティをセット
         */
        setProperty: function(prop) {
            if (typeof prop == "string") {
                this.element.style[ANIMATION] = prop;
            }
            else {
                for (var key in prop) {
                    var fn = ANIM_SETTER_FUNC_NAME_MAP[key];
                    var value = prop[key];
                    fn.call(this, value);
                }
            }
            return this;
        },
        
        /**
         * 名前をセット
         */
        setName: function(name) {
            this.element.style[ANIMATION_NAME] = name;
            return this;
        },
        
        /**
         * アニメーション時間の長さをセット
         */
        setDuration: function(s) {
            this.element.style[ANIMATION_DURATION] = s;
            return this;
        },
        
        /**
         * 補間関数をセット
         */
        setTimingFunction: function(func) {
            this.element.style[ANIMATION_TIMING_FUNCTION] = func;
            return this;
        },
        
        /**
         * イテレータカウントをセット
         */
        setIterationCount: function(n) {
            this.element.style[ANIMATION_ITERATION_COUNT] = n;
            return this;
        },
        
        /**
         * アニメーション開始待ち時間をセット
         */
        setDelay: function(s) {
            this.element.style[ANIMATION_DELAY] = s;
            return this;
        },
        
        /**
         * 判定再生させるかどうかを指定
         * "normal" or "alternate"
         */
        setDirection: function(t) {
            this.element.style[ANIMATION_DURATION] = t;
            return this;
        },
    });
    
    var ANIM_SETTER_FUNC_NAME_MAP = {
        // 小文字対応
        "name"          : tm.dom.Anim.prototype.setName,
        "duration"      : tm.dom.Anim.prototype.setDuration,
        "timingFunction": tm.dom.Anim.prototype.setTimingFunction,
        "iterationCount": tm.dom.Anim.prototype.setIterationCount,
        "delay"         : tm.dom.Anim.prototype.setDelay,
        
        // 大文字対応
        "Name"          : tm.dom.Anim.prototype.setName,
        "Duration"      : tm.dom.Anim.prototype.setDuration,
        "TimingFunction": tm.dom.Anim.prototype.setTimingFunction,
        "IterationCount": tm.dom.Anim.prototype.setIterationCount,
        "Delay"         : tm.dom.Anim.prototype.setDelay,
    };
    
    /**
     * @property    anim
     */
    tm.dom.Element.prototype.getter("anim", function() {
        return this._anim || (this._anim = tm.dom.Anim(this.element));
    });
    
})();


(function(){
    
    /**
     * @class tm.dom.Trans
     * トランス
     */
    tm.dom.Trans = tm.createClass({
        
        /** エレメント */
        element: null,
        
        /**
         * @constructor
         */
        init: function(element) {
            this.element = element;
        },
        
        /**
         * 変換開始
         */
        to: function(props, t) {
            this.set(props).duration(t||1000);
            return this;
        },

        /**
         * セット
         */
        set: function(props) {
            var style = this.element.style;
            var names = [];
            
            for (var key in props) {
                var name = _checkStyleProperty(key);
                names.push( name.toDash() );
                style[name] = props[key] + "";
            }
            
            style[tm.dom.Trans.PROPERTY] = names.join(', ');   // none;
            
            return this;
        },

        /**
         * 間関
         */
        duration: function(t) {
            var style = this.element.style;
            if (typeof t == "number") t = t + "ms";
            style[tm.dom.Trans.DURATION] = t;
            return this;
        },

        /**
         * イージング
         */
        easing: function(ease) {
            var style = this.element.style;
            style[tm.dom.Trans.TIMING_FUNCTION] = func;
            return this;
        },

        /**
         * 終了
         */
        end: function(fn) {
            var elm  = tm.dom.Element(this.element);
            elm.event.add(tm.dom.Trans.END_EVENT, fn);
            return this;
        },

        /**
         * リセット
         */
        reset: function() {
            var style = this.element.style;
            style[tm.dom.Trans.PROPERTY] = "none";
            return this;
        },

        /**
         * 移動
         */
        translate: function(x, y, t) {
            this.to({"transform": "translate({0}px,{1}px)".format(x, y)}, t);
            return this;
        },

        /**
         * 移動3D
         */
        translate3d: function(x, y, z, t) {
            this.to({"transform": "translate3d({0}px,{1}px,{2}px)".format(x, y, z)}, t);
            return this;
        },

        /**
         * 回転
         */
        rotate: function(deg, t) {
            this.to({"transform": "rotate({0}deg)".format(deg)}, t);
            return this;
        },

        /**
         * 回転3D
         */
        rotate3d: function(x, y, z, deg, t) {
            this.to({"transform": "rotate3d({0},{1},{2},{3}deg)".format(x, y, z, deg)}, t);
            return this;
        },

        /**
         * スケール
         */
        scale: function(x, y, t) {
            this.to({"transform": "scale({0},{1})".format(x, y)}, t);
            return this;
        },

        /**
         * 行列変換
         */
        transform: function() {
            // TODO: 実装する
        },
        
        // -------------------------------------
        
        /**
         * プロパティをセット
         */
        setProp: function(prop) {
            var style = this.element.style;
            var prop_list = [];
            
            for (var key in prop) {
                var name = _checkStyleProperty(key);
                prop_list.push( name.toDash() );
                style[name] = prop[key];
            }
            
            style[tm.dom.Trans.PROPERTY] = prop_list.join(', ');   // none;
            
            return this;
        },

        /**
         * 間関をセット
         */
        setDuration: function(t) {
            var style = this.element.style;
            style[tm.dom.Trans.DURATION] = t;
            return this;
        },

        /**
         * タイミングファンクをセット
         */
        setTimingFunction: function(func) {
            var style = this.element.style;
            style[tm.dom.Trans.TIMING_FUNCTION] = func;
            return this;
        },

        /**
         * リセット
         */
        resetProp: function() {
            var style = this.element.style;
            style[tm.dom.Trans.PROPERTY] = "none";
            return this;
        },

        /**
         * 終了時関数を登録
         */
        setEndFunction: function(fn) {
            var elm  = tm.dom.Element(this.element);
            elm.event.add(tm.dom.Trans.END_EVENT, fn);
            return this;
        },
    });
    
    /** @static @property */
    tm.dom.Trans.PROPERTY        = tm.VENDER_PREFIX + "TransitionProperty";
    /** @static @property */
    tm.dom.Trans.DURATION        = tm.VENDER_PREFIX + "TransitionDuration";
    /** @static @property */
    tm.dom.Trans.TIMING_FUNCTION = tm.VENDER_PREFIX + "TransitionTimingFunction";
    /** @static @property */
    tm.dom.Trans.DELAY           = tm.VENDER_PREFIX + "TransitionDelay";
    /** @static @method @member tm.dom.Trans */
    tm.dom.Trans.END_EVENT       = (function(){
        return {
            "webkit": "webkitTransitionEnd",
            "moz"   : "transitionend",
            "o"     : "oTransitionEnd",
        }[tm.VENDER_PREFIX];
    })();
    
    /**
     * @property    trans
     */
    tm.dom.Element.prototype.getter("trans", function(){
        return this._trans || ( this._trans = tm.dom.Trans(this.element) );
    });
    
    var _styleList = {
        "transform": true,
    };
    var _checkStyleProperty = function(name) {
        if (_styleList[name] === true) {
            return '-'+tm.VENDER_PREFIX + name.capitalizeFirstLetter();
        }
        return name;
    };
})();
/*
 * dom/data.js
 */

(function(){
    
    /**
     * @class tm.dom.Data
     */
    tm.define("tm.dom.Data", {

        /** エレメント */
        element: null,
        
        /**
         * @constructor
         */
        init: function(element) {
            this.element = element;
        },
        
        /**
         * 属性をセット
         */
        set: function(name, value) {
        	var key = "data-" + name.toDash();
            this.element.setAttribute(key, value);

            return this;
        },
        
        /**
         * 属性をゲット
         */
        get: function(name, value) {
        	var key = "data-" + name.toDash();
        	return this.element.attributes[key].value;
        },
    });
    
    /**
     * Attr クラス
     * @property    data
     */
    tm.dom.Element.prototype.getter("data", function(){
        return this._data || ( this._data = tm.dom.Data(this.element) );
    });

})();
/*
 * manager.js
 */

(function() {

    tm.asset = tm.asset || {};
    
    /**
     * アセットマネージャー
     */
    tm.asset.Manager = {
        /** アセット */
        assets: {},
        
        /**
         * アセットのゲット
         * @param {Object} key
         */
        get: function(key) {
            return this.assets[key];
        },

        /**
         * アセットのセット
         * @param {Object} key
         * @param {Object} asset
         */
        set: function(key, asset) {
            this.assets[key] = asset;
            return this;
        },

        /**
         * キーと一致するアセットを含んでいるか
         * @param {Object} key
         */
        contains: function(key) {
            return (this.assets[key]) ? true : false;
        },

    };

})();













(function() {

    /**
     * @class tm.asset.Loader
     * @extends tm.event.EventDispatcher
     * アセットローダー
     */
    tm.define("tm.asset.Loader", {
        superClass: "tm.event.EventDispatcher",

        /** @property assets  アセット */
        
        /**
         * @constructor
         */
        init: function() {
            this.superInit();
            
            this.assets = {};
        },
        
        /**
         * キーと一致するアセットを含んでいるか
         * @param {Object} key
         */
        contains: function(key) {
            return (this.assets[key]) ? true : false;
        },
        
        /**
         * アセットのロード実行
         * @param {Object} arg
         */
        load: function(arg) {
            if (tm.util.Type.isObject(arg)) {
                this._loadByObject(arg);
            }
            else {
                this._loadString(arguments[0], arguments[1], arguments[2]);
            }
            
            return this;
        },

        /**
         * アセットのゲット
         * @param {Object} key
         */
        get: function(key) {
            return this.assets[key];
        },

        /**
         * アセットのセット
         * @param {Object} key
         * @param {Object} asset
         */
        set: function(key, asset) {
            this.assets[key] = asset;
            
            // manager の方にもセットする
            tm.asset.Manager.set(key, asset);
            
            return this;
        },
        
        /**
         * アセットのロード
         * @private
         * @param {Object} key
         * @param {Object} path
         * @param {Object} type
         */
        _load: function(key, path, type) {
            // if (tm.asset.Manager.contains(key)) {
            //     return tm.asset.Manager.get(key);
            // }
            
            path = path || key;
            // type が省略されている場合は拡張子から判定する
            type = type || path.split('?')[0].split('#')[0].split('.').last;
            
            var asset = tm.asset.Loader._funcs[type](path, key);
            this.set(key, asset);
            
            return asset;
        },
        /**
         * 文字列指定のアセットのロード
         * @private
         * @param {Object} key
         * @param {Object} path
         * @param {Object} type
         */
        _loadString: function(key, path, type) {
            
            var hash = {};
            hash[key] = {
                url: path,
                type: type,
            };
            this._loadByObject(hash);
        },
        /**
         * オブジェクト指定のアセットのロード
         * @private
         * @param {Object} hash
         */
        _loadByObject: function(hash) {
            var flow = tm.util.Flow(Object.keys(hash).length, function() {
                var e = tm.event.Event("load");
                this.dispatchEvent(e);
            }.bind(this));
            
            var loadAsset = function(asset, key) {

                var e = tm.event.Event("progress");
                e.key = key;
                e.asset = asset;
                e.progress = (flow.counter+1)/flow.waits; // todo
                this.dispatchEvent(e);

                flow.pass();
            }.bind(this);
            
            Object.keys(hash).each(function(key) {
                var value = hash[key];
                var asset = null;

                if (typeof value == 'string') {
                    asset = this._load(key, value);
                }
                else {
                    asset = this._load(key, value['url'] || value['src'] || value['path'], value['type']);
                }
                
                if (asset.loaded) {
                    loadAsset(asset, key);
                }
                else {
                    asset.on("load", function() {
                        loadAsset(asset, key);
                    });
                }
            }.bind(this));
        },
    });
    
    
    tm.asset.Loader._funcs = [];
    tm.asset.Loader.defineFunction("register", function(type, func) {
        this._funcs[type] = func;
    });
    
    
    var _textureFunc = function(path) {
        var texture = tm.asset.Texture(path);
        return texture;
    };
    var _soundFunc = function(path) {
        var audio = tm.sound.WebAudio(path);
        return audio;
    };
    
    var _tmxFunc = function(path) {
        var mapSheet = tm.asset.MapSheet(path);
        return mapSheet;
    };
    
    var _tmssFunc = function(path) {
        var ss = tm.asset.SpriteSheet(path);
        return ss;
    };

    var _jsonFunc = function(path) {
        var file = tm.util.File();
        
        if (typeof path == 'string') {
            file.load({
                url: path,
                dataType: 'json',
            });
        }
        else {
            var data = path;
            file.setData(path);
            file.loaded = true;
        }

        return file;
    };

    var _loadScript = function(path) {
        var script = tm.asset.Script(path);

        return script;
    };

    // image
    tm.asset.Loader.register("png", _textureFunc);
    tm.asset.Loader.register("gif", _textureFunc);
    tm.asset.Loader.register("jpg", _textureFunc);
    tm.asset.Loader.register("jpeg", _textureFunc);

    // sound
    tm.asset.Loader.register("wav", _soundFunc);
    tm.asset.Loader.register("mp3", _soundFunc);
    tm.asset.Loader.register("ogg", _soundFunc);
    tm.asset.Loader.register("m4a", _soundFunc);

    // json
    tm.asset.Loader.register("json", _jsonFunc);

    // map data
    tm.asset.Loader.register("tmx", _tmxFunc);
    
    // spritesheet for tmlib.js
    tm.asset.Loader.register("tmss", _tmssFunc);
    
    // script file
    tm.asset.Loader.register("js", _loadScript);
    
})();


/*
 * texture.js
 */

(function() {
    
    /**
     * @class tm.asset.Texture
     * テクスチャクラス
     * @extends tm.event.EventDispatcher
     */
    tm.define("tm.asset.Texture", {
        superClass: "tm.event.EventDispatcher",
        
        /** window.document.Image */
        element: null,

        /** ロード済みかどうか */
        loaded: false,
        
        /**
         * @constructor
         */
        init: function(src) {
            this.superInit();
            
            this.element = new Image();
            if ( !tm.isLocal() && !(/^data:/.test(src)) ) {
                // this.element.crossOrigin = "anonymous";
            }
            this.element.src = src;
            
            var self = this;
            this.element.onload = function() {
                self.loaded = true;
                var e = tm.event.Event("load");
                self.dispatchEvent( e );
            };

            this.element.onerror = function(e) {
                console.error("[tmlib] {0}の読み込みに失敗!".format(src));
                
                var key = src.split('/').last.replace('.png', '').split('?').first.split('#').first;
                var elm = e.target;
                
                elm.src = "http://dummyimage.com/128x128/444444/eeeeee&text=" + key;
                elm.onerror = null;
            };
        },
        
        /**
         * window.document.Image クラスのインスタンスを返す
         */
        getElement: function() {
            return this.element;
        },
    });
    
    /**
     * @property    width
     * 幅
     */
    tm.asset.Texture.prototype.getter("width", function() {
        return this.element.width;
    });
    
    /**
     * @property    height
     * 高さ
     */
    tm.asset.Texture.prototype.getter("height", function() {
        return this.element.height;
    });
    
})();

(function(){

    /*
     * @static
     * @method
     * ### ref
     * http://dummyimage.com/
     */
    /*
    tm.graphics.TextureManager.loadDummy = function(key, param) {
        param = param || {};

        var paths = ["http://dummyimage.com"];
        paths.push(param.size || 256);
        paths.push(param.bgColor || "aaa");
        paths.push(param.color || "000");
        paths.push(param.format || "png");

        var src = paths.join('/');
        if (param.text) {
            src += '&text=' + param.text;
        }

        this.textures[key] = tm.graphics.Texture(src);
        this.loaded = false;
    };
    */

})();



/*
 * spritesheet.js
 */

(function() {
    
    /**
     * @class tm.asset.SpriteSheet
     * マップシート
     * @extends tm.event.EventDispatcher
     */
    tm.define("tm.asset.SpriteSheet", {
        superClass: "tm.event.EventDispatcher",

        /** ロード済みかどうか */
        loaded: false,

        /**
         * @constructor
         */
        init: function(src) {
            this.superInit();

            this.loaded = false;

            if (typeof src == "string") {
            	this.load(src);
            }
            else {
	            this.parse(src);
    			this.loaded = true;
    			this.dispatchEvent(tm.event.Event("load"));
            }

        },

        /**
         * ロード
         */
        load: function(path) {
        	tm.util.Ajax.load({
        		url: path,
        		dataType: "json",
        		success: function(d) {
        			this.parse(d);
        			this.loaded = true;
        		}.bind(this),
        	});
        },

        /**
         * パース
         */
        parse: function(param) {
            this.frame = param.frame;

            if (typeof param.image == "string") {
                if (!tm.asset.Manager.contains(param.image)) {
                    var loader = tm.asset.Loader();
                    loader.load(param.image);
                }
                this.image = tm.asset.Manager.get(param.image);
            }
            else {
                this.image = param.image;
            }

            if (this.image.loaded === false) {
                this.image.addEventListener("load", function() {
                    this._calcFrames(param.frame);
                    var e = tm.event.Event("load");
                    this.dispatchEvent(e);
                }.bind(this), false);
            }
            else {
                this._calcFrames(param.frame);
                var e = tm.event.Event("load");
                this.dispatchEvent(e);
            }

            this._calcAnim(param.animations);
        },

        /**
         * フレームを取得
         */
        getFrame: function(index) {
            return this.frames[index];
        },
        
        /**
         * アニメーションを取得
         */
        getAnimation: function(name) {
            return this.animations[name];
        },
        
        /**
         * @private
         */
        _calcFrames: function(frame) {
            var frames = this.frames = [];
            
            var w = frame.width;
            var h = frame.height;
            var row = ~~(this.image.width / w);
            var col = ~~(this.image.height/ h);
            
            if (!frame.count) frame.count = row*col;

            for (var i=0,len=frame.count; i<len; ++i) {
                var x   = i%row;
                var y   = (i/row)|0;
                var rect = {
                    x:x*w,
                    y:y*h,
                    width: w,
                    height: h
                };
                frames.push(rect);
            }
        },

        /**
         * @private
         */
        _calcAnim: function(animations) {
            this.animations = {};
            for (var key in animations) {
                var anim = animations[key];

                if (anim instanceof Array) {
                    this.animations[key] = {
                        frames: [].range(anim[0], anim[1]),
                        next: anim[2],
                        frequency: anim[3] || 1
                    };
                }
                else if (typeof anim == "number") {
                    this.animations[key] = {
                        frames: [anim],
                        next: null,
                        frequency: 1
                    };
                }
                else {
                    this.animations[key] = {
                        frames: anim.frames,
                        next: anim.next,
                        frequency: anim.frequency || 1
                    };
                }
            }
            
            // デフォルトアニメーション
            this.animations["default"] = {
                frames: [].range(0, this.frame.count),
                next: "default",
                frequency: 1,
            };
        }

    });

})();

/*
 * mapsheet.js
 */

(function() {

    /**
     * @class tm.asset.MapSheet
     * マップシート
     * @extends tm.event.EventDispatcher
     */
    tm.define("tm.asset.MapSheet", {
        superClass: "tm.event.EventDispatcher",

        /** @property loaded  */

        /**
         * @constructor
         */
        init: function(path) {
            this.superInit();

            this.loaded = false;

            if (typeof path == "string") {
                tm.util.Ajax.load({
                    url: path,
                    success: function(e) {
                        var d = this._parse(e);
                        this.$extend(d);
                        this._checkImage();
                    }.bind(this),
                });
            }
            else {
                this.$extend(arguments[0]);

                this._checkImage();
            }
        },

        /**
         * パース
         * @private
         */
        _parse: function(str) {
            var each = Array.prototype.forEach;
            var data = {};
            var parser = new DOMParser();
            var xml = parser.parseFromString(str, 'text/xml');
            var map = this._attrToJSON(xml.getElementsByTagName('map')[0]);

            this.$extend(map);

            // tilesets(image)
            data.tilesets = this._parseTilesets(xml);

            // layer
            data.layers = this._parseLayers(xml);

            return data;
        },

        /**
         * @private
         */
        _parseTilesets: function(xml) {
            var each = Array.prototype.forEach;
            var self = this;
            var data = [];
            var tilesets = xml.getElementsByTagName('tileset');
            each.call(tilesets, function(tileset) {
                var t = {};
                var props = self._propertiesToJson(tileset);

                if (props.src) {
                    t.image = props.src;
                }
                else {
                    t.image = tileset.getElementsByTagName('image')[0].getAttribute('source');
                }
                data.push(t);
            });

            return data;
        },

        /**
         * @private
         */
        _parseLayers: function(xml) {
            var each = Array.prototype.forEach;
            var data = [];

            var map = xml.getElementsByTagName("map")[0];
            var layers = [];
            each.call(map.childNodes, function(elm) {
                if (elm.tagName == "layer" || elm.tagName == "objectgroup" || elm.tagName == "imagelayer") {
                    layers.push(elm);
                }
            });

            layers.each(function(layer) {
                if (layer.tagName == "layer") {
                    var d = layer.getElementsByTagName('data')[0];
                    var encoding = d.getAttribute("encoding");
                    var l = {
                        type: "layer",
                        name: layer.getAttribute("name"),
                    };

                    if (encoding == "csv") {
                        l.data = this._parseCSV(d.textContent);
                    }
                    else if (encoding == "base64") {
                        l.data = this._parseBase64(d.textContent);
                    }

                    var attr = this._attrToJSON(layer);
                    l.$extend(attr);

                    data.push(l);
                }
                else if (layer.tagName == "objectgroup") {
                    var l = {
                        type: "objectgroup",
                        objects: [],
                        name: layer.getAttribute("name"),
                    };
                    each.call(layer.childNodes, function(elm) {
                        if (elm.nodeType == 3) return ;

                        var d = this._attrToJSON(elm);
                        d.properties = this._propertiesToJson(elm);

                        l.objects.push(d);
                    }.bind(this));

                    data.push(l);
                }
                else if (layer.tagName == "imagelayer") {
                    var l = {
                        type: "imagelayer",
                        name: layer.getAttribute("name"),
                        x: layer.getAttribute("x") || 0,
                        y: layer.getAttribute("y") || 0,
                        alpha: layer.getAttribute("opacity") || 1,
                        visible: (layer.getAttribute("visible") === undefined || layer.getAttribute("visible") != 0),
                    };
                    var imageElm = layer.getElementsByTagName("image")[0];
                    l.image = {
                        source: imageElm.getAttribute("source")
                    };

                    data.push(l);
                }
            }.bind(this));

            return data;
        },

        /**
         * @private
         */
        _parseCSV: function(data) {
            var dataList = data.split(',');
            var layer = [];

            dataList.each(function(elm, i) {
                var num = parseInt(elm, 10) - 1;
                layer.push(num);
            });

            return layer;
        },

        /**
         * http://thekannon-server.appspot.com/herpity-derpity.appspot.com/pastebin.com/75Kks0WH
         * @private
         */
        _parseBase64: function(data) {
            var dataList = atob(data.trim());
            var rst = [];

            dataList = dataList.split('').map(function(e) {
                return e.charCodeAt(0);
            });

            for (var i=0,len=dataList.length/4; i<len; ++i) {
                var n = dataList[i*4];
                rst[i] = parseInt(n, 10) - 1;
            }

            return rst;
        },

        /**
         * @private
         */
        _propertiesToJson: function(elm) {
            var properties = elm.getElementsByTagName("properties")[0];
            var obj = {};
            if (properties === undefined) {
                return obj;
            }
            for (var k = 0;k < properties.childNodes.length;k++) {
                var p = properties.childNodes[k];
                if (p.tagName === "property") {
                    obj[p.getAttribute('name')] = p.getAttribute('value');
                }
            }

            return obj;
        },

        /**
         * @private
         */
        _attrToJSON: function(source) {
            var obj = {};
            for (var i = 0; i < source.attributes.length; i++) {
                var val = source.attributes[i].value;
                val = isNaN(parseFloat(val))? val: parseFloat(val);
                obj[source.attributes[i].name] = val;
            }

            return obj;
        },

        /**
         * @private
         */
        _checkImage: function() {
            var self = this;
            var imageSoruces = [];

            // for tile set
            if (this.tilesets.length) {
                Array.prototype.push.apply(imageSoruces, this.tilesets.map(function(tile) {
                    return tile.image;
                }));
            }

            // for image layer
            this.layers.each(function(layer) {
                if (layer.type == "imagelayer") {
                    imageSoruces.push(layer.image.source);
                }
            });

            if (imageSoruces.length) {
                var i = 0;
                var len = imageSoruces.length;

                var _onloadimage = function() {
                    i++;
                    if (i==len) {
                        this.loaded = true;
                        var e = tm.event.Event("load");
                        this.dispatchEvent(e);
                    }
                }.bind(this);

                imageSoruces.each(function(imageName) {
                    var image = tm.asset.Manager.get(imageName);

                    if (image) {
                        if (image.loaded) {
                            // ロード済み
                            ++i;
                            if (i==len) {
                                this.loaded = true;
                                var e = tm.event.Event("load");
                                self.dispatchEvent(e);
                            }
                        }
                        else {
                            image.addEventListener("load", _onloadimage);
                        }
                    }
                    else {
                        var loader = tm.asset.Loader();
                        loader.load(imageName);
                        var texture = tm.asset.Manager.get(imageName);
                        texture.addEventListener("load", _onloadimage);
                    }
                });

            }
            else {
                this.loaded = true;
                var e = tm.event.Event("load");
                this.dispatchEvent(e);
            }
        },
    });

})();
tm.asset = tm.asset || {};

(function() {

    tm.define("tm.asset.Font", {
        superClass: "tm.event.EventDispatcher",

        init: function(path, key, format) {
            this.superInit();

            var fontFaceStyleElement = tm.dom.Element("head").create("style");
            fontFaceStyleElement.text = "@font-face { font-family: '{0}'; src: url({1}) format('{2}'); }".format(key, path, format);

            tm.asset.Font.checkLoaded(key, function() {
                this.flare("load");
            }.bind(this));
        },
    });

    tm.asset.Font.checkLoaded = function(font, callback) {
        var element = tm.dom.Element("body").create("span");
        element.style
            .set("color", "rgba(0, 0, 0, 0)")
            .set("fontSize", "40px");
        element.text = "QW@HhsXJ=/()あいうえお＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝";

        var before = element.element.offsetWidth;
        element.style
            .set("fontFamily", "'{0}', 'monospace'".format(font));

        var checkLoadFont = function() {
            if (element.element.offsetWidth !== before) {
                element.remove();
                callback && callback();
            } else {
                setTimeout(checkLoadFont, 100);
            }
        };
        setTimeout(checkLoadFont, 100);
    };

    tm.asset.Loader.register("ttf", function(path, key) {
        return tm.asset.Font(path, key, "truetype");
    });
    tm.asset.Loader.register("otf", function(path, key) {
        return tm.asset.Font(path, key, "opentype");
    });
    tm.asset.Loader.register("woff", function(path, key) {
        return tm.asset.Font(path, key, "woff");
    });
    tm.asset.Loader.register("woff2", function(path, key) {
        return tm.asset.Font(path, key, "woff2");
    });

})();

/*
 * script.js
 */

tm.util = tm.util || {};


(function() {
    
    /**
     * @class tm.asset.Script
     * スクリプトクラス
     */

    tm.define("tm.asset.Script", {

        superClass: "tm.event.EventDispatcher",

        /** element */
        element: null,
        /** loaded */
        loaded: false,
        
        /**
         * @constructor
         */
        init: function(src) {
            this.superInit();

            this.loaded = false;
            this.element = document.createElement("script");
            this.element.type = "text/javascript";
            this.element.src = src;
            this.element.charset = "UTF-8";
            this.element.setAttribute("defer", true);
            document.head.appendChild(this.element);
            
            var self = this;
            this.element.onload = function() {
                self.loaded = true;
                self.fire(tm.event.Event("load"));
            };
        },
        
        /**
         * getElement
         */
        getElement: function() {
            return this.element;
        },
        
    });

    tm.asset.Script.load = function(src) {
        var script = tm.asset.Script(src);

        return script;
    };

    /**
     * @static
     * @method
     * Stats を動的ロード
     */
    tm.asset.Script.loadStats = function(version) {
        version = version || "r11";
        var path = null;
        if (["r6", "r7", "r8", "r9", "10"].indexOf(version) != -1) {
            path = "https://cdn.rawgit.com/mrdoob/stats.js/" + version + "/build/Stats.js";
        }
        else {
            path = "http://cdn.rawgit.com/mrdoob/stats.js/" + version + "/build/stats.min.js";
        }

        return this.load(path);
    };

    /**
     * @static
     * @method
     * datGUI を動的ロード
     */
    tm.asset.Script.loadDatGUI = function(version) {
        // http://dat-gui.googlecode.com/git/build/dat.gui.min.js
        // https://dat-gui.googlecode.com/git-history/0.5/build/dat.gui.min.js

        version = version || "0.5";
//        var path = "https://dat-gui.googlecode.com/git-history/" + version + "/build/dat.gui.min.js";
//        var path = "http://dat-gui.googlecode.com/git/build/dat.gui.min.js";
        var path = "http://dat-gui.googlecode.com/git/build/dat.gui.js";
        return this.load(path);
    };

    /**
     * @static
     * @method
     * Three.js を動的ロード
     */
    tm.asset.Script.loadThree = function(version) {
        var THREE_JS_URL = "http://cdn.rawgit.com/mrdoob/three.js/{version}/build/three.js";
//        var THREE_JS_URL = "https://raw.github.com/mrdoob/three.js/{version}/build/three.min.js";
        version = version || "r55";

        var path = THREE_JS_URL.format({version: version});

        return this.load(path);
    };

    /**
     * @static
     * @method
     * BulletML.js を動的ロード
     */
    tm.asset.Script.loadBulletML = function(version) {
        var BULLETML_FOR_TMLIB_JS_URL   = "http://cdn.rawgit.com/daishihmr/bulletml.js/{version}/target/bulletml.for.tmlib.js";
        version = version || "v0.4.2";
        var path = BULLETML_FOR_TMLIB_JS_URL.format({version: version});        
        return this.load(path);
    };


})();

/*
 * keyboard.js
 */

tm.input = tm.input || {};


(function() {
    
    /**
     * @class tm.input.Keyboard
     * キーボードクラス
     * 
     *      @example
     *      
     */
    tm.input.Keyboard = tm.createClass({
        
        /** target element */
        element: null,
        /** key */
        key: null,
        /** 押しているキー */
        press   : null,
        /** 押したキー */
        down    : null,
        /** 離したキー */
        up      : null,
        /** 押していたキー */
        last    : null,
        
        /**
         * @constructor
         * <a href="http://tmlib-js.googlecode.com/svn/trunk/test/input/keyboard-test.html">Test Program</a>.
         * ### Example
         * TM.loadScript("input", "keyboard");
         *  
         * TM.main(function() {
         *     var k = TM.$Key(document);
         *     k.run();
         *     TM.setLoop(function(){
         *         if (k.getKey('a')) { console.log("press 'a'!!"); }
         *     });
         * });
         */
        init: function(element) {
            this.element = element || document;
            
            this.key = {};
            
            this.press  = {};
            this.down   = {};
            this.up     = {};
            this.last   = {};
            
            var self = this;
            this.element.addEventListener("keydown", function(e){
                self.key[e.keyCode] = true;
            });
            this.element.addEventListener("keyup", function(e){
                // delete self.key[e.keyCode];
                self.key[e.keyCode] = false;
                // self.button |= 1<<e.button;
            });
            this.element.addEventListener("keypress", function(e){
                // self.button &= ~(1<<e.button);
            });
        },
        
        /**
         * run.
         * 自動でマウス情報を更新したい際に使用する
         */
        run: function(fps) {
            var self = this;
            fps = fps || 30;
            tm.setLoop(function(){
                self._update();
                if (self.update) self.update();
            }, 1000/fps);
        },
        
        /**
         * 情報更新処理
         * マイフレーム呼んで下さい.
         * @private
         */
        _update: function() {
            // TODO: 一括ビット演算で行うよう修正する
            for (var k in this.key) {
                this.last[k]    = this.press[k];
                this.press[k]   = this.key[k];
                
                this.down[k] = (this.press[k] ^ this.last[k]) & this.press[k];
                this.up[k] = (this.press[k] ^ this.last[k]) & this.last[k];
            }
            
            return this;
        },
        
        /**
         * キーを押しているかをチェック
         * @param   {Number/String} key keyCode or keyName
         * @returns {Boolean}   チェック結果
         */
        getKey: function(key) {
            if (typeof(key) == "string") {
                key = KEY_CODE[key];
            }
            return this.press[key] == true;
        },
        
        /**
         * キーを押したかをチェック
         * @param   {Number/String} key keyCode or keyName
         * @returns {Boolean}   チェック結果
         */
        getKeyDown: function(key) {
            if (typeof(key) == "string") {
                key = KEY_CODE[key];
            }
            return this.down[key] == true;
        },
        
        /**
         * キーを離したかをチェック
         * @param   {Number/String} key keyCode or keyName
         * @returns {Boolean}   チェック結果
         */
        getKeyUp: function(key) {
            if (typeof(key) == "string") {
                key = KEY_CODE[key];
            }
            return this.up[key] == true;
        },
        
        /**
         * キーの方向を Angle(Degree) で取得
         * @returns {Boolean}   角度(Degree)
         */
        getKeyAngle: function() {
            var angle = null;
            var arrowBit =
                (this.getKey("left")   << 3) | // 1000
                (this.getKey("up")     << 2) | // 0100
                (this.getKey("right")  << 1) | // 0010
                (this.getKey("down"));         // 0001
            
            if (arrowBit != 0 && ARROW_BIT_TO_ANGLE_TABLE.hasOwnProperty(arrowBit)) {
                angle = ARROW_BIT_TO_ANGLE_TABLE[arrowBit];
            }
            
            return angle;
        },

        /**
         * キーの押している向きを取得
         * 正規化されている
         */
        getKeyDirection: function() {
            var direction = tm.geom.Vector2(0, 0);

            if (this.getKey("left")) {
                direction.x = -1;
            }
            else if (this.getKey("right")) {
                direction.x = 1;
            }
            if (this.getKey("up")) {
                direction.y = -1;
            }
            else if (this.getKey("down")) {
                direction.y = 1;
            }

            if (direction.x && direction.y) {
                direction.div(Math.SQRT2);
            }

            return direction;
        },
        
        /**
         * キーの状態を設定する
         */
        setKey: function(key, flag) {
            if (typeof(key) == "string") {
                key = KEY_CODE[key];
            }
            this.key[key] = flag;
            
            return this;
        },

        /**
         * キーを全て離したことにする
         */
        clearKey: function() {
            this.key = {};
            
            return this;
        },
        
    });

    /*
     * @enum ARROW_BIT_TO_ANGLE_TABLE
     * 方向のアングル jsduckでは数字をプロパティに指定できない？
     * @private
     */
    var ARROW_BIT_TO_ANGLE_TABLE = {
        /* @property 下 */
        0x01: 270,
        /* @property 右 */
        0x02:   0,
        /* @property 上 */
        0x04:  90,
        /* @property 左 */
        0x08: 180,

        /* @property 右上 */
        0x06:  45,
        /* @property 右下 */
        0x03: 315,
        /* @property 左上 */
        0x0c: 135,
        /* @property 左下 */
        0x09: 225,

        // 三方向同時押し対応
        // 想定外の操作だが対応しといたほうが無難
        /* @property 右上左 */
        0x0e:  90,
        /* @property 上左下 */
        0x0d: 180,
        /* @property 左下右 */
        0x0b: 270,
        /* @property 下右上 */
        0x07:   0,
    };

    /*
     * @enum KEY_CODE
     * キー番号
     * @private
     */
    var KEY_CODE = {
        /* @property */
        "backspace" : 8,
        /* @property */
        "tab"       : 9,
        /* @property */
        "enter"     : 13,
        /* @property */
        "return"    : 13,
        /* @property */
        "shift"     : 16,
        /* @property */
        "ctrl"      : 17,
        /* @property */
        "alt"       : 18,
        /* @property */
        "pause"     : 19,
        /* @property */
        "capslock"  : 20,
        /* @property */
        "escape"    : 27,
        /* @property */
        "pageup"    : 33,
        /* @property */
        "pagedown"  : 34,
        /* @property */
        "end"       : 35,
        /* @property */
        "home"      : 36,
        /* @property */
        "left"      : 37,
        /* @property */
        "up"        : 38,
        /* @property */
        "right"     : 39,
        /* @property */
        "down"      : 40,
        /* @property */
        "insert"    : 45,
        /* @property */
        "delete"    : 46,
        
        /* @property */
        "0" : 48,
        /* @property */
        "1" : 49,
        /* @property */
        "2" : 50,
        /* @property */
        "3" : 51,
        /* @property */
        "4" : 52,
        /* @property */
        "5" : 53,
        /* @property */
        "6" : 54,
        /* @property */
        "7" : 55,
        /* @property */
        "8" : 56,
        /* @property */
        "9" : 57,
        /* @property */
        
        "a" : 65,
        /* @property */
        "A" : 65,
        /* @property */
        "b" : 66,
        /* @property */
        "B" : 66,
        /* @property */
        "c" : 67,
        /* @property */
        "C" : 67,
        /* @property */
        "d" : 68,
        /* @property */
        "D" : 68,
        /* @property */
        "e" : 69,
        /* @property */
        "E" : 69,
        /* @property */
        "f" : 70,
        /* @property */
        "F" : 70,
        /* @property */
        "g" : 71,
        /* @property */
        "G" : 71,
        /* @property */
        "h" : 72,
        /* @property */
        "H" : 72,
        /* @property */
        "i" : 73,
        /* @property */
        "I" : 73,
        /* @property */
        "j" : 74,
        /* @property */
        "J" : 74,
        /* @property */
        "k" : 75,
        /* @property */
        "K" : 75,
        /* @property */
        "l" : 76,
        /* @property */
        "L" : 76,
        /* @property */
        "m" : 77,
        /* @property */
        "M" : 77,
        /* @property */
        "n" : 78,
        /* @property */
        "N" : 78,
        /* @property */
        "o" : 79,
        /* @property */
        "O" : 79,
        /* @property */
        "p" : 80,
        /* @property */
        "P" : 80,
        /* @property */
        "q" : 81,
        /* @property */
        "Q" : 81,
        /* @property */
        "r" : 82,
        /* @property */
        "R" : 82,
        /* @property */
        "s" : 83,
        /* @property */
        "S" : 83,
        /* @property */
        "t" : 84,
        /* @property */
        "T" : 84,
        /* @property */
        "u" : 85,
        /* @property */
        "U" : 85,
        /* @property */
        "v" : 86,
        /* @property */
        "V" : 86,
        /* @property */
        "w" : 87,
        /* @property */
        "W" : 87,
        /* @property */
        "x" : 88,
        /* @property */
        "X" : 88,
        /* @property */
        "y" : 89,
        /* @property */
        "Y" : 89,
        /* @property */
        "z" : 90,
        /* @property */
        "Z" : 90,
        
        /* @property */
        "numpad0" : 96,
        /* @property */
        "numpad1" : 97,
        /* @property */
        "numpad2" : 98,
        /* @property */
        "numpad3" : 99,
        /* @property */
        "numpad4" : 100,
        /* @property */
        "numpad5" : 101,
        /* @property */
        "numpad6" : 102,
        /* @property */
        "numpad7" : 103,
        /* @property */
        "numpad8" : 104,
        /* @property */
        "numpad9" : 105,
        /* @property */
        "multiply"      : 106,
        /* @property */
        "add"           : 107,
        /* @property */
        "subtract"      : 109,
        /* @property */
        "decimalpoint"  : 110,
        /* @property */
        "divide"        : 111,

        /* @property */
        "f1"    : 112,
        /* @property */
        "f2"    : 113,
        /* @property */
        "f3"    : 114,
        /* @property */
        "f4"    : 115,
        /* @property */
        "f5"    : 116,
        /* @property */
        "f6"    : 117,
        /* @property */
        "f7"    : 118,
        /* @property */
        "f8"    : 119,
        /* @property */
        "f9"    : 120,
        /* @property */
        "f10"   : 121,
        /* @property */
        "f11"   : 122,
        /* @property */
        "f12"   : 123,
        
        /* @property */
        "numlock"   : 144,
        /* @property */
        "scrolllock": 145,
        /* @property */
        "semicolon" : 186,
        /* @property */
        "equalsign" : 187,
        /* @property */
        "comma"     : 188,
        /* @property */
        "dash"      : 189,
        /* @property */
        "period"    : 190,
        /* @property */
        "forward slash" : 191,
        /* @property */
        "/": 191,
        /* @property */
        "grave accent"  : 192,
        /* @property */
        "open bracket"  : 219,
        /* @property */
        "back slash"    : 220,
        /* @property */
        "close bracket"  : 221,
        /* @property */
        "single quote"  : 222,
        /* @property */
        "space"         : 32
    };
    
    
})();


/*
 * mouse.js
 */

tm.input = tm.input || {};


(function() {
    
    /**
     * @class tm.input.Mouse
     * マウスクラス
     */
    tm.input.Mouse = tm.createClass({
        /** element */
        element: null,
        
        /** @property  position */
        /** @property  deltaPosition */
        /** @property  prevPosition */
        /** @private @property  _x */
        /** @private @property  _y */

        /**
         * @constructor
         */
        init: function(element) {
            this.element = element || window.document;
            
            this.position       = tm.geom.Vector2(0, 0);
            this.deltaPosition  = tm.geom.Vector2(0, 0);
            this.prevPosition   = tm.geom.Vector2(0, 0);
            this._x = 0;
            this._y = 0;
            this.touches = [];
            
            var self = this;
            this.element.addEventListener("mousedown", function(e){
                self._mousemove(e);
                self.prevPosition.set(self._x, self._y);    // prevPostion をリセット
                self.button |= 1<<e.button;
            });
            this.element.addEventListener("mouseup", function(e){
                self.button &= ~(1<<e.button);
            });
            this.element.addEventListener("mousemove", function(e){
                // 座標更新
                self._mousemove(e);
            });
        },
        
        /**
         * run
         * 自動でマウス情報を更新したい際に使用する
         */
        run: function(fps) {
            var self = this;
            fps = fps || 30;
            
            tm.setLoop(function() {
                self.update();
            }, 1000/fps);
            
            return this;
        },
        
        /**
         * 情報更新処理
         * マイフレーム呼んで下さい.
         */
        update: function() {
            this.last = this.press;
            
            this.press = this.button;
            
            this.down = (this.press ^ this.last) & this.press;
            this.up   = (this.press ^ this.last) & this.last;
            
            // 変化値を更新
            this.deltaPosition.x = this._x - this.position.x;
            this.deltaPosition.y = this._y - this.position.y;
            
            // 前回の座標を更新
            this.prevPosition.setObject(this.position);
            
            // 現在の位置を更新
            this.position.set(this._x, this._y);
        },
        
        /**
         * ボタン取得
         */
        getButton: function(button) {
            if (typeof(button) == "string") {
                button = BUTTON_MAP[button];
            }
            
            return (this.press & button) != 0;
        },
        
        /**
         * ボタンダウン取得
         */
        getButtonDown: function(button) {
            if (typeof(button) == "string") {
                button = BUTTON_MAP[button];
            }
            
            return (this.down & button) != 0;
        },
        
        /**
         * ボタンアップ取得
         */
        getButtonUp: function(button) {
            if (typeof(button) == "string") {
                button = BUTTON_MAP[button];
            }
            
            return (this.up & button) != 0;
        },

        /**
         * @private
         */
        _mousemove: function(e) {
            var rect = e.target.getBoundingClientRect();
            this._x = e.clientX - rect.left;
            this._y = e.clientY - rect.top;
        },

        /**
         * @private
         */
        _mousemoveNormal: function(e) {
            var rect = e.target.getBoundingClientRect();
            this._x = e.clientX - rect.left;
            this._y = e.clientY - rect.top;
        },

        /**
         * @private
         */
        _mousemoveScale: function(e) {
            var rect = e.target.getBoundingClientRect();
            this._x = e.clientX - rect.left;
            this._y = e.clientY - rect.top;
            
            //if (e.target instanceof HTMLCanvasElement) {
                // スケールを考慮した拡縮
                if (e.target.style.width) {
                    this._x *= e.target.width / parseInt(e.target.style.width);
                }
                if (e.target.style.height) {
                    this._y *= e.target.height / parseInt(e.target.style.height);
                }
            //}
        },
        
    });
    
    /** @static @property */
    tm.input.Mouse.BUTTON_LEFT      = 0x1;
    /** @static @property */
    tm.input.Mouse.BUTTON_MIDDLE    = 0x2;
    /** @static @property */
    tm.input.Mouse.BUTTON_RIGHT     = 0x4;
    
    /*
     * 
     */
    var BUTTON_MAP = {
        "left"  : tm.input.Mouse.BUTTON_LEFT,
        "middle": tm.input.Mouse.BUTTON_MIDDLE,
        "right" : tm.input.Mouse.BUTTON_RIGHT
    };
    
    
    /**
     * @property    x
     * x座標値
     */
    tm.input.Mouse.prototype.accessor("x", {
        "get": function()   { return this.position.x; },
        "set": function(v)  { this.position.x = v; }
    });
    
    /**
     * @property    y
     * y座標値
     */
    tm.input.Mouse.prototype.accessor("y", {
        "get": function()   { return this.position.y; },
        "set": function(v)  { this.position.y = v; }
    });
    
    /**
     * @property    dx
     * dx値
     */
    tm.input.Mouse.prototype.accessor("dx", {
        "get": function()   { return this.deltaPosition.x; },
        "set": function(v)  { this.deltaPosition.x = v; }
    });
    
    /**
     * @property    dy
     * dy値
     */
    tm.input.Mouse.prototype.accessor("dy", {
        "get": function()   { return this.deltaPosition.y; },
        "set": function(v)  { this.deltaPosition.y = v; }
    });
    
    
    /**
     * @static
     * @method getPointing
     * ポインティング状態取得(touch との差異対策)
     */
    tm.input.Mouse.prototype.getPointing        = function() { return this.getButton("left"); };
    /**
     * @static
     * @method getPointingStart
     * ポインティングを開始したかを取得(touch との差異対策)
     */
    tm.input.Mouse.prototype.getPointingStart   = function() { return this.getButtonDown("left"); };
    /**
     * @static
     * @method getPointingEnd
     * ポインティングを終了したかを取得(touch との差異対策)
     */
    tm.input.Mouse.prototype.getPointingEnd     = function() { return this.getButtonUp("left"); };
    
    
})();


/*
 * touch.js
 */

tm.input = tm.input || {};


(function() {
    
    /**
     * @class tm.input.Touch
     * タッチクラス
     */
    tm.input.Touch = tm.createClass({
        /** element */
        element: null,
        /** touched */
        touched: false,

        /** @property position */
        /** @property deltaPosition */
        /** @property prevPosition */
        /** @private @property _x */
        /** @private @property _y */
        
        /**
         * @constructor
         * <a href="http://tmlib-js.googlecode.com/svn/trunk/test/input/touch-test.html">Test Program</a>.
         */
        init: function(element) {
            this.element = element || window.document;
            
            this.position       = tm.geom.Vector2(0, 0);
            this.deltaPosition  = tm.geom.Vector2(0, 0);
            this.prevPosition   = tm.geom.Vector2(0, 0);
            this._x = 0;
            this._y = 0;
            this.touches = [];

            var self = this;
            this.element.addEventListener("touchstart", function(e){
                self.touched = true;
                
                self._touchmove(e);
                // 最初だけセット
                self.position.set(self._x, self._y);
                self.prevPosition.set(self._x, self._y);    // prevPostion をリセット

                self._setTouches(e);
            });
            this.element.addEventListener("touchend", function(e){
                self.touched = false;

                self._setTouches(e);
            });
            this.element.addEventListener("touchmove", function(e){
                self._touchmove(e);
                // 画面移動を止める
                e.stop();

                self._setTouches(e);
            });
            
            // var self = this;
            // this.element.addEventListener("touchstart", function(e) {
            //     if (self._touch) return ;
            //     self._touch = e.changedTouches[0];

            //     // changedTouches;
            //     // targetTouches;
            //     self._touchmove(e);
            //     self.prevPosition.setObject(self.position);

            //     self.touched = true;
            // });
            // this.element.addEventListener("touchend", function(e){
            //     if (self._touch == e.changedTouches[0]) {
            //         self.touched = false;
            //     }
            // });
            // this.element.addEventListener("touchmove", function(e){
            //     self._touchmove(e);
            //     // 画面移動を止める
            //     e.stop();
            // });
        },
        
        /**
         * run.
         * 自動でマウス情報を更新したい際に使用する
         */
        run: function(fps) {
            var self = this;
            fps = fps || 30;
            
            tm.setLoop(function() {
                
                self.update();
                
            }, 1000/fps);
            
            return this;
        },
        
        /**
         * 情報更新処理
         * マイフレーム呼んで下さい.
         */
        update: function() {
            this.last   = this.now;
            this.now    = Number(this.touched);
            
            this.start  = (this.now ^ this.last) & this.now;
            this.end    = (this.now ^ this.last) & this.last;
            
            // 変化値を更新
            this.deltaPosition.x = this._x - this.position.x;
            this.deltaPosition.y = this._y - this.position.y;
            
            // 前回の座標を更新
            this.prevPosition.setObject(this.position);
            
            // 現在の位置を更新
            this.position.set(this._x, this._y);
        },
        
        /**
         * タッチしているかを判定
         */
        getTouch: function() {
            return this.touched != 0;
        },
        
        /**
         * タッチ開始時に true
         */
        getTouchStart: function() {
            return this.start != 0;
        },
        
        /**
         * タッチ終了時に true
         */
        getTouchEnd: function() {
            return this.end != 0;
        },

        /**
         * @private
         */
        _touchmove: function(e) {
            var t = e.touches[0];
            var r = e.target.getBoundingClientRect();
            this._x = t.clientX - r.left;
            this._y = t.clientY - r.top;
        },

        /**
         * @private
         */
        _touchmoveScale: function(e) {
            var t = e.touches[0];
            var r = e.target.getBoundingClientRect();
            this._x = t.clientX - r.left;
            this._y = t.clientY - r.top;
            
            if (e.target.style.width) {
                this._x *= e.target.width / parseInt(e.target.style.width);
            }
            if (e.target.style.height) {
                this._y *= e.target.height / parseInt(e.target.style.height);
            }
        },

        _getAdjustPoint: function(p) {
            var elm = this.element;
            var style = elm.style;
            var r = elm.getBoundingClientRect();
            var p = {
                x: p.clientX - r.left,
                y: p.clientY - r.top,
            };
            
            if (style.width) {
                p.x *= elm.width / parseInt(style.width);
            }
            if (style.height) {
                p.y *= elm.height / parseInt(style.height);
            }

            return p;
         },

        _setTouches: function(e) {
            var touches = e.touches;

            this.touches.clear();
            for (var i=0,len=touches.length; i<len; ++i) {
                var p = this._getAdjustPoint(touches[i]);
                this.touches.push(p);
            }

            return this;
        }
        
    });
    
    

    /**
     * @property    x
     * x座標値
     */
    tm.input.Touch.prototype.accessor("x", {
        "get": function()   { return this.position.x; },
        "set": function(v)  { this.position.x = v; }
    });
    
    /**
     * @property    y
     * y座標値
     */
    tm.input.Touch.prototype.accessor("y", {
        "get": function()   { return this.position.y; },
        "set": function(v)  { this.position.y = v; }
    });
    
    /**
     * @property    dx
     * dx値
     */
    tm.input.Touch.prototype.accessor("dx", {
        "get": function()   { return this.deltaPosition.x; },
        "set": function(v)  { this.deltaPosition.x = v; }
    });
    
    /**
     * @property    dy
     * dy値
     */
    tm.input.Touch.prototype.accessor("dy", {
        "get": function()   { return this.deltaPosition.y; },
        "set": function(v)  { this.deltaPosition.y = v; }
    });
    
    
    
    /**
     * @method
     * ポインティング状態取得(mouse との差異対策)
     */
    tm.input.Touch.prototype.getPointing        = tm.input.Touch.prototype.getTouch;
    /**
     * @method
     * ポインティングを開始したかを取得(mouse との差異対策)
     */
    tm.input.Touch.prototype.getPointingStart   = tm.input.Touch.prototype.getTouchStart;
    /**
     * @method
     * ポインティングを終了したかを取得(mouse との差異対策)
     */
    tm.input.Touch.prototype.getPointingEnd     = tm.input.Touch.prototype.getTouchEnd;
    
})();



(function() {
    return ;

    /**
     * @class tm.input.Touches
     * マルチタッチ対応クラス
     * @extends global.Array
     */
    tm.define("tm.input.Touches", {
        superClass: Array,

        /**
         * @constructor
         */
        init: function(elm, length) {
            this.element = elm;
            for (var i=0; i<length; ++i) {
                var touch = tm.input.Touch(this.element);
                this.push(touch);
            }

            var self = this;
            this.element.addEventListener("touchstart", function(e) {
                var target = null;
                for (var i=0; i<length; ++i) {
                    if (!self[i]._touch) {
                        target = self[i];
                        break;
                    }
                }
                if (!target) return ;

                target._touch = e.changedTouches[0];

                target._touchmove(e);
                target.prevPosition.setObject(target.position);

                target.touched = true;
                // changedTouches;
                // targetTouches;
            });
            this.element.addEventListener("touchend", function(e){
                for (var i=0; i<length; ++i) {
                    if (self[i]._touch == e.changedTouches[0]) {
                        self[i]._touch = null;
                        self[i].touched = false;
                    }
                }
            });
            this.element.addEventListener("touchmove", function(e){
                for (var i=0; i<length; ++i) {
                    if (self[i]._touch) {
                        self[i]._touchmove(e);
                    }
                }
                // 画面移動を止める
                e.stop();
            });
        },

        /**
         * 更新
         */
        update: function() {
            this.each(function(touch) {
                touch.update();
            });
        }
    });

})();






/*
 * accelerometer.js
 */

tm.input = tm.input || {};


(function() {
    
    /**
     * @class tm.input.Accelerometer
     * スマートフォンのセンサー情報
     */
    tm.input.Accelerometer = tm.createClass({

        /** @property  gravity 重力センサー */
        /** @property  acceleration 加速度センサー */
        /** @property  rotation 回転加速度センサー */
        /** @property  orientation スマートフォンの傾き */
        
        /**
         * @constructor
         * ### Example
         * <a href="http://tmlib-js.googlecode.com/svn/trunk/test/input/touch-test.html">Test Program</a>.
         * 
         * ### Reference
         * - <http://tmlife.net/programming/javascript/javascript-iphone-acceleration.html>
         * - <http://hidekatsu.com/html5/archives/113>
         * - <http://d.hatena.ne.jp/nakamura001/20110209/1297229062>
         * - <http://d.hatena.ne.jp/nakamura001/20101128/1290946966>
         */
        init: function(element) {
            
            this.gravity        = tm.geom.Vector3(0, 0, 0);
            this.acceleration   = tm.geom.Vector3(0, 0, 0);
            this.rotation       = tm.geom.Vector3(0, 0, 0);
            this.orientation    = tm.geom.Vector3(0, 0, 0);
            
            var self = this;
            window.addEventListener("devicemotion", function(e) {
                var acceleration = self.acceleration;
                var gravity = self.gravity;
                var rotation = self.rotation;
                
                if (e.acceleration) {
                    acceleration.x = e.acceleration.x;
                    acceleration.y = e.acceleration.y;
                    acceleration.z = e.acceleration.z;
                }
                if (e.accelerationIncludingGravity) {
                    gravity.x = e.accelerationIncludingGravity.x;
                    gravity.y = e.accelerationIncludingGravity.y;
                    gravity.z = e.accelerationIncludingGravity.z;
                }
                if (e.rotationRate) {
                    rotation.x = rotation.beta  = e.rotationRate.beta;
                    rotation.y = rotation.gamma = e.rotationRate.gamma;
                    rotation.z = rotation.alpha = e.rotationRate.alpha;
                }
            });
            
            window.addEventListener("deviceorientation", function(e) {
                var orientation = self.orientation;
                orientation.alpha   = e.alpha;  // z(0~360)
                orientation.beta    = e.beta;   // x(-180~180)
                orientation.gamma   = e.gamma;  // y(-90~90)
            });
        },
        
    });
    
})();


/*
 * color.js
 */

tm.graphics = tm.graphics || {};

(function() {
    
    /**
     * @class tm.graphics.Color
     * カラークラス
     */
    tm.graphics.Color = tm.createClass({
        /** R値 */
        r: 255,
        /** G値 */
        g: 255,
        /** B値 */
        b: 255,
        /** A値 */
        a: 1.0,
        
        /**
         * @constructor
         */
        init: function(r, g, b, a) {
            this.set.apply(this, arguments);
        },

        /**
         * セッター.
         */
        set: function(r, g, b, a) {
            this.r = r;
            this.g = g;
            this.b = b;
            this.a = (a !== undefined) ? a : 1.0;
            return this;
        },
        
        /**
         * 数値によるセッター.
         */
        setFromNumber: function(r, g, b, a) {
            this.r = r;
            this.g = g;
            this.b = b;
            this.a = (a !== undefined) ? a : 1.0;
            return this;
        },
        
        /**
         * 配列によるセッター
         */
        setFromArray: function(arr) {
            return this.set.apply(this, arr);
        },
        
        /**
         * オブジェクトによるセッター
         */
        setFromObject: function(obj) {
            return this.set(obj.r, obj.g, obj.b, obj.a);
        },
        
        /**
         * 文字列によるセッター
         */
        setFromString: function(str) {
            var color = tm.graphics.Color.stringToNumber(str);
            return this.set(color[0], color[1], color[2], color[3]);
        },
        
        /**
         * 賢いセッター
         */
        setSmart: function() {
            var arg = arguments[0];
            if (arguments.length >= 3) {
                this.set(arguments.r, arguments.g, arguments.b, arguments.a);
            }
            else if (arg instanceof Array) {
                this.setFromArray(arg);
            }
            else if (arg instanceof Object) {
                this.setFromObject(arg);
            }
            else if (typeof(arg) == "string") {
                this.setFromString(arg);
            }
            return this;
        },

        /**
         * CSS 用 16進数文字列に変換
         */
        toStyleAsHex: function() {
            return "#{0}{1}{2}".format(
                this.r.toString(16).padding(2, '0'),
                this.g.toString(16).padding(2, '0'),
                this.b.toString(16).padding(2, '0')
            );
        },
        
        /**
         * CSS 用 RGB文字列に変換
         */
        toStyleAsRGB: function() {
            return "rgb({r},{g},{b})".format({
                r: ~~this.r,
                g: ~~this.g,
                b: ~~this.b
            });
        },
        
        
        /**
         * CSS 用 RGBA文字列に変換
         */
        toStyleAsRGBA: function() {
            return "rgba({r},{g},{b},{a})".format({
                r: ~~this.r,
                g: ~~this.g,
                b: ~~this.b,
                a: this.a
            });
        },

        /**
         * CSS 用 RGBA 文字列に変換
         */
        toStyle: function() {
            return "rgba({r},{g},{b},{a})".format({
                r: ~~this.r,
                g: ~~this.g,
                b: ~~this.b,
                a: this.a
            });
        },
        
    });
    
    var MATCH_SET_LIST = {
        "hex111": {
            reg: /^#(\w{1})(\w{1})(\w{1})$/,
            exec: function(m) {
                return [
                    parseInt(m[1]+m[1], 16),
                    parseInt(m[2]+m[2], 16),
                    parseInt(m[3]+m[3], 16)
                ];
            }
        },
        "hex222": {
            reg: /^#(\w{2})(\w{2})(\w{2})$/,
            exec: function(m) {
                return [
                    parseInt(m[1], 16),
                    parseInt(m[2], 16),
                    parseInt(m[3], 16)
                ];
            }
        },
        "rgb": {
            reg: /^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,
            exec: function(m) {
                return [
                    parseInt(m[1]),
                    parseInt(m[2]),
                    parseInt(m[3])
                ];
            }
        },
        "rgba": {
            reg: /^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d{1}(\.{1}\d+)?)\)$/,
            exec: function(m) {
                return [
                    parseInt(m[1]),
                    parseInt(m[2]),
                    parseInt(m[3]),
                    parseFloat(m[4])
                ];
            }
        },
        "hsl": {
            reg: /^hsl\((\d{1,3}),\s*(\d{1,3})%,\s*(\d{1,3})%\)$/,
            exec: function(m) {
                return tm.graphics.Color.HSLtoRGB(m[1], m[2], m[3]);
            }
        },
        "hsla": {
            reg: /^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d{1}(\.{1}\d+)?)\)$/,
            exec: function(m) {
                return Color.HSLAtoRGBA(m[1], m[2], m[3], m[4]);
            }
        },
    };

    /**
     * @static
     * カラーリスト
     */
    tm.graphics.Color.COLOR_LIST = {
        /** @property black */
        "black"     : [0x00, 0x00, 0x00],
        /** @property silver */
        "silver"    : [0xc0, 0xc0, 0xc0],
        /** @property gray */
        "gray"      : [0x80, 0x80, 0x80],
        /** @property white */
        "white"     : [0xff, 0xff, 0xff],
        /** @property maroon */
        "maroon"    : [0x80, 0x00, 0x00],
        /** @property red */
        "red"       : [0xff, 0x00, 0x00],
        /** @property purple */
        "purple"    : [0x80, 0x00, 0x80],
        /** @property fuchsia */
        "fuchsia"   : [0xff, 0x00, 0xff],
        /** @property green */
        "green"     : [0x00, 0x80, 0x00],
        /** @property lime */
        "lime"      : [0x00, 0xff, 0x00],
        /** @property olive */
        "olive"     : [0x80, 0x80, 0x00],
        /** @property yellow */
        "yellow"    : [0xff, 0xff, 0x00],
        /** @property navy */
        "navy"      : [0x00, 0x00, 0x80],
        /** @property blue */
        "blue"      : [0x00, 0x00, 0xff],
        /** @property teal */
        "teal"      : [0x00, 0x80, 0x80],
        /** @property aqua */
        "aqua"      : [0x00, 0xff, 0xff],
    };

    /**
     * @static
     * @member tm.graphics.Color
     * @method strToNum
     */
    tm.graphics.Color.strToNum = tm.graphics.Color.stringToNumber = function(str){
        var vlaue = null;
        var type = null;
        
        if (str[0] === '#') {
            type = (str.length == 4) ?  "hex111" : "hex222";
        }
        else if (str[0] === 'r' && str[1] === 'g' && str[2] === 'b') {
            type = (str[3] == 'a') ? "rgba" : "rgb";
        }
        else if (str[0] === 'h' && str[1] === 's' && str[2] === 'l') {
            type = (str[3] == 'a') ? "hsla" : "hsl";
        }
        
        if (type) {
            var match_set = MATCH_SET_LIST[type];
            var m = str.match( match_set.reg );
            value = match_set.exec(m);
        }
        else if (Color.COLOR_LIST[str]){
            value = Color.COLOR_LIST[str];
        }
        
        return value;
    };

    /**
     * @static
     * @method
     * hsl を rgb に変換
     */
    tm.graphics.Color.HSLtoRGB = function(h, s, l) {
        var r, g, b;
        
        h%=360;
        h+=360;
        h%=360;
        s *= 0.01;
        l *= 0.01;
        
        if (s == 0) {
            var l = Math.round(l * 255);
            return [l, l, l];
        }
        var m2 = (l < 0.5) ? l * (1+s) : l + s - l*s;
        var m1 = l*2 - m2;
        
        // red
        var temp = (h + 120)%360;
        if      (temp < 60) { r = m1 + (m2-m1) * temp/60; }
        else if (temp < 180){ r = m2; }
        else                { r = m1; }
        
        // green
        temp = h;
        if      (temp < 60) { g = m1 + (m2-m1) * temp/60; }
        else if (temp < 180){ g = m2; }
        else if (temp < 240){ g = m1 + (m2-m1) * (240-temp)/60; }
        else                { g = m1; }
        
        // blue
        temp = ((h-120)+360)%360;
        if      (temp < 60) { b = m1 + (m2-m1) * temp/60; }
        else if (temp < 180){ b = m2; }
        else if (temp < 240){ b = m1 + (m2-m1) * (240-temp)/60; }
        else                { b = m1; }
        
        return [
            parseInt(r*255),
            parseInt(g*255),
            parseInt(b*255)
            ];
    };

    /**
     * @static
     * @method
     * hsla を rgba に変換
     */
    tm.graphics.Color.HSLAtoRGBA = function(h, s, l, a) {
        var temp = Color.HSLtoRGB(h, s, l); temp[3] = a;
        return rgb;
    };

    /**
     * @static
     * @method
     * rgb 値を作成
     */
    tm.graphics.Color.createStyleRGB = function(r, g, b) {
        return "rgba(" + r + "," + g + "," + b + ")";
    };
    
    /**
     * @static
     * @method
     * rgba 値を作成
     */
    tm.graphics.Color.createStyleRGBA = function(r, g, b, a) {
        return "rgba(" + r + "," + g + "," + b + "," + a + ")";
    };

    /**
     * @static
     * @method
     * hsl 値を作成
     */
    tm.graphics.Color.createStyleHSL = function(h, s, l) {
        return "hsl(" + h + "," + s + "%," + l + "%)";
    };
    
    /**
     * @static
     * @method
     * hsla 値を作成
     */
    tm.graphics.Color.createStyleHSLA = function(h, s, l, a) {
        return "hsla(" + h + "," + s + "%," + l + "%," + a + ")";
    };
})();

/*
 * canvas.js
 */

tm.graphics = tm.graphics || {};

(function() {
    
    /**
     * @class tm.graphics.Canvas
     * キャンバス
     */
    tm.graphics.Canvas = tm.createClass({
        
        /** 要素 */
        element: null,
        
        /** キャンバス */
        canvas: null,
        
        /** コンテキスト */
        context: null,
        
        /**
         * @constructor
         */
        init: function(canvas) {
            this.canvas = null;
            if (typeof canvas == "string") {
                this.canvas = document.querySelector(canvas);
            }
            else {
                this.canvas = canvas || document.createElement("canvas");
            }
            this.element            = this.canvas;
            this.context            = this.canvas.getContext("2d");
            this.context.lineCap    = "round";
            this.context.lineJoin   = "round";
        },
        
        /**
         * リサイズする
         */
        resize: function(width, height) {
            this.canvas.width   = width;
            this.canvas.height  = height;
            return this;
        },
        
        /**
         * リサイズウィンドウ
         */
        resizeWindow: function() {
            this.canvas.style.position  = "fixed";
            this.canvas.style.margin    = "0px";
            this.canvas.style.padding   = "0px";
            this.canvas.style.left      = "0px";
            this.canvas.style.top       = "0px";
            return this.resize(window.innerWidth, window.innerHeight);
        },
        
        /**
         * フィット
         */
        resizeToFitScreen: function() {
            this.canvas.style.position  = "fixed";
            this.canvas.style.margin    = "0px";
            this.canvas.style.padding   = "0px";
            this.canvas.style.left      = "0px";
            this.canvas.style.top       = "0px";
            return this.resize(window.innerWidth, window.innerHeight);
        },
        
        /**
         * 拡縮で画面にフィットさせる
         * 名前は仮. 検討する
         */
        fitWindow: function(everFlag) {
            var _fitFunc = function() {
                everFlag = everFlag === undefined ? true : everFlag;
                var e = this.element;
                var s = e.style;
                
                s.position = "absolute";
                s.margin = "auto";
                s.left = "0px";
                s.top  = "0px";
                s.bottom = "0px";
                s.right = "0px";

                var rateWidth = e.width/window.innerWidth;
                var rateHeight= e.height/window.innerHeight;
                var rate = e.height/e.width;
                
                if (rateWidth > rateHeight) {
                    s.width  = (innerWidth).floor()+"px";
                    s.height = (innerWidth*rate).floor()+"px";
                }
                else {
                    s.width  = (innerHeight/rate).floor()+"px";
                    s.height = (innerHeight).floor()+"px";
                }
            }.bind(this);
            
            // 一度実行しておく
            _fitFunc();
            // リサイズ時のリスナとして登録しておく
            if (everFlag) {
                window.addEventListener("resize", _fitFunc, false);
            }
        },
        
        /**
         * クリア
         */
        clear: function(x, y, width, height) {
            x = x || 0;
            y = y || 0;
            width = width || this.width;
            height= height|| this.height;
            this.context.clearRect(x, y, width, height);
            return this;
        },
        
        
        /**
         * 色指定クリア
         * @param {String}  fillStyle
         * @param {Number}  [x=0]
         * @param {Number}  [y=0]
         * @param {Number}  [width=this.width]
         * @param {Number}  [height=this.height]
         */
        clearColor: function(fillStyle, x, y, width, height) {
            x = x || 0;
            y = y || 0;
            width = width || this.width;
            height= height|| this.height;
            
            this.save();
            this.resetTransform();          // 行列初期化
            this.fillStyle = fillStyle;     // 塗りつぶしスタイルセット
            this.context.fillRect(x, y, width, height);
            this.restore();
            
            return this;
        },
                
        /**
         * パスを開始(リセット)
         */
        beginPath: function() {
            this.context.beginPath();
            return this;
        },
                
        /**
         *  パスを閉じる
         */
        closePath: function() {
            this.context.closePath();
            return this;
        },
        

        /**
         *  新規パス生成
         */
        moveTo: function(x, y) {
            this.context.moveTo(x, y);
            return this;
        },
        
        /**
         * パスに追加
         */
        lineTo: function(x, y) {
            this.context.lineTo(x, y);
            return this;
        },
        
        /**
         * パス内を塗りつぶす
         */
        fill: function() {
            this.context.fill();
            return this;
        },
        
        /**
         * パス上にラインを引く
         */
        stroke: function() {
            this.context.stroke();
            return this;
        },
        
        /**
         * クリップ
         */
        clip: function() {
            this.context.clip();
            return this;
        },
        
        /**
         * 点描画
         */
        drawPoint: function(x, y) {
            return this.strokeRect(x, y, 1, 1);
            // return this.beginPath().moveTo(x-0.5, y-0.5).lineTo(x+0.5, y+0.5).stroke();
        },

        /**
         * ラインパスを作成
         */
        line: function(x0, y0, x1, y1) {
            return this.moveTo(x0, y0).lineTo(x1, y1);
        },
        
        /**
         * ラインを描画
         */
        drawLine: function(x0, y0, x1, y1) {
            return this.beginPath().line(x0, y0, x1, y1).stroke();
        },
        
        /**
         * ダッシュラインを描画
         */
        drawDashLine: function(x0, y0, x1, y1, pattern) {
            var patternTable = null;
            if (typeof(pattern) == "string") {
                patternTable = pattern;
            }
            else {
                pattern = pattern || 0xf0f0;
                patternTable = pattern.toString(2);
            }
            patternTable = patternTable.padding(16, '1');
            
            var vx = x1-x0;
            var vy = y1-y0;
            var len = Math.sqrt(vx*vx + vy*vy);
            vx/=len; vy/=len;
            
            var x = x0;
            var y = y0;
            for (var i=0; i<len; ++i) {
                if (patternTable[i%16] == '1') {
                    this.drawPoint(x, y);
                    // this.fillRect(x, y, this.context.lineWidth, this.context.lineWidth);
                }
                x += vx;
                y += vy;
            }
            
            return this;
        },
        
        /**
         * v0(x0, y0), v1(x1, y1) から角度を求めて矢印を描画
         * http://hakuhin.jp/as/rotation.html
         */
        drawArrow: function(x0, y0, x1, y1, arrowRadius) {
            var vx = x1-x0;
            var vy = y1-y0;
            var angle = Math.atan2(vy, vx)*180/Math.PI;
            
            this.drawLine(x0, y0, x1, y1);
            this.fillPolygon(x1, y1, arrowRadius || 5, 3, angle);
            
            return this;
        },
        
        
        /**
         * lines
         */
        lines: function() {
            this.moveTo(arguments[0], arguments[1]);
            for (var i=1,len=arguments.length/2; i<len; ++i) {
                this.lineTo(arguments[i*2], arguments[i*2+1]);
            }
            return this;
        },

        /**
         * ラインストローク描画
         */
        strokeLines: function() {
            this.beginPath();
            this.lines.apply(this, arguments);
            this.stroke();
            return this;
        },

        /**
         * ライン塗りつぶし描画
         */
        fillLines: function() {
            this.beginPath();
            this.lines.apply(this, arguments);
            this.fill();
            return this;
        },
        
        /**
         * 四角形パスを作成する
         */
        rect: function(x, y, width, height) {
            this.context.rect.apply(this.context, arguments);
            return this;
        },
        
        /**
         * 四角形塗りつぶし描画
         */
        fillRect: function() {
            this.context.fillRect.apply(this.context, arguments);
            return this;
        },
        
        /**
         * 四角形ライン描画
         */
        strokeRect: function() {
            this.context.strokeRect.apply(this.context, arguments);
            return this;
        },
        
        /**
         * 角丸四角形パス
         */
        roundRect: function(x, y, width, height, radius) {
            var l = x + radius;
            var r = x + width - radius;
            var t = y + radius;
            var b = y + height - radius;
            
            /*
            var ctx = this.context;
            ctx.moveTo(l, y);
            ctx.lineTo(r, y);
            ctx.quadraticCurveTo(x+width, y, x+width, t);
            ctx.lineTo(x+width, b);
            ctx.quadraticCurveTo(x+width, y+height, r, y+height);
            ctx.lineTo(l, y+height);
            ctx.quadraticCurveTo(x, y+height, x, b);
            ctx.lineTo(x, t);
            ctx.quadraticCurveTo(x, y, l, y);
            /**/
            
            this.context.arc(l, t, radius,     -Math.PI, -Math.PI*0.5, false);  // 左上
            this.context.arc(r, t, radius, -Math.PI*0.5,            0, false);  // 右上
            this.context.arc(r, b, radius,            0,  Math.PI*0.5, false);  // 右下
            this.context.arc(l, b, radius,  Math.PI*0.5,      Math.PI, false);  // 左下
            this.closePath();
            
            return this;
        },
        /**
         * 角丸四角形塗りつぶし
         */
        fillRoundRect: function(x, y, width, height, radius) {
            return this.beginPath().roundRect(x, y, width, height, radius).fill();
        },
        /**
         * 角丸四角形ストローク描画
         */
        strokeRoundRect: function(x, y, width, height, radius) {
            return this.beginPath().roundRect(x, y, width, height, radius).stroke();
        },
        
        /**
         * ポリゴンパス
         */
        polygon: function(x, y, size, sides, offsetAngle) {
            var radDiv = (Math.PI*2)/sides;
            var radOffset = (offsetAngle!=undefined) ? offsetAngle*Math.PI/180 : -Math.PI/2;
            
            this.moveTo(x + Math.cos(radOffset)*size, y + Math.sin(radOffset)*size);
            for (var i=1; i<sides; ++i) {
                var rad = radDiv*i+radOffset;
                this.lineTo(
                    x + Math.cos(rad)*size,
                    y + Math.sin(rad)*size
                );
            }
            this.closePath();
            return this;
        },
        /**
         * ポリゴン塗りつぶし
         */
        fillPolygon: function(x, y, radius, sides, offsetAngle) {
            return this.beginPath().polygon(x, y, radius, sides, offsetAngle).fill();
        },
        /**
         * ポリゴンストローク描画
         */
        strokePolygon: function(x, y, radius, sides, offsetAngle) {
            return this.beginPath().polygon(x, y, radius, sides, offsetAngle).stroke();
        },
        
        /**
         * star
         */
        star: function(x, y, radius, sides, sideIndent, offsetAngle) {
            var sideIndentRadius = radius * (sideIndent || 0.38);
            var radOffset = (offsetAngle) ? offsetAngle*Math.PI/180 : -Math.PI/2;
            var radDiv = (Math.PI*2)/sides/2;
            
            this.moveTo(
                x + Math.cos(radOffset)*radius,
                y + Math.sin(radOffset)*radius
            );
            for (var i=1; i<sides*2; ++i) {
                var rad = radDiv*i + radOffset;
                var len = (i%2) ? sideIndentRadius : radius;
                this.lineTo(
                    x + Math.cos(rad)*len,
                    y + Math.sin(rad)*len
                );
            }
            this.closePath();
            return this;
        },

        /**
         * 星を塗りつぶし描画
         */
        fillStar: function(x, y, radius, sides, sideIndent, offsetAngle) {
            return this.beginPath().star(x, y, radius, sides, sideIndent, offsetAngle).fill();
        },

        /**
         * 星をストローク描画
         */
        strokeStar: function(x, y, radius, sides, sideIndent, offsetAngle) {
            return this.beginPath().star(x, y, radius, sides, sideIndent, offsetAngle).stroke();
        },

        /*
         * heart
         */
        heart: function(x, y, radius, angle) {
            var half_radius = radius*0.5;
            var rad = (angle === undefined) ? Math.PI/4 : Math.degToRad(angle);

            // 半径 half_radius の角度 angle 上の点との接線を求める
            var p = Math.cos(rad)*half_radius;
            var q = Math.sin(rad)*half_radius;

            // 円の接線の方程式 px + qy = r^2 より y = (r^2-px)/q
            var x2 = -half_radius;
            var y2 = (half_radius*half_radius-p*x2)/q;

            // 中心位置調整
            var height = y2 + half_radius;
            var offsetY = half_radius-height/2;

            // パスをセット
            this.moveTo(0+x, y2+y+offsetY);

            this.arc(-half_radius+x, 0+y+offsetY, half_radius, Math.PI-rad, Math.PI*2);
            this.arc(half_radius+x, 0+y+offsetY, half_radius, Math.PI, rad);
            this.closePath();

            return this;
        },

        /*
         * fill heart
         */
        fillHeart: function(x, y, radius, angle) {
            return this.beginPath().heart(x, y, radius, angle).fill();
        },

        /*
         * stroke heart
         */
        strokeHeart: function(x, y, radius, angle) {
            return this.beginPath().heart(x, y, radius, angle).stroke();
        },
        
        /**
         * 円のパスを設定
         */
        circle: function(x, y, radius) {
            this.context.arc(x, y, radius, 0, Math.PI*2, false);
            return this;
        },
        
        /**
         * 塗りつぶし円を描画
         */
        fillCircle: function(x, y, radius) {
            var c = this.context;
            c.beginPath();
            c.arc(x, y, radius, 0, Math.PI*2, false);
            c.closePath();
            c.fill();
            return this;
            // return this.beginPath().circle(x, y, radius).fill();
        },
        
        /**
         * ストローク円を描画
         */
        strokeCircle: function(x, y, radius) {
            return this.beginPath().circle(x, y, radius).stroke();
        },
        
        
        /**
         * 円弧のパスを設定
         */
        arc: function(x, y, radius, startAngle, endAngle, anticlockwise) {
            this.context.arc(x, y, radius, startAngle, endAngle, anticlockwise);
            return this;
        },
        
        /**
         * 塗りつぶし円弧を描画
         */
        fillArc: function(x, y, radius, startAngle, endAngle, anticlockwise) {
            return this.beginPath().arc(x, y, radius, startAngle, endAngle, anticlockwise).fill();
        },
        
        /**
         * ストローク円弧を描画
         */
        strokeArc: function(x, y, radius, startAngle, endAngle, anticlockwise) {
            return this.beginPath().arc(x, y, radius, startAngle, endAngle, anticlockwise).stroke();
        },
        
        /**
         * 三角形パスを設定
         */
        triangle: function(x0, y0, x1, y1, x2, y2) {
            this.moveTo(x0, y0).lineTo(x1, y1).lineTo(x2, y2);
            this.closePath();
            return this;
        },
        
        /**
         * 塗りつぶし三角形を描画
         */
        fillTriangle: function(x0, y0, x1, y1, x2, y2) {
            return this.beginPath().triangle(x0, y0, x1, y1, x2, y2).fill();
        },
        
        /**
         * ストローク三角形を描画
         */
        strokeTriangle: function(x0, y0, x1, y1, x2, y2) {
            return this.beginPath().triangle(x0, y0, x1, y1, x2, y2).stroke();
        },
        

        /**
         * 塗りつぶしテキストを描画
         */
        fillText: function(text, x, y) {
            return this.context.fillText.apply(this.context, arguments);
        },
        
        /**
         * ストロークテキスト
         */
        strokeText: function(text, x, y) {
            return this.context.strokeText.apply(this.context, arguments);
        },
        
        fillVerticalText: function(text, x, y) {
            this._drawVerticalText("fillText", text, x, y);
        },
        strokeVerticalText: function(text, x, y) {
            this._drawVerticalText("strokeText", text, x, y);
        },
        
        _drawVerticalText: function(func, text, x, y) {
            var ctx = this.context;
            var lines = text.split('\n');
            var charSize = this.context.measureText('あ').width;
            
            ctx.save();
            
            ctx.textAlign = "right";
            ctx.textBaseline = "top";

            Array.prototype.forEach.call(text, function(ch, j) {
                ctx[func](ch, x, y+charSize*j);
            });
            
            ctx.restore();
        },
        
        /**
         * drawLabelBox, drawLabelArea, drawTextBox, 
         */
        _drawLabelArea: function(func, param) {
            var ctx = this.context;
            var text = param.text;
            var charSize = this.context.measureText('あ').width;
            var lines = text.split('\n');
            var lineSpace = (param.lineSpace || 1)*charSize;
            
            ctx.save();
            
            // 横書き
            if (!param.mode || param.mode == "horizon") {
                var maxCharNum = Math.max( (param.width/charSize)|0, 1 );
                var normalLines = [];
                
                ctx.textAlign = "left";
                ctx.textBaseline = "top";
                
                
                lines.each(function(line) {
                    for (var i=0,len=line.length; i<len; i+=maxCharNum) {
                        var str = line.substr(i, maxCharNum);
                        normalLines.push(str);
                    }
                });
                
                var funcName = func + "Text";
                normalLines.each(function(line, i) {
                    ctx[funcName](line, param.x, param.y + i*lineSpace + 4);
                });
            }
            // 縦書き
            else {
                var maxCharNum = Math.max( (param.height/charSize)|0, 1 );
                var startX = param.x + param.width;
                var normalLines = [];
                
                lines.each(function(line) {
                    for (var i=0,len=line.length; i<len; i+=maxCharNum) {
                        var str = line.substr(i, maxCharNum);
                        normalLines.push(str);
                    }
                });
                
                var funcName = func + "VerticalText";
                normalLines.each(function(line, i) {
                    // boldになるとフォントサイズが変わるため、マージンとして15pxずらす
                    this[funcName](line, startX-i*lineSpace, param.y+15);
                }.bind(this));
            }
            
            ctx.restore();
        },
        
        fillLabelArea: function(param) {
            this._drawLabelArea("fill", param);
        },
        
        strokeLabelArea: function(param) {
            this._drawLabelArea("stroke", param);
        },
        
        /**
         * 画像描画
         */
        drawImage: function(image, x, y) {
            this.context.drawImage.apply(this.context, arguments);
            return ;
            
            x = x || 0;
            y = y || 0;
            this.context.drawImage(image, x, y);
            return this;
            // ctx.drawImage(this.image.canvas,
                // 0, 0, this.width, this.height,
                // -this.width/2, -this.height/2, this.width, this.height);
        },
        
        /**
         * テクスチャ描画
         */
        drawTexture: function(texture, x, y) {
            arguments[0] = texture.element;
            this.context.drawImage.apply(this.context, arguments);
            
            return this;
        },
        
        /**
         * ビットマップ描画
         */
        drawBitmap: function(bitmap, x, y) {
            arguments[0] = bitmap.imageData;
            this.context.putImageData.apply(this.context, arguments);
            
            return this;
        },
        
        /**
         * dummy
         */
        drawScale9Image: function(image, rect0, rect1) {
            
            var leftWidth   = rect1.x;
            var middleWidth = rect1.width;
            var rightWidth  = image.width - (leftWidth+middleWidth);
            var finalWidth  = rect0.width - (leftWidth+rightWidth);
            var topHeight   = rect1.y;
            
            // left top
            this.drawImage(image,
                0, 0, leftWidth, topHeight,
                rect0.x, rect0.y, leftWidth, topHeight);
            // middle top
            this.drawImage(image,
                leftWidth, 0, middleWidth, topHeight,
                rect0.x + leftWidth, rect0.y, finalWidth, topHeight)
            // right top
            this.drawImage(image,
                leftWidth+middleWidth, 0, rightWidth, topHeight,
                rect0.x + leftWidth + finalWidth, rect0.y, rightWidth, topHeight);
            
            return this;
        },
        
        /**
         * 行列をセット
         */
        setTransform: function(m11, m12, m21, m22, dx, dy) {
            this.context.setTransform(m11, m12, m21, m22, dx, dy);
            return this;
        },
        
        
        /**
         * 行列をリセット
         */
        resetTransform: function() {
            this.setTransform(1.0, 0.0, 0.0, 1.0, 0.0, 0.0);
            return this;
        },
        
        
        /**
         * 中心に移動
         */
        setTransformCenter: function() {
            this.context.setTransform(1, 0, 0, 1, this.width/2, this.height/2);
            return this;
        },
        
        /**
         * 行列を掛ける
         */
        transform: function(m11, m12, m21, m22, dx, dy) {
            this.context.transform(m11, m12, m21, m22, dx, dy);
            return this;
        },
        
        /**
         * 保存
         */
        save: function() {
            this.context.save();
            return this;
        },
        
        /**
         * 復元
         */
        restore: function() {
            this.context.restore();
            return this;
        },
        
        /**
         * 移動
         */
        translate: function(x, y) {
            this.context.translate(x, y);
            return this;
        },
        
        /**
         * 回転
         */
        rotate: function(rotation) {
            this.context.rotate(rotation);
            return this;
        },
        
        /**
         * スケール
         */
        scale: function(scaleX, scaleY) {
            this.context.scale(scaleX, scaleY);
            return this;
        },
        
        /**
         * 画像として保存
         */
        saveAsImage: function(mime_type) {
            mime_type = mime_type || tm.graphics.Canvas.MIME_TYPE_PNG;
            var data_url = this.canvas.toDataURL(mime_type);
            // data_url = data_url.replace(mime_type, "image/octet-stream");
            window.open(data_url, "save");
            
            // toDataURL を使えば下記のようなツールが作れるかも!!
            // TODO: プログラムで絵をかいて保存できるツール
        },

        /**
         * アルファとブレンドモードを同時セット
         * TODO: 未実装
         */
        setCompositing: function(alpha, compositeOperation) {
            // TODO
        },

        /**
         * 塗りつぶしスタイルをセット
         */
        setFillStyle: function(style) {
            this.context.fillStyle = style;
            return this;
        },

        /**
         * ストロークスタイルをセット
         */
        setStrokeStyle: function(style) {
            this.context.strokeStyle = style;
            return this;
        },
        
        /**
         * <a href="http://www.w3.org/TR/2010/WD-2dcontext-20100624/#colors-and-styles">http://www.w3.org/TR/2010/WD-2dcontext-20100624/#colors-and-styles</a>
         */
        setColorStyle: function(stroke, fill) {
            fill = fill || stroke;
            
            this.context.strokeStyle    = stroke;
            this.context.fillStyle      = fill;
            return this;
        },
        
        /**
         * テキストをセット
         */
        setText: function(font, align, baseline) {
            var c = this.context;
            c.font          = font;
            c.textAlign     = align;
            c.textBaseline  = baseline;
        },
        
        /**
         * ラインスタイルを一括セット
         * <a href="http://www.w3.org/TR/2010/WD-2dcontext-20100624/#line-styles">http://www.w3.org/TR/2010/WD-2dcontext-20100624/#line-styles</a>
         */
        setLineStyle: function(width, cap, join, miter) {
            with(this.context) {
                lineWidth   = width || 1;
                lineCap     = cap   || "round";
                lineJoin    = join  || "round";
                miterLimit  = miter || 10.0;
            }
            return this;
        },
        
        /**
         * 影をセット
         * - <http://www.html5.jp/canvas/ref/property/shadowColor.html>
         * - <http://www.w3.org/TR/2010/WD-2dcontext-20100624/#shadows>
         */
        setShadow: function(color, offsetX, offsetY, blur) {
            var ctx = this.context;
            
            ctx.shadowColor     = color     || "black";
            ctx.shadowOffsetX   = offsetX   || 0;
            ctx.shadowOffsetY   = offsetY   || 0;
            ctx.shadowBlur      = blur      || 0;
            
            return this;
        },
        
        /**
         * エレメント取得
         */
        getElement: function() {
            return this.element;
        },
    });
    
    /** @static @property */
    tm.graphics.Canvas.MIME_TYPE_PNG = "image/png";
    /** @static @property */
    tm.graphics.Canvas.MIME_TYPE_JPG = "image/jpeg";
    /** @static @property */
    tm.graphics.Canvas.MIME_TYPE_SVG = "image/svg+xml";
    
    /**
     * @property    width
     * 幅
     */
    tm.graphics.Canvas.prototype.accessor("width", {
        "get": function()   { return this.canvas.width; },
        "set": function(v)  { this.canvas.width = v; }
    });
    
    /**
     * @property    height
     * 高さ
     */
    tm.graphics.Canvas.prototype.accessor("height", {
        "get": function()   { return this.canvas.height; },
        "set": function(v)  { this.canvas.height = v;   }
    });
    
    /**
     * @property    fillStyle
     * 塗りつぶしスタイル
     */
    tm.graphics.Canvas.prototype.accessor("fillStyle", {
        "get": function()   { return this.context.fillStyle; },
        "set": function(v)  { this.context.fillStyle = v;   }
    });
    
    
    /**
     * @property    strokeStyle
     * ストロークスタイル
     */
    tm.graphics.Canvas.prototype.accessor("strokeStyle", {
        "get": function()   { return this.context.strokeStyle; },
        "set": function(v)  { this.context.strokeStyle = v;   }
    });
    
    
    /**
     * @property    globalAlpha
     * アルファ指定
     */
    tm.graphics.Canvas.prototype.accessor("globalAlpha", {
        "get": function()   { return this.context.globalAlpha; },
        "set": function(v)  { this.context.globalAlpha = v;   }
    });
    
    
    /**
     * @property    globalCompositeOperation
     * ブレンド指定
     */
    tm.graphics.Canvas.prototype.accessor("globalCompositeOperation", {
        "get": function()   { return this.context.globalCompositeOperation; },
        "set": function(v)  { this.context.globalCompositeOperation = v;   }
    });

    /**
     * @property    shadowBlur
     * シャドウブラー
     */
    tm.graphics.Canvas.prototype.accessor("shadowBlur", {
        "get": function()   { return this.context.shadowBlur; },
        "set": function(v)  { this.context.shadowBlur = v;   }
    });
    

    /**
     * @property    shadowColor
     * シャドウブラーカラー
     */
    tm.graphics.Canvas.prototype.accessor("shadowColor", {
        "get": function()   { return this.context.shadowColor; },
        "set": function(v)  { this.context.shadowColor = v;   }
    });
    

    /**
     * @property    shadowOffsetX
     * シャドウオフセット X 
     */
    tm.graphics.Canvas.prototype.accessor("shadowOffsetX", {
        "get": function()   { return this.context.shadowOffsetX; },
        "set": function(v)  { this.context.shadowOffsetX = v;   }
    });
    

    /**
     * @property    shadowOffsetY
     * シャドウオフセット Y
     */
    tm.graphics.Canvas.prototype.accessor("shadowOffsetY", {
        "get": function()   { return this.context.shadowOffsetY; },
        "set": function(v)  { this.context.shadowOffsetY = v;   }
    });
    
    /**
     * @property    lineCap
     * ライン終端の描画方法
     */
    tm.graphics.Canvas.prototype.accessor("lineCap", {
        "get": function()   { return this.context.lineCap; },
        "set": function(v)  { this.context.lineCap = v;   }
    });
    
    /**
     * @property    lineJoin
     * ラインつなぎ目の描画方法
     */
    tm.graphics.Canvas.prototype.accessor("lineJoin", {
        "get": function()   { return this.context.lineJoin; },
        "set": function(v)  { this.context.lineJoin = v;   }
    });
    
    /**
     * @property    miterLimit
     * マイターリミット
     */
    tm.graphics.Canvas.prototype.accessor("miterLimit", {
        "get": function()   { return this.context.miterLimit; },
        "set": function(v)  { this.context.miterLimit = v;   }
    });
    
    /**
     * @property    lineWidth
     * ライン幅設定
     */
    tm.graphics.Canvas.prototype.accessor("lineWidth", {
        "get": function()   { return this.context.lineWidth; },
        "set": function(v)  { this.context.lineWidth = v;   }
    });
    
    /**
     * @property    font
     * フォント
     */
    tm.graphics.Canvas.prototype.accessor("font", {
        "get": function()   { return this.context.font; },
        "set": function(v)  { this.context.font = v;   }
    });
    
    /**
     * @property    textAlign
     * テキストのアラインメント
     */
    tm.graphics.Canvas.prototype.accessor("textAlign", {
        "get": function()   { return this.context.textAlign; },
        "set": function(v)  { this.context.textAlign = v;   }
    });
    
    /**
     * @property    textBaseline
     * テキストのベースライン
     */
    tm.graphics.Canvas.prototype.accessor("textBaseline", {
        "get": function()   { return this.context.textBaseline; },
        "set": function(v)  { this.context.textBaseline = v;   }
    });
    
    /**
     * @property    centerX
     * センターX
     */
    tm.graphics.Canvas.prototype.getter("centerX", function() {
        return this.canvas.width/2;
    });
    
    /**
     * @property    centerY
     * センターY
     */
    tm.graphics.Canvas.prototype.getter("centerY", function(){
        return this.canvas.height/2;
    });

    /**
     * @property    imageSmoothingEnabled
     * 画像スムージング設定
     */
    tm.graphics.Canvas.prototype.accessor("imageSmoothingEnabled", {
        "get": function() {
            return this.context.imageSmoothingEnabled;
        },
        "set": function(v) {
            this.context.imageSmoothingEnabled = v;
            this.context.webkitImageSmoothingEnabled = v;
            this.context.mozImageSmoothingEnabled = v;
        }
    });
    
})();




/*
 * bitmap.js
 */

tm.graphics = tm.graphics || {};

(function() {
    
    /**
     * @class tm.graphics.Bitmap
     * ビットマップクラス
     */
    tm.graphics.Bitmap = tm.createClass({
        
        /** イメージデータ */
        imageData: null,
        
        /**
         * @constructor
         */
        init: function(imageData) {
            if (!dummyCanvas) {
                dummyCanvas = document.createElement("canvas");
                dummyContext= dummyCanvas.getContext("2d");
            }
            this._init.apply(this, arguments);
            this.init = this._init;
        },

        /**
         * @private
         */
        _init: function(imageData) {
            if (arguments.length == 1) {
                this.imageData = imageData;
                this.data = imageData.data;
            }
            else if (arguments.length == 2) {
                var w = arguments[0];
                var h = arguments[1];
                this.imageData = dummyContext.createImageData(w, h);
                this.data = this.imageData.data;
            }
        },
        
        /**
         * index 指定でピクセル値を取得
         * 最も高速
         */
        getPixelIndex: function(index) {
            var i = index*4;
            return [
                this.data[i+0],
                this.data[i+1],
                this.data[i+2],
                this.data[i+3]
            ];
        },
        
        /**
         * x, y 指定でピクセル値を取得
         */
        getPixelXY: function(x, y) {
            return this.getPixelIndex( this.posToIndex(x, y) );
        },
        
        /**
         * ピクセル値を取得
         * ### Memo
         * - index 指定か x, y 指定にするか検討中
         * - 配列で返すか数値で返すか検討中. 速度の早いやつを採用する
         */
        getPixel: function(x, y) {
            return this.getPixelIndex( this.posToIndex(x, y) );
        },

        /**
         * ピクセルを数値としてゲット
         */
        getPixelAsNumber: function(index) {
            var i = index*4;
            return (this.data[i+3] << 24) | (this.data[i+0] << 16) | (this.data[i+1] << 8) | this.data[i+2];
        },

        /**
         * ピクセルをオブジェクトとしてゲット
         */
        getPixelAsObject: function(index) {
            var i = index*4;
            return {
                r: this.data[i+0],
                g: this.data[i+1],
                b: this.data[i+2],
                a: this.data[i+3]
            };
        },

        /**
         * ピクセルを配列としてゲット
         */
        getPixelAsArray: function(index) {
            var i = index*4;
            return [
                this.data[i+0],
                this.data[i+1],
                this.data[i+2],
                this.data[i+3]
            ];
        },
        
        /**
         * 指定した範囲内のピクセル平均値を取得
         */
        getPixelAverage: function(x, y, width, height) {
            var rgba = [0, 0, 0, 0];
            
            // 範囲
            var l = x;
            var r = x+width;
            var t = y;
            var b = y+height;
            
            // ハミ出し調整
            if (l < 0) { l = 0; }
            if (r > this.width) { r = this.width; }
            if (t < 0) { t = 0; }
            if (b > this.height) { b = this.height; }
            
            // 範囲内のピクセル全てを取得
            var temp = [];
            var bitmapWidth = this.width;
            for (var i=t; i<b; ++i) {
                for (var j=l; j<r; ++j) {
                    var index = bitmapWidth*i + j;
                    temp.push( this.getPixelIndex(index) );
                    // temp.push( this.getPixelXY(j, i) );
                }
            }
            
            // 平均を求める
            var len = len=temp.length;
            for (var i=0; i<len; ++i) {
                rgba[0] += temp[i][0];
                rgba[1] += temp[i][1];
                rgba[2] += temp[i][2];
                rgba[3] += temp[i][3];
            }
            
            rgba[0]/=len;
            rgba[1]/=len;
            rgba[2]/=len;
            rgba[3]/=len;
            
            return rgba;
        },
        
        
        /**
         * index 指定でピクセル値をセット
         * 最も高速
         */
        setPixelIndex: function(index, r, g, b) {
            var i = index*4;
            this.data[i+0] = r;
            this.data[i+1] = g;
            this.data[i+2] = b;
            return this;
        },
        
        /**
         * x, y指定でピクセル値をセット
         */
        setPixelXY: function(x, y, r, g, b) {
            return this.setPixelIndex(y*this.imageData.width+x, r, g, b);
        },
        
        /**
         * ピクセル値をセット
         */
        setPixel: function(index, r, g, b) {
            return this.setPixelIndex(y*this.imageData.width+x, r, g, b);
        },

        /**
         * 32bit セット
         */
        setPixel32Index: function(index, r, g, b, a) {
            var i = index*4;
            this.data[i+0] = r;
            this.data[i+1] = g;
            this.data[i+2] = b;
            this.data[i+3] = a;
            return this;
        },

        /**
         * 32bit セット
         */
        setPixel32: function(x, y, r, g, b, a) {
            return this.setPixel32Index(y*this.width+x, r, g, b, a);
        },

        /**
         * 32bit セット
         */
        setPixel32XY: function(x, y, r, g, b, a) {
            return this.setPixel32Index(y*this.width+x, r, g, b, a);
        },

        /**
         * 配列からピクセルをセット
         */
        setPixelFromArray: function(index, pixel) {
            return this.setPixel(index, pixel[0], pixel[1], pixel[2]);
        },

        /**
         * 配列からピクセルをセット
         */
        setPixel32FromArray: function(index, pixel) {
            return this.setPixel32(index, pixel[0], pixel[1], pixel[2], pixel[3]);
        },

        /**
         * argb
         */
        setPixelFromNumber: function(index, pixel) {
            return this.setPixel(index, (pixel & 0x00ff0000)>>>16, (pixel & 0x0000ff00)>>>8, (pixel & 0x000000ff)>>>0);
        },

        /**
         * argb
         */
        setPixel32FromNumber: function(index, pixel) {
            return this.setPixel32(index, (pixel & 0x00ff0000)>>>16, (pixel & 0x0000ff00)>>>8, (pixel & 0x000000ff)>>>0, (pixel & 0xff000000)>>>24);
        },
        
        /**
         * object
         */
        setPixelFromObject: function(index, pixel) {
            return this.setPixel(pixel.r, pixel.g, pixel.b);
        },
        /**
         * オブジェクトからピクセルをセット
         */
        setPixel32FromObject: function(index, pixel) {
            return this.setPixel32(pixel.r, pixel.g, pixel.b, pixel.a);
        },
        
        /**
         * string
         * rgb, hsl, #... #...... などに対応予定
         */
        setPixelFromString: function(index, pixel) {
            // TODO
        },
        
        /**
         * 位置をインデックスに変換
         */
        posToIndex: function(x, y) {
            return y*this.imageData.width + x;
        },
        
        /**
         * フィルター
         */
        filter: function(filter) {
            for (var i=0; i<this.height; ++i) {
                for (var j=0; j<this.width; ++j) {
                    var index = this.posToIndex(j, i);
                    var p = this.getPixel(j, i);
                    
                    filter.calc(p, index, j, i, this);
                }
            }
            
            return this;
        },
        
        /**
         * ノイズ
         */
        noise: function(low, high) {
            low = low  || 0;
            high= high || 255;
            range= high-low;
            
            for (var i=0,len=this.length; i<len; ++i) {
                var p = this.getPixelIndex(i);
                p[0] = Math.random()*range + low;
                p[1] = Math.random()*range + low;
                p[2] = Math.random()*range + low;
                p[3] = 255;
                this.setPixel32Index(i, p[0], p[1], p[2], p[3]);
            }
        },

        /**
         * フィルタを適応する
         * TODO: 未実装
         */
        applyFilter: function(filter) {
            
        },
        
    });
    
    /** @property width  幅 */
    tm.graphics.Bitmap.prototype.accessor("width", {
        "get": function()   { return this.imageData.width; },
        "set": function(v)  { this.imageData.width = v;    }
    });
    /** @property height  高さ */
    tm.graphics.Bitmap.prototype.accessor("height", {
        "get": function()   { return this.imageData.height; },
        "set": function(v)  { this.imageData.height = v;    }
    });
    /** @property length */
    tm.graphics.Bitmap.prototype.getter("length", function() {
        return this.imageData.width*this.imageData.height;
    });
    
    
    /**
     * @member tm.graphics.Canvas
     * ビットマップ取得
     */
    tm.graphics.Canvas.prototype.getBitmap = function(x, y, width, height) {
        return tm.graphics.Bitmap(this.context.getImageData(x||0, y||0, width||this.width, height||this.height));
    };
    
    /**
     * @member tm.graphics.Canvas
     * ビットマップ生成
     */
    tm.graphics.Canvas.prototype.createBitmap = function(width, height) {
        return tm.graphics.Bitmap(this.context.createImageData(width||this.width, height||this.height));
    };

    /**
     * @member tm.asset.Texture
     * ビットマップ生成
     */
    tm.asset.Texture.prototype.getBitmap = function(x, y, width, height) {
        var canvas = tm.graphics.Canvas();
        canvas.resize(this.width, this.height);
        canvas.drawTexture(this, 0, 0, this.width, this.height);
        return canvas.getBitmap(x, y, width, height);
    };

    var dummyCanvas = null;
    var dummyContext = null;
})();


/*
 * filter.js
 */

tm.graphics = tm.graphics || {};

(function() {
    
    /**
     * @class tm.graphics.MonochromeFilter
     * モノクロフィルタ
     */
    tm.graphics.MonochromeFilter = tm.createClass({
        
        /**
         * @constructor
         */
        init: function() {},
        
        /**
         * apply
         */
        apply: function(src, dst) {
            var len = src.length;
            for (var i=0; i<len; ++i) {
                var p = src.getPixelIndex(i);
                var grayscale = p[0]*0.3 + p[1]*0.59 + p[2]*0.11;
                dst.setPixel32Index(i, grayscale, grayscale, grayscale, p[3]);
            }
            
            return dst;
        },
    });
    
    
})();




(function() {
    
    /**
     * @class tm.graphics.ReverseFilter
     * リバースフィルタ
     */
    tm.graphics.ReverseFilter = tm.createClass({
        
        /**
         * @constructor
         */
        init: function() {},
        
        /**
         * apply
         */
        apply: function(src, dst) {
            for (var i=0,len=src.width*src.height; i<len; ++i) {
                var p = src.getPixelIndex(i);
                p[0] = 255-p[0];
                p[1] = 255-p[1];
                p[2] = 255-p[2];
                dst.setPixel32Index(i, p[0], p[1], p[2], 255);
            }
            
            return dst;
        },
    });
    
    
})();


(function() {
    
    /**
     * @class tm.graphics.BlurFilter
     * ブラーフィルタ
     * 
     * ### Reference
     * - <http://www40.atwiki.jp/spellbound/pages/153.html>
     * - <http://www.flother.com/blog/2010/image-blur-html5-canvas/>
     */
    tm.graphics.BlurFilter = tm.createClass({

        /** @property blurX */
        /** @property blurY */
        /** @property quality */
        
        /**
         * @constructor
         */
        init: function(blurX, blurY, quality) {
            this.blurX      = blurX || 4;
            this.blurY      = blurY || 4;
            this.quality    = quality || 1;
        },
        
        /**
         * apply
         */
        apply: function(src, dst) {
            var halfX       = Math.floor(this.blurX/2);
            var halfY       = Math.floor(this.blurY/2);
            var rangeX      = this.blurX;
            var rangeY      = this.blurY;
            var srcWidth    = src.width;
            var srcHeight   = src.height;
            var len         = src.length;
            
            // ブラー処理
            var _apply = function(src, dst) {
                for (var i=0; i<len; ++i) {
                    var x = i%srcWidth;
                    var y = Math.floor(i/srcWidth);
                    var p = src.getPixelAverage(x-halfX, y-halfY, rangeX, rangeY);
                    dst.setPixel32Index(i, p[0], p[1], p[2], 255);
                }
            };
            
            // quality の回数だけブラーをかける
            var tempDst     = src;
            for (var i=0; i<this.quality; ++i) {
                src = tempDst;
                tempDst = tm.graphics.Bitmap(srcWidth, srcHeight);
                _apply(src, tempDst);
            }
            
            // 結果に代入
            //? メモリリークとか大丈夫なのかな
            dst.imageData = tempDst.imageData;
            
            return dst;
        },
    });
    
    
})();


(function() {
    
    // トゥーンテーブル
    var defaultToonTable = [];
    for(var i=0; i<255; ++i) {
        var n=0;
        
        if      (i<100) { n =  60; }
        else if (i<150) { n = 150; }
        else if (i<180) { n = 180; }
        else            { n = 220; }
        
        defaultToonTable[i] = n;
    }
    
    /**
     * @class tm.graphics.ToonFilter
     * トゥーンフィルタ
     */
    tm.graphics.ToonFilter = tm.createClass({
        
        /** トゥーンテーブル */
        toonTable: null,
        
        /**
         * @constructor
         */
        init: function(toonTable) {
            this.toonTable = toonTable || defaultToonTable;
        },
        
        /**
         * apply
         */
        apply: function(src, dst) {
            for (var i=0,len=src.width*src.height; i<len; ++i) {
                var pixel = src.getPixelIndex(i);
                var r = this.toonTable[ pixel[0] ];
                var g = this.toonTable[ pixel[1] ];
                var b = this.toonTable[ pixel[2] ];
                dst.setPixel32Index(i, r, g, b, 255);
            }
            
            return dst;
        },
    });
    
    
})();



(function() {
    
    /**
     * @class tm.graphics.ColorMatrixFilter
     * カラーマトリックスフィルタ
     * 
     * ### Reference
     * - <http://blog.boreal-kiss.com/2008/04/08113113.html/>
     * - <http://voglia.jp/2010/01/26/260>
     * - <http://hakuhin.jp/as/color.html#COLOR_02>
     * - <http://d.hatena.ne.jp/umezo/20090122/1232627694>
     * - <http://www40.atwiki.jp/spellbound/pages/188.html>
     */
    tm.graphics.ColorMatrixFilter = tm.createClass({
        
        /** @property colorMatrix */

        /**
         * @constructor
         */
        init: function(colorMatrix) {
            this.colorMatrix = colorMatrix;
        },
        
        /**
         * @property
         * apply
         */
        apply: function(src, dst) {
            var cm = this.colorMatrix;
            for (var i=0,len=src.length; i<len; ++i) {
                var pixel = src.getPixelIndex(i);
                var r = (pixel[0] * cm[0]) + (pixel[1] * cm[1]) + (pixel[2] * cm[2]) + (pixel[3] * cm[3]) + cm[4];
                var g = (pixel[0] * cm[5]) + (pixel[1] * cm[6]) + (pixel[2] * cm[7]) + (pixel[3] * cm[8]) + cm[9];
                var b = (pixel[0] * cm[10]) + (pixel[1] * cm[11]) + (pixel[2] * cm[12]) + (pixel[3] * cm[13]) + cm[14];
                var a = (pixel[0] * cm[15]) + (pixel[1] * cm[16]) + (pixel[2] * cm[17]) + (pixel[3] * cm[18]) + cm[19];
                dst.setPixel32Index(i, r, g, b, a);
            }
            
            return dst;
        }
        
    });
    
})();












/*
 * gradient.js
 */

tm.graphics = tm.graphics || {};

(function() {
    
    tm.graphics.Canvas.prototype.setGradient = function(gradient) {
        this.context.fillStyle = gradient.gradient;
    };
    
})();

(function() {
    
    /**
     * @class tm.graphics.LinearGradient
     * 線形グラデーション
     */
    tm.graphics.LinearGradient = tm.createClass({

        /**
         * @constructor
         */
        init: function(x, y, width, height) {
            if (!dummyCanvas) {
                dummyCanvas = document.createElement("canvas");
                dummyContext= dummyCanvas.getContext("2d");
            }
            this._init(x, y, width, height);
            this.init = this._init;
        },

        /**
         * @private
         */
        _init: function(x, y, width, height) {
            this.gradient = dummyContext.createLinearGradient(x, y, width, height);
        },

        /**
         * カラー点を追加
         */
        addColorStop: function(offset, color) {
            this.gradient.addColorStop(offset, color);
            return this;
        },

        /**
         * カラー点をリストで追加
         */
        addColorStopList: function(prop) {
            for (var i=0,len=prop.length; i<len; ++i) {
                var offset  = prop[i].offset;
                var color   = prop[i].color;
                this.addColorStop(offset, color);
            }
            return this;
        },

        /**
         * スタイル化
         */
        toStyle: function() {
            return this.gradient;
        },
        
    });

    
    /**
     * @class tm.graphics.RadialGradient
     * 円形グラデーション
     */
    tm.graphics.RadialGradient = tm.createClass({

        /**
         * @constructor
         */        
        init: function(x0, y0, r0, x1, y1, r1) {
            if (!dummyCanvas) {
                dummyCanvas = document.createElement("canvas");
                dummyContext= dummyCanvas.getContext("2d");
            }
            this._init(x0, y0, r0, x1, y1, r1);
            this.init = this._init;
        },

        /**
         * @private
         */
        _init: function(x0, y0, r0, x1, y1, r1) {
            this.gradient = dummyContext.createRadialGradient(x0, y0, r0, x1, y1, r1);
        },
        
        /**
         * カラー点を追加
         */
        addColorStop: function(offset, color) {
            this.gradient.addColorStop(offset, color);
            return this;
        },

        /**
         * カラー点をリストで追加
         */
        addColorStopList: function(prop) {
            for (var i=0,len=prop.length; i<len; ++i) {
                var offset  = prop[i].offset;
                var color   = prop[i].color;
                this.addColorStop(offset, color);
            }
            return this;
        },

        /**
         * スタイル化
         */
        toStyle: function() {
            return this.gradient;
        },
        
    });

    var dummyCanvas = null;
    var dummyContext = null;
    
})();
















/*
 * tween.js
 */

tm.anim = tm.anim || {};

(function() {
    
    
    /**
     * @class tm.anim.Tween
     * Tween クラス
     * @extends tm.event.EventDispatcher
     */
    tm.anim.Tween = tm.createClass({
        
        superClass: tm.event.EventDispatcher,

        /** アニメーションさせる対象  */
        target      : null,
        /** アニメーションの時間  */
        time        : null,
        /** プロパティ 未使用？  */
        prop        : null,
        /** 現在のプロパティ  */
        nowProps    : null,
        /** 未使用  */
        now         : null,
        /** 未使用  */
        begin       : null,
        /** 未使用  */
        finish      : null,
        /** アニメーションにかける時間  */
        duration    : null,
        /** ループするかどうか  */
        isLooping   : null,
        /** アニメーション中かどうか  */
        isPlaying   : null,
        /** アニメーション実行関数  */
        func        : Math.linear,
        /** フレームレート  */
        fps         : 30,
        
        /**
         * @constructor
         * @param {Object} target
         * @param {Object} finishProps
         * @param {Object} duration
         * @param {Function} func
         */
        init: function(target, finishProps, duration, func) {
            this.superInit();
            
            this.time = 0;
            this.nowProps = {};
            this.isPlaying = false;

            if (arguments.length > 0) {
                this.to.apply(this, arguments);
            }
        },

        /**
         * 指定した値までアニメーション
         * @param {Object} target
         * @param {Object} finishProps
         * @param {Object} duration
         * @param {Function} func
         */
        to: function(target, finishProps, duration, func) {
            var beginProps = {};

            for (var key in finishProps) {
                beginProps[key] = target[key];
            }

            this.fromTo(target, beginProps, finishProps, duration, func);

            return this;
        },

        /**
         * 指定した値を足した値までアニメーション
         * @param {Object} target
         * @param {Object} props
         * @param {Object} duration
         * @param {Function} func
         */
        by: function(target, props, duration, func) {
            var beginProps = {};
            var finishProps = {};

            for (var key in props) {
                beginProps[key] = target[key];
                finishProps[key] = target[key] + props[key];
            }

            this.fromTo(target, beginProps, finishProps, duration, func);

            return this;
        },

        /**
         * 開始の値から終了の値までアニメーション
         * @param {Object} target
         * @param {Object} beginProps
         * @param {Object} finishProps
         * @param {Object} duration
         * @param {Function} func
         */
        fromTo: function(target, beginProps, finishProps, duration, func) {
            this.target = target;
            this.beginProps  = beginProps;
            this.finishProps = finishProps;
            this.duration = duration;
            
            // setup
            this.changeProps = {};
            for (var key in beginProps) {
                this.changeProps[key] = finishProps[key] - beginProps[key];
            }
            this.setTransition(func);

            return this;
        },

        /**
         * from
         * @param {Object} target
         * @param {Object} beginProps
         * @param {Object} duration
         * @param {Function} func
         */
        from: function(target, beginProps, duration, func) {
            var finishProps = {};

            for (var key in beginProps) {
                finishProps[key] = target[key];
            }

            this.fromTo(target, beginProps, finishProps, duration, func);

            return this;
        },
        
        /**
         * easingの指定か、コールバックの指定か調べる
         * @param {Function} func
         */
        setTransition: function(func) {
            if (typeof func == 'function') {
                this.func = func;
            }
            else if (typeof func == 'string'){
                this.func = tm.anim.easing[func];
            }
            else {
                this.func = tm.anim.easing["default"];
            }
            return this;
        },
        
        /**
         * アニメーションの再開
         */
        resume: function() {
            this.isPlaying = true;
            this._resumeTime();
            this._updateTime();
            this.dispatchEvent(tm.event.TweenEvent("resume", this.time, this.nowProps));
        },
        
        /**
         * アニメーションの開始
         */
        start: function() {
            this.isPlaying = true;
            this._startTime();
            this._updateTime();
            this.dispatchEvent(tm.event.TweenEvent("start", this.time, this.nowProps));
        },
        
        /**
         * アニメーションのストップ
         */
        stop: function() {
            this.isPlaying = false;
            this.dispatchEvent(tm.event.TweenEvent("stop", this.time, this.nowProps));
        },
        
        /**
         * 開始位置まで戻る
         */
        rewind: function() {
            this.time = 0;
            this.update();
        },
        
        /**
         * 最後位置まで早送り
         */
        fforward: function() {
            this.time = this.duration;
            this.update();
        },

        /**        
         * ヨーヨーのアニメーション
         */
        yoyo: function() {
            var temp = this.finishProps;
            this.finishProps = this.beginProps;
            this.beginProps  = temp;
            for (var key in this.beginProps) {
                this.changeProps[key] = this.finishProps[key] - this.beginProps[key];
            }
            this.start();
        },
        
        /**
         * 更新
         */
        update: function() {
            for (var key in this.changeProps) {
                this.nowProps[key] = this.func(this.time, this.beginProps[key], this.changeProps[key], this.duration);
                this.target[key] = this.nowProps[key];
            }
            this.dispatchEvent(tm.event.TweenEvent("change", this.time, this.nowProps));
        },
        
        /**
         * 時間を巻き戻す
         * @private
         */
        _resumeTime: function() {
            this.startTime = (new Date()).getTime() - this.time;
        },
        
        /**
         * スタート時間を設定
         * @private
         */
        _startTime: function() {
            this.startTime = (new Date()).getTime();
        },
        
        /**
         * 時間を進める
         * @private
         */
        _updateTime: function() {
            if (this.isPlaying) {
                this._setTime((new Date()).getTime() - this.startTime);
                setTimeout(arguments.callee.bind(this), 1000/this.fps);
            }
        },
        
        /**
         * 時間を設定する
         * @param {Object} t
         * @private
         */
        _setTime: function(t) {
            var time = t;
            // モーション終了
            if (time > this.duration) {
                // ループ
                if (this.isLooping) {
                    this.rewind();
                    // 座標を更新
                    this.update();
                    // イベント開始
                    this.dispatchEvent(tm.event.TweenEvent("loop", this.time, this.nowProps));
                }
                // 終了
                else {
                    this.time = this.duration;
                    // 座標を更新
                    this.update();
                    // 停止
                    this.stop();
                    // イベント
                    this.dispatchEvent(tm.event.TweenEvent("finish", this.time, this.nowProps));
                }
            }
            // 更新
            else {
                this.time = time;
                // 座標を更新
                this.update();
            }
        }
    });
})();


/*
 * easing
 */
(function() {
    
    /**
     * @class tm.anim.easing
     * イージング
     * ### Reference
     * - <http://coderepos.org/share/wiki/JSTweener>
     * - <http://coderepos.org/share/browser/lang/javascript/jstweener/trunk/src/JSTweener.js>
     * - <http://gsgd.co.uk/sandbox/jquery/easing/jquery.easing.1.3.js>
     * - <http://hosted.zeh.com.br/tweener/docs/en-us/misc/transitions.html>
     */
    tm.anim.easing = {
        /** default */
        "default": function(t, b, c, d) {
            return c*t/d + b;
        },        
        /** linear */
        linear: function(t, b, c, d) {
            return c*t/d + b;
        },        
        /** swing */
        swing: function(t, b, c, d) {
            return -c *(t/=d)*(t-2) + b;
        },        
        /** easeInQuad */
        easeInQuad: function(t, b, c, d) {
            return c*(t/=d)*t + b;
        },        
        /** easeOutQuad */
        easeOutQuad: function(t, b, c, d) {
            return -c *(t/=d)*(t-2) + b;
        },        
        /** easeInOutQuad */
        easeInOutQuad: function(t, b, c, d) {
            if((t/=d/2) < 1) return c/2*t*t + b;
            return -c/2 *((--t)*(t-2) - 1) + b;
        },
        /** defeInCubic */
        easeInCubic: function(t, b, c, d) {
            return c*(t/=d)*t*t + b;
        },
        /** easeOutCubic */
        easeOutCubic: function(t, b, c, d) {
            return c*((t=t/d-1)*t*t + 1) + b;
        },
        /** easeInOutCubic */
        easeInOutCubic: function(t, b, c, d) {
            if((t/=d/2) < 1) return c/2*t*t*t + b;
            return c/2*((t-=2)*t*t + 2) + b;
        },
        /** easeOutInCubic */
        easeOutInCubic: function(t, b, c, d) {
            if(t < d/2) return tm.anim.easing.easeOutCubic(t*2, b, c/2, d);
            return tm.anim.easing.easeInCubic((t*2)-d, b+c/2, c/2, d);
        },
        /** easeInQuart */
        easeInQuart: function(t, b, c, d) {
            return c*(t/=d)*t*t*t + b;
        },
        /** easeOutQuart */
        easeOutQuart: function(t, b, c, d) {
            return -c *((t=t/d-1)*t*t*t - 1) + b;
        },
        /** easeInOutQuart */
        easeInOutQuart: function(t, b, c, d) {
            if((t/=d/2) < 1) return c/2*t*t*t*t + b;
            return -c/2 *((t-=2)*t*t*t - 2) + b;
        },
        /** easeOutInQuart */
        easeOutInQuart: function(t, b, c, d) {
            if(t < d/2) return tm.anim.easing.easeOutQuart(t*2, b, c/2, d);
            return tm.anim.easing.easeInQuart((t*2)-d, b+c/2, c/2, d);
        },
        /** easeInQuint */
        easeInQuint: function(t, b, c, d) {
            return c*(t/=d)*t*t*t*t + b;
        },
        /** easeOutQuint */
        easeOutQuint: function(t, b, c, d) {
            return c*((t=t/d-1)*t*t*t*t + 1) + b;
        },
        /** easeInOutQuint */
        easeInOutQuint: function(t, b, c, d) {
            if((t/=d/2) < 1) return c/2*t*t*t*t*t + b;
            return c/2*((t-=2)*t*t*t*t + 2) + b;
        },
        /** easeOutInQuint */
        easeOutInQuint: function(t, b, c, d) {
            if(t < d/2) return tm.anim.easing.easeOutQuint(t*2, b, c/2, d);
            return tm.anim.easing.easeInQuint((t*2)-d, b+c/2, c/2, d);
        },
        /** easeInSine */
        easeInSine: function(t, b, c, d) {
            return -c * Math.cos(t/d *(Math.PI/2)) + c + b;
        },
        /** easeOutSine */
        easeOutSine: function(t, b, c, d) {
            return c * Math.sin(t/d *(Math.PI/2)) + b;
        },
        /** easeInOutSine */
        easeInOutSine: function(t, b, c, d) {
            return -c/2 *(Math.cos(Math.PI*t/d) - 1) + b;
        },
        /** easeOutInSine */
        easeOutInSine: function(t, b, c, d) {
            if(t < d/2) return tm.anim.easing.easeOutSine(t*2, b, c/2, d);
            return tm.anim.easing.easeInSine((t*2)-d, b+c/2, c/2, d);
        },
        /** easeInExpo */
        easeInExpo: function(t, b, c, d) {
            return(t==0) ? b : c * Math.pow(2, 10 *(t/d - 1)) + b - c * 0.001;
        },
        /** easeOutExpo */
        easeOutExpo: function(t, b, c, d) {
            return(t==d) ? b+c : c * 1.001 *(-Math.pow(2, -10 * t/d) + 1) + b;
        },
        /** easeInOutExpo */
        easeInOutExpo: function(t, b, c, d) {
            if(t==0) return b;
            if(t==d) return b+c;
            if((t/=d/2) < 1) return c/2 * Math.pow(2, 10 *(t - 1)) + b - c * 0.0005;
            return c/2 * 1.0005 *(-Math.pow(2, -10 * --t) + 2) + b;
        },
        /** easeOutInExpo */
        easeOutInExpo: function(t, b, c, d) {
            if(t < d/2) return tm.anim.easing.easeOutExpo(t*2, b, c/2, d);
            return tm.anim.easing.easeInExpo((t*2)-d, b+c/2, c/2, d);
        },
        /** easeInCirc */
        easeInCirc: function(t, b, c, d) {
            return -c *(Math.sqrt(1 -(t/=d)*t) - 1) + b;
        },
        /** easeOutCirc */
        easeOutCirc: function(t, b, c, d) {
            return c * Math.sqrt(1 -(t=t/d-1)*t) + b;
        },
        /** easeInOutCirc */
        easeInOutCirc: function(t, b, c, d) {
            if((t/=d/2) < 1) return -c/2 *(Math.sqrt(1 - t*t) - 1) + b;
            return c/2 *(Math.sqrt(1 -(t-=2)*t) + 1) + b;
        },
        /** easeOutInCirc */
        easeOutInCirc: function(t, b, c, d) {
            if(t < d/2) return tm.anim.easing.easeOutCirc(t*2, b, c/2, d);
            return tm.anim.easing.easeInCirc((t*2)-d, b+c/2, c/2, d);
        },
        /** easeInElastic */
        easeInElastic: function(t, b, c, d, a, p) {
            var s;
            if(t==0) return b;  if((t/=d)==1) return b+c;  if(!p) p=d*.3;
            if(!a || a < Math.abs(c)) { a=c; s=p/4; } else s = p/(2*Math.PI) * Math.asin(c/a);
            return -(a*Math.pow(2,10*(t-=1)) * Math.sin((t*d-s)*(2*Math.PI)/p )) + b;
        },
        /** easeOutElastic */
        easeOutElastic: function(t, b, c, d, a, p) {
            var s;
            if(t==0) return b;  if((t/=d)==1) return b+c;  if(!p) p=d*.3;
            if(!a || a < Math.abs(c)) { a=c; s=p/4; } else s = p/(2*Math.PI) * Math.asin(c/a);
            return(a*Math.pow(2,-10*t) * Math.sin((t*d-s)*(2*Math.PI)/p ) + c + b);
        },
        /** easeInOutElastic */
        easeInOutElastic: function(t, b, c, d, a, p) {
            var s;
            if(t==0) return b;  if((t/=d/2)==2) return b+c;  if(!p) p=d*(.3*1.5);
            if(!a || a < Math.abs(c)) { a=c; s=p/4; }       else s = p/(2*Math.PI) * Math.asin(c/a);
            if(t < 1) return -.5*(a*Math.pow(2,10*(t-=1)) * Math.sin((t*d-s)*(2*Math.PI)/p )) + b;
            return a*Math.pow(2,-10*(t-=1)) * Math.sin((t*d-s)*(2*Math.PI)/p )*.5 + c + b;
        },
        /** easeOutInElastic */
        easeOutInElastic: function(t, b, c, d, a, p) {
            if(t < d/2) return tm.anim.easing.easeOutElastic(t*2, b, c/2, d, a, p);
            return tm.anim.easing.easeInElastic((t*2)-d, b+c/2, c/2, d, a, p);
        },
        /** easeInBack */
        easeInBack: function(t, b, c, d, s) {
            if(s == undefined) s = 1.70158;
            return c*(t/=d)*t*((s+1)*t - s) + b;
        },
        /** easeOutBack */
        easeOutBack: function(t, b, c, d, s) {
            if(s == undefined) s = 1.70158;
            return c*((t=t/d-1)*t*((s+1)*t + s) + 1) + b;
        },
        /** easeInOutBack */
        easeInOutBack: function(t, b, c, d, s) {
            if(s == undefined) s = 1.70158;
            if((t/=d/2) < 1) return c/2*(t*t*(((s*=(1.525))+1)*t - s)) + b;
            return c/2*((t-=2)*t*(((s*=(1.525))+1)*t + s) + 2) + b;
        },
        /** easeOutInBack */
        easeOutInBack: function(t, b, c, d, s) {
            if(t < d/2) return tm.anim.easing.easeOutBack(t*2, b, c/2, d, s);
            return tm.anim.easing.easeInBack((t*2)-d, b+c/2, c/2, d, s);
        },
        /** easeInBounce */
        easeInBounce: function(t, b, c, d) {
            return c - tm.anim.easing.easeOutBounce(d-t, 0, c, d) + b;
        },
        /** easeOutBounce */
        easeOutBounce: function(t, b, c, d) {
            if((t/=d) <(1/2.75)) {
                return c*(7.5625*t*t) + b;
            } else if(t <(2/2.75)) {
                return c*(7.5625*(t-=(1.5/2.75))*t + .75) + b;
            } else if(t <(2.5/2.75)) {
                return c*(7.5625*(t-=(2.25/2.75))*t + .9375) + b;
            } else {
                return c*(7.5625*(t-=(2.625/2.75))*t + .984375) + b;
            }
        },
        /** easeInOutBounce */
        easeInOutBounce: function(t, b, c, d) {
            if(t < d/2) return tm.anim.easing.easeInBounce(t*2, 0, c, d) * .5 + b;
            else return tm.anim.easing.easeOutBounce(t*2-d, 0, c, d) * .5 + c*.5 + b;
        },
        /** easeOutInBounce */
        easeOutInBounce: function(t, b, c, d) {
            if(t < d/2) return tm.anim.easing.easeOutBounce(t*2, b, c/2, d);
            return tm.anim.easing.easeInBounce((t*2)-d, b+c/2, c/2, d);
        }
    };
    
})();








/*
 * Timer
 */


(function() {

    tm.define("tm.app.Timer", {
        /** フレーム */
        frame: 0,
        fps: 30,
        frameTime: 1000/30,

        init: function() {
            this.frame = 0;
            this.fps = tm.app.Timer["default"].fps;
        },

        reset: function() {
            this.frame = 0;
            return this;
        },

        update: function() {
            this.frame = this.frame + 1;
            return this;
        },

        getFrame: function() {
            return this.frame;
        },

        getSeconds: function() {
            return this._seconds;
        },

        getMilliseconds: function() {
            return this._milliseconds;
        },

        checkIntervalEnd: function(time) {
            var t = (time/this.fps)|0;
            if (this.frame % t == 0) {
                return true;
            }
            return false;
        },

        // start ~ end の間かを判定する
        checkBetween: function(start, end) {
            if (arguments.length == 1) {
                end = Math.max(start, 0);
                start = end-this.frameTime;
            }
            var time = (this.frame/this.fps)*1000;

            return start <= time < end;
            return Math.inside(time, start, end);
        },

        _update: function() {
            var time = (this.frame/this.fps);
            this._seconds = time|0;
            this._milliseconds = (time*1000)|0;
        }
    });

    tm.app.Timer.prototype.accessor("frame", {
        "get": function() {
            return this._frame;
        },
        "set": function(frame){
            this._frame = frame;
            this._update();
        },
    });
    
    /**
     * @property fps
     * fps
     */
    tm.app.Timer.prototype.accessor("fps", {
        "get": function() {
            return this._fps;
        },
        "set": function(fps){
            if (fps !== this._fps) {
                this.frameTime = (1000/fps);
            }
            this._fps = fps;
            this._update();
        },
    });    

    tm.app.Timer["default"] = {
        fps: 30,
    };

})();




/*
 * updater.js
 */

 
(function() {
    
    /**
     * @class tm.app.Updater
     * 更新管理クラス
     */
    tm.define("tm.app.Updater", {
        app: null,

        init: function(app) {
            this.app = app;
        },

        update: function(root) {
            this._updateElement(root);
        },

        _updateElement: function(elm) {
            var app = this.app;
            
            // 更新するかを判定
            if (elm.awake == false) return ;

            // 更新
            if (elm.update) elm.update(app);

            // エンターフレームイベント
            if (elm.hasEventListener("enterframe")) {
                var e = tm.event.Event("enterframe");
                e.app = app;
                elm.fire(e);
            }
            
            // タッチ判定
            if (elm.interactive) {
                elm._checkPointing(app);
            }

            // 子供を更新
            var len = elm.children.length;
            if (len > 0) {
                var tempChildren = elm.children.slice();
                for (var i=0; i<len; ++i) {
                    this._updateElement(tempChildren[i]);
                }
            }
        },
    });

})();



/*
 * baseapp.js
 */

tm.app = tm.app || {};


(function() {
    
    /**
     * @class tm.app.BaseApp
     * ベースアプリケーション
     */
    tm.app.BaseApp = tm.createClass({

        superClass: tm.event.EventDispatcher,
        
        /** エレメント */
        element       : null,
        /** マウスクラス */
        mouse         : null,
        /** タッチクラス */
        touch         : null,
        /** マウスクラス + タッチクラス */
        pointing      : null,
        /** キーボードクラス */
        keyboard      : null,
        /** 加速度センサー */
        accelerometer : null,
        /** 更新クラス */
        updater       : null,
        /** statsライブラリ */
        stats         : null,
        /** タイマー */
        timer         : null,
        /** 現在更新中か */
        awake         : null,
        /** @private  シーン情報の管理 */
        _scenes       : null,
        /** @private  シーンのインデックス */
        _sceneIndex   : 0,

        /**
         * @constructor
         * @param {Object} elm
         */
        init: function(elm) {
            this.superInit();

            this.element = elm;

            // タイマー
            this.timer = tm.app.Timer();

            // マウスを生成
            this.mouse      = tm.input.Mouse(this.element);
            // タッチを生成
            this.touch      = tm.input.Touch(this.element, 0);
            // キーボードを生成
            this.keyboard   = tm.input.Keyboard();
            
            // ポインティングをセット(PC では Mouse, Mobile では Touch)
            this.pointing   = (tm.isMobile) ? this.touch : this.mouse;
            this.element.addEventListener("touchstart", function () {
                this.pointing = this.touch;
            }.bind(this));
            this.element.addEventListener("mousedown", function () {
                this.pointing = this.mouse;
            }.bind(this));
            
            // 加速度センサーを生成
            this.accelerometer = tm.input.Accelerometer();

            this.updater = tm.app.Updater(this);
            
            // 再生フラグ
            this.awake = true;
            
            // シーン周り
            this._scenes = [ tm.app.Scene() ];
            this._sceneIndex = 0;
            
            // 決定時の処理をオフにする(iPhone 時のちらつき対策)
            this.element.addEventListener("touchstart", function(e) { e.stop(); });
            this.element.addEventListener("touchmove", function(e) { e.stop(); });
            
            // ウィンドウフォーカス時イベントリスナを登録
            window.addEventListener("focus", function() {
                this.fire(tm.event.Event("focus"));
                this.currentScene.dispatchEvent(tm.event.Event("focus"));
            }.bind(this));
            // ウィンドウブラー時イベントリスナを登録
            window.addEventListener("blur", function() {
                this.fire(tm.event.Event("blur"));
                this.currentScene.dispatchEvent(tm.event.Event("blur"));
            }.bind(this));
            // クリック
            this.element.addEventListener((tm.isMobile) ? "touchend" : "mouseup", this._onclick.bind(this));
        },
        
        /**
         * 実行
         */
        run: function() {
            var self = this;

            this.startedTime = new Date();
            this.prevTime = new Date();
            this.deltaTime = 0;

            var _run = function() {
                // start
                var start = (new Date()).getTime();

                // run
                self._loop();

                // calculate progress time
                var progress = (new Date()).getTime() - start;
                // calculate next waiting time
                var newDelay = self.timer.frameTime-progress;

                // set next running function
                setTimeout(_run, newDelay);
            };

            _run();

            return this;
        },
        
        /*
         * ループ処理
         * @private
         */
        _loop: function() {
            // update
            if (this.update) this.update();
            this._update();
            
            // draw
            if (this.draw) this.draw();
            this._draw();

            var now = new Date();
            this.deltaTime = now - this.prevTime;
            this.prevTime = now;
            
            // stats update
            if (this.stats) this.stats.update();
        },
        
        /**
         * シーンを切り替える
         * @param {Object} scene
         * ## Reference
         * - <http://ameblo.jp/hash-r-1234/entry-10967942550.html>
         */
        replaceScene: function(scene) {
            var e = null;
            if (this.currentScene) {
                e = tm.event.Event("exit");
                e.app = this;
                this.currentScene.dispatchEvent(e);
                this.currentScene.app = null;
            }
            e = tm.event.Event("enter");
            e.app = this;
            this.currentScene = scene;
            this.currentScene.app = this;
            this.currentScene.dispatchEvent(e);

            return this;
        },
        
        /**
         * シーンをプッシュする(ポーズやオブション画面などで使用)
         * @param {Object} scene
         */
        pushScene: function(scene) {
            this.fire(tm.event.Event("push"));

            var e = tm.event.Event("pause");
            e.app = this;
            this.currentScene.dispatchEvent(e);
            
            this._scenes.push(scene);
            ++this._sceneIndex;
            
            this.fire(tm.event.Event("pushed"));

            var e = tm.event.Event("enter");
            e.app = this;
            scene.app = this;
            scene.dispatchEvent(e);


            return this;
        },
        
        /**
         * シーンをポップする(ポーズやオブション画面などで使用)
         */
        popScene: function() {
            this.fire(tm.event.Event("pop"));
            
            var scene = this._scenes.pop();
            --this._sceneIndex;
            
            var e = tm.event.Event("exit");
            e.app = this;
            scene.dispatchEvent(e);
            scene.app = null;

            this.fire(tm.event.Event("poped"));
            
            // 
            var e = tm.event.Event("resume");
            e.app = this;
            e.prevScene = scene;
            this.currentScene.dispatchEvent(e);
            
            return scene;
        },
        
        /**
         * 外部のFPS表示ライブラリ Stats を生成、配置する
         * ## Reference
         * - <https://github.com/mrdoob/stats.js>
         */
        enableStats: function() {
            if (window["Stats"]) {
                // Stats
                this.stats = new Stats();
                // 右上に設定
                this.stats.domElement.style.position = "fixed";
                this.stats.domElement.style.left     = "5px";
                this.stats.domElement.style.top      = "20px";
                document.body.appendChild(this.stats.domElement);
            }
            else {
                console.warn("not defined stats.");
            }

            return this;
        },
        
        /**
         * dat gui を有効化
         */
        enableDatGUI: function() {
            if (window.dat) {
                var gui = new dat.GUI();
                
                return gui;
            }
        },
        
        /**
         * シーンのupdateを実行するようにする
         */
        start: function() {
            this.awake = true;

            return this;
        },
        
        /**
         * シーンのupdateを実行しないようにする
         */
        stop: function() {
            this.awake = false;

            return this;
        },
        
        /**
         * デバイスやシーンのアップデート呼び出し処理
         * @private
         */
        _update: function() {
            // デバイス系 Update
            this.mouse.update();
            this.keyboard._update();
            this.touch.update();
            // this.touches.update();
            
            if (this.awake) {
                this.updater.update(this.currentScene);
                this.timer.update();
            }
        },
        
        /**
         * 描画用仮想関数
         * @private
         */
        _draw: function() {},
        
        /**
         * elementの取得
         */
        getElement: function() {
            return this.element;
        },

        /**
         * クリックイベント登録
         * @private
         * @param {Object} e
         */
        _onclick: function(e) {
            var _fn = function(elm) {
                if (elm.children.length > 0) {
                    elm.children.each(function(elm) { _fn(elm); });
                }
                if (elm._clickFlag && elm.hasEventListener("click")) {
                    elm.dispatchEvent(tm.event.Event("click"));
                }
                elm._clickFlag = false;
            };
            _fn(this.currentScene);
        },
    });
    
    /**
     * @property currentScene
     * カレントシーン
     */
    tm.app.BaseApp.prototype.accessor("currentScene", {
        "get": function() { return this._scenes[this._sceneIndex]; },
        "set": function(v){ this._scenes[this._sceneIndex] = v; }
    });
    
    /**
     * @property frame
     * フレーム
     */
    tm.app.BaseApp.prototype.accessor("frame", {
        "get": function() {
            return this.timer.frame;
        },
        "set": function(v){
            this.timer.frame = v;
        }
    });
    
    /**
     * @property fps
     * fps
     */
    tm.app.BaseApp.prototype.accessor("fps", {
        "get": function() {
            return this.timer.fps;
        },
        "set": function(v){
            this.timer.fps = v;
        }
    });
    
})();














/*
 * element.js
 */

tm.app = tm.app || {};


(function() {
    
    /**
     * @class tm.app.Element
     * アプリケーション用オブジェクトの基底となるクラス
     * 親子関係の情報を管理する
     * @extends tm.event.EventDispatcher
     */
    tm.app.Element = tm.createClass({
        superClass: tm.event.EventDispatcher,
        
        /** 親 */
        parent: null,
        /** 子 */
        children: null,
        
        /**
         * @constructor
         */
        init: function() {
            this.superInit();
            this.children = [];
        },
        
        /**
         * 親から離す
         */
        remove: function() {
            console.assert(this.parent);
            this.parent.removeChild(this);

            this.parent = null;
            
            return this;
        },
        
        /**
         * 子供を追加
         * @param {Object} child
         */
        addChild: function(child) {
            if (child.parent) child.remove();
            child.parent = this;
            this.children.push(child);

            var e = tm.event.Event("added");
            child.dispatchEvent(e);
            
            return child;
        },
        
        /**
         * parent に自分を子供として追加
         * @param {Object} parent
         */
        addChildTo: function(parent) {
            parent.addChild(this);
            
            // if (this.parent) this.remove();
            // this.parent = parent;
            // parent.children.push(child);
            
            return this;
        },
        
        /**
         * まとめて追加
         * scene 遷移時に子供をごっそり移譲するときなどに使用
         * まだ動作確認していない
         * @param {Object} children
         */
        addChildren: function(children) {
            var tempChildren = children.slice();
            for (var i=beginIndex,len=tempChildren.length; i<len; ++i) {
                this.addChild(tempChildren[i]);
            }
        },
        
        /**
         * index 指定で要素を取得
         */
        addChildAt: function(child, index) {
            if (child.parent) child.remove();
            child.parent = this;
            this.children.splice(index, 0, child);

            var e = tm.event.Event("added");
            child.dispatchEvent(e);

            return child;
        },
        
        /**
         * 指定で要素を取得
         */
        getChildAt: function(child) {
            return this.children.at(child);
        },
        
        /**
         * 指定で要素を取得
         */
        getChildIndex: function(child) {
            return this.children.indexOf(child);
        },
        
        /**
         * child に一致するエレメントを離す
         * @param {Object} child
         */
        removeChild: function(child) {
            var index = this.children.indexOf(child);
            if (index != -1) {
                this.children.splice(index, 1);
                var e = tm.event.Event("removed");
                child.dispatchEvent(e);
            }
        },
        
        /**
         * すべての child を離す
         * @param {Object} beginIndex
         */
        removeChildren: function(beginIndex) {
            beginIndex = beginIndex || 0;
            var tempChildren = this.children.slice();
            for (var i=beginIndex,len=tempChildren.length; i<len; ++i) {
                tempChildren[i].remove();
            }
            this.children = [];
        },
        
        /**
         * 名前の一致する child を取得
         * @param {String} name
         */
        getChildByName: function(name) {
            for (var i=0,len=this.children.length; i<len; ++i)
                if (this.children[i].name == name) return this.children[i];
            
            return null;
        },
        
        /**
         * 関数実行
         * @param {Function} func
         * @param {Object} args
         */
        execChildren: function(func, args) {
            args = (args && args.length) ? args : [args];
            // 関数内で remove される可能性があるので配列をコピーする
            var tempChildren = this.children.slice();
            for (var i=0,len=tempChildren.length; i<len; ++i) {
                func.apply(tempChildren[i], args);
            }
        },
        
        /**
         * 親を取得
         */
        getParent: function() { return this.parent; },
        
        /**
         * ルートを取得
         */
        getRoot: function() {
            if (!this.parent) return null;
            // TODO: 親をたどって NULL だったらそのエレメントを返す
            var elm = null;
            for (elm=this.parent; elm.parent != null; elm = elm.parent) {}
            return elm;
        },
        
        /**
         * jsonをパースしてthisに展開
         */
        fromJSON: function(data) {
            var _fromJSON = function(name, data) {
                var init = data["init"];
                var args = (init instanceof Array) ? init : [init];
                var type = (DIRTY_CLASS_MAP[data.type]) ? DIRTY_CLASS_MAP[data.type] : data.type;
                var _class = tm.using(type);
                
                console.assert(Object.keys(_class).length !== 0, _class + " is not defined.");
                
                var elm = _class.apply(null, args).addChildTo(this);
                elm.fromJSON(data);
                
                this[name] = elm;
            }.bind(this);
            
            for (var key in data) {
                var value = data[key];
                if (key == "children") {
                    if (value instanceof Array) {
                        for (var i=0,len=value.length; i<len; ++i) {
                            var childData = value[i];
                            _fromJSON(childData.name, childData);
                        }
                    }
                    else {
                        for (var key in value) {
                            var childData = value[key];
                            _fromJSON(key, childData);
                        }
                    }
                }
                else {
                    if (key == "type") key = "__key";
                    this[key] = value;
                }
            }

            return this;
        },
        /**
         * 要素を JSON 化する
         * TODO: 実装する予定
         */
        toJSON: function() {
            // TODO:
        },
        
    });

    /*
     * @private
     * namespaceの後方互換
     */
    var DIRTY_CLASS_MAP = {
        "Sprite"                : "tm.display.Sprite",
        "Label"                 : "tm.display.Label",
        "Shape"                 : "tm.display.Shape",
        "CircleShape"           : "tm.display.CircleShape",
        "TriangleShape"         : "tm.display.TriangleShape",
        "RectangleShape"        : "tm.display.RectangleShape",
        "RoundRectangleShape"   : "tm.display.RoundRectangleShape",
        "TextShape"             : "tm.display.TextShape",
        "StarShape"             : "tm.display.StarShape",
        "PolygonShape"          : "tm.display.PolygonShape",
        "HeartShape"            : "tm.display.HeartShape",
        "AnimationSprite"       : "tm.display.AnimationSprite",
        
        "LabelButton"           : "tm.ui.LabelButton",
        "IconButton"            : "tm.ui.IconButton",
        "GlossyButton"          : "tm.ui.GlossyButton",
        "FlatButton"            : "tm.ui.FlatButton",
    };
    
})();

/*
 * object2d.js
 */

(function() {
    
    /**
     * @class tm.app.Object2D
     * Object2D
     * @extends tm.app.Element
     */
    tm.define("tm.app.Object2D", {
        superClass: "tm.app.Element",
        
        /** 位置 */
        position: null,
        /** スケール */
        scale: null,
        /** 回転 */
        rotation: 0,
        /** 起きているフラグ */
        awake: true,
        /** @private  幅 */
        _width:  64,
        /** @private  高さ */
        _height: 64,
        /** @property pointing      ポインティング */
        /** @property origin        中心位置 */
        /** @property _matrix       マトリックス */
        /** @property hitFlags      ヒット判定フラグ */
        /** @property downFlags     ダウンフラグ */
        /** @property _worldMatrix  グローバル行列 */
        /** @property _worldAlpha   グローバルのα値 */
        
        /**
         * @constructor
         * @param {Object} elm
         */
        init: function() {
            this.superInit();
            this.position = tm.geom.Vector2(0, 0);
            this.scale    = tm.geom.Vector2(1, 1);
            this.pointing = tm.geom.Vector2(0, 0);
            this.origin   = tm.geom.Vector2(0.5, 0.5);
            this._matrix  = tm.geom.Matrix33();
            this._matrix.identity();
            
            this.boundingType = "circle";
            this.checkHierarchy = true;
            this.interactive = false;
            this.hitFlags = [];
            this.downFlags= [];
            this._clickFlag = false;

            this._worldMatrix = tm.geom.Matrix33().identity();
            this._worldAlpha = 1.0;
        },
        
        /**
         * 最終的な行列をゲット
         */
        getFinalMatrix: function() {
            var matrix = tm.geom.Matrix33();
 
            if (this.parent) {
                matrix.multiply(this.parent.getFinalMatrix());
            }
            matrix.translate(this.x, this.y);
            matrix.rotateZ(this.rotation*Math.DEG_TO_RAD);
            matrix.scale(this.scaleX, this.scaleY);
 
            return matrix;
        },
        
        /**
         * 点と衝突しているかを判定
         * @param {Number} x
         * @param {Number} y
         */
        isHitPoint: function(x, y) {
            // 円判定
            var p = this.globalToLocal(tm.geom.Vector2(x, y));
            this.pointing.x = p.x;
            this.pointing.y = p.y;
            
            if (((p.x)*(p.x)+(p.y)*(p.y)) < (this.radius*this.radius)) {
                return true;
            }
            return false;
        },
 
        /**
         * 円として点と衝突判定
         * @param {Number} x
         * @param {Number} y
         */
        isHitPointCircle: function(x, y) {
            var lenX = this.x - x;
            var lenY = this.y - y;
            if (((lenX)*(lenX)+(lenY)*(lenY)) < (this.radius*this.radius)) {
                return true;
            }
            return false;
        },
 
        /**
         * 矩形として点と衝突判定
         * @param {Number} x
         * @param {Number} y
         */
        isHitPointRect: function(x, y) {
            // ここから下のバージョンは四角形
            
            var left   = this.x - this.width*this.originX;
            var right  = this.x + this.width*(1-this.originX);
            var top    = this.y - this.height*this.originY;
            var bottom = this.y + this.height*(1-this.originY);
            
            if ( left < x && x < right && top  < y && y < bottom ) { return true; }
            
            return false;
        },
        
        /**
         * 階層を考慮した円衝突判定
         * @param {Number} x
         * @param {Number} y
         */
        isHitPointCircleHierarchy: function(x, y) {
            // 円判定
            var p = this.globalToLocal(tm.geom.Vector2(x, y));
            this.pointing.x = p.x;
            this.pointing.y = p.y;
            
            if (((p.x)*(p.x)+(p.y)*(p.y)) < (this.radius*this.radius)) {
                return true;
            }
            return false;
        },
        
        /**
         * 階層を考慮した矩形衝突判定
         * @param {Number} x
         * @param {Number} y
         */
        isHitPointRectHierarchy: function(x, y) {
            var p = this.globalToLocal(tm.geom.Vector2(x, y));
            this.pointing.x = p.x;
            this.pointing.y = p.y;
            
            var left   = -this.width*this.originX;
            var right  = +this.width*(1-this.originX);
            var top    = -this.height*this.originY;
            var bottom = +this.height*(1-this.originY);
            
            if ( left < p.x && p.x < right && top  < p.y && p.y < bottom ) { return true; }
            
            return false;
        },
        
        /**
         * 要素と衝突しているかを判定
         * @param {Object} elm
         */
        isHitElement: function(elm) {
            var selfGlobalPos  = this.parent.localToGlobal(this);
            if (((this.x-elm.x)*(this.x-elm.x)+(this.y-elm.y)*(this.y-elm.y)) < (this.radius+elm.radius)*(this.radius+elm.radius)) {
                return true;
            }
            return false;
        },
 
        /**
         * 円同士の衝突判定
         * @param {Object} elm
         */
        isHitElementCircle: function(elm) {
            return tm.collision.testCircleCircle(this.getBoundingCircle(), elm.getBoundingCircle());
        },
 
        /**
         * 円同士の衝突判定
         * @param {Object} elm
         */
        isHitElementRect: function(elm) {
            return tm.collision.testRectRect(this.getBoundingRect(), elm.getBoundingRect());    
        },
 
        /**
         * バウンディングサークル
         * @param {Object} elm
         */
        getBoundingCircle: function() {
            return tm.geom.Circle(this.centerX, this.centerY, this.radius);
        },
 
        /**
         * バウンディングレクト
         * @param {Object} elm
         */
        getBoundingRect: function() {
            return tm.geom.Rect(this.left, this.top, this.width, this.height);
        },
 
        /**
         * ローカル座標をグローバル座標に変換
         * @param {Object} elm
         */
        localToGlobal: function(p) {
            return this.getFinalMatrix().multiplyVector2(p);
        },
        
        /**
         * グローバル座標をローカル座標に変換
         * @param {Object} elm
         */
        globalToLocal: function(p) {
            var matrix = this._worldMatrix.clone();
            matrix.invert();
            matrix.transpose();

            return matrix.multiplyVector2(p);
        },
        
        /**
         * X 座標値をセット
         * @param {Number} x
         */
        setX: function(x) {
            this.position.x = x;
            return this;
        },
        
        /**
         * Y 座標値をセット
         * @param {Number} y
         */
        setY: function(y) {
            this.position.y = y;
            return this;
        },
        
        /**
         * XY 座標をセット
         * @param {Number} x
         * @param {Number} y
         */
        setPosition: function(x, y) {
            this.position.x = x;
            this.position.y = y;
            return this;
        },

        /**
         * 回転をセット
         * @param {Number} rotation
         */
        setRotation: function(rotation) {
            this.rotation = rotation;
            return this;
        },

        /**
         * スケールをセット
         * @param {Number} x
         * @param {Number} y
         */
        setScale: function(x, y) {
            this.scale.x = x;
            if (arguments.length <= 1) {
                this.scale.y = x;
            } else {
                this.scale.y = y;
            }
            return this;
        },
        
        /**
         * 基準点をセット
         * @param {Number} x
         * @param {Number} y
         */
        setOrigin: function(x, y) {
            this.origin.x = x;
            this.origin.y = y;
            return this;
        },
        
        /**
         * 幅をセット
         * @param {Number} width
         */
        setWidth: function(width) {
            this.width = width;
            return this;
        },
        
        /**
         * 高さをセット
         * @param {Number} height
         */
        setHeight: function(height) {
            this.height = height;
            return this;
        },
        
        /**
         * サイズ(幅, 高さ)をセット
         * @param {Number} width
         * @param {Number} height
         */
        setSize: function(width, height) {
            this.width  = width;
            this.height = height;
            return this;
        },
        
        /**
         * 起動
         */
        wakeUp: function() {
            this.awake = true;
            return this;
        },
        
        /**
         * 停止
         */
        sleep: function() {
            this.awake = false;
            return this;
        },
        
        /**
         * タッチ判定の有効/無効をセット
         * @param {Boolean} flag
         */
        setInteractive: function(flag, type) {
            this.interactive = flag;

            if (type) {
                this.boundingType = type;
            }

            return this;
        },
        
        /**
         * バウンディングタイプをセット("circle" or "rect")
         * @param {Object} type
         */
        setBoundingType: function(type) {
            this.boundingType = type;
            return this;
        },
        
        /**
         * ポインティングをチェック
         * @private
         * @param {Object} app
         */
        _checkPointing: function(app) {
            console.assert(false);
        },
        
        /**
         * マウスチェック
         * @private
         * @param {Object} app
         */
        _checkMouse: function(app) {
            this.__checkPointing(app, app.pointing, 0);
        },

        /**
         * タッチチェック
         * @private
         * @param {Object} app
         */
        _checkTouch: function(app) {
            var self = this;
            this.__checkPointing(app, app.pointing, 0);
            // app.touches.each(function(touch, i) {
            //     self.__checkPointing(app, touch, i);
            // });
        },
        
        /**
         * チェックポインンティング
         * @private
         * @param {Object} app
         * @param {Object} p
         * @param {Number} index
         */
        __checkPointing: function(app, p, index) {
            var elm = this.element;
            
            var prevHitFlag = this.hitFlags[index];
            this.hitFlags[index]    = this.isHitPoint(p.x, p.y);

            if (!prevHitFlag && this.hitFlags[index]) {
                this._dispatchPointingEvent("mouseover", "touchover", "pointingover", app, p);
            }
            
            if (prevHitFlag && !this.hitFlags[index]) {
                this._dispatchPointingEvent("mouseout", "touchout", "pointingout", app, p);
            }
            
            if (this.hitFlags[index]) {
                if (p.getPointingStart()) {
                    this._dispatchPointingEvent("mousedown", "touchstart", "pointingstart", app, p);
                    this.downFlags[index] = true;
                    this._clickFlag = true;
                }
            }
            
            if (this.downFlags[index]) {
                this._dispatchPointingEvent("mousemove", "touchmove", "pointingmove", app, p);
            }
            
            if (this.downFlags[index]==true && p.getPointingEnd()) {
                this._dispatchPointingEvent("mouseup", "touchend", "pointingend", app, p);
                this.downFlags[index] = false;
            }
        },
        
        /**
         * ポイントイベントを発火する
         * @private
         * @param {Object} mouse
         * @param {Object} touch
         * @param {Object} pointing
         * @param {Object} app
         * @param {Object} p
         */
        _dispatchPointingEvent: function(mouse, touch, pointing, app, p) {
            this.dispatchEvent( tm.event.MouseEvent(mouse, app, p) );
            this.dispatchEvent( tm.event.TouchEvent(touch, app, p) );
            this.dispatchEvent( tm.event.PointingEvent(pointing, app, p) );
        },
        
        /**
         * ワールドマトリックスを計算
         * @private
         */
        _calcWorldMatrix: function() {
            if (!this.parent) {
                return ;
            }

            // 行列
            if(this.rotation != this.rotationCache) {
                this.rotationCache = this.rotation;
                var r = this.rotation*Math.DEG_TO_RAD;
                this._sr =  Math.sin(r);
                this._cr =  Math.cos(r);
            }

            var localTransform = this._matrix.m;
            var parentTransform = this.parent._worldMatrix.m;
            var worldTransform = this._worldMatrix.m;
            //console.log(localTransform)
            localTransform[0] = this._cr * this.scale.x;
            localTransform[1] =-this._sr * this.scale.y
            localTransform[3] = this._sr * this.scale.x;
            localTransform[4] = this._cr * this.scale.y;

            // 
            localTransform[2] = this.position.x;
            localTransform[5] = this.position.y;

            // cache
            var a00 = localTransform[0], a01 = localTransform[1], a02 = localTransform[2],
                a10 = localTransform[3], a11 = localTransform[4], a12 = localTransform[5],

                b00 = parentTransform[0], b01 = parentTransform[1], b02 = parentTransform[2],
                b10 = parentTransform[3], b11 = parentTransform[4], b12 = parentTransform[5];

            worldTransform[0] = b00 * a00 + b01 * a10;
            worldTransform[1] = b00 * a01 + b01 * a11;
            worldTransform[2] = b00 * a02 + b01 * a12 + b02;

            worldTransform[3] = b10 * a00 + b11 * a10;
            worldTransform[4] = b10 * a01 + b11 * a11;
            worldTransform[5] = b10 * a02 + b11 * a12 + b12;
        },
        
        /**
         * dirty method
         * @private
         */
        _dirtyCalc: function() {
            this._calcWorldMatrix();
        },
    });
 
    /**
     * @property    x
     * x座標値
     */
    tm.app.Object2D.prototype.accessor("x", {
        "get": function()   { return this.position.x; },
        "set": function(v)  { this.position.x = v; }
    });
    
    /**
     * @property    y
     * y座標値
     */
    tm.app.Object2D.prototype.accessor("y", {
        "get": function()   { return this.position.y; },
        "set": function(v)  { this.position.y = v; }
    });
 
    /**
     * @property    originX
     * x座標値
     */
    tm.app.Object2D.prototype.accessor("originX", {
        "get": function()   { return this.origin.x; },
        "set": function(v)  { this.origin.x = v; }
    });
    
    /**
     * @property    originY
     * y座標値
     */
    tm.app.Object2D.prototype.accessor("originY", {
        "get": function()   { return this.origin.y; },
        "set": function(v)  { this.origin.y = v; }
    });
    
    /**
     * @property    scaleX
     * スケールX値
     */
    tm.app.Object2D.prototype.accessor("scaleX", {
        "get": function()   { return this.scale.x; },
        "set": function(v)  { this.scale.x = v; }
    });
    
    /**
     * @property    scaleY
     * スケールY値
     */
    tm.app.Object2D.prototype.accessor("scaleY", {
        "get": function()   { return this.scale.y; },
        "set": function(v)  { this.scale.y = v; }
    });
    
    
    
    /**
     * @property    width
     * width
     */
    tm.app.Object2D.prototype.accessor("width", {
        "get": function()   { return this._width; },
        "set": function(v)  { this._width = v; }
    });
    
    
    /**
     * @property    height
     * height
     */
    tm.app.Object2D.prototype.accessor("height", {
        "get": function()   { return this._height; },
        "set": function(v)  { this._height = v; }
    });
    
    /**
     * @property    radius
     * 半径
     */
    tm.app.Object2D.prototype.accessor("radius", {
        "get": function()   {
            return (this._radius !== undefined) ? this._radius : (this.width+this.height)/4;
        },
        "set": function(v)  { this._radius = v; }
    });
    
    /**
     * @property    top
     * 左
     */
    tm.app.Object2D.prototype.accessor("top", {
        "get": function()   { return this.y - this.height*this.originY; },
        "set": function(v)  { this.y = v + this.height*this.originY; },
    });
 
    /**
     * @property    right
     * 左
     */
    tm.app.Object2D.prototype.accessor("right", {
        "get": function()   { return this.x + this.width*(1-this.originX); },
        "set": function(v)  { this.x = v - this.width*(1-this.originX); },
    });
 
    /**
     * @property    bottom
     * 左
     */
    tm.app.Object2D.prototype.accessor("bottom", {
        "get": function()   { return this.y + this.height*(1-this.originY); },
        "set": function(v)  { this.y = v - this.height*(1-this.originY); },
    });
 
    /**
     * @property    left
     * 左
     */
    tm.app.Object2D.prototype.accessor("left", {
        "get": function()   { return this.x - this.width*this.originX; },
        "set": function(v)  { this.x = v + this.width*this.originX; },
    });

    /**
     * @property    centerX
     * centerX
     */
    tm.app.Object2D.prototype.accessor("centerX", {
        "get": function()   { return this.x + this.width/2 - this.width*this.originX; },
        "set": function(v)  {
            // TODO: どうしようかな??
        }
    });
 
    /**
     * @property    centerY
     * centerY
     */
    tm.app.Object2D.prototype.accessor("centerY", {
        "get": function()   { return this.y + this.height/2 - this.height*this.originY; },
        "set": function(v)  {
            // TODO: どうしようかな??
        }
    });
 
    /**
     * @property    boundingType
     * boundingType
     */
    tm.app.Object2D.prototype.accessor("boundingType", {
        "get": function() {
            return this._boundingType;
        },
        "set": function(v) {
            this._boundingType = v;
            this._setIsHitFunc();
        },
    });
 
    /**
     * @property    checkHierarchy
     * checkHierarchy
     */
    tm.app.Object2D.prototype.accessor("checkHierarchy", {
        "get": function()   { return this._checkHierarchy; },
        "set": function(v)  {
            this._checkHierarchy = v;
            this._setIsHitFunc();
        }
    });
 
 
    var _isHitFuncMap = {
        "rect": tm.app.Object2D.prototype.isHitPointRect,
        "circle": tm.app.Object2D.prototype.isHitPointCircle,
        "true": function() { return true; },
        "false": function() { return false; },
    };
 
    var _isHitFuncMapHierarchy = {
        "rect": tm.app.Object2D.prototype.isHitPointRectHierarchy,
        "circle": tm.app.Object2D.prototype.isHitPointCircleHierarchy,
        "true": function() { return true; },
        "false": function() { return false; },
    };
 
    var _isHitElementMap = {
        "rect": tm.app.Object2D.prototype.isHitElementRect,
        "circle": tm.app.Object2D.prototype.isHitElementCircle,
        "true": function() { return true; },
        "false": function() { return false; },
    };
 
    /**
     * @member      tm.app.Object2D
     * @property    _setIsHitFunc
     * @private
     */
    tm.app.Object2D.prototype._setIsHitFunc = function() {
        var isHitFuncMap = (this.checkHierarchy) ? _isHitFuncMapHierarchy : _isHitFuncMap;
        var boundingType = this.boundingType;
        var isHitFunc = (isHitFuncMap[boundingType]) ? (isHitFuncMap[boundingType]) : (isHitFuncMap["true"]);
 
        this.isHitPoint   = (isHitFuncMap[boundingType]) ? (isHitFuncMap[boundingType]) : (isHitFuncMap["true"]);
        this.isHitElement = (_isHitElementMap[boundingType]) ? (_isHitElementMap[boundingType]) : (_isHitElementMap["true"]);
    };
    
    /**
     * @member      tm.app.Object2D
     * @property    _checkPointing
     * ポイントをチェック
     * @param {Object} isMobile
     * @private
     */
    tm.app.Object2D.prototype._checkPointing = (tm.isMobile) ?
        tm.app.Object2D.prototype._checkTouch : tm.app.Object2D.prototype._checkMouse;

    
})();




;(function() {


    /**
     * @class tm.app.Grid
     * @extends tm.app.Object2d
     * グリッド
     */
    tm.define("tm.app.Grid", {
        superClass: "tm.app.Object2D",

        cellWidth: 64,
        cellHeight: 64,
        maxPerLine: 8,
        arrangement: "horizontal", // vertical
        
        /**
         * @constructor
         */
        init: function(param) {
            this.superInit();

        },

        reposition: function() {
            var childs = this.children;

            if (this.arrangement == "horizontal") {
                childs.each(function(child, i) {
                    var xIndex = (i%this.maxPerLine);
                    var yIndex = (i/this.maxPerLine)|0;
                    var x = this.cellWidth*xIndex;
                    var y = this.cellHeight*yIndex;
                    child.setPosition(x, y);
                }, this);
            }
            else {
                childs.each(function(child, i) {
                    var xIndex = (i/this.maxPerLine)|0;
                    var yIndex = (i%this.maxPerLine);
                    var x = this.cellWidth*xIndex;
                    var y = this.cellHeight*yIndex;
                    child.setPosition(x, y);
                }, this);
            }
        },
    });

})();


/*
 * scene.js
 */

tm.app = tm.app || {};


(function() {
    
    /**
     * @class tm.app.Scene
     * シーンとして使用するゲームエレメントクラス
     * @extends tm.app.Object2D
     */
    tm.app.Scene = tm.createClass({
        superClass: tm.app.Object2D,

        app: null,

        /** ManagerScene 経由で生成された際に次にどのシーンに遷移するかのラベル */
        nextLabel: "",

        /** ManagerScene 経由で生成された際に次のシーンに渡す引数 */
        nextArguments: null,

        /**
         * @constructor
         */
        init: function() {
            this.superInit();
            
            this.boundingType = "none";
            
            // タッチに反応させる
            this.setInteractive(true);
        },

        exit: function(param) {
            if (!this.app) return ;

            if (typeof param !== 'object') {
                var temp = {};
                temp.nextLabel = arguments[0];
                temp.nextArguments = arguments[1];
                param = temp;
            }

            if (param.nextLabel) {
                this.nextLabel = param.nextLabel;
            }
            if (param.nextArguments) {
                this.nextArguments = param.nextArguments;
            }

            this.app.popScene();

            return this;
        },

    });
    
})();



/*
 * collision.js
 */

tm.app = tm.app || {};


(function() {
    
    /**
     * @class tm.app.Collision
     * 衝突管理クラス
     */
    tm.app.Collision = tm.createClass({
        
        /** @property */
        element: null,
        /** @property */
        collideList: null,

        /**
         * @constructor
         * @param {Object} elm
         */
        init: function(elm) {
            this.element = elm;
            this.collideList = [];
        },
        
        /**
         * 更新
         * @param {Object} app
         */
        update: function(app) {
            var cl  = this.collideList.clone();
            var elm = this.element;
            
            for (var i=0,len=cl.length; i<len; ++i) {
                var c = cl[i];
                if (elm.isHitElement(c.element)) {
                    // 最初の衝突だった場合は collisionenter を呼ぶ
                    if (c.collide === false) {
                        var e = tm.event.Event("collisionenter");
                        e.other = c.element;
                        elm.dispatchEvent(e);
                    }
                    // 通常の衝突イベント
                    var e = tm.event.Event("collisionstay");
                    e.other = c.element;
                    elm.dispatchEvent(e);
                    
                    c.collide = true;
                }
                else {
                    if (c.collide == true) {
                        var e = tm.event.Event("collisionexit");
                        e.other = c.element;
                        elm.dispatchEvent(e);
                    }
                    c.collide = false;
                }
            }
        },
        
        /**
         * 追加
         * @param {Object} elm
         */
        add: function(elm) {
            this.collideList.push({
                element: elm,
                collide: false,
            });
        },
        
        /**
         * 削除
         * @param {Object} elm
         */
        remove: function(elm) {
            this.collideList.eraseIf(function(v) {
                return v.element == elm;
            });
        },
        
    });
    
    
    /**
     * @member      tm.app.Element
     * @property    collision
     * コリジョン
     */
    tm.app.Element.prototype.getter("collision", function() {
        if (!this._collision) {
            this._collision = tm.app.Collision(this);
            this.addEventListener("enterframe", function(e){
                this._collision.update(e.app);
            });
        }
        
        return this._collision;
    });
    
    
})();
/*
 * tweener.js
 */

(function() {

    /**
     * @class tm.app.Tweener
     * トゥイーナークラス
     * @extends tm.event.EventDispatcher
     */
    tm.define("tm.app.Tweener", {
        superClass: "tm.app.Element",

        /**
         * @constructor
         * @param {Object} elm
         */
        init: function(elm) {
            this.superInit();

            this.setTarget(elm || {});
            this.loop = false;

            this._init();
        },

        /**
         * 初期化
         */
        _init: function() {
            this._index = 0;
            this._tasks = [];
            this._func = this._updateTask;
            this.isPlaying = true;
        },

        /**
         * ターゲットのセット
         * @param {Object} target
         */
        setTarget: function(target) {
            this.element = target;

            return this;
        },

        /**
         * 更新
         * @param {Object} app
         */
        update: function(app) {
            this._func(app);
            return ;
            var tweens = this.tweens.clone();
            for (var i=0,len=tweens.length; i<len; ++i) {
                var tween = tweens[i];
                
                // 待ちチェック
                if (tween.delay > 0) {
                    tween.delay -= 1000/app.fps;
                    continue;
                }
                
                var time = tween.time + 1000/app.fps;
                tween._setTime(time);
                
                if (tween.time >= tween.duration) {
                    // 削除
                    this.tweens.erase(tween);
                    
                    // 全てのアニメーション終了チェック
                    if (this.tweens.length <= 0) {
                        this.isAnimation = false;
                        var e = tm.event.Event("finish");
                        this.element.fire(e);
                        this.dispatchEvent(e);
                    }
                }
                else {
                    tween.update();
                }
            }
        },

        /**
         * タスクの更新
         * @private
         * @param {Object} app
         */
        _updateTask: function(app) {
            if (!this.isPlaying) return ;

            var task = this._tasks[this._index];
            if (!task) {

                if (this.loop === true) {
                    this._index = 0;
                }
                else {
                    this.isPlaying = false;
                }

                return ;
            }
            this._index++;

            if (task.type == "tween") {
                var data = task.data;
                var fnStr= task.data.type;
                var args = task.data.args;
                this._tween = tm.anim.Tween();

                this._tween[fnStr].apply(this._tween, args);

                this._func = this._updateTween;
                this._func(app);
            }
            else if (task.type == "wait") {
                this._wait = task.data;
                this._wait.time = 0;

                this._func = this._updateWait;
                this._func(app);
            }
            else if (task.type == "call") {
                task.data.func.apply(task.data.self, task.data.args);
                // 1フレーム消費しないよう再帰
                this._updateTask(app);
            }
            else if (task.type == "set") {
                this.element.$extend(task.data.values);
                // 1フレーム消費しないよう再帰
                this._updateTask(app);
            }
        },

        /**
         * Tween の更新
         * @private
         * @param {Object} elm
         */
        _updateTween: function(app) {
            var tween = this._tween;
            var time = tween.time + 1000/app.fps;
            tween._setTime(time);
            
            if (tween.time >= tween.duration) {
                // 削除
                delete this._tween;
                this._tween = null;
                this._func = this._updateTask;
            }
            else {
                tween.update();
            }

        },

        /**
         * 時間の更新
         * @private
         * @param {Object} elm
         */
        _updateWait: function(app) {
            var wait = this._wait;
            wait.time += 1000/app.fps;

            if (wait.time >= wait.limit) {
                delete this._wait;
                this._wait = null;
                this._func = this._updateTask;
            }
        },

        /**
         * 追加
         * @param {Object} param
         */
        add: function(param) {
            if (!param.target) param.target = this.element;

            this._tasks.push({
                type: "tween",
                data: param
            });

            if (this.isAnimation == false) {
                this.isAnimation = true;
                var e = tm.event.Event("animationstart");
                this.element.dispatchEvent(e);
            }
            
            return this;
        },

        /**
         * 指定した値を足した値までアニメーション
         * @param {Object} props
         * @param {Object} duration
         * @param {Function} fn
         */
        by: function(props, duration, fn) {
            this._addTweenTask({
                props: props,
                duration: duration,
                fn: fn,
                type: "by"
            });
            return this;
        },

        /**
         * 指定した値までアニメーション
         * @param {Object} props
         * @param {Object} duration
         * @param {Function} fn
         */
        to: function(props, duration, fn) {
            this._addTweenTask({
                props: props,
                duration: duration,
                fn: fn,
                type: "to"
            });
            return this;
        },

        from: function(props, duration, fn) {
            this._addTweenTask({
                props: props,
                duration: duration,
                fn: fn,
                type: "from"
            });
            return this;
        },

        /**
         * 移動アニメーション
         * @param {Number} x
         * @param {Number} y
         * @param {Object} duration
         * @param {Function} fn
         */
        move: function(x, y, duration, fn) {
            return this.to({x:x, y:y}, duration, fn);
        },

        /**
         * 指定した値を足した座標までアニメーション
         * @param {Number} x
         * @param {Number} y
         * @param {Object} duration
         * @param {Function} fn
         */
        moveBy: function(x, y, duration, fn) {
            return this.by({x:x, y:y}, duration, fn);
        },

        /**
         * 回転アニメーション
         * @param {Number} rotation
         * @param {Object} duration
         * @param {Function} fn
         */
        rotate: function(rotation, duration, fn) {
            return this.to({rotation:rotation}, duration, fn);
        },

        /**
         * 拡縮アニメーション
         * @param {Number} scale
         * @param {Object} duration
         * @param {Function} fn
         */
        scale: function(scale, duration, fn) {
            return this.to({scaleX:scale, scaleY:scale}, duration, fn);
        },

        /**
         * フェードアニメーション
         * @param {Object} value
         * @param {Object} duration
         */
        fade: function(value, duration) {
            this.to({"alpha":value}, duration);
            return this;
        },

        /**
         * フェードイン
         * @param {Object} duration
         */
        fadeIn: function(duration) {
            this.fade(1.0, duration);
            return this;
        },

        /**
         * フェードアウト
         * @param {Object} duration
         */
        fadeOut: function(duration) {
            this.fade(0.0, duration);
            return this;
        },

        /**
         * Tween のタスクを追加
         * @private
         * @param {Object} param
         */
        _addTweenTask: function(param) {
            param.target   = (param.target !== undefined) ? param.target : this.element;
            param.duration = (param.duration !== undefined) ? param.duration : 1000;

            this._tasks.push({
                type: "tween",
                data: {
                    args: [param.target, param.props, param.duration, param.fn],
                    type: param.type
                }
            });

            if (this.isAnimation == false) {
                this.isAnimation = true;
                var e = tm.event.Event("animationstart");
                this.element.dispatchEvent(e);
            }
            
            return this;
        },

        /**
         * 待ち時間
         * @param {Object} time
         */
        wait: function(time) {
            this._tasks.push({
                type: "wait",
                data: {
                    limit: time
                }
            });
            return this;
        },

        /**
         * コールバックを登録
         * @param {Function} fn
         * @param {Object} args
         */
        call: function(fn, self, args) {
            this._tasks.push({
                type: "call",
                data: {
                    func: fn,
                    self: self || this,
                    args: args,
                },
            });

            return this;
        },

        /**
         * プロパティをセット
         * @param {Object} key
         * @param {Object} value
         */
        set: function(key, value) {
            var values = null;
            if (arguments.length == 2) {
                values = {};
                values[key] = value;
            }
            else {
                values = key;
            }
            this._tasks.push({
                type: "set",
                data: {
                    values: values
                }
            });

            return this;
        },

        /**
         * アニメーション開始
         */
        play: function() {
            this.isPlaying = true;
            return this;
        },

        /**
         * アニメーションを一時停止
         */
        pause: function() {
            this.isPlaying = false;
            return this;
        },

        /**
         * アニメーションを巻き戻す
         */
        rewind: function() {
            this._func = this._updateTask;
            this._index = 0;
            this.play();
            return this;
        },

        /**
         * アニメーションループ設定
         * @param {Boolean} flag
         */
        setLoop: function(flag) {
            this.loop = flag;
            return this;
        },

        /**
         * アニメーションをクリア
         */
        clear: function() {
            this._init();
            return this;
        }
    });

    /**
     * @member      tm.app.Element
     * @property    tweener
     * トゥイーンアニメーション
     */
    tm.app.Element.prototype.getter("tweener", function() {
        if (!this._tweener) {
            this._tweener = tm.app.Tweener(this);
            this.on("enterframe", function(e) {
                this._tweener.update(e.app);
            });
        }
        
        return this._tweener;
    });
})();

/*
 * timeline.js
 */

tm.namespace("tm.app", function() {

    /**
     * @class tm.app.Timeline
     * タイムラインクラス
     * @extends tm.event.EventDispatcher
     */
    tm.define("tm.app.Timeline", {
        superClass: "tm.app.Element",
        
        /**
         * @constructor
         * @param {Object} elm
         */
        init: function(elm) {
            this.superInit();
            
            this.setTarget(elm || {});
            
            this.currentFrame = 0;
            this.currentTime = 0;
            this.prevTime = 0;
            this.duration = 0;
            this.isPlay = true;
            this._tweens  = [];
            this._actions = [];
        },
        
        /**
         * 更新
         * @param {Object} app
         */
        update: function(app) {
            if (!this.isPlay) return ;

            if (this.prevTime <= this.duration) {
                this._updateTween();
                this._updateAction();
            }

            this.currentFrame++;
            this.prevTime = this.currentTime;
            this.currentTime = ((this.currentFrame/app.fps)*1000)|0;
        },
        
        /**
         * トゥイーンを更新
         * @private
         */
        _updateTween: function() {
            var tweens = this._tweens;
            for (var i=0,len=tweens.length; i<len; ++i) {
                var tween = tweens[i];
                
                if (tween.delay > this.currentTime) {
                    continue ;
                }
                
                var time = this.currentTime - tween.delay;
                tween._setTime(time);
                if (tween.time >= tween.duration) {
                }
                else {
                    tween.update();
                }
            }
        },
        
        /**
         * アクションを更新
         * @private
         */
        _updateAction: function() {
            var actions = this._actions;
            
            for (var i=0,len=actions.length; i<len; ++i) {
                var action = actions[i];
                
                if (this.prevTime <= action.delay && action.delay < this.currentTime) {
                    if (action.type == "call") {
                        action.func.call(action.self);
                        // action.func();
                    }
                    else if (action.type == "set") {
                        var props = action.props;
                        for (var key in props) {
                            this.element[key] = props[key];
                        }
                    }
                }
            }
        },
        
        /**
         * 指定した値までアニメーション
         * @param {Object} delay
         * @param {Object} props
         * @param {Object} duration
         * @param {Function} func
         */
        to: function(delay, props, duration, fn) {
            console.assert(typeof delay == "number", "to の第一引数はdelayに変わりました");
            this._addTween({
                props: props,
                duration: duration,
                fn: fn,
                delay: delay
            });
            
            return this;
        },

        /**
         * 指定した値を足した値までアニメーション
         * @param {Object} delay
         * @param {Object} props
         * @param {Object} duration
         * @param {Function} func
         */
        by: function(delay, props, duration, fn) {
            console.assert(typeof delay == "number", "by の第一引数はdelayに変わりました");
            for (var key in props) {
                props[key] += this.element[key] || 0;
            }
            this._addTween({
                props: props,
                duration: duration,
                fn: fn,
                delay: delay
            });
            
            return this;
        },
        
        /**
         * 関数を実行
         * @param {Object} delay
         * @param {Function} func
         */
        call: function(delay, func, self) {
            console.assert(typeof delay == "number", "call の第一引数はdelayに変わりました");
            this._addAction({
                "type": "call",
                func: func,
                self: self || this,
                delay: delay,
            });
            return this;
        },
        
        /**
         * プロパティをセット
         * @param {Object} delay
         * @param {Object} props
         */
        set: function(delay, props) {
            console.assert(typeof delay == "number", "set の第一引数はdelayに変わりました");
            this._addAction({
                "type": "set",
                props: props,
                delay: delay,
            });
            return this;
        },


        /**
         * ターゲットのセット
         * @param {Object} target
         */
        setTarget: function(target) {
            this.element = target;

            return this;
        },

        /**
         * ターゲットをゲット
         */
        getTarget: function() {
            return this.element;
        },
        
        /**
         * アニメーション開始
         * アニメーションが終了したら再度アニメーションを行う
         * @param {Number} frame
         */
        gotoAndPlay: function(frame) {
            this.isPlay = true;
            this.currentFrame = frame;
            this._updateTween();
        },
        
        /**
         * アニメーション開始
         * アニメーションが終了したらストップする
         * @param {Number} frame
         */
        gotoAndStop: function(frame) {
            this.currentFrame = frame;
            this.isPlay = false;
            this._updateTween();
        },

        /**
         * tween を追加
         * @private
         * @param {Object} tween
         */
        _addTween: function(tween) {
            tween.duration = tween.duration || 1000;
            tween.duration = this._dirty(tween.duration);
            tween.delay = tween.delay || 0;
            tween.delay = this._dirty(tween.delay);

            var tweenObj = tm.anim.Tween();
            tweenObj.to(this.element, tween.props, tween.duration, tween.fn);
            tweenObj.delay = tween.delay;

            this._tweens.push(tweenObj);
            this._updateDuration(tweenObj);
        },

        /**
         * アニメーションを追加
         * @private
         * @param {Object} action
         */
        _addAction: function(action) {
            action.delay = action.delay || 0;
            action.delay = this._dirty(action.delay);

            this._actions.push(action);
            this._updateDuration(action);
        },
        
        /**
         * 時間を更新
         * @private
         * @param {Object} task
         */
        _updateDuration: function(task) {
            var duration = task.delay + (task.duration ? task.duration : 0);
            if (this.duration < duration) this.duration = duration;
            return this;
        },

        /**
         * dirty method
         * @private
         * @param {Object} t
         */
        _dirty: function(t) {
            return t;
//            return (t/this.fps).toInt();
        },
        
        /**
         * ロード
         * @param {Object} data
         */
        load: function(data) {
            
            for (var key in data.timeline) {
                var value = data.timeline[key];
            }
            
            return this;
        },
        
        /**
         * アニメーションをクリア
         */
        clear: function() {
            this.currentFrame = 0;
            this.prevTime = 0;
            this.currentTime = 0;
            this.duration = 0;
            this.isPlay = true;
            this._tweens  = [];
            this._actions = [];
            
            return this;
        }
        
    });
    
    
    
    /**
     * @member      tm.app.Element
     * @property    timeline
     * タイムラインアニメーション
     */
    tm.app.Element.prototype.getter("timeline", function() {
        if (!this._timeline) {
            this._timeline = tm.app.Timeline(this);
            this.on("enterframe", function(e) {
                this._timeline.update(e.app);
            });
        }

        return this._timeline;
    });
    
});

/*
 * canvasapp.js
 */

tm.display = tm.display || {};

(function() {

    /**
     * @class tm.display.CanvasApp
     * キャンバスアプリケーション
     * @extends tm.app.BaseApp
     */
    tm.display.CanvasApp = tm.createClass({
        superClass: tm.app.BaseApp,

        /** @property element */
        /** @property canvas */
        /** @property renderer */
        /** @property background */
        /** @property _scenes */
        /** @property mouse */
        /** @property touch */
        
        /**
         * @constructor
         */
        init: function(canvas) {
            if (canvas instanceof HTMLCanvasElement) {
                this.element = canvas;
            }
            else if (typeof canvas == "string") {
                this.element = document.querySelector(canvas);
            }
            else {
                this.element = document.createElement("canvas");
            }

            // 親の初期化
            this.superInit(this.element);

            // グラフィックスを生成
            this.canvas = tm.graphics.Canvas(this.element);
            this.renderer = tm.display.CanvasRenderer(this.canvas);
            
            // カラー
            this.background = "black";
            
            // シーン周り
            this._scenes = [ tm.app.Scene() ];


            this._canvasCache = [];
            this._canvasCacheCache = [];
            this.on("push", function() {
                this._draw();

                var canvas = this._canvasCacheCache.pop();
                if (!canvas) {
                    var element = this.canvas.element.cloneNode();
                    canvas = tm.graphics.Canvas(element);
                }
                canvas.clear();
                canvas.drawTexture(this.canvas, 0, 0);
                this._canvasCache.push(canvas);
            });
            this.on("poped", function() {
                var canvas = this._canvasCache.pop();
                this._draw();

                this._canvasCacheCache.push(canvas);
            });
        },
        
        /**
         * リサイズ
         */
        resize: function(width, height) {
            this.width = width;
            this.height= height;
            
            return this;
        },

        /**
         * ウィンドウのサイズにリサイズ
         */
        resizeWindow: function() {
            this.width = innerWidth;
            this.height= innerHeight;
            
            return this;
        },
        
        /**
         * 画面にフィットさせる
         */
        fitWindow: function(everFlag) {
            // 画面にフィット
            this.canvas.fitWindow(everFlag);
            
            // マウスとタッチの座標更新関数をパワーアップ
            this.mouse._mousemove = this.mouse._mousemoveScale;
            this.touch._touchmove = this.touch._touchmoveScale;

            return this;
        },

        /**
         * @private
         */
        _draw: function() {
            this.canvas.clear();
            
            this.canvas.fillStyle   = "white";
            this.canvas.strokeStyle = "white";
            this.canvas.context.lineJoin = "round";
            this.canvas.context.lineCap  = "round";

            // スタックしたキャンバスを描画
            if (this._canvasCache.last)
                this.canvas.drawTexture(this._canvasCache.last, 0, 0);
            
            // this._canvasCache.each(function(bitmap, index) {
            //     this.canvas.drawBitmap(bitmap, 0, 0);
            // }, this);

            
            // 描画は全てのシーン行う
            this.canvas.save();

            this.renderer.render(this.currentScene);

            this.canvas.restore();
        },
        
    });
    
    
    /**
     * @property    width
     * 幅
     */
    tm.display.CanvasApp.prototype.accessor("width", {
        "get": function()   { return this.canvas.width; },
        "set": function(v)  { this.canvas.width = v; }
    });
    
    /**
     * @property    height
     * 高さ
     */
    tm.display.CanvasApp.prototype.accessor("height", {
        "get": function()   { return this.canvas.height; },
        "set": function(v)  { this.canvas.height = v; }
    });
    
    /**
     * @property    height
     * 高さ
     */
    tm.display.CanvasApp.prototype.accessor("background", {
        "get": function()   { return this.canvas._background; },
        "set": function(v)  {
            this._background = v;
            this.element.style.background = v;
        }
    });

})();



/*
 * canvaselement.js
 */

tm.display = tm.display || {};


(function() {

    /**
     * @class tm.display.CanvasElement
     * キャンバスエレメント
     * @extends tm.app.Object2D
     */
    tm.display.CanvasElement = tm.createClass({
        superClass: tm.app.Object2D,

        /** 表示フラグ */
        visible: true,
        /** クリッピングフラグ */
        clipping: false,
        /** fillStyle */
        fillStyle: "white",
        /** strokeStyle */
        strokeStyle: "white",
        /** アルファ */
        alpha: 1.0,
        /** ブレンドモード */
        blendMode: "source-over",
        /** シャドウカラー */
        shadowColor: "black",
        /** シャドウオフセットX */
        shadowOffsetX: 0,
        /** シャドウオフセットY */
        shadowOffsetY: 0,
        /** シャドウオフブラー */
        shadowBlur: 0,

        /**
         * @constructor
         */
        init: function() {
            this.superInit();
        },

        /**
         * アルファをセット
         */
        setAlpha: function(alpha) {
            this.alpha = alpha;
            return this;
        },

        /**
         * シャドウカラーをセット
         */
        setShadowColor: function(color) {
            this.shadowColor = color;
            return this;
        },
        
        /**
         * シャドウブラーをセット
         */
        setShadowBlur: function(blur) {
            this.shadowBlur = blur;
            return this;
        },
        
        /**
         * シャドウオフセットをセット
         */
        setShadowOffset: function(x, y) {
            this.shadowOffsetX = x;
            this.shadowOffsetY = y;
            return this;
        },

        /**
         * バウンディングサークルを描画
         */
        drawBoundingCircle: function(canvas) {
            canvas.save();
            canvas.lineWidth = 2;
            canvas.strokeCircle(0, 0, this.radius);
            canvas.restore();
        },

        /**
         * バウンディングレクトを描画
         */
        drawBoundingRect: function(canvas) {
            canvas.save();
            canvas.lineWidth = 2;
            canvas.strokeRect(-this.width*this.originX, -this.height*this.originY, this.width, this.height);
            canvas.restore();
        },

        /**
         * ????
         */
        drawFillRect: function(ctx) {
            ctx.fillRect(-this.width/2, -this.height/2, this.width, this.height);
            return this;
        },
        /**
         * ????
         */
        drawStrokeRect: function(ctx) {
            ctx.strokeRect(-this.width/2, -this.height/2, this.width, this.height);
            return this;
        },

        /**
         * ????
         */
        drawFillArc: function(ctx) {
            ctx.beginPath();
            ctx.arc(0, 0, this.radius, 0, Math.PI*2, false);
            ctx.fill();
            ctx.closePath();
            return this;
        },
        /**
         * ????
         */
        drawStrokeArc: function(ctx) {
            ctx.beginPath();
            ctx.arc(0, 0, this.radius, 0, Math.PI*2, false);
            ctx.stroke();
            ctx.closePath();
            return this;
        },

        /**
         * 表示/非表示をセット
         */
        setVisible: function(flag) {
            this.visible = flag;
            return this;
        },

        /**
         * 表示
         */
        show: function() {
            this.visible = true;
            return this;
        },

        /**
         * 非表示
         */
        hide: function() {
            this.visible = false;
            return this;
        },

        /**
         * 塗りつぶしスタイルをセット
         */
        setFillStyle: function(style) {
            this.fillStyle = style;
            return this;
        },

        /**
         * ストロークスタイルをセット
         */
        setStrokeStyle: function(style) {
            this.strokeStyle = style;
            return this;
        },

        /**
         * ブレンドモードをセット
         */
        setBlendMode: function(blendMode) {
            this.blendMode = blendMode;
            return this;
        },

        /**
         * ロード
         */
        load: function(data) {
            var self = this;

            data.layers.forEach(function(layer) {
                if (layer.type != "objectgroup") return ;

                var group = tm.display.CanvasElement().addChildTo(self);
                group.width = layer.width;
                group.height = layer.height;

                layer.objects.forEach(function(obj) {
                    var _class = tm.using(obj.type);
                    if (Object.keys(_class).length === 0) {
                        _class=tm.display[obj.type];
                    }
                    var initParam = null;
                    if (obj.properties.init) {
                        initParam = JSON.parse(obj.properties.init);
                    }
                    var element = _class.apply(null, initParam).addChildTo(group);
                    var props   = obj.properties;
                    for (var key in props) {
                        if (key == "init") continue ;
                        var value = props[key];
                        element[key] = value;
                    }

                    element.x = obj.x;
                    element.y = obj.y;
                    element.width = obj.width;
                    element.height = obj.height;
                });

                self[layer.name] = group;
            });
        },

        /**
         * @private
         */
        _calcAlpha: function() {
            if (!this.parent) {
                this._worldAlpha = this.alpha;
                return ;
            }
            else {
                // alpha
                this._worldAlpha = this.parent._worldAlpha * this.alpha;
            }
        },

        /**
         * @private
         */
        _dirtyCalc: function() {
            this._calcAlpha();
            this._calcWorldMatrix();
        },
    });


})();


/*
 * sprite.js
 */


tm.display = tm.display || {};


(function() {
    
    /**
     * @class tm.display.Sprite
     * 画像の描画を行うクラス
     * @extends tm.display.CanvasElement
     */
    tm.display.Sprite = tm.createClass({
        superClass: tm.display.CanvasElement,
        
        /** @property srcRect          */
        /** @property width            width */
        /** @property height           height */
        /** @property @private _image  表示しているアセット(画像) */

        /**
         * @constructor
         */
        init: function(image, width, height) {
            this.superInit();
            
            console.assert(typeof image != 'number', "Sprite の第一引数はテクスチャもしくはテクスチャ名に変わりました");
            
            this._frameIndex = 0;
            this.srcRect = tm.geom.Rect(0, 0, 64, 64);
            
            // 引数あり
            if (arguments.length >= 1) {
                this.setImage(image).fitImage();

                if (width !== undefined) this.width = width;
                if (height !== undefined) this.height = height;
            }
        },

        /**
         * 表示するアセット(画像)をセット
         */
        setImage: function(image, width, height) {
            if (typeof image == "string") {
                var key = image;
                image = tm.asset.Manager.get(key);
                console.assert(image != null, "don't find '" + key + "' as image.");
            }
            
            this._image = image;
            this.srcRect.x = 0;
            this.srcRect.y = 0;
            this.srcRect.width  = image.element.width;
            this.srcRect.height = image.element.height;

            if (width  !== undefined) this.width  = width;
            if (height !== undefined) this.height = height;
            // this.width  = (width !== undefined)  ? width  : image.element.width;
            // this.height = (height !== undefined) ? height : image.element.height;

            return this;
        },

        /**
         * 表示しているアセット(画像)を取得
         */
        getImage: function() {
            return this._image;
        },

        /**
         * 自分自信を画像サイズと同じサイズにする
         */
        fitImage: function() {
            this.width  = this.image.width;
            this.height = this.image.height;

            return this;
        },
        
        /**
         * フレームインデックスをセット
         */
        setFrameIndex: function(index, width, height) {
            var tw  = width || this.width;      // tw
            var th  = height || this.height;    // th
            var row = ~~(this.image.width / tw);
            var col = ~~(this.image.height / th);
            var maxIndex = row*col;
            index = index%maxIndex;
            
            var x   = index%row;
            var y   = ~~(index/row);
            this.srcRect.x = x*tw;
            this.srcRect.y = y*th;
            this.srcRect.width  = tw;
            this.srcRect.height = th;

            this._frameIndex = index;

            return this;
        },
        
        /**
         * @private
         */
        _refreshSize: function() {},
    });
    
    /**
     * @property    image
     * 画像
     */
    tm.display.Sprite.prototype.accessor("image", {
        "get": function()   {
            return this._image;
        },
        "set": function(image)  {
            this.setImage(image);
        }
    });

    /**
     * @property    frameIndex
     * フレームインデックス
     */
    tm.display.Sprite.prototype.accessor("frameIndex", {
        "get": function()   {
            return this._frameIndex;
        },
        "set": function(value)  {
            this.setFrameIndex(value);
        }
    });
    
})();

/*
 * shape.js
 */


tm.display = tm.display || {};


(function() {
    
    /**
     * @class tm.display.Shape
     * @extends tm.display.CanvasElement
     * 図形を描画するクラス
     */
    tm.display.Shape = tm.createClass({
        superClass: tm.display.CanvasElement,
        
        /** @property canvsa */
        /** @property width */
        /** @property height */
        /** @property autoRender */

        /**
         * @constructor
         */
        init: function(param) {
            param = this._dirtyCheckParam.apply(this, arguments);
            var param = {}.$safe(param, {
                width: 64,
                height: 64,
                // bgColor: "#888",
                bgColor: "transparent",

                fillStyle: "red",
                strokeStyle: "white",
                lineWidth: "2",
                shadowBlur: 0,
                shadowColor: "red",
            });
            
            this.superInit();

            // 
            this.canvas = tm.graphics.Canvas();
            // 
            this.$extend(param);
            // 
            this.render();
            // 
            this.autoRender = true;
        },

        _prerender: function() {
            var c = this.canvas;
            c.resize(this.width, this.height);
            c.clearColor(this.bgColor);

            c.save();

            // パラメータセット
            c.fillStyle   = this.fillStyle;
            c.strokeStyle = this.strokeStyle;
            c.lineWidth   = this.lineWidth;
            c.shadowBlur  = this.shadowBlur;
            c.shadowColor  = this.shadowColor;

            return this;
        },

        _postrender: function() {
            var c = this.canvas;
            c.restore();

            return this;
        },

        render: function() {
            this._prerender();

            this._render();

            this._postrender();
        },

        _render: function() {

        },

        /**
         * テキスト描画
         */
        renderText: function(param) {
            var c = this.canvas;
            param = {}.$extend(tm.display.Shape.DEFAULT_SHAPE_PARAM_TEXT, param);

            c.save();
            
            // パラメータセット
            c.fillStyle     = param.fillStyle;
            c.strokeStyle   = param.strokeStyle;
            c.lineWidth     = param.lineWidth;
            c.font          = param.font;
            c.textAlign     = param.textAlign;
            c.textBaseline  = param.textBaseline;

            // 描画
            c.strokeText(param.text, this.width/2, this.height/2);
            c.fillText(param.text, this.width/2, this.height/2);
            
            c.restore();
        },


        // TODO: old support(plan delete)
        _dirtyCheckParam: function(param) {
            var param = param;
            if (arguments.length >= 2) {
                var width = arguments[0];
                var height= arguments[1];
                var param = arguments[2] || {};
                param.width = width;
                param.height = height;

                console.warn("tmlib.js warn: arguments of shape init is only param from version 0.4");
            }

            return param;
        },
        
    });

    ["width", "height", "bgColor", "strokeStyle", "fillStyle", "lineWidth", "shadowBlur", "shadowColor"].each(function(prop) {
        var propName = '_' + prop;

        tm.display.Shape.prototype.accessor(prop, {
            "get": function()   {
                return this[propName];
            },
            "set": function(v)  {
                this[propName] = v;
                if (this.autoRender === true) {
                    this.render();
                }
            }
        });
    });

})();


(function() {
    
    /**
     * @class tm.display.CircleShape
     * @extends tm.display.Shape
     * 簡単に円を描画できるクラス
     * 
     *      @example display
     *      var shape = tm.display.CircleShape().addChildTo(this);
     *      shape.setPosition(50, 50);
     */
    tm.define("tm.display.CircleShape", {
        superClass: tm.display.Shape,
        
        /**
         * @constructor
         */
        init: function(param) {
            param = this._dirtyCheckParam.apply(this, arguments);
            this.superInit(param);

            this.render();
        },

        _render: function() {
            var c = this.canvas;
            // 描画
            var radius = Math.min(this.width, this.height)/2;
            c.fillCircle(this.width/2, this.height/2, radius);
            c.strokeCircle(this.width/2, this.height/2, radius-Number(c.lineWidth)/2);
        },
    });
    
})();




(function() {
    
    /**
     * @class tm.display.TriangleShape
     * 簡単に三角形を描画できるクラス
     * @extends tm.display.Shape
     */
    tm.define("tm.display.TriangleShape", {
        superClass: tm.display.Shape,
        
        /**
         * @constructor
         */
        init: function(param) {
            param = this._dirtyCheckParam.apply(this, arguments);
            param = {}.$safe(param, {
                fillStyle: "green",
            });
            this.superInit(param);

            this.render();
        },

        _render: function() {
            var c = this.canvas;

            // 描画
            var x = this.width/2;
            var y = this.height/2;
            var radius = Math.min(this.width, this.height)/2;
            var offsetLine = Number(c.lineWidth)*1;
            c.fillPolygon(x, y, radius, 3);
            c.strokePolygon(x, y, radius-offsetLine, 3);
        },
    });
    
})();




(function() {
    
    /**
     * @class tm.display.RectangleShape
     * 簡単に矩形を描画できるクラス
     * @extends tm.display.Shape
     */
    tm.define("tm.display.RectangleShape", {
        superClass: tm.display.Shape,
        
        /**
         * @constructor
         */
        init: function(param) {
            param = this._dirtyCheckParam.apply(this, arguments);
            param = {}.$safe(param, {
                fillStyle: "blue",
            });
            this.superInit(param);

            this.render();
        },

        _render: function() {
            var c = this.canvas;
            // 描画
            var lw = this.lineWidth;
            var lw_half = lw/2;
            c.fillRect(0, 0, this.width, this.height);
            c.strokeRect(lw_half, lw_half, this.width-lw, this.height-lw);
        },
    });
    
})();




(function() {
    
    /**
     * @class tm.display.RoundRectangleShape
     * 簡単に矩形を描画できるクラス
     * @extends tm.display.Shape
     */
    tm.define("tm.display.RoundRectangleShape", {
        superClass: tm.display.Shape,
        
        /**
         * @constructor
         */
        init: function(param) {
            param = this._dirtyCheckParam.apply(this, arguments);
            param = {}.$safe(param, {
                fillStyle: "blue",
                cornerRadius: 8,
            });
            this.superInit(param);

            this.render();
        },

        _render: function() {
            var c = this.canvas;
            // 描画
            var lw = this.lineWidth;
            var lw_half = lw/2;

            c.fillRoundRect(lw_half, lw_half, this.width-lw, this.height-lw, this.cornerRadius);
            c.strokeRoundRect(lw_half, lw_half, this.width-lw, this.height-lw, this.cornerRadius);
        },
    });

    ["cornerRadius"].each(function(prop) {
        var propName = '_' + prop;

        tm.display.RoundRectangleShape.prototype.accessor(prop, {
            "get": function()   {
                return this[propName];
            },
            "set": function(v)  {
                this[propName] = v;
                if (this.autoRender === true) { this.render(); }
            }
        });
    });

})();


(function() {
    
    /**
     * @class tm.display.StarShape
     * 簡単に星形を描画できるクラス
     * @extends tm.display.Shape
     */
    tm.define("tm.display.StarShape", {
        superClass: tm.display.Shape,
        
        /**
         * @constructor
         */
        init: function(param) {
            param = this._dirtyCheckParam.apply(this, arguments);
            param = {}.$safe(param, {
                fillStyle: "yellow",
                sides: 5,
                sideIndent: 0.38,
                offsetAngle: -90,
            });
            this.superInit(param);

            this.render();
        },

        _render: function() {
            var c = this.canvas;

            var sides       = this.sides;
            var sideIndent  = this.sideIndent;
            var offsetAngle = this.offsetAngle;
            
            // 描画
            var x = this.width/2;
            var y = this.height/2;
            var radius = Math.min(this.width, this.height)/2;
            var offsetLine = Number(c.lineWidth)*1.5;
            c.fillStar(x, y, radius, sides, sideIndent, offsetAngle);
            c.strokeStar(x, y, radius-offsetLine, sides, sideIndent, offsetAngle);
        },
    });

    ["sides", "sideIndent", "offsetAngle"].each(function(prop) {
        var propName = '_' + prop;

        tm.display.StarShape.prototype.accessor(prop, {
            "get": function()   {
                return this[propName];
            },
            "set": function(v)  {
                this[propName] = v;
                if (this.autoRender === true) {
                    this.render();
                }
            }
        });
    });
    
})();



(function() {
    
    /**
     * @class tm.display.PolygonShape
     * @extends tm.display.Shape
     * ポリゴン描画クラス
     */
    tm.define("tm.display.PolygonShape", {
        superClass: tm.display.Shape,
        
        /**
         * @constructor
         */
        init: function(param) {
            param = this._dirtyCheckParam.apply(this, arguments);
            param = {}.$safe(param, {
                fillStyle: "cyan",
                sides: 5,
                sideIndent: 0.38,
                offsetAngle: -90,
            });
            this.superInit(param);

            this.render();
        },

        _render: function() {
            var c = this.canvas;

            var sides       = this.sides;
            var offsetAngle = this.offsetAngle;
            
            // 描画
            var x = this.width/2;
            var y = this.height/2;
            var radius = Math.min(this.width, this.height)/2;
            var offsetLine = Number(c.lineWidth)*0.6;
            c.fillPolygon(x, y, radius, sides, offsetAngle);
            c.strokePolygon(x, y, radius-offsetLine, sides, offsetAngle);
        },
    });

    ["sides", "offsetAngle"].each(function(prop) {
        var propName = '_' + prop;

        tm.display.PolygonShape.prototype.accessor(prop, {
            "get": function()   {
                return this[propName];
            },
            "set": function(v)  {
                this[propName] = v;
                if (this.autoRender === true) {
                    this.render();
                }
            }
        });
    });
    
})();




(function() {
    
    /**
     * @class tm.display.HeartShape
     * 簡単にハートを描画できるクラス
     * @extends tm.display.Shape
     */
    tm.define("tm.display.HeartShape", {
        superClass: tm.display.Shape,
        
        /**
         * @constructor
         */
        init: function(param) {
            param = this._dirtyCheckParam.apply(this, arguments);
            param = {}.$safe(param, {
                fillStyle: "pink",
                cornerAngle: 45,
            });
            this.superInit(param);

            this.render();
        },

        _render: function() {
            var c = this.canvas;
            // 描画
            var x = this.width/2;
            var y = this.height/2;
            var radius = Math.min(this.width, this.height)/2;
            c.fillHeart(x, y, radius, this.cornerAngle);
            c.strokeHeart(x, y, radius-Number(c.lineWidth)/2, this.cornerAngle);
        },
    });

    ["cornerAngle"].each(function(prop) {
        var propName = '_' + prop;

        tm.display.HeartShape.prototype.accessor(prop, {
            "get": function()   {
                return this[propName];
            },
            "set": function(v)  {
                this[propName] = v;
                if (this.autoRender === true) { this.render(); }
            }
        });
    });

})();




(function() {

    var dummyCanvas = null;
    
    /**
     * @class tm.display.TextShape
     * @extends tm.display.Shape
     * テキスト描画クラス
     */
    tm.define("tm.display.TextShape", {

        superClass: "tm.display.Shape",
        
        /**
         * @constructor
         */
        init: function(width, height, param) {
            param = this._dirtyCheckParam.apply(this, arguments);
            param = {}.$safe(param, {
                fillStyle: "black",
                lineWidth: 4,
                text: "hello, world!",
                fontSize: 64,
                fontWeight: "",
                fontFamily: "'HiraKakuProN-W3'",
            });
            this.superInit(param);

            this.fit();

            this.render();
        },

        fit: function() {
            if (!dummyCanvas) {
                dummyCanvas = tm.graphics.Canvas();
            }
            dummyCanvas.font = "{fontWeight} {fontSize}px {fontFamily}".format(this);
            var textWidth = dummyCanvas.context.measureText(this.text).width + (10);
            var textHeight = dummyCanvas.context.measureText('あ').width*1.5;
            this.width = textWidth;
            this.height = textHeight;
        },

        _render: function() {
            var c = this.canvas;

            c.fillStyle = this.fillStyle;
            c.strokeStyle = this.strokeStyle;
            c.font = "{fontWeight} {fontSize}px {fontFamily}".format(this);
            c.textAlign = "center";
            c.textBaseline = "middle";

            var textWidth = c.context.measureText(this.text).width;

            var hw = this.width/2;
            var hh = this.height/2
            c.strokeText(this.text, hw, hh);
            c.fillText(this.text, hw, hh);
        },

    });

    ['text', "fontWeight", "fontSize", "fontFamily"].each(function(prop) {
        var propName = '_' + prop;

        tm.display.TextShape.prototype.accessor(prop, {
            "get": function()   {
                return this[propName];
            },
            "set": function(v)  {
                this[propName] = v;
                if (this.autoRender === true) { this.render(); }
            }
        });
    });

    
})();



















/*
 * label.js
 */

tm.display = tm.display || {};


(function() {
    
    var dummyCanvas  = null;
    var dummyContext = null;

    /**
     * @class tm.display.Label
     * システムフォントを描画するクラス
     * @extends tm.display.CanvasElement
     */
    tm.display.Label = tm.createClass({
        
        superClass: tm.display.CanvasElement,
        
        /** 塗りつぶしフラグ */
        fill: true,
        /** ストロークフラグ */
        stroke: false,
        /** デバッグボックス */
        debugBox: false,

        /** @property _fontSize @private */
        /** @property _fontFamily @private */
        /** @property _fontWeight @private */
        /** @property _lineHeight @private */
        /** @property align */
        /** @property baseline */
        /** @property maxWidth */

        /**
         * @constructor
         */
        init: function(text, size) {
            this.superInit();
            
            this.text       = text || "";
            
            this._fontSize   = size || 24;
            this._fontFamily = tm.display.Label["default"].fontFamily;
            this._fontWeight = "";
            this._lineHeight = 1.2;
            this._updateFont();
            
            this.align = tm.display.Label["default"].align;
            this.baseline = tm.display.Label["default"].baseline;

            this.maxWidth   = null;
        },
        
        /**
         * アラインをセット
         */
        setAlign: function(align) {
            this.align = align;
            return this;
        },
        
        /**
         * ベースラインをセット
         */
        setBaseline: function(baseline) {
            this.baseline = baseline;
            return this;
        },
        
        /**
         * フォントサイズをセット
         */
        setFontSize: function(size) {
            this.fontSize = size;
            return this;
        },
        
        /**
         * フォントファミリーをセット
         */
        setFontFamily: function(family) {
            this.fontFamily= family;
            return this;
        },

        /**
         * フォントウェイトをセット
         */
        setFontWeight: function(weight) {
            this.fontWeight= weight;
            return this;
        },

        /**
         * @private
         */
        _updateFont: function() {
            this.fontStyle = "{fontWeight} {fontSize}px {fontFamily}".format(this);
            if (!dummyCanvas) {
                dummyCanvas = document.createElement("canvas");
                dummyContext = dummyCanvas.getContext('2d');
            }
            dummyContext.font = this.fontStyle;
            this.textSize = dummyContext.measureText('あ').width * this.lineHeight;
        },

        /**
         * @private
         */
        _updateLines: function() {
            this._lines = (this._text+'').split('\n');
        },
        
    });
    
    /**
     * @property    text
     * 文字
     */
    tm.display.Label.prototype.accessor("text", {
        "get": function() { return this._text; },
        "set": function(v){
            if (v == null || v == undefined) {
                this._text = "";
            }
            else {
                this._text = v;
            }
            this._updateLines();
        }
    });
    
    /**
     * @property    fontSize
     * フォントサイズ
     */
    tm.display.Label.prototype.accessor("fontSize", {
        "get": function() { return this._fontSize; },
        "set": function(v){ this._fontSize = v; this._updateFont(); }
    });
    
    /**
     * @property    fontFamily
     * フォント
     */
    tm.display.Label.prototype.accessor("fontFamily", {
        "get": function() { return this._fontFamily; },
        "set": function(v){ this._fontFamily = v; this._updateFont(); }
    });
    
    /**
     * @property    fontWeight
     */
    tm.display.Label.prototype.accessor("fontWeight", {
        "get": function() { return this._fontWeight; },
        "set": function(v) {
            this._fontWeight = v; this._updateFont();
        },
    });
    
    /**
     * @property lineHeight
     */
    tm.display.Label.prototype.accessor("lineHeight", {
        "get": function() { return this._lineHeight; },
        "set": function(v) {
            this._lineHeight = v; this._updateFont();
        },
    });
    
    tm.display.Label["default"] = {
        align: "center",
        baseline: "middle",
        fontFamily: "'HiraKakuProN-W3'", // Hiragino or Helvetica
        // align: "start",
        // baseline: "alphabetic",
    };

    
})();


/*
 * animationsprite.js
 */


tm.display = tm.display || {};


(function() {

    /**
     * @class tm.display.AnimationSprite
     * スプライトアニメーションクラス
     * @extends tm.display.CanvasElement
     */
    tm.display.AnimationSprite = tm.createClass({
        superClass: tm.display.CanvasElement,

        /** @property ss                 sprite sheet */
        /** @property width              width */
        /** @property height             height */
        /** @property currentFrame       現在のフレーム */
        /** @property currentFrameIndex  現在のフレームインデックス */
        /** @property paused             ポーズ */
        /** @property currentAnimation   現在のアニメーション */

        /**
         * @constructor
         */
        init: function(ss, width, height) {
            this.superInit();

            if (typeof ss == "string") {
                var ss = tm.asset.Manager.get(ss);
                console.assert(ss, "not found " + ss);
            }

            console.assert(typeof ss == "object", "AnimationSprite の第一引数はスプライトシートもしくはスプライトシート名に変わりました");

            this.ss = ss;

            this.width  = width || ss.frame.width;
            this.height = height|| ss.frame.height;

            this.currentFrame = 0;
            this.currentFrameIndex = 0;
            this.paused = true;

            this.currentAnimation = null;

            this.addEventListener("enterframe", function(e) {
                if (!this.paused && e.app.frame%this.currentAnimation.frequency === 0) {
                    this._updateFrame();
                }
            });
        },

        /**
         * 描画
         */
        draw: function(canvas) {
            var srcRect = this.ss.getFrame(this.currentFrame);
            var element = this.ss.image.element;

            canvas.drawImage(element,
                srcRect.x, srcRect.y, srcRect.width, srcRect.height,
                -this.width*this.originX, -this.height*this.originY, this.width, this.height);
        },

        /**
         * 再生
         */
        gotoAndPlay: function(name) {
            name = (name !== undefined) ? name : "default";

            this.paused = false;
            this.currentAnimation = this.ss.animations[name];
            this.currentFrame = 0;
            this.currentFrameIndex = 0;
            this._normalizeFrame();

            return this;
        },

        /**
         * ストップ
         */
        gotoAndStop: function(name) {
            name = (name !== undefined) ? name : "default";

            this.paused = true;
            this.currentAnimation = this.ss.animations[name];
            this.currentFrame = 0;
            this.currentFrameIndex = 0;
            this._normalizeFrame();

            return this;
        },

        /**
         * フレーム数のカウントアップ
         * @private
         */
        _updateFrame: function() {
            this.currentFrameIndex += 1;
            this._normalizeFrame();
        },

        /**
         * @private
         */
        _normalizeFrame: function() {
            var anim = this.currentAnimation;
            if (anim) {
                if (this.currentFrameIndex < anim.frames.length) {
                    this.currentFrame = anim.frames[this.currentFrameIndex];
                }
                else {
                    if (anim.next) {
                        this.gotoAndPlay(anim.next);
                    }
                    else {
                        this.currentFrameIndex = anim.frames.length - 1;
                        this.currentFrame = anim.frames[this.currentFrameIndex];
                        this.paused = true;
                    }
                    // dispatch animationend
                    var e = tm.event.Event("animationend");
                    this.dispatchEvent(e);
                }
            }
        },

    });

})();


/*
 * mapsprite.js
 */


(function() {

    /**
     * @class tm.display.MapSprite
     * マップ描画クラス
     * @extends tm.display.CanvasElement
     */
    tm.define("tm.display.MapSprite", {
        superClass: "tm.display.CanvasElement",

        /** @property mapSheet */
        /** @property chipWidth */
        /** @property chipHeight */
        /** @property originX */
        /** @property originY */
        /** @property width */
        /** @property height */
        /** @property tileset */

        /**
         * @constructor
         */
        init: function(mapSheet, chipWidth, chipHeight) {
            this.superInit();

            if (typeof mapSheet == "string") {
                this.mapSheet = tm.asset.Manager.get(mapSheet);
            }
            else {
                this.mapSheet = mapSheet;
            }

            this.chipWidth  = chipWidth  || 32;
            this.chipHeight = chipHeight || 32;

            this.originX = this.originY = 0;

            this.width = chipWidth*this.mapSheet.width;
            this.height= chipWidth*this.mapSheet.height;

            this.tileset = [];
            this.tilesetInfo = {};
            this._build();
        },

        /**
         * @private
         */
        _build: function() {
            var self = this;

            this.mapSheet.tilesets.each(function(tileset, index) {
                self._buildTileset(tileset, index);
            });

            this.mapSheet.layers.each(function(layer, hoge) {
                if (layer.type == "objectgroup") {
                    self._buildObject(layer);
                }
                else if (layer.type == "imagelayer") {
                    self._buildImageLayer(layer);
                }
                else {
                    self._buildLayer(layer);
                }
            });
        },

        /**
         * @private
         */
        _buildTileset: function(tileset, index) {
            var self      = this;
            var mapSheet  = this.mapSheet;
            var texture   = tm.asset.Manager.get(tileset.image);
            var xIndexMax = (texture.width / mapSheet.tilewidth)|0;
            var yIndexMax = (texture.height / mapSheet.tileheight)|0;

            var info = {
                begin: self.tileset.length,
                end: self.tileset.length + xIndexMax * yIndexMax
            };

            self.tilesetInfo[index] = info;

            if (tileset.name !== undefined) {
                self.tilesetInfo[tileset.name] = info;
            }

            yIndexMax.times(function(my) {
                xIndexMax.times(function(mx) {
                    var rect = tm.geom.Rect(
                        mx * mapSheet.tilewidth,
                        my * mapSheet.tileheight,
                        mapSheet.tilewidth,
                        mapSheet.tileheight
                        );
                    self.tileset.push({
                        image: tileset.image,
                        rect: rect
                    });
                });
            });
        },

        /**
         * @private
         */
        _buildLayer: function(layer) {
            var self     = this;
            var mapSheet = this.mapSheet;
            var shape    = tm.display.Shape({
                width: this.width,
                height: this.height
            }).addChildTo(this);
            var visible  = (layer.visible === 1) || (layer.visible === undefined);
            var opacity  = layer.opacity === undefined ? 1 : layer.opacity;
            var tileset  = [];
            shape.origin.set(0, 0);

            if (layer.tilesets !== undefined) {
                var tilesets = null;
                if (Array.isArray(layer.tilesets)) {
                    tilesets = layer.tilesets;
                } else {
                    tilesets = [layer.tilesets];
                }
                tilesets.each(function(n) {
                    var info = self.tilesetInfo[n];
                    tileset = tileset.concat(self.tileset.slice(info.begin, info.end));
                });
            } else {
                tileset = self.tileset;
            }

            if (visible) {
                layer.data.each(function(d, index) {
                    var type = d;
                    if (type == -1) {
                        return ;
                    }
                    type = Math.abs(type);
                    if (tileset[type] === undefined) {
                        return ;
                    }

                    var xIndex = index%mapSheet.width;
                    var yIndex = (index/mapSheet.width)|0;
                    var dx = xIndex*self.chipWidth;
                    var dy = yIndex*self.chipHeight;

                    var tile = tileset[type];

                    var texture = tm.asset.Manager.get(tile.image);
                    var rect = tile.rect;

                    shape.canvas.globalAlpha = opacity;
                    shape.canvas.drawTexture(texture,
                        rect.x, rect.y, rect.width, rect.height,
                        dx, dy, self.chipWidth, self.chipHeight
                        );
                }.bind(this));
            }

        },

        /**
         * @private
         */
        _buildObject: function(layer) {
            var self = this;

            var group = tm.display.CanvasElement().addChildTo(self);
            group.width = self.width;
            group.height = self.height;

            layer.objects.forEach(function(obj) {
                var _class = tm.using(obj.type);
                if (Object.keys(_class).length === 0) {
                    _class=tm.display[obj.type];
                }

                var initParam = null;
                if (obj.properties.init) {
                    initParam = JSON.parse(obj.properties.init);
                }
                var element = _class.apply(null, initParam).addChildTo(group);
                var props   = obj.properties;
                for (var key in props) {
                    if (key == "init") continue ;
                    var value = props[key];
                    element[key] = value;
                }

                element.x = obj.x;
                element.y = obj.y;
                element.width = obj.width;
                element.height = obj.height;

                group[obj.name] = element;
            });

            self[layer.name] = group;

        },

        /**
         * @private
         */
        _buildImageLayer: function(layer) {
            var sprite = tm.display.Sprite(layer.image.source).setOrigin(0, 0).addChildTo(this);
            sprite.x = layer.x;
            sprite.y = layer.y;
            sprite.alpha = layer.alpha;
            sprite.visible = layer.visible;

            this[layer.name] = sprite;
        }

    });

})();




/*
 * renderer.js
 */

 
(function() {
    
    /**
     * @class tm.display.CanvasRenderer
     * キャンバス描画クラス
     */
    tm.define("tm.display.CanvasRenderer", {
        /** キャンバス */
        canvas: null,

        /** @property @private _context     コンテキスト */

        /**
         * @constructor
         * コンストラクタ
         */
        init: function(canvas) {
            this.canvas = canvas;
            this._context = this.canvas.context;
        },

        /**
         * 描画
         */
        render: function(root) {
            this.canvas.save();
            this.renderObject(root);
            this.canvas.restore();
        },

        /**
         * オブジェクトを描画
         */
        renderObject: function(obj) {
            if (obj.visible === false) return ;
            var context = this._context;

            // TODO: 別の場所で呼ぶよう調整する
            obj._dirtyCalc && obj._dirtyCalc();

            // 描画可能かをチェック
            if (!this._checkRenderable(obj)) {
                // 子供達のみ描画実行
                if (obj.children.length > 0) {
                    var tempChildren = obj.children.slice();
                    for (var i=0,len=tempChildren.length; i<len; ++i) {
                        this.renderObject(tempChildren[i]);
                    }
                }

                return ;
            }

            // 
            if (!obj.draw) {
                this._setRenderFunction(obj);
            }

            // 情報をセット
            if (obj.fillStyle)   context.fillStyle   = obj.fillStyle;
            if (obj.strokeStyle) context.strokeStyle = obj.strokeStyle;
            context.globalAlpha    = obj._worldAlpha;
            context.globalCompositeOperation = obj.blendMode;
            
            if (obj.shadowBlur) {
                context.shadowColor   = obj.shadowColor;
                context.shadowOffsetX = obj.shadowOffsetX;
                context.shadowOffsetY = obj.shadowOffsetY;
                context.shadowBlur    = obj.shadowBlur;
            }
            else {
                context.shadowOffsetX = 0;
                context.shadowOffsetY = 0;
                context.shadowColor   = "rgba(0, 0, 0, 0)";
            }
            
            // 行列をセット
            var m = obj._worldMatrix.m;
            context.setTransform( m[0], m[3], m[1], m[4], m[2], m[5] );
            

            if (obj.clipping) {
                context.save();

                // クリップ処理を実行
                if (obj.clip) {
                    obj.clip();
                }
                else {
                    onclip.call(obj, this.canvas);
                }
                context.clip();

                obj.draw(this.canvas);
                
                // 子供達も実行
                if (obj.children.length > 0) {
                    var tempChildren = obj.children.slice();
                    for (var i=0,len=tempChildren.length; i<len; ++i) {
                        this.renderObject(tempChildren[i]);
                    }
                }

                context.restore();
            }
            else {
                obj.draw(this.canvas);
                
                // 子供達も実行
                if (obj.children.length > 0) {
                    var tempChildren = obj.children.slice();
                    for (var i=0,len=tempChildren.length; i<len; ++i) {
                        this.renderObject(tempChildren[i]);
                    }
                }
            }
        },

        /**
         * @private
         */
        _checkRenderable: function(obj) {
            if (obj._renderable === undefined) {
                obj._renderable = (obj instanceof tm.display.CanvasElement);
            }
            return obj._renderable;
        },

        /**
         * @private
         */
        _setRenderFunction: function(obj) {
            if (obj instanceof tm.display.Sprite) {
                obj.draw = renderFuncList["sprite"];
            }
            else if (obj instanceof tm.display.MapSprite) {
                obj.draw = function() {};
            }
            else if (obj instanceof tm.display.Label) {
                obj.draw = renderFuncList["label"];
            }
            else if (obj instanceof tm.display.Shape) {
                obj.draw = renderFuncList["shape"];
            }
            else {
                obj.draw = function() {};
            }
        }

    });
    
    var renderFuncList = {
        "sprite": function(canvas) {
            var srcRect = this.srcRect;
            var element = this._image.element;
            
            canvas.context.drawImage(element,
                srcRect.x, srcRect.y, srcRect.width, srcRect.height,
                -this.width*this.origin.x, -this.height*this.origin.y, this.width, this.height);
        },
        "shape": function(canvas) {
            var srcRect = this.srcRect;
            canvas.drawImage(
                this.canvas.canvas,
                0, 0, this.canvas.width, this.canvas.height,
                -this.width*this.origin.x, -this.height*this.origin.y, this.width, this.height);
        },
        "label": function(canvas) {
            canvas.setText(this.fontStyle, this.align, this.baseline);
            if (this.lineWidth) canvas.lineWidth = this.lineWidth;
            
            if (this.stroke) {
                if (this.maxWidth) {
                    this._lines.each(function(elm, i) {
                        canvas.strokeText(elm, 0, this.textSize*i, this.maxWidth);
                    }.bind(this));
                }
                else {
                    this._lines.each(function(elm, i) {
                        canvas.strokeText(elm, 0, this.textSize*i);
                    }.bind(this));
                }
            }
            if (this.fill) {
                if (this.maxWidth) {
                    this._lines.each(function(elm, i) {
                        canvas.fillText(elm, 0, this.textSize*i, this.maxWidth);
                    }.bind(this));
                }
                else {
                    this._lines.each(function(elm, i) {
                        canvas.fillText(elm, 0, this.textSize*i);
                    }.bind(this));
                }
            }
            
            if (this.debugBox) {
                canvas.strokeRect(0, 0, this.width, -this.size);
            }
        }
    };

    var onclip = function(c) {
        c.beginPath();
        c.rect(
            -this.width*this.origin.x,
            -this.height*this.origin.y,
            this.width,
            this.height
            );
    };

})();
 


 
(function() {
    
    /**
     * @class tm.display.BoundingRectRenderer
     * バウンディング表示レンダー
     * @extends tm.display.CanvasRenderer
     */
    tm.define("tm.display.BoundingRectRenderer", {
        superClass: "tm.display.CanvasRenderer",

        /**
         * @constructor
         * コンストラクタ
         */
        init: function(canvas) {
            this.superInit(canvas);
        },

        /**
         * @private
         */
        _setRenderFunction: function(obj) {
            obj.draw = render;
        }
    });

    var render = function(canvas) {
        canvas.save();
        canvas.lineWidth = 2;
        canvas.strokeRect(-this.width*this.originX, -this.height*this.originY, this.width, this.height);
        canvas.restore();
    };

})();
 












/*
 * userinterface.js
 */

tm.ui = tm.ui || {};



(function() {
    
    /**
     * @class tm.ui.Pad
     * padクラス
     * @extends tm.display.Shape
     */
    tm.ui.Pad = tm.createClass({
        superClass: tm.display.Shape,
        
        isTouching: false,
        circle: null,

        /**
         * @constructor
         */
        init: function() {
            this.superInit(120, 120);
            
            var c = this.canvas;
            c.fillStyle = "#fff";
            c.fillCircle(60, 60, 60);
            c.fillStyle = "#eee";
            
            this._createCircle();
            
            this.setInteractive(true);
            
            this.alpha = 0.75;
        },

        /**
         * @private
         */
        _createCircle: function() {
            var circle = this.circle = tm.display.Shape(80, 80);
            this.addChild(circle);
            
            var c = circle.canvas;
            c.fillStyle = "#222";
            c.setShadow("black", 2, 2, 2);
            c.fillCircle(40, 40, 35);
        },

        onpointingstart: function() {
            this.isTouching = true;
        },

        onpointingend: function() {
            this.isTouching = false;
            this.circle.position.set(0, 0);
        },

        onpointingmove: function(e) {
            if (this.isTouching==false) return ;
            var p = e.pointing;
            var v = tm.geom.Vector2(p.x - this.x, p.y - this.y);
            var len = v.length();
            v.div(len);
            if (len > 40) len = 40;
            
            this.angle = Math.radToDeg(v.toAngle());
            this.circle.position.set(v.x*len, v.y*len);
            
            // 大きさ
            this.distance  = len/40.0;
            // 向きベクトル
            this.direction = v.mul(this.distance);
        }
        
        
    });
    
})();




/*
 * button.js
 */

tm.ui = tm.ui || {};


;(function() {

    tm.define("tm.ui.BaseButton", {
        superClass: "tm.display.CanvasElement",

        init: function(param) {
            this.superInit();

            param = param || {};
            this.width = param.width || 64;
            this.height = param.height || 64;

            this.setInteractive(true);
            this.boundingType = "rect";

            this.on("pointingend", function() {
                this.flare('push');
            });
        },
    });

})();


;(function() {

    tm.define("tm.ui.SpriteButton", {
        superClass: "tm.ui.BaseButton",

        init: function(image) {
            this.superInit();

            this.sprite = tm.display.Sprite(image).addChildTo(this);

            this.width = this.sprite.width;
            this.height = this.sprite.height;
        },
    });

})();


;(function() {
    
    /**
     * @class tm.ui.LabelButton
     * LabelButton
     * @extends tm.display.Label
     */
    tm.ui.LabelButton = tm.createClass({
        superClass: tm.display.Label,

        /**
         * @constructor
         */
        init: function(text) {
            this.superInit(text);
            
            this.alpha = tm.ui.LabelButton.DEFAULT_ALPHA;
            this.setAlign("center").setBaseline("middle");
            
            this.setInteractive(true);
            this.boundingType = "rect";
            
            this.addEventListener("pointingover", function() {
                this.tweener.clear();
                this.tweener.fadeIn(250);
            }.bind(this));
            this.addEventListener("pointingout", function() {
                this.tweener.clear();
                this.tweener.fade(tm.ui.LabelButton.DEFAULT_ALPHA, 250);
            }.bind(this));
            
            /*
            var d = this.draw;
            this.draw = function(canvas) {
                d.call(this, canvas);
                this.drawBoundingRect(canvas);
            }
            /*
            */
        }
    });
    
    /**
     * @static
     * @property
     * デフォルトとなるアルファ値
     */
    tm.ui.LabelButton.DEFAULT_ALPHA = 0.5;
    
})();


(function() {
    
    /**
     * @class tm.ui.IconButton
     * IconButton
     * @extends tm.display.Sprite
     */
    tm.ui.IconButton = tm.createClass({
        superClass: tm.display.Sprite,
        
        /**
         * @constructor
         */
        init: function() {
            this.superInit.call(this, arguments);
            
            this.setInteractive(true);
            this.boundingType = "rect";

            this.on("pointingend", function() {
                this.flare('push');
            });
        },
    });
    
    /**
     * @static
     * @property
     * デフォルトとなるアルファ値
     */
    tm.ui.IconButton.DEFAULT_ALPHA = 0.5;
    
})();


(function() {
    
    /**
     * @class tm.ui.GlossyButton
     * glossy button
     * @extends tm.display.Shape
     */
    tm.ui.GlossyButton = tm.createClass({
        superClass: tm.display.Shape,

        /**
         * @constructor
         */
        init: function(width, height, backgroundColor, text) {
            this.superInit(width, height);
            
            text  = text  || "Button";
            this.backgroundColor = backgroundColor || "black";
            this.alpha = tm.ui.GlossyButton.DEFAULT_ALPHA;
            
            this.setInteractive(true);
            this.boundingType = "rect";
            this.addEventListener("pointingover", function() {
                this.tweener.clear();
                this.tweener.fade(1.0, 250);
            });
            this.addEventListener("pointingout", function() {
                this.tweener.clear();
                this.tweener.fade(tm.ui.GlossyButton.DEFAULT_ALPHA, 250);
            });
            
            // ラベル
            this.label = tm.display.Label(text || "").addChildTo(this);
            this.label.setAlign("center").setBaseline("middle");
            
            this._refresh();
        },

        /**
         * 背景色をセット
         */
        setBackgroundColor: function(backgroundColor) {
            this.backgroundColor = backgroundColor;
            
            this._refresh();
            
            return this;
        },

        /**
         * リフレッシュ
         * @private
         */
        _refresh: function() {
            // ボタン描画
            var c = this.canvas;
            c.resize(this.width, this.height);
            c.fillStyle = this.backgroundColor;
            c.fillRoundRect(2, 2, this.width-4, this.height-4, 10);
            c.strokeStyle   = "rgba(100,100,100,0.75)";
            c.lineWidth     = 2;
            c.strokeRoundRect(2, 2, this.width-4, this.height-4, 10);
            
            // テカリ
            c.roundRect(2, 2, this.width-4, this.height-4, 10);
            c.clip();
            
            var grad = tm.graphics.LinearGradient(0, 0, 0, this.height);
            
            // grad.addColorStop(0.0, "hsl(  0, 75%, 50%)");
            // grad.addColorStop(0.5, "hsl(120, 75%, 50%)");
            // grad.addColorStop(1.0, "hsl(240, 75%, 50%)");
            grad.addColorStop(0.0, "rgba(255,255,255,0.9)");
            grad.addColorStop(0.5, "rgba(255,255,255,0.5)");
            grad.addColorStop(0.51, "rgba(255,255,255,0.2)");
            grad.addColorStop(1.0, "rgba(255,255,255,0.0)");
            c.setGradient(grad);
            c.fillRect(2, 2, this.width-4, this.height-4, 10);
            
            // ラベルのサイズをリセット
            this.label.setSize(this.width, this.height);
        },
    });

    /**
     * @static
     * @property
     * デフォルトとなるアルファ値
     */
    tm.ui.GlossyButton.DEFAULT_ALPHA = 0.5;
    
    
})();


(function() {

    /**
     * @class tm.ui.FlatButton
     * フラットデザインのボタン
     * @extends tm.display.Shape
     */
    tm.define("tm.ui.FlatButton", {
        superClass: "tm.ui.BaseButton",

        /**
         * @constructor
         */
        init: function(param) {
            param = (param || {}).$safe(tm.ui.FlatButton.defaults);

            this.superInit(param);

            this.shape = tm.display.RoundRectangleShape(param).addChildTo(this);

            this.label = tm.display.Label(param.text).addChildTo(this);
            this.label.setFontSize(param.fontSize).setFontFamily(param.fontFamily).setAlign("center").setBaseline("middle");
        },
    });

    tm.ui.FlatButton.defaults = {
        width: 300,
        height: 100,
        fillStyle: "hsl(180, 60%, 50%)",
        strokeStyle: "transparent",
        text: "START",
        fontSize: 50,
        cornerRadius: 8,
        fontFamily: "'ヒラギノ角ゴ Pro W3', 'Hiragino Kaku Gothic Pro', 'メイリオ', 'Meiryo', 'ＭＳ Ｐゴシック', 'MS PGothic', sans-serif",
    };

})();




/*
 * menudialog.js
 */

(function() {
    
    /**
     * @class tm.ui.MenuDialog
     * メニューダイアログ
     * @extends tm.app.Scene
     */
    tm.define("tm.ui.MenuDialog", {
        superClass: tm.app.Scene,

        /** @type {string} タイトル */
        titleText: null,
        /** @type {Array.<string>} メニュー名リスト */
        menu: null,
        /** @type {Array.<string>} メニュー詳細リスト */
        descriptions: null,
        /** @type {boolean} exit の表示/非表示 */
        showExit: false,

        /** @type {tm.display.Label} dummy */
        title: null,
        /** @type {Array.<tm.ui.LabelButton>} dummy */
        selections: [],
        /** @type {tm.display.Label} dummy */
        description: null,
        /** @type {tm.display.RectangleShape} dummy */
        box: null,
        /** @type {tm.display.RectangleShape} dummy */
        cursor: null,

        /** @private */
        _selected: 0,
        /** @private */
        _opened: false,
        /** @private */
        _finished: false,

        /** @private */
        _screenWidth: 0,
        /** @private */
        _screenHeight: 0,

        /**
         * @constructor
         * @param {Object} params
         */
        init: function(params) {
            this.superInit();

            this._screenWidth = params.screenWidth;
            this._screenHeight = params.screenHeight;

            this.titleText = params.title;
            this.menu = [].concat(params.menu);
            this._selected = ~~params.defaultSelected;
            this.showExit = !!params.showExit;
            if (params.menuDesctiptions) {
                this.descriptions = params.menuDesctiptions;
            } else {
                this.descriptions = [].concat(params.menu);
            }

            if (this.showExit) {
                this.menu.push("exit");
                this.descriptions.push("前の画面へ戻ります");
            }

            var height = Math.max((1+this.menu.length)*50, 50) + 40;
            this.box = tm.display.RectangleShape(this._screenWidth * 0.8, height, {
                strokeStyle: "rgba(0,0,0,0)",
                fillStyle: "rgba(43,156,255, 0.8)",
            }).setPosition(this._screenWidth*0.5, this._screenHeight*0.5);
            this.box.width = 1;
            this.box.height = 1;
            this.box.setBoundingType("rect");
            this.box.tweener
                .to({ width: this._screenWidth*0.8, height: height }, 200, "easeOutExpo")
                .call(this._onOpen.bind(this));
            this.box.addChildTo(this);

            this.description = tm.display.Label("", 14)
                .setAlign("center")
                .setBaseline("middle")
                .setPosition(this._screenWidth*0.5, this._screenHeight-10)
                .addChildTo(this);
        },

        /**
         * @private
         */
        _onOpen: function() {
            var self = this;
            var y = this._screenHeight*0.5 - this.menu.length * 25;

            this.title = tm.display.Label(this.titleText, 30)
                .setAlign("center")
                .setBaseline("middle")
                .setPosition(this._screenWidth*0.5, y)
                .addChildTo(this);

            this.cursor = this._createCursor();

            this.selections = this.menu.map(function(text, i) {
                var self = this;
                y += 50;
                var selection = tm.ui.LabelButton(text)
                    .setPosition(this._screenWidth*0.5, y)
                    .addChildTo(this);
                selection.interactive = true;
                selection.addEventListener("click", function() {
                    if (self._selected === i) {
                        self.closeDialog(self._selected);
                    } else {
                        self._selected = i;
                        var e = tm.event.Event("menuselect");
                        e.selectValue = self.menu[self._selected];
                        e.selectIndex = i;
                        self.dispatchEvent(e);
                    }
                });
                selection.width = this._screenWidth * 0.7;
                return selection;
            }.bind(this));

            this.cursor.y = this.selections[this._selected].y;

            this._opened = true;

            // close window when touch bg outside
            this.addEventListener("pointingend", function(e) {
                var p = e.app.pointing;
                if (!self.box.isHitPoint(p.x, p.y)) {
                    self.closeDialog(self._selected);
                }
            });

            // dispatch opened event
            var e = tm.event.Event("menuopened");
            this.dispatchEvent(e);
        },

        /**
         * @private
         */
        _createCursor: function() {
            var cursor = tm.display.RectangleShape(this._screenWidth*0.7, 30, {
                strokeStyle: "rgba(0,0,0,0)",
                fillStyle: "rgba(12,79,138,1)"
            }).addChildTo(this);
            cursor.x = this._screenWidth*0.5;
            cursor.target = this._selected;
            
            cursor.update = function() {
                if (this.target !== this.parent._selected) {
                    this.target = this.parent._selected;
                    this.tweener.clear();
                    this.tweener.to({
                        y: this.parent.selections[this.parent._selected].y
                    }, 200, "easeOutExpo");
                }
            };

            return cursor;
        },

        /**
         * 更新
         */
        update: function(app) {
            this.description.text = this.descriptions[this._selected];
        },

        /**
         * 閉じる
         */
        closeDialog: function(result) {
            this._finished = true;

            var e = tm.event.Event("menuselected");
            e.selectIndex = result;
            this.dispatchEvent(e);

            this.tweener
                .clear()
                .wait(200)
                .call(function() {
                    this.cursor.remove();
                    this.title.remove();
                    this.selections.each(function(sel) {
                        sel.remove();
                    });
                    this.box.tweener.clear();
                    this.box.tweener
                        .to({ width: 1, height: 1 }, 200, "easeInExpo")
                        .call(function() {
                            this.app.popScene();
                            var e = tm.event.Event("menuclosed");
                            e.selectIndex = result;
                            this.dispatchEvent(e);
                        }.bind(this));
                }.bind(this));
            this.cursor.tweener
                .clear()
                .call(function() {
                    this.visible = !this.visible;
                }.bind(this.cursor))
                .setLoop(true);
        },

        /**
         * 描画
         */
        draw: function(canvas) {
            canvas.fillStyle = "rgba(0,0,0,0.8)";
            canvas.fillRect(0,0,this._screenWidth,this._screenHeight);
        },

    });

})();

/*
 * sketch.js
 */

;(function() {
    
    var DEFAULT_PARAM = {
        bgColor: "rgba(255, 255, 255, 1.0)",
        penColor: "rgba(0, 0, 0, 1.0)",
        lineWidth: 16,
    };
    
    /**
     * @class tm.ui.Sketch
     * Sketch
     * @extends tm.display.Shape
     */
    tm.define("tm.ui.Sketch", {
        superClass: "tm.display.Shape",
        
        /**
         * @constructor
         */
        init: function(param) {
            param = this._dirtyCheckParam.apply(this, arguments);
            param.$safe(DEFAULT_PARAM);
            this.superInit(param);
            
            this.autoRender = false;
            
            this._setup(param);
        },
        
        _setup: function(param) {
            var self = this;
            
            // setup this
            this.boundingType = "rect";
            this.setInteractive(true);
            
            // setup canvas
            var c = this.canvas.context;
            c.lineCap  = "round";
            c.lineJoin = "round";
            c.miterLimit = 10.0;
            this.bgColor = param.bgColor;
            this.penColor = param.penColor;
            this.lineWidth = param.lineWidth;
            
            // setup event
            this.on("pointingstart", function(e) {
                var p = e.app.pointing;
                
                self._drawPoint(p.position);
            });
            this.on("pointingmove", function(e) {
                var p = e.app.pointing;
                self._drawLine(p.prevPosition, p.position);
                self.points.push({
                    x: p.x-this.left,
                    y: p.y-this.top,
                });
            });
            this.on("pointingend", function(e) {
                self.pointsList.push(self.points);
                self.points = [];
            });

            // ポイントスタック
            this.pointsList = [];
            this.points = [];
        },
        
        /**
         * 画面をbgColor色でクリアする
         */
        clear: function() {
            this.canvas.clear();
            this.canvas.clearColor(this.bgColor);

            this.pointsList = [];
            this.points = [];
            
            return this;
        },
        
        _drawPoint: function(p) {
            this.canvas.drawPoint(p.x-this.left, p.y-this.top);
        },
        
        _drawLine: function(p, prev) {
            this.canvas.drawLine(
                p.x-this.left, p.y-this.top,
                prev.x-this.left, prev.y-this.top
            );
        },
        
    });

    /**
     * @property    penColor
     * penColor
     */
    tm.ui.Sketch.prototype.accessor("penColor", {
        "get": function()   { return this._penColor; },
        "set": function(v)  {
            this._penColor = v;
            this.canvas.strokeStyle = v;
        }
    });
    
    /**
     * @property    bgColor
     * bgColor
     */
    tm.ui.Sketch.prototype.accessor("bgColor", {
        "get": function()   { return this._bgColor; },
        "set": function(v)  {
            this._bgColor = v;
            this.clear();
        }
    });
    
    /**
     * @property    lineWidth
     * lineWidth
     */
    tm.ui.Sketch.prototype.accessor("lineWidth", {
        "get": function()   { return this._lineWidth; },
        "set": function(v)  {
            this._lineWidth = v;
            this.canvas.lineWidth = v;
        }
    });

    
})();


/*
 *  gauge.js
 */



(function() {

    /**
     * @class tm.ui.Gauge
     * ゲーム用ゲージクラス
     * @extends tm.display.CanvasElement
     */
    tm.ui.Gauge = tm.createClass({
        superClass: tm.display.CanvasElement,
        
        
        /**
         * アニメーションさせるかどうかのフラグ
         */
        animationFlag: true,
        /**
         * 0~100 に変化する際にかかる時間
         * つまり10*1000 だった場合は, 0~10に変化するさいに　1秒かかる
         */
        animationTime: 10*1000, // 10 秒

        /**
         * @constructor
         */
        init: function(param) {
            this.superInit();
            
            param = param || {};
            param.$safe({
                width: 300,
                height: 25,
                color: "hsl(220, 100%, 50%)",
                bgColor: "#444",
                borderColor: "white",
                borderWidth: 4,
            });
            
            this.$extend(param);
            
            this._reset();
        },

        /**
         * 満タンかをチェック
         */
        isFull: function() {
            return this._value === this._maxValue;
        },

        /**
         * 空っぽかをチェック
         */
        isEmpty: function() {
            return this._value == 0;
        },

        /**
         * @private
         */
        _reset: function(direction) {
            this.originX = 0;
            this._value = 100;
            this._value = this._maxValue = 100;
        },

        /**
         * 値をセット
         */
        setValue: function(value) {
            value= Math.clamp(value, 0, this._maxValue);

            this._realValue = value;
            
            // end when now value equal value of argument
            if (this._value === value) return ;
            
            // fire value change event
            this.fire(tm.event.Event("change"));
            
            if (this.isAnimation()) {
                this.tweener.clear();

                var time = (Math.abs(this._value-value)/100)*this.animationTime;
                this.tweener.clear()
                    .to({ "_value":value }, time)
                    .call(function() {
                        this.fire(tm.event.Event("changed"));

                        if (this.isEmpty()) {
                            this.fire(tm.event.Event("empty"));
                        }
                        else if (this.isFull()) {
                            this.fire(tm.event.Event("full"));
                        }
                    }.bind(this));
            }
            else {
                this._value = value;
                this.fire(tm.event.Event("changed"));
                
                if (this.isEmpty()) {
                    this.fire(tm.event.Event("empty"));
                }
                else if (this.isFull()) {
                    this.fire(tm.event.Event("full"));
                }
            }
            
            return this;
        },

        /**
         * 値をゲット
         */
        getValue: function() {
            return this.value;
        },

        /**
         * 値を％でセット
         */
        setPercent: function(percent) {
            return this.setValue(this._maxValue*percent*0.01);
        },

        /**
         * 値を％でゲット
         */
        getPercent: function() {
            return (this._value/this._maxValue)*100;
        },

        /**
         * 値を比率でセット
         */
        setRatio: function(ratio) {
            return this.setValue(this._maxValue*ratio);
        },

        /**
         * 値を比率でゲット
         */
        getRatio: function() {
            return this._value/this._maxValue;
        },
        
        isAnimation: function() {
            return this.animationFlag;
        },
        
        draw: function(canvas) {
            canvas.save();
            
            // bg
            canvas.fillStyle = this.bgColor;
            canvas.fillRect(0, 0, this.width, this.height);
            
            // bar
            canvas.fillStyle = this.color;
            canvas.fillRect(0, 0, this.width*this.getRatio(), this.height);
            
            // border
            canvas.strokeStyle = this.borderColor;
            canvas.lineWidth = this.borderWidth;
            canvas.strokeRect(0, 0, this.width, this.height);
            
            canvas.restore();
        }
    });
    
    /**
     * @property    value
     * 値
     */
    tm.ui.Gauge.prototype.accessor("value", {
        get: function() {
            return this._value;
        },
        set: function(v) {
            this.setValue(v);
        },
    });

    /**
     * @property    percent
     * パーセント
     */
    tm.ui.Gauge.prototype.accessor("percent", {
        get: function() {
            return this.getPercent();
        },
        set: function(v) {
            this.setPercent(v);
        },
    });
    
    
    /**
     * @property    ratio
     * 比率
     */
    tm.ui.Gauge.prototype.accessor("ratio", {
        get: function() {
            return this.getRatio();
        },
        set: function(v) {
            this.setRatio(v);
        },
    });
    
})();


;(function() {
    
    /**
     * @class tm.ui.FlatGauge
     * ゲーム用ゲージクラス
     * @extends tm.ui.Gauge
     */
    tm.define("tm.ui.FlatGauge", {
        superClass: "tm.ui.Gauge",
        
        /**
         * @constructor
         */
        init: function(param) {
            this.superInit(param);
        },
        
        draw: function(canvas) {
            canvas.save();
            
            canvas.save();
            
            canvas.roundRect(0, 0, this.width, this.height, this.height/2);
            canvas.clip();
            
            // bg
            canvas.fillStyle = this.bgColor;
            canvas.fillRect(0, 0, this.width, this.height);
            
            // bar
            canvas.fillStyle = this.color;
            canvas.fillRect(0, 0, this.width*this.getRatio(), this.height);
            
            canvas.restore();
            
            // border
            canvas.strokeStyle = this.borderColor;
            canvas.lineWidth = this.borderWidth;
            canvas.strokeRoundRect(0, 0, this.width, this.height, this.height/2);
            
            canvas.restore();
        },
    });
    
})();



;(function() {
    
    /**
     * @class tm.ui.GlossyGauge
     * ゲーム用ゲージクラス
     * @extends tm.ui.Gauge
     */
    tm.define("tm.ui.GlossyGauge", {
        superClass: "tm.ui.Gauge",
        
        init: function(param) {
            param = param || {};
            param.borderWidth = param.borderWidth || 2;
            this.superInit(param);
        },
        
        /**
         * @constructor
         */
        draw: function(c) {
            c.save();
            
            // clip
            c.roundRect(0, 0, this.width, this.height, this.height/2);
            c.clip();
            
            // bg
            c.fillStyle = this.bgColor;
            c.fillRect(0, 0, this.width, this.height);
            
            // bar
            c.fillStyle = this.color;
            c.fillRect(0, 0, this.width*this.getRatio(), this.height);
            var grad = tm.graphics.LinearGradient(0, 0, 0, this.height);
            grad.addColorStop(0.0,  "rgba(255,255,255,0.9)");
            grad.addColorStop(0.5,  "rgba(255,255,255,0.5)");
            grad.addColorStop(0.51, "rgba(255,255,255,0.2)");
            grad.addColorStop(1.0,  "rgba(255,255,255,0.0)");
            c.setGradient(grad);
            c.fillRect(0, 0, this.width*this.getRatio(), this.height);
            
            c.restore();
            
            // border
            c.lineWidth = this.borderWidth;
            c.strokeStyle = this.borderColor;
            c.strokeRoundRect(0, 0, this.width, this.height, this.height/2);
        },
    });
    
})();




;(function() {
    
    /**
     * @class tm.ui.LabelArea
     * @extends tm.display.Shape
     * ラベルエリアクラス
     */
    tm.define("tm.ui.LabelArea", {
        superClass: "tm.display.Shape",
        
        init: function(param) {
            param = param || {};
            this.superInit(param.width || 150, param.height || 60);
            this.canvas.clearColor("red");
            this.$extend({
                mode:         param.mode       || "horizon",
                _fillStyle:   param.fillStyle  || "#aaa",
                _bgColor:     param.bgColor    || "transparent",
                _fontSize:    param.fontSize   || 24,
                _fontFamily:  param.fontFamily || "'Consolas', 'Monaco', 'ＭＳ ゴシック'",
                _fontWeight:  param.fontWeight || "",
                lineSpace:    param.lineSpace  || 1, // 行間, 文字サイズ(px)に対する倍率
            });
            this._updateFont();
            this.setText(param.text || "こんにちは,世界!");
        },
        
        setText: function(text) {
            if (this._text === text) { return ; }
            
            this._text =  text;
            
            this._renderText();
        },
        
        _renderText: function() {
            this.canvas.width  =this.width;
            this.canvas.height =this.height;
            
            this.canvas.clearColor(this.bgColor);
            
            this.canvas.font = this.fontStyle;
            this.canvas.fillStyle = this.fillStyle;
            this.canvas.fillLabelArea({
                text: this._text,
                x: 0,
                y: 0,
                width: this.width,
                height: this.height,
                mode: this.mode,
                lineSpace: this.lineSpace,
            });
        },

        /**
         * @private
         */
        _updateFont: function() {
            this.fontStyle = "{fontWeight} {fontSize}px {fontFamily}".format(this);
            if (this.text) {
                this._renderText();
            }
        },
    });
    
    
    /**
     * @property    text
     * 文字
     */
    tm.ui.LabelArea.prototype.accessor("text", {
        "get": function() { return this._text; },
        "set": function(v){
            this.setText(v);
        }
    });
    
    /**
     * @property    fontSize
     * フォントサイズ
     */
    tm.ui.LabelArea.prototype.accessor("fontSize", {
        "get": function() { return this._fontSize; },
        "set": function(v){ this._fontSize = v; this._updateFont(); }
    });
    
    /**
     * @property    fontFamily
     * フォント
     */
    tm.ui.LabelArea.prototype.accessor("fontFamily", {
        "get": function() { return this._fontFamily; },
        "set": function(v){ this._fontFamily = v; this._updateFont(); }
    });
    
    /**
     * @property    fontWeight
     */
    tm.ui.LabelArea.prototype.accessor("fontWeight", {
        "get": function() { return this._fontWeight; },
        "set": function(v) {
            this._fontWeight = v; this._updateFont();
        },
    });
    
    /**
     * @property    fillStyle
     */
    tm.ui.LabelArea.prototype.accessor("fillStyle", {
        "get": function() { return this._fillStyle; },
        "set": function(v) {
            this._fillStyle = v; this._updateFont();
        },
    });
    
    /**
     * @property    bgColor
     */
    tm.ui.LabelArea.prototype.accessor("bgColor", {
        "get": function() { return this._bgColor; },
        "set": function(v) {
            this._bgColor = v; this._updateFont();
        },
    });

    /**
     * @property    width
     * dummy
     */
    tm.ui.LabelArea.prototype.accessor("width", {
        "get": function() { return this._width; },
        "set": function(v){
            this._width = v;
            if (this.text) {
                this._renderText();
            }
        }
    });
    
    /**
     * @property    height
     * dummy
     */
    tm.ui.LabelArea.prototype.accessor("height", {
        "get": function() { return this._height; },
        "set": function(v){
            this._height = v;
            if (this.text) {
                this._renderText();
            }
        }
    });

    
})();


;(function() {

    tm.game = tm.game || {};


    tm.game.setup = function(param) {
        param.$safe({
            query: "#world",
            title: "Title",
            background: "rgba(250, 250, 250, 1.0)",
            width: 640,
            height: 960,
            startLabel: 'title',
            fitting: true,
            fps: 30,
            assets: window.ASSETS || null,
        });

        tm.globalize();

        this.expand(param);

        var scenes = [
            {
                className: "SplashScene",
                arguments: {
                    width: param.width,
                    height: param.height,
                },
                label: "splash",
                nextLabel: "title",
            },
            {
                className: "TitleScene",
                arguments: {
                    title: param.title,
                },
                label: "title",
            },
            {
                className: "GameScene",
                label: "game",
                nextLabel: "result",
            },
            {
                className: "ResultScene",
                arguments: {
                    message: param.title,
                },
                label: "result",
                nextLabel: "title",
            },

            {
                className: "PauseScene",
                label: "pause",
            },
        ];

        tm.main(function() {
            var app = tm.app.CanvasApp(param.query);    // 生成
            app.resize(SCREEN_WIDTH, SCREEN_HEIGHT);    // サイズ(解像度)設定
            if (param.fitting) { app.fitWindow(); }     // 自動フィッティング有効
            app.background = param.background;          // 背景色
            app.fps = param.fps;                        // fps

            if (param.assets) {
                var loading = tm.game.LoadingScene({
                    assets: param.assets,
                    width: SCREEN_WIDTH,
                    height: SCREEN_HEIGHT,
                });
                loading.onload = function() {
                    app.replaceScene(tm.game.ManagerScene({
                        startLabel: param.startLabel,
                        scenes: scenes,
                    }));
                };
                app.replaceScene(loading);
            }
            else {
                app.replaceScene(tm.game.ManagerScene({
                    startLabel: param.startLabel,
                    scenes: scenes,
                }));
            }

            app.run();

            tm.game.app = app;
        });
    };

    tm.game.expand = function(param) {
        tm.global.$extend({
            SCREEN_WIDTH: param.width,
            SCREEN_HEIGHT: param.height,
            SCREEN_CENTER_X: param.width/2,
            SCREEN_CENTER_Y: param.height/2,
            SCREEN_GRID_X: GridSystem(param.width, 16),
            SCREEN_GRID_Y: GridSystem(param.height, 16),
            QUERY: tm.util.QueryString.parse(location.search.substr(1)),
        });

    };

})();

/*
 * TitleScene
 */


(function() {

    tm.define("tm.game.TitleScene", {
        superClass: "tm.app.Scene",

        init: function(param) {
            this.superInit();

            param = {}.$extend(tm.game.TitleScene["default"], param);
            this.param = param;

            this.fromJSON({
                children: {
                    bg: {
                        type: "tm.display.RectangleShape",
                        init: {
                            width: param.width,
                            height: param.height,
                            fillStyle: param.bgColor,
                            strokeStyle: "transparent",
                        },
                        originX: 0,
                        originY: 0,
                    }
                }
            });

            if (param.bgImage) {
                this.fromJSON({
                    children: {
                        bgImage: {
                            type: "tm.display.Sprite",
                            init: [param.bgImage],
                            originX: 0,
                            originY: 0,
                        }
                    }
                });
            }

            this.fromJSON({
                children: {
                    titleLabel: {
                        type: "Label", name: "titleLabel",
                        text: param.title,
                        x: this._toGridX(6),
                        y: this._toGridY(3),
                        fillStyle: param.fontColor,
                        fontSize: param.fontSize,
                        fontFamily: "'Helvetica-Light' 'Meiryo' sans-serif",
                        align: "center",
                        baseline: "middle",
                    },
                    messageLabel: {
                        type: "Label", name: "nextLabel",
                        text: param.message || "",
                        x: this._toGridX(6),
                        y: this._toGridY(6),
                        fillStyle: param.fontColor,
                        fontSize: param.fontSize*0.36,
                        fontFamily: "'Helvetica-Light' 'Meiryo' sans-serif",
                        align: "center",
                        baseline: "middle",
                    },
                    touchLabel: {
                        type: "Label", name: "nextLabel",
                        text: "TOUCH START",
                        x: this._toGridX(6),
                        y: this._toGridY(9),
                        fillStyle: param.fontColor,
                        fontSize: param.fontSize*0.4,
                        fontFamily: "'Helvetica-Light' 'Meiryo' sans-serif",
                        align: "center",
                        baseline: "middle",
                    }
                }
            });

            this.touchLabel.tweener
                .fadeOut(500)
                .fadeIn(1000)
                .setLoop(true);

            this.autopop = param.autopop;
        },

        _toGridX: function(index) {
            return this.param.width/12*index;
        },

        _toGridY: function(index) {
            return this.param.height/12*index;
        },

        onpointingstart: function() {
            this.flare("finish");

            if (this.autopop) {
                this.app.popScene();
            }
        },
    });

    tm.game.TitleScene["default"] = {
        title: "Time is money",
        message: "",
        fontSize: 72,
        fontColor: "#444",
        width: 640,
        height: 960,
        bgColor: "rgb(240,240,240)",
        bgImage: null,
        autopop: true,
    };

})();


/*
 * ResultScene
 */


(function() {

    tm.define("tm.game.ResultScene", {
        superClass: "tm.app.Scene",

        init: function(param) {
            this.superInit();

            param = {}.$extend(tm.game.ResultScene["default"], param);
            this.param = param;

            var userData = this._getUserData();
            var bestScore = (userData.bestScore) ? userData.bestScore : 0;
            var highScoreFlag = (param.score > bestScore);

            if (param.record) {
                if (highScoreFlag) {
                    userData.bestScore = param.score;
                    this._record(userData);
                }
            }

            this.fromJSON({
                children: {
                    bg: {
                        type: "tm.display.RectangleShape",
                        init: {
                            width: param.width,
                            height: param.height,
                            fillStyle: param.bgColor,
                            strokeStyle: "transparent",
                        },
                        originX: 0,
                        originY: 0,
                    }
                }
            });

            if (param.bgImage) {
                this.fromJSON({
                    children: {
                        bgImage: {
                            type: "tm.display.Sprite",
                            init: [param.bgImage],
                            originX: 0,
                            originY: 0,
                        }
                    }
                });
            }

            var baseLabelParam = {
                type: "Label",
                fillStyle: param.fontColor,
                fontFamily: "'Helvetica-Light' 'Meiryo' sans-serif",
            };

            this.fromJSON({
                children: {
                    scoreText: baseLabelParam.$extend({
                        text: "score",
                        x: this._toGridX(4),
                        y: this._toGridY(3),
                        fontSize: param.fontSize*0.5,
                    }),
                    scoreLabel: {
                        type: "Label",
                        text: param.score,
                        x: this._toGridX(4),
                        y: this._toGridY(4),
                        fillStyle: param.fontColor,
                        fontSize: param.fontSize,
                        fontFamily: "'Helvetica-Light' 'Meiryo' sans-serif",
                    },
                    bestText: {
                        type: "Label",
                        text: "best",
                        x: this._toGridX(8),
                        y: this._toGridY(3),
                        fillStyle: param.fontColor,
                        fontSize: param.fontSize*0.5,
                        fontFamily: "'Helvetica-Light' 'Meiryo' sans-serif",
                    },
                    bestLabel: {
                        type: "Label",
                        text: bestScore,
                        x: this._toGridX(8),
                        y: this._toGridY(4),
                        fillStyle: param.fontColor,
                        fontSize: param.fontSize,
                        fontFamily: "'Helvetica-Light' 'Meiryo' sans-serif",
                    },

                    newRecordText: {
                        type: "Label",
                        text: "new record!",
                        x: this._toGridX(6),
                        y: this._toGridY(6),
                        fillStyle: param.fontColor,
                        fontSize: param.fontSize*0.5,
                        fontFamily: "'Helvetica-Light' 'Meiryo' sans-serif",
                        visible: false,
                    },

                    messageText: {
                        type: "Label",
                        text: param.message,
                        x: this._toGridX(6),
                        y: this._toGridY(7),
                        fillStyle: param.fontColor,
                        fontSize: param.fontSize*0.5,
                        fontFamily: "'Helvetica-Light' 'Meiryo' sans-serif",
                    },

                    shareButton: {
                        type: "FlatButton",
                        init: {
                            text: "Share",
                            width: 200,
                            fillStyle: "hsl(240, 100%, 64%)",
                        },
                        x: this._toGridX(4),
                        y: this._toGridY(9),
                    },
                    backButton: {
                        type: "FlatButton",
                        init: {
                            text: "Back",
                            width: 200,
                            fillStyle: "hsl(240, 80%, 0%)",
                        },
                        x: this._toGridX(8),
                        y: this._toGridY(9),
                    }
                }
            });

            // setup tweet
            var text = "SCORE: {score}, {message}".format(param);
            var twitterURL = tm.social.Twitter.createURL({
                type    : "tweet",
                text    : text,
                hashtags: param.hashtags,
                url     : param.url, // or window.document.location.href
            });
            this.shareButton.onclick = function() {
                window.open(twitterURL, 'share window', 'width=400, height=300');
            };

            // setup back
            this.backButton.onpointingstart = this._back.bind(this);
            this.autopop = param.autopop;

            // setup record
            if (highScoreFlag) {
                this.newRecordText.show();
                this.newRecordText.tweener
                    .set({alpha:0.0})
                    .fadeIn(2000)
                    .setLoop(true)
                    ;
            }
        },

        _getUserData: function() {
            var key = location.pathname.toCRC32();
            var data = localStorage.getItem(key);
            return (data) ? JSON.parse(data) : {};
        },

        _record: function(data) {
            var key = location.pathname.toCRC32();
            var dataString = JSON.stringify(data);
            localStorage.setItem(key, dataString);
            return this;
        },

        _toGridX: function(index) {
            return this.param.width/12*index;
        },

        _toGridY: function(index) {
            return this.param.height/12*index;
        },

        _back: function() {
            this.flare("finish");

            if (this.autopop) {
                this.app.popScene();
            }
        },
    });

    tm.game.ResultScene["default"] = {
        score: 0,
        message: "this is tmlib.js project.",
        hashtags: "tmlibjs,game",
        related: "tmlib.js tmlife javascript",
        url: "http://phi-jp.github.io/tmlib.js/",

        width: 640,
        height: 960,
        fontColor: "#444",
        fontSize: 90,
        bgColor: "rgba(255,255,255, 0.9)",
        bgImage: null,
        record: true,
        autopop: true,
    };

})();


/*
 * loadingscene.js
 */


;(function() {
    
    var DEFAULT_PARAM = {
        width: 465,
        height: 465,
        bgColor: "transparent",
    };
    
    tm.define("tm.game.LoadingScene", {
        superClass: "tm.app.Scene",
        
        init: function(param) {
            this.superInit();
            
            this.param = param = {}.$extend(DEFAULT_PARAM, param);

            this.fromJSON({
                children: {
                    stage: {
                        type: "tm.display.CanvasElement",
                    },
                }
            });

            this.stage.fromJSON({
                children: {
                    bg: {
                        type: "tm.display.Shape",
                        init: {
                            width: param.width,
                            height: param.height,
                        },
                        originX: 0,
                        originY: 0,
                    },
                    piyoLayer: {
                        type: "tm.display.CanvasElement",
                    },
                    label: {
                        type: "tm.display.Label",
                        text: "LOADING",
                        x: param.width/2,
                        y: param.height/2-20,
                        align: "center",
                        baseline: "middle",
                        fontSize: 46,
                        shadowBlur: 4,
                        shadowColor: "hsl(190, 100%, 50%)",
                    },
                    // piyo: {
                    //     type: "tm.display.Shape",
                    //     init: [84, 84],
                    // },
                    bar: {
                        type: "tm.ui.Gauge",
                        init: [{
                            width: param.width,
                            height: 10,
                            color: "hsl(200, 100%, 80%)",
                            bgColor: "transparent",
                            borderColor: "transparent",
                            borderWidth: 0,
                        }],
                        x: 0,
                        y: 0,
                    },
                }
            });
            
            // bg
            var bg = this.stage.bg;
            bg.canvas.clearColor(param.bgColor);

            // label
            var label = this.stage.label;
            label.tweener
                .to({alpha:1}, 1000)
                .to({alpha:0.5}, 1000)
                .setLoop(true)

            // bar
            var bar = this.stage.bar;
            bar.animationFlag = false;
            bar.value = 0;
            bar.animationFlag = true;
            bar.animationTime = 100;
            
            // ひよこさん
            this._createHiyoko(param).addChildTo(this.stage.piyoLayer);

            // load
            var stage = this.stage;
            stage.alpha = 0.0;
            stage.tweener.clear().fadeIn(100).call(function() {
                if (param.assets) {
                    var loader = tm.asset.Loader();
                    loader.onload = function() {
                        stage.tweener.clear().wait(200).fadeOut(200).call(function() {
                            if (param.nextScene) {
                                this.app.replaceScene(param.nextScene());
                            }
                            var e = tm.event.Event("load");
                            this.fire(e);

                            if (param.autopop == true) {
                                this.app.popScene();
                            }
                        }.bind(this));
                    }.bind(this);
                    
                    loader.onprogress = function(e) {
                        // update bar
                        bar.value = e.progress*100;

                        // dispatch event
                        var event = tm.event.Event("progress");
                        event.progress = e.progress;
                        this.fire(event);
                    }.bind(this);
                    
                    loader.load(param.assets);
                }
            }.bind(this));
        },

        onpointingstart: function(app) {
            // ひよこさん生成
            var p = app.pointing;
            var piyo = this._createHiyoko(this.param).addChildTo(this.stage.piyoLayer);
            piyo.x = p.x;
            piyo.y = p.y;
        },

        _createHiyoko: function(param) {
            // ひよこさん
            var piyo = tm.display.Shape({
                width: 84,
                height: 84,
            });
            piyo.x = tm.util.Random.randint(0, param.width);
            piyo.y = tm.util.Random.randint(0, param.height);
            piyo.canvas.setColorStyle("white", "yellow").fillCircle(42, 42, 32);
            piyo.canvas.setColorStyle("white", "black").fillCircle(27, 27, 2);
            piyo.canvas.setColorStyle("white", "brown").fillRect(40, 70, 4, 15).fillTriangle(0, 40, 11, 35, 11, 45);
            piyo.dir = tm.geom.Vector2.random(0, 360, 4);
            var rect = tm.geom.Rect(0, 0, param.width, param.height);
            rect.padding(42);
            piyo.update = function(app) {
                this.position.add(this.dir);

                if (this.x < rect.left) {
                    this.x = rect.left;
                    this.dir.x*=-1;
                }
                else if (this.x > rect.right) {
                    this.x = rect.right;
                    this.dir.x*=-1;
                }
                if (this.y < rect.top) {
                    this.y = rect.top;
                    this.dir.y*=-1;
                }
                else if (this.y > rect.bottom) {
                    this.y = rect.bottom;
                    this.dir.y*=-1;
                }

                if (this.dir.x<0) {
                    this.rotation -= 7;
                    this.scaleX = 1;
                }
                else {
                    this.rotation += 7;
                    this.scaleX = -1;
                }

                // // 向き更新
                // if (app.pointing.getPointingStart()) {
                //     var p = app.pointing.position;
                //     var v = tm.geom.Vector2.sub(p, this.position);
                //     this.dir = v.normalize().mul(4);
                // }

            };

            return piyo;
        },
    });
    
})();






/*
 * splash
 */

;(function() {
    var SPLASH_IMAGE_PATH = "https://files.gitter.im/phi-jp/tmlib.js/t5F7/splash.png";

    tm.define("SplashScene", {
        superClass: "tm.app.Scene",

        init: function(param) {
            this.superInit();

            this.param = param;

            this.splashImage = tm.asset.Texture(param.path || SPLASH_IMAGE_PATH);
            this.splashImage.onload = this._init.bind(this);
        },

        _init: function() {
            var width = this.param.width;
            var height = this.param.height;
            
            tm.display.Shape({
                width: width,
                height: height,
                bgColor: "white"
            }).setOrigin(0, 0).addChildTo(this);

            tm.display.Sprite(this.splashImage, width, height)
                .setOrigin(0, 0)
                .setAlpha(0)
                .addChildTo(this)
                .tweener
                    .clear()
                    .wait(250)
                    .fadeIn(500)
                    .wait(1000)
                    .fadeOut(500)
                    .wait(250)
                    .call(function() {
                        this.app.popScene();
                    }.bind(this));
        },
    });
})();


/*
 *
 */

;(function() {

    /**
     * @class tm.game.ManagerScene
     * マネージャーシーン
     * @extends tm.app.Scene
     */
    tm.define("tm.game.ManagerScene", {
        superClass: "tm.app.Scene",

        /**
         * @constructor
         */
        init: function(param) {
            this.superInit();

            this.setScenes(param.scenes);

            this.on("enter", function() {
                this.gotoScene(param.startLabel || 0);
            }.bind(this));

            this.on("resume", this.onnext.bind(this));

            this.commonArguments = {};
        },

        /**
         * scenes をセット
         */
        setScenes: function(scenes) {
            this.scenes = scenes;
            this.sceneIndex = 0;

            return this;
        },

        /**
         * index(or label) のシーンへ飛ぶ
         */
        gotoScene: function(index, args) {
            index = (typeof index == 'string') ? this.labelToIndex(index) : index||0;

            // イベント発火
            var e = tm.event.Event("prepare");
            this.fire(e);

            var data = this.scenes[index];
            var klass = tm.using(data.className);
            var initArguments = data.arguments;
            var initArguments = {}.$extend(initArguments, args);
            var scene = klass.call(null, initArguments);
            if (!scene.nextLabel) {
                scene.nextLabel = data.nextLabel;
            }
            if (!scene.nextArguments) {
                scene.nextArguments = data.nextArguments;
            }
            this.app.pushScene(scene);

            this.sceneIndex = index;
            this.currentScene = scene;

            // イベント発火
            var e = tm.event.Event("goto");
            e.scene = scene;
            this.fire(e);

            return this;
        },

        /**
         * 次のシーンへ飛ぶ
         */
        gotoNext: function(args) {
            var data = this.scenes[this.sceneIndex];
            var nextIndex = null;

            // 次のラベルが設定されていた場合
            if (data.nextLabel) {
                nextIndex = this.labelToIndex(data.nextLabel);
            }
            // 次のシーンに遷移
            else if (this.sceneIndex+1 < this.scenes.length) {
                nextIndex = this.sceneIndex+1;
            }

            if (nextIndex !== null) {
                this.gotoScene(nextIndex, args);
            }
            else {
                this.fire(tm.event.Event("finish"));
            }

            return this;
        },

        /**
         * シーンインデックスを取得
         */
        getCurrentIndex: function() {
            return this.sceneIndex;
        },

        /**
         * シーンラベルを取得
         */
        getCurrentLabel: function() {
            return this.scenes[this.sceneIndex].label;
        },

        /**
         * ラベルからインデックスに変換
         */
        labelToIndex: function(label) {
            var data = this.scenes.filter(function(data) {
                return data.label == label;
            })[0];

            return this.scenes.indexOf(data);
        },

        /**
         * インデックスからラベルに変換
         */
        indexToLabel: function(index) {
            return this.scenes[index].label;
        },

        onnext: function(e) {
            var nextLabel = e.prevScene.nextLabel;
            var nextArguments = e.prevScene.nextArguments;
            if (nextLabel) {
                this.gotoScene(nextLabel, nextArguments);
            }
            else {
                this.gotoNext(nextArguments);
            }
        },
    });

})();


;(function() {

	tm.define("tm.game.NumericalInputScene", {
		superClass: "tm.app.Scene",

		init: function(param) {
			this.superInit();

			this.fromJSON({
				children: {
					inputLabel: {
						type: "tm.display.Label",
						fillStyle: "white",
						text: "",
						fontSize: 64,
						x: 320,
						y: 120,
					},
					buttonGroup: {
						type: "tm.display.CanvasElement",
					},
				},
			});


			[1, 2, 3, 4, 5, 6, 7, 8, 9, 'C', 0, 'OK'].each(function(n, i) {
				var button = this._createButton(n.toString()).addChildTo(this.buttonGroup);
				var xIndex = i%3;
				var yIndex = (i/3)|0;
				button.x = 190*xIndex + 130;
				button.y = 177*yIndex + 280;
			}, this);

			var self = this;
			var buttons = this.buttonGroup.children;
			buttons.each(function(button) {
				button.setInteractive(true).setBoundingType("circle");
				button.radius = 145/2;
				button.onpointingstart = function() {
					if (this.label.text == 'OK') {
						var e = tm.event.Event("decided");
						e.value = Number(self.inputLabel.text);
						self.fire(e);
					}
					else if (this.label.text == 'C') {
						var e = tm.event.Event("push");
						self.inputLabel.text = "";
						self.flare("clear");
					}
					else {
						self.inputLabel.text += this.label.text;
						self.flare("push", {
							select: this.label.text,
						});
					}
				}
			});
		},

		_createButton: function(n) {
			var button = tm.display.CanvasElement();

			button.fromJSON({
				children: {
					bg: {
						type: "tm.display.CircleShape",
						init: [145, 145, {
							fillStyle: "transparent",
							strokeStyle: "white",
						}],
					},
					label: {
						type: "tm.display.Label",
						text: n,
						fontSize: 64,
						fillStyle: "white",
					},
				},
			});

			return button;
		},
	});

})();

/*
 * countscene.js
 */

;(function() {

    tm.define("tm.game.CountScene", {
        superClass: "tm.app.Scene",

        init: function(param) {
            this.superInit();

            param = param.$safe({
                width: 640,
                height: 960,
                bgColor: '#444',
                count: 3,
                autopop: true,
                fontSize: 180,
            });

            param = param || {};

            this.fromJSON({
                children: {
                    bg: {
                        type: "tm.display.Shape",
                        width: param.width,
                        height: param.height,
                        bgColor: param.bgColor,
                        originX: 0,
                        originY: 0,
                    },
                    label: {
                        type: "tm.display.Label",
                        fillStyle: "white",
                        fontSize: param.fontSize,
                        x: SCREEN_CENTER_X,
                        y: SCREEN_CENTER_Y,
                    },
                }
            });

            if (param.count instanceof Array) {
                this.countList = param.count.reverse();
            }
            else {
                this.countList = Array.range(1, param.count+1);
            }
            this.counter = this.countList.length;
            this.autopop = param.autopop;
            this._updateCount();
        },

        _updateCount: function() {
            var endFlag = this.counter <= 0;
            var index = --this.counter;

            this.label.text = this.countList[index];

            this.label.scale.set(1, 1);
            this.label.tweener
                .clear()
                .to({
                    scaleX: 1,
                    scaleY: 1,
                    alpha: 1,
                }, 250)
                .wait(500)
                .to({
                    scaleX: 1.5,
                    scaleY: 1.5,
                    alpha: 0.0
                }, 250)
                .call(function() {
                    if (this.counter <= 0) {
                        this.flare('finish');
                        if (this.autopop) {
                            this.app.popScene();
                        }
                    }
                    else {
                        this._updateCount();
                    }
                }, this);
        },

    });

})();
/*
 * three.js
 */

tm.three = tm.three || {};


(function() {

    if (!tm.global.THREE) return ;
    
    /**
     * @class tm.three.ThreeApp
     * 3Dライブラリ - Three.jsをtmlib.jsで対応
     * @extends tm.app.BaseApp
     */
    tm.three.ThreeApp = tm.createClass({
        superClass: tm.app.BaseApp,
        
        /** canvas */
        canvas      : null,
        /** canvas */
        background  : null,
        /** @private canvas */
        _scenes      : null,
        /** @private canvas */
        _sceneIndex  : 0,
        
        /**
         * @constructor
         */
        init: function(canvas) {
            if (canvas instanceof HTMLCanvasElement) {
                this.element = canvas;
            }
            else if (typeof canvas == "string") {
                this.element = document.querySelector(canvas);
            }
            else {
                this.element = document.createElement("canvas");
                document.body.appendChild(this.element);
            }

            // 親の初期化
            this.superInit(this.element);

            // レンダラーを生成
//            this.renderer = new THREE.CanvasRenderer({ canvas: this.element });
            this.renderer = new THREE.WebGLRenderer({ canvas: this.element, clearColor: 0x222222, clearAlpha: 1.0 });

            this.renderer.setSize(this.element.width, this.element.height);
            
            // シーン周り
            this._scenes = [ tm.three.Scene() ];
        },
        
        /**
         * @TODO ?
         */
        resize: function(width, height) {
            this.width = width;
            this.height= height;
            this.renderer.setSize(this.width, this.height);
            
            return this;
        },

        /**
         * @TODO ?
         */
        resizeWindow: function() {
            this.width = innerWidth;
            this.height= innerHeight;
            this.renderer.setSize(this.width, this.height);
            
            return this;
        },
        
        /**
         * 画面にフィットさせる
         */
        fitWindow: function(everFlag) {
            // 画面にフィット
            var _fitFunc = function() {
                everFlag = everFlag === undefined ? true : everFlag;
                var e = this.element;
                var s = e.style;
                
                s.position = "absolute";
                s.left = "0px";
                s.top  = "0px";
                
                var rateWidth = e.width/window.innerWidth;
                var rateHeight= e.height/window.innerHeight;
                var rate = e.height/e.width;
                
                if (rateWidth > rateHeight) {
                    s.width  = innerWidth+"px";
                    s.height = innerWidth*rate+"px";
                }
                else {
                    s.width  = innerHeight/rate+"px";
                    s.height = innerHeight+"px";
                }
            }.bind(this);
            
            // 一度実行しておく
            _fitFunc();
            // リサイズ時のリスナとして登録しておく
            if (everFlag) {
                window.addEventListener("resize", _fitFunc, false);
            }
            
            // マウスとタッチの座標更新関数をパワーアップ
            this.mouse._mousemove = this.mouse._mousemoveScale;
            this.touch._touchmove = this.touch._touchmoveScale;
        },

        /**
         * @TODO ?
         * @private
         */
        _draw: function() {
            // 描画は全てのシーン行う
            for (var i=0, len=this._scenes.length; i<len; ++i) {
                this.renderer.render(this.currentScene, this.currentScene.camera);
            }
        },
        
    });
    
    
    /**
     * @property    width
     * 幅
     */
    tm.three.ThreeApp.prototype.accessor("width", {
        "get": function()   { return this.element.width; },
        "set": function(v)  { this.element.width = v; }
    });
    
    /**
     * @property    height
     * 高さ
     */
    tm.three.ThreeApp.prototype.accessor("height", {
        "get": function()   { return this.element.height; },
        "set": function(v)  { this.element.height = v; }
    });
    
})();


(function() {
    
    if (!tm.global.THREE) return ;

    /**
     * @class tm.three.Element
     * @TODO ?
     */
    tm.three.Element = tm.createClass({
        superClass: THREE.Object3D,

        /**
         * @constructor
         */
        init: function() {
            // THREE.Object3D の初期化 
            THREE.Object3D.call(this);

            tm.event.EventDispatcher.prototype.init.call(this);
        },
        
        /**
         * 更新処理
         */
        update: function() {},

        /**
         * @TODO ?
         * @private
         */
        _update: function(app) {
            // 更新有効チェック
            if (this.awake == false) return ;
            
            this.update(app);
            
            var e = tm.event.Event("enterframe");
            e.app = app;
            this.dispatchEvent(e);
            // 子供達も実行
            if (this.children.length > 0) {
                var tempChildren = this.children.slice();
                for (var i=0,len=tempChildren.length; i<len; ++i) {
                    var child = tempChildren[i];
                    child._update && child._update(app);
                }
                //this.execChildren(arguments.callee, app);
            }
        },
    });
    
    // tm.event.EventDispatcher を継承
    tm.three.Element.prototype.$safe(tm.event.EventDispatcher.prototype);
    
})();

(function() {
    
    if (!tm.global.THREE) return ;

    /**
     * @class tm.three.MeshElement
     * @TODO ?
     */
    tm.three.MeshElement = tm.createClass({
        superClass: THREE.Mesh,
        
        /**
         * @constructor
         */
        init: function(geometry, material) {
            material = material || new THREE.MeshNormalMaterial();
            // THREE.Mesh の初期化
            THREE.Mesh.call(this, geometry, material);

            tm.three.Element.prototype.init.call(this);
        },
    });
    
    // tm.three.Element を継承
    tm.three.MeshElement.prototype.$safe(tm.three.Element.prototype);

    
    /**
     * @class tm.three.CubeElement
     * @TODO ?
     * @extends tm.three.MeshElement
     */
    tm.three.CubeElement = tm.createClass({
        superClass: tm.three.MeshElement,

        /**
         * @constructor
         */
        init: function(width, height, depth) {
            width  = width || 100;
            height = height || 100;
            depth  = depth || 100;

            var geometry = new THREE.CubeGeometry(width, height, depth);
            var material = new THREE.MeshNormalMaterial();

            this.superInit(geometry, material);
        }
    });


    /**
     * @class tm.three.SphereElement
     * @TODO ?
     * @extends tm.three.MeshElement
     */
    tm.three.SphereElement = tm.createClass({
        superClass: tm.three.MeshElement,

        /**
         * @constructor
         */
        init: function(radius, widthSegments, heightSegments) {
            radius          = radius || 45;
            widthSegments   = widthSegments || 16;
            heightSegments  = heightSegments || 12;

            var geometry = new THREE.SphereGeometry(radius, widthSegments, heightSegments);
            var material = new THREE.MeshNormalMaterial();

            this.superInit(geometry, material);
        }
    });

    /**
     * @class tm.three.PlaneElement
     * @TODO ?
     * @extends tm.three.MeshElement
     */
    tm.three.PlaneElement = tm.createClass({
        superClass: tm.three.MeshElement,

        /**
         * @constructor
         */
        init: function(width, height) {
            var geometry = new THREE.PlaneGeometry(width, height);
            var material = new THREE.MeshNormalMaterial();

            this.superInit(geometry, material);
        }
    });


    /**
     * @class tm.three.FloorElement
     * @TODO ?
     * @extends tm.three.MeshElement
     */
    tm.three.FloorElement = tm.createClass({
        superClass: tm.three.MeshElement,

        /**
         * @constructor
         */
        init: function(width, height) {
            width  = width || 1000;
            height = height || 1000;
            var geometry = new THREE.PlaneGeometry(width, height);
            var material = new THREE.MeshBasicMaterial();

            this.superInit(geometry, material);

            this.rotation.x = -Math.PI/2;
            this._render();
        },

        /**
         * @TODO ?
         * @private
         */
        _render: function() {
            var c = tm.graphics.Canvas();
            c.resize(128, 128);
            c.clearColor("#444");
            c.setFillStyle("white");
            c.fillRect(0, 0, 64, 64);
            c.fillRect(64, 64, 64, 64);

            var texture = new THREE.Texture(c.element);
            texture.wrapS = texture.wrapT = THREE.RepeatWrapping;
            texture.repeat.set(10, 10);
            texture.needsUpdate = true;
            this.material.map = texture;
        }
    });

    /**
     * @class tm.three.TextElement
     * @TODO ?
     * @extends tm.three.MeshElement
     */
    tm.three.TextElement = tm.createClass({
        superClass: tm.three.MeshElement,

        /**
         * @constructor
         */
        init: function(text, param) {
            var geometry = new THREE.TextGeometry(text, param);
            var material = new THREE.MeshNormalMaterial();

            this.superInit(geometry, material);
        }
    });

    /**
     * @class tm.three.CanvasTexture
     * @TODO ?
     */
    tm.three.CanvasTexture = tm.createClass({
        superClass: THREE.Texture,

        /** canvas */
        canvas: null,
        /** @property needsUpdate */

        /**
         * @constructor
         */
        init: function() {
            this.canvas = tm.graphics.Canvas();

            THREE.Texture.call(this, this.canvas.element);
            this.needsUpdate = true;
        }

    });


})();

(function() {
    
    if (!tm.global.THREE) return ;

    /**
     * @class tm.three.Scene
     * シーン
     */
    tm.three.Scene = tm.createClass({
        superClass: THREE.Scene,
        
        /** @property camera    カメラ */
        /** @property Projector プロジェクター */

        /**
         * @constructor
         */
        init: function(fov, aspect) {
            fov = fov || 60;
            aspect = aspect || 640/480;
            // THREE.Scene の初期化
            THREE.Scene.call(this);

            // tm.three.Element を継承
            tm.three.Element.prototype.init.call(this);

            this.camera = new THREE.PerspectiveCamera(fov, aspect, 1, 10000);
            this.camera.position.y = 100;
            this.camera.position.z = 500;

            this.projector = new THREE.Projector();
        },

        /**
         * @TODO ?
         */
        intersect: function(objects) {
            objects = objects || this.children;
            var mouseX = this.app.pointing.x;
            var mouseY = this.app.pointing.y;

            mouseX = (mouseX/this.app.width) *2-1;
            mouseY =-(mouseY/this.app.height)*2+1;

            var vector = new THREE.Vector3(mouseX, mouseY, 0.5);
            this.projector.unprojectVector(vector, this.camera);

            var raycaster = new THREE.Raycaster(
                this.camera.position, vector.sub(this.camera.position).normalize()
            );

            return raycaster.intersectObjects(objects);
        }
    });
    
    // tm.three.Element を継承
    tm.three.Scene.prototype.$safe(tm.three.Element.prototype);
})();





/*
 * sound.js
 */

tm.sound = tm.sound || {};


(function() {
    
    tm.sound.globalVolume = 1.0;
    
})();


(function() {
    
    /**
     * @class tm.sound.Sound
     * サウンドクラス
     */
    tm.sound.Sound = tm.createClass({
        superClass: tm.event.EventDispatcher,

        /** element */
        element     : null,
        /** loaded */
        loaded      : false,
        /** isPlay */
        isPlay      : false,
        
        /**
         * @constructor
         */
        init: function(src) {
            this.superInit();
            
            this.element = new Audio();
            this.element.src = src;
            this.element.load();
            this.element.setAttribute("preload", "auto");
            
            var self = this;
            this.element.addEventListener("canplaythrough", function(){
                self.loaded = true;
                self.fire(tm.event.Event("load"));
            });
            this.element.addEventListener("ended", function(){
                self.isPlay = false;
            });
            this.element.addEventListener("error", function(){
                console.warn(this.src + "の読み込みに失敗しました");
            });
            
            this.element.volume = 1.0;
            
            //? モバイル系は音が不安定なので一時対応
            if (tm.isMobile) {
                this.loaded = true;
            }
        },
        
        /**
         * 再生
         */
        play: function() {
            this.element.play();
            this.isPlay = true;
            return this;
        },
        
        /**
         * 停止
         */
        stop: function() {
            this.element.pause();
            //? スマホだと止まるので応急対応
            if (!tm.isMobile) {
                this.element.currentTime = 0;
            }
            this.isPlay = false;
            return this;
        },
        
        /**
         * 一時停止
         */
        pause: function() {
            this.element.pause();
            return this;
        },
        
        /**
         * クローン
         */
        clone: function() {
            return tm.sound.Sound( this.element.src );
        },
        
    });
    
    
    
    /**
     * @property    volume
     * ボリューム
     */
    tm.sound.Sound.prototype.accessor("volume", {
        "get": function() { return this.element.volume; },
        "set": function(v){ this.element.volume = v; }
    });
    
    
    if ((new Audio()).loop !== undefined) {
    
        /**
         * @property    loop
         * ループフラグ
         */
        tm.sound.Sound.prototype.accessor("loop", {
            "get": function() { return this.element.loop; },
            "set": function(v){ this.element.loop = v; }
        });
    }
    // firefox 対応
    else {
        var onLoopFunc = function() {
            this.play();
        }
        tm.sound.Sound.prototype.accessor("loop", {
            "get": function() { return this.element.loop; },
            "set": function(v){
                // ループが false の状態で ture が来た場合ループ用関数を登録する
                if (this.element.loop != true && v == true) {
                    this.element.addEventListener("ended", onLoopFunc, false);
                }
                // 関数が登録されていて false が設定された場合ループ用関数を解除する
                else if (this.element.loop == true && v == false) {
                    this.element.removeEventListener("ended", onLoopFunc, false);
                }
                this.element.loop = v;
            }
        });
    }
    
    
    /**
     * @static
     * サポートしている拡張子
     */
    tm.sound.Sound.SUPPORT_EXT = (function(){
        var ext     = "";
        var audio   = new Audio();
        
        if      (audio.canPlayType("audio/wav") == 'maybe') { ext="wav"; }
        else if (audio.canPlayType("audio/mp3") == 'maybe') { ext="mp3"; }
        else if (audio.canPlayType("audio/ogg") == 'maybe') { ext="ogg"; }
        
        return ext;
    })();
    
})();

/*
 * webaudio.js
 */

tm.sound = tm.sound || {};

(function() {

    var context = null;

    /**
     * @class tm.sound.WebAudio
     * WebAudioクラス
     * @extends tm.event.EventDispatcher
     */
    tm.sound.WebAudio = tm.createClass({
        superClass: tm.event.EventDispatcher,

        /** loaded */
        loaded: false,
        /** context */
        context: null,
        /** panner */
        panner: null,
        /** volume */
        volume: 0.8,
        /** playing **/
        playing: false,

        _pannerEnabled: true,

        /**
         * @constructor
         */
        init: function(src_or_buffer) {
            this.superInit();

            this.context = context;
            var type = typeof(src_or_buffer);

            if (type==="string") {
                this.loaded = false;
                this._load(src_or_buffer);
            }
            else if (type==="object") {
                this._setup();
                this.buffer = src_or_buffer;
                this.loaded = true;
                this.dispatchEvent( tm.event.Event("load") );
            }
            else {
                this._setup();
                this.loaded = false;
            }
        },

        /**
         * 再生
         * - noteGrainOn ... http://www.html5rocks.com/en/tutorials/casestudies/munkadoo_bouncymouse/
         */
        play: function(time) {
            if (this.playing == true) { return ; }
            this.playing = true;

            if (time === undefined) time = 0;

            this.source.start(this.context.currentTime + time);

            var self = this;
            var time = (this.source.buffer.duration/this.source.playbackRate.value)*1000;
            window.setTimeout(function() {
                var e = tm.event.Event("ended");
                self.fire(e);
            }, time);

            return this;
        },

        /**
         * 停止
         */
        stop: function(time) {
            if (this.playing == false) { return ; }
            this.playing = false;

            if (time === undefined) time = 0;
            if (this.source.playbackState == 0) {
                return ;
            }
            this.source.stop(this.context.currentTime + time);

            var buffer = this.buffer;
            var volume = this.volume;
            var loop   = this.loop;

            this.source = this.context.createBufferSource();
            this.source.connect(this.gainNode);
            this.buffer = buffer;
            this.volume = volume;
            this.loop = loop;

            return this;
        },

        /**
         * ポーズ
         */
        pause: function() {
            this.source.disconnect();

            return this;
        },

        /**
         * レジューム
         */
        resume: function() {
            this.source.connect(this.gainNode);

            return this;
        },

        /**
         * 複製
         */
        clone: function() {
            var webAudio = tm.sound.WebAudio(this.buffer);
            webAudio.volume = this.volume;
            return webAudio;
        },
        /**
         * dummy
         */
        setPosition: function(x, y, z) {
            this.panner.setPosition(x, y||0, z||0);

            return this;
        },
        /**
         * dummy
         */
        setVelocity: function(x, y, z) {
            this.panner.setVelocity(x, y||0, z||0);

            return this;
        },
        /**
         * dummy
         */
        setOrientation: function(x, y, z) {
            this.panner.setOrientation(x, y||0, z||0);

            return this;
        },

        /**
         * dummy
         * チェーンメソッド用
         */
        setBuffer: function(v) {
            this.buffer = v;
            return this;
        },


        /**
         * dummy
         * チェーンメソッド用
         */
        setLoop: function(v) {
            this.loop = v;
            return this;
        },


        /**
         * dummy
         * チェーンメソッド用
         */
        setVolume: function(v) {
            this.volume = v;
            return this;
        },


        /**
         * チェーンメソッド用
         */
        setPlaybackRate: function(v) {
            this.playbackRate = v;
            return this;
        },

        /**
         * @private
         */
        _load: function(src) {
            if (!this.context) {
                console.warn("本環境はWebAudio未対応です。(" + src + ")");
                return;
            }

            var self = this;
            tm.util.Ajax.load({
                type: "GET",
                url: src,
                responseType: "arraybuffer",
                success: function(data) {
                    // console.debug("WebAudio ajax load success");
                    self.context.decodeAudioData(data, function(buffer) {
                        // console.debug("WebAudio decodeAudioData success");
                        self._setup();
                        self.buffer = buffer;
                        self.loaded = true;
                        self.dispatchEvent( tm.event.Event("load") );
                    }, function() {
                        console.warn("音声ファイルのデコードに失敗しました。(" + src + ")");
                        self._setup();
                        self.buffer = context.createBuffer(1, 1, 22050);
                        self.loaded = true;
                        self.dispatchEvent( tm.event.Event("load") );
                    });
                }
            });
        },

        /**
         * @private
         */
        _setup: function() {
            this.source     = this.context.createBufferSource();
            this.gainNode   = this.context.createGain();
            // this.panner     = this.context.createPanner();
            this.analyser   = this.context.createAnalyser();

            this.source.connect(this.gainNode);
            // this.gainNode.connect(this.panner);
            // this.panner.connect(this.analyser);
            this.gainNode.connect(this.analyser);
            this.analyser.connect(this.context.destination);

            // TODO 暫定的対応
            if (tm.BROWSER === "Firefox") {
                this.pannerEnabled = false;
            }
        },

        /**
         * トーン
         */
        tone: function(hertz, seconds) {
            // handle parameter
            hertz   = hertz !== undefined ? hertz : 200;
            seconds = seconds !== undefined ? seconds : 1;
            // set default value
            var nChannels   = 1;
            var sampleRate  = 44100;
            var amplitude   = 2;
            // create the buffer
            var buffer  = this.context.createBuffer(nChannels, seconds*sampleRate, sampleRate);
            var fArray  = buffer.getChannelData(0);
            // fill the buffer
            for(var i = 0; i < fArray.length; i++){
                var time    = i / buffer.sampleRate;
                var angle   = hertz * time * Math.PI;
                fArray[i]   = Math.sin(angle)*amplitude;
            }
            // set the buffer
            this.buffer = buffer;
            return this;    // for chained API
        },
    });

    /**
     * @property    buffer
     * バッファー
     */
    tm.sound.WebAudio.prototype.accessor("buffer", {
        get: function()  { return this.source.buffer; },
        set: function(v) { this.source.buffer = v; }
    });

    /**
     * @property    loop
     * ループフラグ
     */
    tm.sound.WebAudio.prototype.accessor("loop", {
        get: function()  { return this.source.loop; },
        set: function(v) { this.source.loop = v; }
    });

    /**
     * @property    valume
     * ボリューム
     */
    tm.sound.WebAudio.prototype.accessor("volume", {
        get: function()  { return this.gainNode.gain.value; },
        set: function(v) { this.gainNode.gain.value = v; }
    });

    /**
     * @property    playbackRate
     * プレイバックレート
     */
    tm.sound.WebAudio.prototype.accessor("playbackRate", {
        get: function()  { return this.source.playbackRate.value; },
        set: function(v) { this.source.playbackRate.value = v; }
    });

    /**
     * @property    pannerEnabled
     * panner有効
     */
    tm.sound.WebAudio.prototype.accessor("pannerEnabled", {
        get: function()  { return this._pannerEnabled; },
        set: function(v) {
            this.gainNode.disconnect();
            this.panner.disconnect();
            if (v) {
                this.gainNode.connect(this.panner);
                this.panner.connect(this.analyser);
            } else {
                this.gainNode.connect(this.analyser);
            }
            this._pannerEnabled = v;

            // console.debug("WebAudio pannerEnabled: " + v);
        }
    });

    /**
     * @property    loopStart
     * ループ開始位置（秒）
     */
    tm.sound.WebAudio.prototype.accessor("loopStart", {
        get: function()  { return this.source.loopStart; },
        set: function(v) { this.source.loopStart = v; }
    });

    /**
     * @property    loopEnd
     * ループ終了位置（秒）
     */
    tm.sound.WebAudio.prototype.accessor("loopEnd", {
        get: function()  { return this.source.loopEnd; },
        set: function(v) { this.source.loopEnd = v; }
    });

    /** @static @property */
    tm.sound.WebAudio.isAvailable = (tm.global.AudioContext || tm.global.webkitAudioContext || tm.global.mozAudioContext) ? true : false;

    tm.sound.WebAudio.createContext = function() {
        if (tm.global.AudioContext) {
            context = new AudioContext();
        }
        else if (tm.global.webkitAudioContext) {
            context = new webkitAudioContext();
        }
        else if (tm.global.mozAudioContext) {
            context = new mozAudioContext();
        }

        tm.sound.WebAudio.context = context;
    };

    /**
     * @static
     * iOSでWebAudioを使う場合、window.ontouchend等でこの関数を実行する
     */
    tm.sound.WebAudio.unlock = function() {
        var unlockBuffer = context.createBuffer(1, 1, 22050);
        var unlockSrc = context.createBufferSource();
        unlockSrc.buffer = unlockBuffer;
        unlockSrc.connect(context.destination);
        unlockSrc.start(0);
    };

    tm.sound.WebAudio.createContext();
})();




/*
 * soundmanager.js
 */

;(function() {

    /*
     * tm.sound.SoundManager
     * ### Ref
     * - http://evolve.reintroducing.com/_source/classes/as3/SoundManager/SoundManager.html
     * - https://github.com/nicklockwood/SoundManager
     */
    tm.sound.SoundManager = {
        volume: 0.8,
        musicVolume: 0.8,
        muteFlag: false,
        currentMusic: null,

        /*
         * 再生
         */
        play: function(name, volume, startTime, loop) {
            var origin = tm.asset.Manager.get(name);
            if (origin == null) {
                console.warn('not found ' + name);
                return ;
            }
            var sound = origin.clone();

            sound.volume = this.getVolume();
            sound.play();

            return sound;
        },
        stop: function() {
            // TODO: 
        },
        pause: function() {
            // TODO: 
        },
        fade: function() {
            // TODO: 
        },
        setVolume: function(volume) {
            this.volume = volume;
        },
        getVolume: function() {
            return this.isMute() ? 0 : this.volume;
        },
        /*
         * ミュート(toggle)
         */
        mute: function() {
            this.muteFlag = (this.muteFlag === true) ? false : true;

            if (this.currentMusic) {
                this.currentMusic.volume = this.getVolumeMusic();
            }

            return this;
        },
        isMute: function() {
            return this.muteFlag;
        },

        /*
         * 音楽を再生
         */
        playMusic: function(name, fadeTime, loop) {
            if (this.currentMusic) {
                this.stopMusic(fadeTime);
            }

            var origin = tm.asset.Manager.get(name);
            if (origin == null) {
                console.warn('not found ' + name);
                return ;
            }
            var music = origin.clone();

            music.setLoop(true);
            music.volume = this.getVolumeMusic();
            music.play();

            if (fadeTime > 0) {
                var count = 32;
                var counter = 0;
                var unitTime = fadeTime/count;
                var volume = this.getVolumeMusic();

                music.volume = 0;
                var id = setInterval(function() {
                    counter += 1;
                    var rate = counter/count;
                    music.volume = rate*volume;

                    if (rate >= 1) {
                        clearInterval(id);
                        return false;
                    }

                    return true;
                }, unitTime);
            }
            else {
                music.volume = this.getVolumeMusic();
            }

            this.currentMusic = music;

            return this.currentMusic;
        },

        /*
         * 音楽を停止
         */
        stopMusic: function(fadeTime) {
            if (!this.currentMusic) { return ; }

            var music = this.currentMusic;

            if (fadeTime > 0) {
                var count = 32;
                var counter = 0;
                var unitTime = fadeTime/count;
                var volume = this.getVolumeMusic();

                music.volume = 0;
                var id = setInterval(function() {
                    counter += 1;
                    var rate = counter/count;
                    music.volume = volume*(1-rate);

                    if (rate >= 1) {
                        music.stop();
                        clearInterval(id);
                        return false;
                    }

                    return true;
                }, unitTime);
            }
            else {
                this.currentMusic.stop();
            }
        },
        /*
         * 音楽を一時停止
         */
        pauseMusic: function() {
            if (!this.currentMusic) { return ; }
            this.currentMusic.pause();
        },
        /*
         * 音楽を再開
         */
        resumeMusic: function() {
            if (!this.currentMusic) { return ; }
            this.currentMusic.resume();
        },
        /*
         * 音楽のボリュームを設定
         */
        setVolumeMusic: function(volume) {
            this.musicVolume = volume;
            if (this.currentMusic) {
                this.currentMusic.volume = volume;
            }

            return this;
        },
        /*
         * 音楽のボリュームを取得
         */
        getVolumeMusic: function(volume) {
            return this.isMute() ? 0 : this.musicVolume;
        },
    };

})();


/*
 * twitter.js
 */

tm.social = tm.social || {};


(function() {
    
    /**
     * @class tm.social.Twitter
     * ツイッター関連ネームスペース
     */
    tm.social.Twitter = tm.social.Twitter || {};
    
    tm.social.Twitter.API_URL = "http://api.twitter.com/1";    // version 1 は廃止予定らしい
    var BASE_URL = "http://twitter.com/intent";


    /**
     * @member      tm.social.Twitter
     * Tweet する
     * @param {Object} prop
     * ### Reference
     * - <https://dev.twitter.com/docs/intents>
     * ### Example
     *      tm.social.Twitter.createURL({
     *          type        : "tweet",              // タイプ(tweet/retweet/favorite/user)
     *          tweet_id    : "210219483959263232", // 対象となる Tweet
     *          in_reply_to : "210219483959263232", // 返信する対象となる Tweet
     *          text        : "Test",               // テキスト
     *          screen_name : "phi_jp",             // スクリーンネーム
     *          hashtags    : "javascript,tmlibjs", // ハッシュタグ
     *          url         : "http://tmlife.net",  // url
     *          via         : "phi_jp",             // ～から
     *          related     : "tmlib.js tmlife",    // 関連ワード
     *      });
     */
    tm.social.Twitter.createURL = function(prop) {
        var param_string_list = [];
        for (var key in prop) {
            if (key == "type") continue;
            var value = encodeURIComponent(prop[key]);
            var param_string = key+"="+value;
            param_string_list.push(param_string);
        }
        
        var url = "{baseURL}/{type}?{param}".format({
            baseURL : BASE_URL,
            type    : prop.type,
            param   : param_string_list.join('&'),
        });
        
        return url;
    };
    
    
})();

(function() {
    
    var BASE_URL = "http://api.twitter.com/1/{type}/{kind}.json";

    /**
     * @member      tm.social.Twitter
     */
    tm.social.Twitter.api = function(type, kind, param, callback) {
        var url = BASE_URL.format({ type:type, kind:kind });
        var qs  = tm.util.QueryString.stringify(param);
        
        tm.util.Ajax.loadJSONP(url + "?" + qs, callback);
    };
    
})();



(function() {
    
    var BASE_URL = "http://search.twitter.com/search.json";

    /**
     * @member      tm.social.Twitter
     */
    tm.social.Twitter.search = function(param, callback) {
        var url = BASE_URL;
        var qs  = tm.util.QueryString.stringify(param);
        
        tm.util.Ajax.loadJSONP(url + "?" + qs, callback);
    };
    
})();


(function() {
    
    /*
     * format = xml or json
     */
    var BASE_URL = "http://api.twitter.com/1/statuses/followers.json";
    //http://api.twitter.com/1/statuses/followers.json?id=tmlife_jp
    
    /**
     * @member      tm.social.Twitter
     * 
     * user_id      ユーザーID
     * screen_name  screen_name
     * cursor       -1 を指定すると先頭から 100
     * include_entities     true を指定すると entities を取得できる
     * 
     */
    tm.social.Twitter.getFollowers = function(param, callback) {
        tm.social.Twitter.api("statuses", "followers", param, callback);
        
        /*
        tm.social.Twitter.api("statuses", "public_timeline", param, callback);
        tm.social.Twitter.api("statuses", "home_timeline", param, callback);
        tm.social.Twitter.api("statuses", "friends_timeline", param, callback);
        tm.social.Twitter.api("statuses", "user_timeline", param, callback);
        tm.social.Twitter.api("statuses", "replies", param, callback);
        tm.social.Twitter.api("statuses", "mentions", param, callback);
        */
    };
    
})();





































/*
 * nineleap.js
 */

tm.social = tm.social || {};


(function() {

    /**
     * @class tm.social.NineLeap
     * 9leap ネームスペース
     */
    tm.social.Nineleap = tm.social.Nineleap || {};

    var BASE_URL = "http://9leap.net/games/{id}/result?score={score}&result={result}";

    /**
     * @member      tm.social.Nineleap
     */
    tm.social.Nineleap.DEBUG_GAME_ID = "0";

    /**
     * @member      tm.social.Nineleap
     * @method      createURL
     * 9leap 用の URL を生成
     */
    tm.social.Nineleap.createURL = function(id, score, result) {
        return BASE_URL.format({
            id      : id,
            score   : score,
            result  : result
        });
    };

    /**
     * @member      tm.social.Nineleap
     * @method      postRanking
     * 9leap でランキングを POST
     */
    tm.social.Nineleap.postRanking = function(score, result) {
        if (location.hostname == 'r.jsgames.jp') {
            var id = location.pathname.match(/^\/games\/(\d+)/)[1];
            location.replace( this.createURL(id, score, result) );
        }
        else {
            console.warn("9leap に投稿されていません!");
        }
    };

    /**
     * @member      tm.social.Nineleap
     * @method      gotoLogin
     * 9leapログインページヘ遷移する.
     */
    tm.social.Nineleap.gotoLogin = function() {
        window.location.replace("http://9leap.net/api/login");
    };

    /**
     * @member      tm.social.Nineleap
     * @method      isOn9leap
     * アプリケーションが9leap上にデプロイされているか
     */
    tm.social.Nineleap.isOn9leap = function() {
        return window.location.hostname === "r.jsgames.jp";
    };

    /**
     * @member      tm.social.Nineleap
     * @method      getGameId
     * 9leapのゲームIDを取得する
     */
    tm.social.Nineleap.getGameId = function() {
        if (tm.social.Nineleap.isOn9leap()) {
            return window.location.pathname.match(/^\/games\/(\d+)/)[1];
        } else {
            return tm.social.Nineleap.DEBUG_GAME_ID;
        }
    };

    /**
     * @member      tm.social.Nineleap
     * @method      getMyData
     * プレイヤーのゲームデータを取得する
     */
    tm.social.Nineleap.getMyData = function(callback) {
        tm.util.Ajax.loadJSONP(tm.social.Nineleap.createMyDataURL(), callback);
    };

    /**
     * @member      tm.social.Nineleap
     * @method      postMyData
     * プレイヤーのゲームデータを保存する
     */
    tm.social.Nineleap.postMyData = function(data, callback) {
        tm.util.Ajax.load({
            type: "POST",
            url: tm.social.Nineleap.createMemoryURL("user_memory.json"),
            dataType: "json",
            data: "json=" + JSON.stringify(data),
            contentType: "application/x-www-form-urlencoded;charset=UTF-8",
            async: false,
            beforeSend: function(xhr) {
                xhr.withCredentials = true;
            },
            success: callback,
            error: function(responseText) {
                console.error(responseText);
            }
        });
    };

    /**
     * @member      tm.social.Nineleap
     * @method      createMemoryURL
     * 9leap Memory API へアクセスするURLを生成
     */
    tm.social.Nineleap.createMemoryURL = function() {
        var url = [
            "http://9leap.net/api/memory/",
            tm.social.Nineleap.getGameId() + "/",
        ];
        for (var i = 0, len = arguments.length; i < len; i++) {
            url.push(arguments[i]);
        }

        return url.join("");
    };
    /**
     * @member      tm.social.Nineleap
     * @method      createMyDataURL
     * ユーザデータURLを生成
     */
    tm.social.Nineleap.createMyDataURL = function() {
        return tm.social.Nineleap.createMemoryURL("user_memory.json");
    };
    /**
     * @member      tm.social.Nineleap
     * @method      createUserDataURL
     * 他のユーザのプレイデータURLを生成
     */
    tm.social.Nineleap.createUserDataURL = function(screenName) {
        return tm.social.Nineleap.createMemoryURL("u/", screenName + ".json");
    };
    /**
     * @member      tm.social.Nineleap
     * @method      createRecentDataURL
     * 最近プレイしたユーザのプレイデータURLを生成
     */
    tm.social.Nineleap.createRecentDataURL = function(max) {
        max = max || 30;
        return tm.social.Nineleap.createMemoryURL("recent_memories.json", "?max=" + max);
    };
    /**
     * @member      tm.social.Nineleap
     * @method      createFriendDataURL
     * TwitterでフォローしているユーザのプレイデータURLを生成
     */
    tm.social.Nineleap.createFriendDataURL = function(max) {
        max = max || 30;
        return tm.social.Nineleap.createMemoryURL("friends_memories.json", "?max=" + max);
    };
    /**
     * @member      tm.social.Nineleap
     * @method      createRankingDataURL
     * スコアランキング上位のユーザのプレイデータURLを生成
     */
    tm.social.Nineleap.createRankingDataURL = function(max) {
        max = max || 30;
        return tm.social.Nineleap.createMemoryURL("ranking_memories.json", "?max=" + max);
    };
})();


/*
 * chart.js
 */

tm.google = tm.google || {};


(function() {
    
    /**
     * @class tm.google.Chart
     * チャートネームスペース
     */
    tm.google.Chart = tm.google.Chart || {};
    
    var DYNAMIC_ICONS_BASE_URL  = "https://chart.googleapis.com/chart?chst={type}&chld={data}";
    var QR_CODE_BASE_URL        = "https://chart.googleapis.com/chart?chs={size}&cht={type}&chl={text}&chco={color}";
    
    /**
     * @static
     * ダイナミックアイコン
     * @param {string}  type    d_bubble_text_small OR d_fnote_title OR chst=d_fnote etc...
     * @param {string}  data    
     * ### Example
     *      tm.google.Chart.createDynamicIcons("d_bubble_icon_text_small", "ski|bb|Hello, world!|FFFFFF|000000");
     *      tm.google.Chart.createDynamicIcons("d_fnote", "balloon|1|000000|l|Hello, world!");
     *      tm.google.Chart.createDynamicIcons("d_fnote", "pinned_c|1|000000|l|Hello, world!");
     *      tm.google.Chart.createDynamicIcons("d_weather", "taped_y|sunny|Barcelona|max+25°C|min+15°C");
     *      tm.google.Chart.createDynamicIcons("d_simple_text_icon_left", "flag_jp|14|000|flag_jp|24|000|FFF");
     */
    tm.google.Chart.createDynamicIcons = function(type, data) {
        // data = encodeURIComponent(data);
        return DYNAMIC_ICONS_BASE_URL.format({
            type:type,
            data:data
        });
    };
    
    /**
     * @static
     * QRCode 生成
     * @param {Object} prop
     * ### Reference
     * - <https://developers.google.com/chart/?hl=ja#qrcodes>
     * - <https://developers.google.com/chart/infographics/?hl=ja>
     * - <https://google-developers.appspot.com/chart/infographics/docs/overview>
     * ### Example
     *      tm.google.Chart.createQRCode("160x160", "http://tmlife.net");
     *      tm.google.Chart.createQRCode("160x160", "Hello, world");
     */
    tm.google.Chart.createQRCode = function(size, text, color) {
        text = encodeURIComponent(text);
        
        return QR_CODE_BASE_URL.format({
            type:"qr",
            size:size,
            text:text,
        });
    };
    
    /**
     * @static
     * Tex 生成
     */
    tm.google.Chart.createTeX = function() {
        //&chco=ff0000ff
    };
    
})();


;(function() {
    
    /**
     * @member      tm.app.Element
     * @property    interaction
     * インタラクション
     */
    tm.app.Element.prototype.getter("interaction", function() {
        console.assert(false, "interaction は Object2d に統合されました. obj.setInteractive(true); とすればタッチ判定が有効になります.");
    });
    
    
    var dirtyClass = {
        "display": [
            "Sprite",
            "Shape",
            "CircleShape",
            "TriangleShape",
            "RectangleShape",
            "RoundRectangleShape",
            "StarShape",
            "PolygonShape",
            "HeartShape",
            "TextShape",
            "CanvasRenderer",
            "BoundingRectRenderer",
            "Label",
            "MapSprite",
            "CanvasElement",
            "CanvasApp",
            "AnimationSprite",
            "SpriteSheet",
        ],
        "ui": [
            "LabelButton",
            "IconButton",
            "GlossyButton",
            "FlatButton",
            "LoadingScene",
        ],
    };
    
    for (var key in dirtyClass) {
        var namespace = dirtyClass[key];
        namespace.each(function(className) {
            tm.app[className] = tm[key][className];
        });
    }
    
    tm.asset.AssetManager = tm.asset.Manager;

    tm.util.getter('Script', function() {
        console.warn('`tm.util.Script` は `tm.asset.Script` になりました!');
    });

    tm.ui.LoadingScene = function(param) {
        console.warn('`tm.ui.LoadingScene` は `tm.game.LoadingScene` になりました!');
        return tm.game.LoadingScene(param);
    };

    tm.scene = tm.scene || {};
    tm.scene.ManagerScene = tm.game.ManagerScene;
    tm.scene.LoadingScene = tm.game.LoadingScene;
    tm.scene.TitleScene = tm.game.TitleScene;
    tm.scene.ResultScene = tm.game.ResultScene;
    tm.scene.NumericalInputScene = tm.game.NumericalInputScene;
    
    tm.getter('scene', function() {
        debugger;
        console.warn('tm.scene は tm.game に変更されました');
        return tm.game;
    });

})();

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],2:[function(require,module,exports){
var tm = require("../libs/tmlib");
var GameScene = require("./scenes/GameScene");

tm.main(function() {
	var app = tm.display.CanvasApp("#app");
	app.resize(500, 500).fitWindow();

	app.replaceScene(GameScene("123"));

	app.run();
});

},{"../libs/tmlib":1,"./scenes/GameScene":3}],3:[function(require,module,exports){
var tm = require("../../libs/tmlib");

var GameScene = tm.createClass({
	superClass: tm.app.Scene,
	init: function() {
		this.superInit();
		this.fromJSON({
			children: {
				title: {
					type: "tm.display.Label",
					init: ["hello world"],
					x: 250,
					y: 250,
				}
			}
		});
	}
});

module.exports = GameScene;

},{"../../libs/tmlib":1}]},{},[2])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL0FwcERhdGEvUm9hbWluZy9ucG0vbm9kZV9tb2R1bGVzL3dhdGNoaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJsaWJzL3RtbGliLmpzIiwic3JjL21haW4uanMiLCJzcmMvc2NlbmVzL0dhbWVTY2VuZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQzEvbUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLypcclxuICogdG1saWIuanMgMC41LjBcclxuICogaHR0cDovL2dpdGh1Yi5jb20vcGhpLWpwL3RtbGliLmpzXHJcbiAqIE1JVCBMaWNlbnNlZFxyXG4gKiBcclxuICogQ29weXJpZ2h0IChDKSAyMDEwIHBoaSwgaHR0cDovL3RtbGlmZS5uZXRcclxuICovXHJcblxyXG4oZnVuY3Rpb24oKSB7IFwidXNlIHN0cmljdFwiOyB9KSgpO1xyXG5cclxuLypcclxuICogdG0gbmFtZXNwYWNlXHJcbiAqL1xyXG52YXIgdG0gPSB0bSB8fCB7fTtcclxudG0uZ2xvYmFsID0gd2luZG93IHx8IGdsb2JhbCB8fCB0aGlzO1xyXG50bS5nbG9iYWwudG0gPSB0bTtcclxuXHJcbi8vIG5vZGUuanNcclxuaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIG1vZHVsZS5leHBvcnRzKSB7XHJcbiAgICBtb2R1bGUuZXhwb3J0cyA9IHRtO1xyXG59XHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog44OQ44O844K444On44OzXHJcbiAgICAgKi9cclxuICAgIHRtLlZFUlNJT04gPSAnMC41LjAnO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogdG1saWIuanMg44Gu44Or44O844OI44OR44K5XHJcbiAgICAgKi9cclxuICAgIHRtLkxJQl9ST09UID0gKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgaWYgKCF3aW5kb3cuZG9jdW1lbnQpIHJldHVybiA7XHJcblxyXG4gICAgICAgIHZhciBzY3JpcHRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIik7XHJcbiAgICAgICAgZm9yICh2YXIgaT0wLCBsZW49c2NyaXB0cy5sZW5ndGg7IGk8bGVuOyArK2kpIHtcclxuXHJcbiAgICAgICAgfVxyXG4gICAgfSkoKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOODluODqeOCpuOCtlxyXG4gICAgICovXHJcbiAgICB0bS5CUk9XU0VSID0gKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICghd2luZG93Lm5hdmlnYXRvcikgcmV0dXJuIDtcclxuXHJcbiAgICAgICAgaWYgICAgICAoL2Nocm9tZS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpICAgeyByZXR1cm4gXCJDaHJvbWVcIjsgIH1cclxuICAgICAgICBlbHNlIGlmICgvc2FmYXJpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgICB7IHJldHVybiBcIlNhZmFyaVwiOyAgfVxyXG4gICAgICAgIGVsc2UgaWYgKC9maXJlZm94L2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgIHsgcmV0dXJuIFwiRmlyZWZveFwiOyB9XHJcbiAgICAgICAgZWxzZSBpZiAoL29wZXJhL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgICAgeyByZXR1cm4gXCJPcGVyYVwiOyAgIH1cclxuICAgICAgICBlbHNlIGlmICgvZ2V0Y2tvL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgICB7IHJldHVybiBcIkdldGNrb1wiOyAgfVxyXG4gICAgICAgIGVsc2UgaWYgKC9tc2llL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgICAgIHsgcmV0dXJuIFwiSUVcIjsgICAgICB9XHJcbiAgICAgICAgZWxzZSB7IHJldHVybiAnJzsgfVxyXG4gICAgfSkoKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOODmeODs+ODgOODvOODl+ODrOODleOCo+ODg+OCr+OCuVxyXG4gICAgICovXHJcbiAgICB0bS5WRU5ERVJfUFJFRklYID0gKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICghd2luZG93KSByZXR1cm4gO1xyXG5cclxuICAgICAgICB2YXIgbWFwID0ge1xyXG4gICAgICAgICAgICBcIkNocm9tZVwiICAgIDogXCJ3ZWJraXRcIixcclxuICAgICAgICAgICAgXCJTYWZhcmlcIiAgICA6IFwid2Via2l0XCIsXHJcbiAgICAgICAgICAgIFwiRmlyZWZveFwiICAgOiBcIm1velwiLFxyXG4gICAgICAgICAgICBcIk9wZXJhXCIgICAgIDogXCJvXCIsXHJcbiAgICAgICAgICAgIFwiSUVcIiAgICAgICAgOiBcIm1zXCJcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4gbWFwW3RtLkJST1dTRVJdIHx8IFwiXCI7XHJcbiAgICB9KSgpO1xyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIOODouODkOOCpOODq+OBi+OBqeOBhuOBi+OBruWIpOWumuODleODqeOCsFxyXG4gICAgICovXHJcbiAgICB0bS5pc01vYmlsZSA9IChmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoIXdpbmRvdy5uYXZpZ2F0b3IpIHJldHVybiA7XHJcblxyXG4gICAgICAgIHZhciB1YSA9IG5hdmlnYXRvci51c2VyQWdlbnQ7XHJcbiAgICAgICAgcmV0dXJuICh1YS5pbmRleE9mKFwiaVBob25lXCIpID4gMCB8fCB1YS5pbmRleE9mKFwiaVBhZFwiKSA+IDAgfHwgdWEuaW5kZXhPZihcIkFuZHJvaWRcIikgPiAwKTtcclxuICAgIH0pKCk7XHJcbiAgICBcclxuICAgIHRtLmlzTG9jYWwgPSAoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGZsYWcgPSAobG9jYXRpb24ucHJvdG9jb2wgPT0gXCJmaWxlOlwiKTtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBmbGFnOyB9O1xyXG4gICAgfSkoKTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiDjgq/jg6njgrnlrprnvqlcclxuICAgICAqL1xyXG4gICAgdG0uY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbihwcm9wKSB7XHJcbiAgICAgICAgLy8g44OH44OV44Kp44Or44OI5YCkXHJcbiAgICAgICAgcHJvcC5pbml0ID0gcHJvcC5pbml0IHx8IGZ1bmN0aW9uKCkge307XHJcbiAgICAgICAgcHJvcC5zdXBlckNsYXNzID0gcHJvcC5zdXBlckNsYXNzIHx8IG51bGw7XHJcblxyXG4gICAgICAgIC8vIOOCr+ODqeOCueS9nOaIkFxyXG4gICAgICAgIHZhciB0bV9jbGFzcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgdGVtcCA9IG5ldyB0bV9jbGFzcy5wcm90b3R5cGUuY3JlYXRvcigpO1xyXG4gICAgICAgICAgICB0bV9jbGFzcy5wcm90b3R5cGUuaW5pdC5hcHBseSh0ZW1wLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGVtcFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIOe2meaJv1xyXG4gICAgICAgIGlmIChwcm9wLnN1cGVyQ2xhc3MpIHtcclxuICAgICAgICAgICAgcHJvcC5pbml0Lm93bmVyID0gdG1fY2xhc3M7XHJcbiAgICAgICAgICAgIHRtX2NsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUocHJvcC5zdXBlckNsYXNzLnByb3RvdHlwZSk7XHJcbiAgICAgICAgICAgIHRtX2NsYXNzLnByb3RvdHlwZS5zdXBlckluaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjYWxsZXIgICAgPSB0aGlzLnN1cGVySW5pdC5jYWxsZXI7IC8vIOWRvOOBs+WHuuOBl+OCguOBqFxyXG4gICAgICAgICAgICAgICAgdmFyIHN1YmNsYXNzICA9IGNhbGxlci5vd25lcjsgLy8g5ZG844Gz5Ye644GX44KC44Go44KS5oyB44Gj44Gm44GE44KL44Kv44Op44K5XHJcbiAgICAgICAgICAgICAgICB2YXIgc3VwZXJjbGFzcz0gc3ViY2xhc3MucHJvdG90eXBlLnN1cGVyQ2xhc3M7IC8vIOWRvOOBs+WHuuOBl+OCguOBqOOCr+ODqeOCueOBruimquOCr+ODqeOCuVxyXG4gICAgICAgICAgICAgICAgdmFyIHN1cGVySW5pdCA9IHN1cGVyY2xhc3MucHJvdG90eXBlLmluaXQ7IC8vIOWRvOOBs+WHuuOBl+OCguOBqOOCr+ODqeOCueOBruimquOCr+ODqeOCueOBriBpbml0XHJcbi8vICAgICAgICAgICAgICAgIHZhciBzdXBlck1ldGhvZCA9IHRoaXMuc3VwZXJJbml0LmNhbGxlci5vd25lci5wcm90b3R5cGUuc3VwZXJDbGFzcy5wcm90b3R5cGUuaW5pdDtcclxuXHJcbiAgICAgICAgICAgICAgICBzdXBlckluaXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdG1fY2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gdG1fY2xhc3M7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0bV9jbGFzcy5wcm90b3R5cGUuc2VsZkNsYXNzID0gdG1fY2xhc3M7XHJcblxyXG4gICAgICAgIC8vIOODl+ODreODkeODhuOCo+OCkui/veWKoFxyXG4gICAgICAgIGZvciAodmFyIGtleSBpbiBwcm9wKSB7XHJcbiAgICAgICAgICAgIHRtX2NsYXNzLnByb3RvdHlwZVtrZXldID0gcHJvcFtrZXldO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8g44Kv44Oq44Ko44Kk44K/44Gu55Sf5oiQXHJcbiAgICAgICAgdG1fY2xhc3MucHJvdG90eXBlLmNyZWF0b3IgPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH07XHJcbiAgICAgICAgLy8g44Kv44Oq44Ko44Kk44K/44Gu57aZ5om/XHJcbiAgICAgICAgdG1fY2xhc3MucHJvdG90eXBlLmNyZWF0b3IucHJvdG90eXBlID0gdG1fY2xhc3MucHJvdG90eXBlO1xyXG5cclxuICAgICAgICB0bV9jbGFzcy5fY2xhc3MgPSB0cnVlO1xyXG5cclxuICAgICAgICByZXR1cm4gdG1fY2xhc3M7XHJcbiAgICB9O1xyXG5cclxuICAgIHRtLmNsYXNzZXMgPSB7fTtcclxuICAgIHZhciBfY2Fsc3NEZWZpbmVkQ2FsbGJhY2sgPSB7fTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOOCr+ODqeOCueWumue+qVxyXG4gICAgICogcGhpIOOCr+ODqeOCueWumue+qSA8aHR0cDovL2pzZG8uaXQvcGhpL2VFbWo+XHJcbiAgICAgKiBuZXcg44GoIGFwcGx5IOOCkuWQjOaZguOBq+S9v+OBhiA8aHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xNjA2Nzk3L3VzZS1vZi1hcHBseS13aXRoLW5ldy1vcGVyYXRvci1pcy10aGlzLXBvc3NpYmxlPlxyXG4gICAgICovXHJcbiAgICB0bS5kZWZpbmUgPSBmdW5jdGlvbihwYXRoLCBwcm9wKSB7XHJcbiAgICAgICAgdmFyIGluZGV4ICAgICAgID0gcGF0aC5sYXN0SW5kZXhPZihcIi5cIik7XHJcbiAgICAgICAgdmFyIG5zTmFtZSAgICAgID0gcGF0aC5zdWJzdHJpbmcoMCwgaW5kZXgpO1xyXG4gICAgICAgIHZhciBucyAgICAgICAgICA9IChuc05hbWUpID8gdG0udXNpbmcobnNOYW1lKSA6IHRtLmdsb2JhbDtcclxuICAgICAgICB2YXIgY2xhc3NOYW1lICAgPSAobnNOYW1lKSA/IHBhdGguc3Vic3RyaW5nKGluZGV4KzEpIDogcGF0aDtcclxuICAgICAgICB2YXIgYmluZCAgICAgICAgPSBGdW5jdGlvbi5wcm90b3R5cGUuYmluZDtcclxuICAgICAgICB2YXIgdW5zaGlmdCAgICAgPSBBcnJheS5wcm90b3R5cGUudW5zaGlmdDtcclxuXHJcbiAgICAgICAgcHJvcC5fcGF0aCAgICAgID0gcGF0aDtcclxuICAgICAgICBwcm9wLl9jbGFzc05hbWUgPSBjbGFzc05hbWU7XHJcblxyXG4gICAgICAgIHZhciBfY2xhc3MgPSBudWxsO1xyXG4gICAgICAgIHZhciBzdXBlckNsYXNzID0gcHJvcC5zdXBlckNsYXNzO1xyXG5cclxuICAgICAgICBpZiAoc3VwZXJDbGFzcyAmJiB0eXBlb2Ygc3VwZXJDbGFzcyA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIHZhciBzdXBlckNsYXNzTmFtZSA9IHN1cGVyQ2xhc3M7XHJcbiAgICAgICAgICAgIHN1cGVyQ2xhc3MgPSB0bS51c2luZyhzdXBlckNsYXNzKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChzdXBlckNsYXNzLl9jbGFzcykge1xyXG4gICAgICAgICAgICAgICAgcHJvcC5zdXBlckNsYXNzID0gc3VwZXJDbGFzcztcclxuICAgICAgICAgICAgICAgIF9jbGFzcyA9IHRtLmNyZWF0ZUNsYXNzKHByb3ApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8g6Kaq44Kv44Op44K544GM5ZG844Gw44KM44Gf6Zqb44Gr5YaN5bqm5a6f6KGM44GZ44KLXHJcbiAgICAgICAgICAgICAgICBpZiAoIV9jYWxzc0RlZmluZWRDYWxsYmFja1tzdXBlckNsYXNzTmFtZV0pIHtcclxuICAgICAgICAgICAgICAgICAgICBfY2Fsc3NEZWZpbmVkQ2FsbGJhY2tbc3VwZXJDbGFzc05hbWVdID0gW107XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgX2NhbHNzRGVmaW5lZENhbGxiYWNrW3N1cGVyQ2xhc3NOYW1lXS5wdXNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRtLmRlZmluZShwYXRoLCBwcm9wKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIF9jbGFzcyA9IHRtLmNyZWF0ZUNsYXNzKHByb3ApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8g44Kt44Oj44OD44K344Ol44GX44Gm44GK44GPXHJcbiAgICAgICAgbnNbY2xhc3NOYW1lXSA9IHRtLmNsYXNzZXNbcGF0aF0gPSBfY2xhc3M7XHJcblxyXG4gICAgICAgIGlmIChfY2Fsc3NEZWZpbmVkQ2FsbGJhY2tbcGF0aF0pIHtcclxuICAgICAgICAgICAgdmFyIGxpc3QgPSBfY2Fsc3NEZWZpbmVkQ2FsbGJhY2tbcGF0aF07XHJcbiAgICAgICAgICAgIGZvciAodmFyIGk9MCxsZW49bGlzdC5sZW5ndGg7IGk8bGVuOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIGxpc3RbaV0oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBkZWxldGUgX2NhbHNzRGVmaW5lZENhbGxiYWNrW3BhdGhdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIF9jbGFzcztcclxuICAgIH07XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5ZCN5YmN56m66ZaTXHJcbiAgICAgKiB0eXBlc2NyaXB0IOOBriBtdWRsZSDmqZ/og73jgpLlj4LogINcclxuICAgICAqIGh0dHBzOi8vc2l0ZXMuZ29vZ2xlLmNvbS9zaXRlL2p1bjFzYm9hcmRnYW1lcy9wcm9ncmFtbWluZy90eXBlc2NyaXB0XHJcbiAgICAgKi9cclxuICAgIHRtLm5hbWVzcGFjZSA9IGZ1bmN0aW9uKG5zLCBmbikge1xyXG4gICAgICAgIHZhciBucyA9IHRtLnVzaW5nKG5zKTtcclxuXHJcbiAgICAgICAgZm4uY2FsbChucywgbnMpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOS9v+eUqFxyXG4gICAgICovXHJcbiAgICB0bS51c2luZyA9IGZ1bmN0aW9uKG5zKSB7XHJcbiAgICAgICAgaWYgKHRtLmNsYXNzZXNbbnNdKSByZXR1cm4gdG0uY2xhc3Nlc1tuc107XHJcblxyXG4gICAgICAgIHZhciBwYXRoID0gbnMuc3BsaXQoL1ssLlxcLyBdfDo6Lyk7XHJcbiAgICAgICAgdmFyIGN1cnJlbnQgPSB0bS5nbG9iYWw7XHJcblxyXG4gICAgICAgIGZvciAodmFyIGk9MCxsZW49cGF0aC5sZW5ndGg7IGk8bGVuOyArK2kpIHtcclxuICAgICAgICAgICAgdmFyIGRpciA9IHBhdGhbaV07XHJcbiAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50W2Rpcl0gfHwgKGN1cnJlbnRbZGlyXT17fSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyDjgq3jg6Pjg4Pjgrfjg6VcclxuICAgICAgICB0bS5jbGFzc2VzW25zXSA9IGN1cnJlbnQ7XHJcblxyXG4gICAgICAgIHJldHVybiBjdXJyZW50O1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdG0uZ2xvYmFsaXplID0gZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgdG0uJGZvckluKGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoa2V5ID09PSBcImNsYXNzZXNcIikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChrZXkgPT09IFwiZ2xvYmFsXCIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoa2V5ID09PSBcImV2ZW50XCIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoa2V5ID09PSBcImRvbVwiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcIiMjIyMgXCIgKyBrZXkgKyBcIiAjIyMjIyMjIyMjI1wiKTtcclxuICAgICAgICAgICAgdmFsdWUuJGZvckluKGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGlmICghd2luZG93W2tleV0pIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvd1trZXldID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiDlkI3liY3jgpLogIPjgYjjgarjgYrjgZlcclxuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhrZXkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB0bVtcImltcG9ydFwiXSA9IGZ1bmN0aW9uKG5hbWVzcGFjZSkge1xyXG4gICAgICAgIHZhciB0YXJnZXQgPSB0bVtuYW1lc3BhY2VdO1xyXG4gICAgICAgIHRtLmdsb2JhbC4kc3RyaWN0KHRhcmdldCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog44Or44O844OXXHJcbiAgICAgKi9cclxuICAgIHRtLnNldExvb3AgPSBmdW5jdGlvbihmbiwgZGVsYXkpIHtcclxuICAgICAgICB2YXIgdGVtcCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyDplovlp4vmmYLplpNcclxuICAgICAgICAgICAgdmFyIHN0YXJ0ID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIOWun+ihjFxyXG4gICAgICAgICAgICBmbigpO1xyXG5cclxuICAgICAgICAgICAgLy8g57WM6YGO5pmC6ZaTXHJcbiAgICAgICAgICAgIHZhciBwcm9ncmVzcyA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCkgLSBzdGFydDtcclxuICAgICAgICAgICAgLy8g5qyh5Zue44G+44Gn44Gu5b6F44Gh5pmC6ZaT44KS6KiI566XXHJcbiAgICAgICAgICAgIHZhciBuZXdEZWxheSA9IGRlbGF5LXByb2dyZXNzO1xyXG4gICAgICAgICAgICBuZXdEZWxheSA9IChuZXdEZWxheSA+IDApID8gbmV3RGVsYXkgOiAwO1xyXG5cclxuICAgICAgICAgICAgLy8g5qyh5Zue5ZG844Gz5Ye644GX55m76YyyXHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoYXJndW1lbnRzLmNhbGxlZSwgbmV3RGVsYXkpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgc2V0VGltZW91dCh0ZW1wLCBkZWxheSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHRtLmluZm9ybSA9IGZ1bmN0aW9uKHBhcmVudCl7XHJcbiAgICAgICAgcGFyZW50ID0gcGFyZW50IHx8IGRvY3VtZW50LmJvZHk7XHJcblxyXG4gICAgICAgIHZhciBlSW5mbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgZUluZm8uc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJ0bS1pbmZvXCIpO1xyXG4gICAgICAgIGVJbmZvLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGhpcy5zdHlsZS5vcGFjaXR5ID0gMC45O1xyXG4gICAgICAgIH0sIGZhbHNlKTtcclxuICAgICAgICBlSW5mby5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdXRcIiwgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGhpcy5zdHlsZS5vcGFjaXR5ID0gMC4yNTtcclxuICAgICAgICB9LCBmYWxzZSk7XHJcblxyXG4gICAgICAgIHdpdGgoZUluZm8uc3R5bGUpIHtcclxuICAgICAgICAgICAgcG9zaXRpb24gICAgPSBcImFic29sdXRlXCI7XHJcbiAgICAgICAgICAgIHdpZHRoICAgICAgID0gXCIxMDAlXCI7XHJcbiAgICAgICAgICAgIC8vIHRvcCAgICAgICAgID0gXCIwcHhcIjtcclxuICAgICAgICAgICAgYm90dG9tICAgICAgPSBcIjBweFwiO1xyXG4gICAgICAgICAgICBsZWZ0ICAgICAgICA9IFwiMHB4XCI7XHJcbiAgICAgICAgICAgIHJpZ2h0ICAgICAgID0gXCIwcHhcIjtcclxuICAgICAgICAgICAgbWFyZ2luICAgICAgPSBcIjBweFwiO1xyXG4gICAgICAgICAgICBwYWRkaW5nICAgICA9IFwiMTBweCAwcHhcIjtcclxuICAgICAgICAgICAgekluZGV4ICAgICAgPSBcIjBcIjtcclxuICAgICAgICAgICAgdGV4dEFsaWduICAgPSBcImNlbnRlclwiO1xyXG4gICAgICAgICAgICBmb250RmFtaWx5ICA9ICdcIk1laXJ5b1wiLCBcIuODoeOCpOODquOCqlwiLCBcIuODkuODqeOCruODjuinkuOCtCBQcm8gVzNcIiwgc2Fucy1zZXJpZic7XHJcbiAgICAgICAgICAgIGZvbnRTaXplICAgID0gXCIxM3B4XCI7XHJcbiAgICAgICAgICAgIG9wYWNpdHkgICAgID0gXCIwLjI1XCI7XHJcbiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvciA9IFwicmdiKDIzMCwyMzAsMjU1KVwiO1xyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kICA9IFwiLXdlYmtpdC1saW5lYXItZ3JhZGllbnQodG9wLCBoc2xhKDAsIDEwMCUsIDEwMCUsIDAuOCkgMCUsIGhzbGEoMCwgMTAwJSwgMTAwJSwgMC4zKSA1MCUsIGhzbGEoMCwgMTAwJSwgMTAwJSwgMC4xKSA1MSUsIGhzbGEoMCwgMTAwJSwgMTAwJSwgMC4yKSAxMDAlKSwgcmdiKDE5MCwxOTAsMjEwKVwiO1xyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kICA9IFwiLW1vei1saW5lYXItZ3JhZGllbnQodG9wLCBoc2xhKDAsIDEwMCUsIDEwMCUsIDAuOCkgMCUsIGhzbGEoMCwgMTAwJSwgMTAwJSwgMC4zKSA1MCUsIGhzbGEoMCwgMTAwJSwgMTAwJSwgMC4xKSA1MSUsIGhzbGEoMCwgMTAwJSwgMTAwJSwgMC4yKSAxMDAlKSwgcmdiKDE5MCwxOTAsMjEwKVwiO1xyXG4gICAgICAgICAgICBXZWJraXRUcmFuc2l0aW9uID0gXCIxc1wiO1xyXG4gICAgICAgICAgICBNb3pUcmFuc2l0aW9uID0gXCIxc1wiO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLypcclxuICAgICAgICBlSW5mby5pbm5lckhUTUwgPSBcIuOBk+OBruODl+ODreOCsOODqeODoOOBp+WIqeeUqOOBl+OBpuOBhOOCiyBKYXZhU2NyaXB0IOODqeOCpOODluODqeODqiDjgI50bWxpYi5qc+OAjyDjga88YSBocmVmPSd7dG1saWJMaW5rfSc+44GT44Gh44KJPC9hPuOBi+OCieODgOOCpuODs+ODreODvOODieOBp+OBjeOBvuOBmS4g6Kmz44GX44GP44GvPGEgaHJlZj0ne2Jsb2dMaW5rfSc+QmxvZzwvYT7jgavmm7jjgYTjgabjgYTjgb7jgZkuXCIuZm9ybWF0KHtcclxuICAgICAgICAgICAgXCJ0bWxpYkxpbmtcIjogXCJodHRwOi8vY29kZS5nb29nbGUuY29tL3AvdG1saWItanMvZG93bmxvYWRzL2xpc3RcIixcclxuICAgICAgICAgICAgXCJibG9nTGlua1wiIDogXCJodHRwOi8vdG1saWZlLm5ldC90bWxpYlwiXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgKi9cclxuICAgICAgICBlSW5mby5pbm5lckhUTUwgPSBcIuOBk+OBruODl+ODreOCsOODqeODoOOBp+WIqeeUqOOBl+OBpuOBhOOCiyBKYXZhU2NyaXB0IOODqeOCpOODluODqeODqiDjgI50bWxpYi5qc+OAjyDjgavjgaTjgYTjgabjga88YSBocmVmPSd7cHJvamVjdExpbmt9Jz7jgZPjgaHjgok8L2E+LlwiLmZvcm1hdCh7XHJcbiAgICAgICAgICAgIFwicHJvamVjdExpbmtcIiA6IFwiaHR0cHM6Ly9naXRodWIuY29tL3BoaTE2MTgvdG1saWIuanNcIlxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHBhcmVudC5hcHBlbmRDaGlsZChlSW5mbyk7XHJcbiAgICB9O1xyXG5cclxufSkoKTtcclxuXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgaWYgKCF3aW5kb3cpIHJldHVybiA7XHJcblxyXG4gICAgaWYgKCF3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKSB7XHJcbiAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSA9IHdpbmRvd1t0bS5WRU5ERVJfUFJFRklYICsgXCJSZXF1ZXN0QW5pbWF0aW9uRnJhbWVcIl0gfHwgZnVuY3Rpb24oY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoY2FsbGJhY2ssIDEwMDAvNjApO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCF3aW5kb3cuY2FuY2VsUmVxdWVzdEFuaW1hdGlvbkZyYW1lKSB7XHJcbiAgICAgICAgd2luZG93LmNhbmNlbFJlcXVlc3RBbmltYXRpb25GcmFtZSA9IHdpbmRvd1t0bS5WRU5ERVJfUFJFRklYICsgXCJDYW5jZWxSZXF1ZXN0QW5pbWF0aW9uRnJhbWVcIl0gfHwgd2luZG93LmNsZWFyVGltZW91dDtcclxuICAgIH1cclxuXHJcbn0pKCk7XHJcblxyXG5cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIGlmICghd2luZG93LmRvY3VtZW50KSByZXR1cm4gO1xyXG5cclxuICAgIHZhciBfbWFpbkxpc3RlbmVycyA9IFtdO1xyXG5cclxuICAgIHRtLm1haW4gICAgPSBmdW5jdGlvbihmbikge1xyXG4gICAgICAgIGlmIChmbikge1xyXG4gICAgICAgICAgICBfbWFpbkxpc3RlbmVycy5wdXNoKGZuKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIF9tYWluKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgX21haW4gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBmb3IgKHZhciBpPTAsbGVuPV9tYWluTGlzdGVuZXJzLmxlbmd0aDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICBfbWFpbkxpc3RlbmVyc1tpXSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgX21haW5MaXN0ZW5lcnMgPSBbXTtcclxuICAgIH07XHJcblxyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIF9tYWluKCk7XHJcbiAgICB9LCBmYWxzZSk7XHJcblxyXG59KSgpO1xyXG4vKlxyXG4gKiBvYmplY3QuanNcclxuICovXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIGdsb2JhbC5PYmplY3RcclxuICAgICAqIE9iamVjdOOBruaLoeW8tVxyXG4gICAgICovXHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCBkZWZpbmVWYXJpYWJsZVxyXG4gICAgICog5aSJ5pWw44KS6L+95YqgXHJcbiAgICAgKiBAcGFyYW0gICB7U3RyaW5nfSBrZXkgbmFtZVxyXG4gICAgICogQHBhcmFtICAge09iamVjdH0gcGFyYW1cclxuICAgICAqL1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE9iamVjdC5wcm90b3R5cGUsIFwiZGVmaW5lVmFyaWFibGVcIiwge1xyXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbihuYW1lLCB2YWwpIHtcclxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIG5hbWUsIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlOiB2YWwsXHJcbiAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgd3JpdGFibGU6IHRydWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCBkZWZpbmVGdW5jdGlvblxyXG4gICAgICog6Zai5pWw44KS6L+95YqgXHJcbiAgICAgKiBAcGFyYW0gICB7U3RyaW5nfSBrZXkgbmFtZVxyXG4gICAgICogQHBhcmFtICAge0Z1bmN0aW9ufSBmdW5jdGlvblxyXG4gICAgICovXHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoT2JqZWN0LnByb3RvdHlwZSwgXCJkZWZpbmVGdW5jdGlvblwiLCB7XHJcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKG5hbWUsIGZuKSB7XHJcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBuYW1lLCB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZTogZm4sXHJcbiAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2QgZGVmaW5lSW5zdGFuY2VWYXJpYWJsZVxyXG4gICAgICog44Kk44Oz44K544K/44Oz44K55aSJ5pWw44KS5a6a576p44GZ44KLXHJcbiAgICAgKi9cclxuICAgIE9iamVjdC5wcm90b3R5cGUuZGVmaW5lRnVuY3Rpb24oXCJkZWZpbmVJbnN0YW5jZVZhcmlhYmxlXCIsIGZ1bmN0aW9uKG5hbWUsIHZhbCl7XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMucHJvdG90eXBlLCBuYW1lLCB7XHJcbiAgICAgICAgICAgIHZhbHVlOiB2YWwsXHJcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kIGRlZmluZUluc3RhbmNlTWV0aG9kXHJcbiAgICAgKiDjgqTjg7Pjgrnjgr/jg7Pjgrnjg6Hjgr3jg4Pjg4njgpLlrprnvqnjgZnjgotcclxuICAgICAqL1xyXG4gICAgT2JqZWN0LnByb3RvdHlwZS5kZWZpbmVGdW5jdGlvbihcImRlZmluZUluc3RhbmNlTWV0aG9kXCIsIGZ1bmN0aW9uKG5hbWUsIGZuKXtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcy5wcm90b3R5cGUsIG5hbWUsIHtcclxuICAgICAgICAgICAgdmFsdWU6IGZuLFxyXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2Qgc2V0dGVyXHJcbiAgICAgKiDjgrvjg4Pjgr/jg7zjgpLlrprnvqnjgZnjgotcclxuICAgICAqL1xyXG4gICAgT2JqZWN0LmRlZmluZUluc3RhbmNlTWV0aG9kKFwic2V0dGVyXCIsIGZ1bmN0aW9uKG5hbWUsIGZuKXtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgbmFtZSwge1xyXG4gICAgICAgICAgICBzZXQ6IGZuLFxyXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kIGdldHRlclxyXG4gICAgICog44Ky44OD44K/44O844KS5a6a576p44GZ44KLXHJcbiAgICAgKi9cclxuICAgIE9iamVjdC5kZWZpbmVJbnN0YW5jZU1ldGhvZChcImdldHRlclwiLCBmdW5jdGlvbihuYW1lLCBmbil7XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIG5hbWUsIHtcclxuICAgICAgICAgICAgZ2V0OiBmbixcclxuICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCBhY2Nlc3NvclxyXG4gICAgICog44Ki44Kv44K744OD44K1KOOCu+ODg+OCv+ODvC/jgrLjg4Pjgr/jg7wp44KS5a6a576p44GZ44KLXHJcbiAgICAgKi9cclxuICAgIE9iamVjdC5kZWZpbmVJbnN0YW5jZU1ldGhvZChcImFjY2Vzc29yXCIsIGZ1bmN0aW9uKG5hbWUsIHBhcmFtKSB7XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIG5hbWUsIHtcclxuICAgICAgICAgICAgc2V0OiBwYXJhbVtcInNldFwiXSxcclxuICAgICAgICAgICAgZ2V0OiBwYXJhbVtcImdldFwiXSxcclxuICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCAkZm9ySW5cclxuICAgICAqIOOCquODluOCuOOCp+OCr+ODiOeUqOODq+ODvOODl+WHpueQhlxyXG4gICAgICovXHJcbiAgICBPYmplY3QuZGVmaW5lSW5zdGFuY2VNZXRob2QoXCIkZm9ySW5cIiwgZnVuY3Rpb24oZm4sIHNlbGYpIHtcclxuICAgICAgICBzZWxmID0gc2VsZiB8fCB0aGlzO1xyXG5cclxuICAgICAgICBPYmplY3Qua2V5cyh0aGlzKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSwgaW5kZXgpIHtcclxuICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpc1trZXldO1xyXG5cclxuICAgICAgICAgICAgZm4uY2FsbChzZWxmLCBrZXksIHZhbHVlLCBpbmRleCk7XHJcbiAgICAgICAgfSwgdGhpcyk7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kICAkaGFzXHJcbiAgICAgKiDjgZ3jga7jg5fjg63jg5Hjg4bjgqPjgpLmjIHjgaPjgabjgYTjgovjgYvjgpLliKTlrprjgZnjgotcclxuICAgICAqL1xyXG4gICAgT2JqZWN0LmRlZmluZUluc3RhbmNlTWV0aG9kKFwiJGhhc1wiLCBmdW5jdGlvbihrZXkpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5oYXNPd25Qcm9wZXJ0eShrZXkpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kICAkZXh0ZW5kXHJcbiAgICAgKiDku5bjga7jg6njgqTjg5bjg6njg6rjgajnq7blkIjjgZfjgaHjgoPjgYbjga7jgacgZXh0ZW5kIC0+ICRleHRlbmQg44Go44GX44G+44GX44GfXHJcbiAgICAgKi9cclxuICAgIE9iamVjdC5kZWZpbmVJbnN0YW5jZU1ldGhvZChcIiRleHRlbmRcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChhcmd1bWVudHMsIGZ1bmN0aW9uKHNvdXJjZSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBwcm9wZXJ0eSBpbiBzb3VyY2UpIHtcclxuICAgICAgICAgICAgICAgIHRoaXNbcHJvcGVydHldID0gc291cmNlW3Byb3BlcnR5XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHRoaXMpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCAgJHNhZmVcclxuICAgICAqIOWuieWFqOaLoeW8tVxyXG4gICAgICog5LiK5pu444GN44GX44Gq44GEXHJcbiAgICAgKi9cclxuICAgIE9iamVjdC5kZWZpbmVJbnN0YW5jZU1ldGhvZChcIiRzYWZlXCIsIGZ1bmN0aW9uKHNvdXJjZSkge1xyXG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoYXJndW1lbnRzLCBmdW5jdGlvbihzb3VyY2UpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgcHJvcGVydHkgaW4gc291cmNlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpc1twcm9wZXJ0eV0gPT09IHVuZGVmaW5lZCkgdGhpc1twcm9wZXJ0eV0gPSBzb3VyY2VbcHJvcGVydHldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgdGhpcyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2QgICRzdHJpY3RcclxuICAgICAqIOWOs+agvOaLoeW8tVxyXG4gICAgICog44GZ44Gn44Gr44GC44Gj44Gf5aC05ZCI44Gv6K2m5ZGKXHJcbiAgICAgKi9cclxuICAgIE9iamVjdC5kZWZpbmVJbnN0YW5jZU1ldGhvZChcIiRzdHJpY3RcIiwgZnVuY3Rpb24oc291cmNlKSB7XHJcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChhcmd1bWVudHMsIGZ1bmN0aW9uKHNvdXJjZSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBwcm9wZXJ0eSBpbiBzb3VyY2UpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuYXNzZXJ0KCF0aGlzW3Byb3BlcnR5XSwgXCJ0bSBlcnJvcjogezB9IGlzIEFscmVhZHlcIi5mb3JtYXQocHJvcGVydHkpKTtcclxuICAgICAgICAgICAgICAgIHRoaXNbcHJvcGVydHldID0gc291cmNlW3Byb3BlcnR5XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHRoaXMpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kICAkcGlja1xyXG4gICAgICog44OU44OD44KvXHJcbiAgICAgKi9cclxuICAgIE9iamVjdC5kZWZpbmVJbnN0YW5jZU1ldGhvZChcIiRwaWNrXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciB0ZW1wID0ge307XHJcblxyXG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoYXJndW1lbnRzLCBmdW5jdGlvbihrZXkpIHtcclxuICAgICAgICAgICAgaWYgKGtleSBpbiB0aGlzKSB0ZW1wW2tleV0gPSB0aGlzW2tleV07XHJcbiAgICAgICAgfSwgdGhpcyk7XHJcblxyXG4gICAgICAgIHJldHVybiB0ZW1wO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kICAkb21pdFxyXG4gICAgICog44Kq44Of44OD44OIXHJcbiAgICAgKi9cclxuICAgIE9iamVjdC5kZWZpbmVJbnN0YW5jZU1ldGhvZChcIiRvbWl0XCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciB0ZW1wID0ge307XHJcblxyXG4gICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzKSB7XHJcbiAgICAgICAgICAgIGlmIChBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGFyZ3VtZW50cywga2V5KSA9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgdGVtcFtrZXldID0gdGhpc1trZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdGVtcDtcclxuICAgIH0pO1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuLypcclxuICogYXJyYXkuanNcclxuICovXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzICAgZ2xvYmFsLkFycmF5XHJcbiAgICAgKiBBcnJheeOBruaLoeW8tVxyXG4gICAgICogXHJcbiAgICAgKiAgICAgIEBleGFtcGxlIGRpc3BsYXlcclxuICAgICAqICAgICAgWzEsIDIsIDNdLmZpcnN0O1xyXG4gICAgICovXHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGZpcnN0XHJcbiAgICAgKiDmnIDliJ3jga7opoHntKBcclxuICAgICAqL1xyXG4gICAgQXJyYXkucHJvdG90eXBlLmFjY2Vzc29yKFwiZmlyc3RcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzWzBdOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXNbMF0gPSB2OyB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgbGFzdFxyXG4gICAgICog5pyA5b6M44Gu6KaB57SgXHJcbiAgICAgKi9cclxuICAgIEFycmF5LnByb3RvdHlwZS5hY2Nlc3NvcihcImxhc3RcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzW3RoaXMubGVuZ3RoLTFdOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXNbdGhpcy5sZW5ndGgtMV0gPSB2OyB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2QgIGVxdWFsc1xyXG4gICAgICog5rih44GV44KM44Gf6YWN5YiX44Go562J44GX44GE44GL44Gp44GG44GL44KS44OB44Kn44OD44KvXHJcbiAgICAgKi9cclxuICAgIEFycmF5LmRlZmluZUluc3RhbmNlTWV0aG9kKFwiZXF1YWxzXCIsIGZ1bmN0aW9uKGFycikge1xyXG4gICAgICAgIC8vIOmVt+OBleODgeOCp+ODg+OCr1xyXG4gICAgICAgIGlmICh0aGlzLmxlbmd0aCAhPT0gYXJyLmxlbmd0aCkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGZvciAodmFyIGk9MCxsZW49dGhpcy5sZW5ndGg7IGk8bGVuOyArK2kpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXNbaV0gIT09IGFycltpXSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCAgZGVlcEVxdWFsc1xyXG4gICAgICog44ON44K544OI44GV44KM44Gm44GE44KL6YWN5YiX5ZCr44KB5rih44GV44KM44Gf6YWN5YiX44Go562J44GX44GE44GL44Gp44GG44GL44KS44OB44Kn44OD44KvXHJcbiAgICAgKiBlcXVhbHNEZWVwIOOBq+OBmeOCi+OBi+aknOioji4gKEphdmEg44Gn44GvIGRlZXBFcXVhbHMg44Gq44Gu44Gn44Go44KK44GC44GI44Ga5ZCI44KP44Gb44Go44GPKVxyXG4gICAgICovXHJcbiAgICBBcnJheS5kZWZpbmVJbnN0YW5jZU1ldGhvZChcImRlZXBFcXVhbHNcIiwgZnVuY3Rpb24oYXJyKSB7XHJcbiAgICAgICAgLy8g6ZW344GV44OB44Kn44OD44KvXHJcbiAgICAgICAgaWYgKHRoaXMubGVuZ3RoICE9PSBhcnIubGVuZ3RoKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZm9yICh2YXIgaT0wLGxlbj10aGlzLmxlbmd0aDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gKHRoaXNbaV0uZGVlcEVxdWFscykgPyB0aGlzW2ldLmRlZXBFcXVhbHMoYXJyW2ldKSA6ICh0aGlzW2ldID09PSBhcnJbaV0pO1xyXG4gICAgICAgICAgICBpZiAocmVzdWx0ID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgY29udGFpbnNcclxuICAgICAqIOimgee0oOOBjOWQq+OBvuOCjOOBhOOCi+OBi+OCkuODgeOCp+ODg+OCr1xyXG4gICAgICovXHJcbiAgICBBcnJheS5kZWZpbmVJbnN0YW5jZU1ldGhvZChcImNvbnRhaW5zXCIsIGZ1bmN0aW9uKGl0ZW0sIGZyb21JbmRleCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmluZGV4T2YoaXRlbSwgZnJvbUluZGV4KSAhPSAtMTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2QgIGF0XHJcbiAgICAgKiDjg6vjg7zjg5fmt7vlrZfjgqLjgq/jgrvjgrkoUnVieSDjgaPjgb3jgYTjgoTjgaQpXHJcbiAgICAgKi9cclxuICAgIEFycmF5LmRlZmluZUluc3RhbmNlTWV0aG9kKFwiYXRcIiwgZnVuY3Rpb24oaSkge1xyXG4gICAgICAgIGklPXRoaXMubGVuZ3RoO1xyXG4gICAgICAgIGkrPXRoaXMubGVuZ3RoO1xyXG4gICAgICAgIGklPXRoaXMubGVuZ3RoO1xyXG4gICAgICAgIHJldHVybiB0aGlzW2ldO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kICBzd2FwXHJcbiAgICAgKiBh55Wq55uuIOOBqCBi55Wq55uuIOOCkuWFpeOCjOabv+OBiOOCi1xyXG4gICAgICovXHJcbiAgICBBcnJheS5kZWZpbmVJbnN0YW5jZU1ldGhvZChcInN3YXBcIiwgZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICAgIHZhciB0ZW1wID0gdGhpc1thXTtcclxuICAgICAgICB0aGlzW2FdID0gdGhpc1tiXTtcclxuICAgICAgICB0aGlzW2JdID0gdGVtcDtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCAgZXJhc2VcclxuICAgICAqIGVsbSDjgajkuIDoh7TjgZnjgovopoHntKDjgpLliYrpmaRcclxuICAgICAqL1xyXG4gICAgQXJyYXkuZGVmaW5lSW5zdGFuY2VNZXRob2QoXCJlcmFzZVwiLCBmdW5jdGlvbihlbG0pIHtcclxuICAgICAgICB2YXIgaW5kZXggID0gdGhpcy5pbmRleE9mKGVsbSk7XHJcbiAgICAgICAgaWYgKGluZGV4ID49IDApIHtcclxuICAgICAgICAgICAgdGhpcy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2QgIGVyYXNlQWxsXHJcbiAgICAgKiBlbG0g44Go5LiA6Ie044GZ44KL6KaB57Sg44KS5YWo44Gm5YmK6ZmkXHJcbiAgICAgKi9cclxuICAgIEFycmF5LmRlZmluZUluc3RhbmNlTWV0aG9kKFwiZXJhc2VBbGxcIiwgZnVuY3Rpb24oZWxtKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaT0wLGxlbj10aGlzLmxlbmd0aDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICBpZiAodGhpc1tpXSA9PSBlbG0pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3BsaWNlKGktLSwgMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kICBlcmFzZUlmXHJcbiAgICAgKiDmnaHku7bjgavjg57jg4Pjg4HjgZfjgZ/opoHntKDjgpLliYrpmaRcclxuICAgICAqL1xyXG4gICAgQXJyYXkuZGVmaW5lSW5zdGFuY2VNZXRob2QoXCJlcmFzZUlmXCIsIGZ1bmN0aW9uKGZuKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaT0wLGxlbj10aGlzLmxlbmd0aDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICBpZiAoIGZuKHRoaXNbaV0sIGksIHRoaXMpICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBpZiAoIGZuKHRoaXNbaV0sIGksIHRoaXMpICkgeyB0aGlzLnNwbGljZShpLS0sIDEpOyB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCAgZXJhc2VJZkFsbFxyXG4gICAgICog5p2h5Lu244Gr44Oe44OD44OB44GX44Gf6KaB57Sg44KS5YmK6ZmkXHJcbiAgICAgKi9cclxuICAgIEFycmF5LmRlZmluZUluc3RhbmNlTWV0aG9kKFwiZXJhc2VJZkFsbFwiLCBmdW5jdGlvbihmbikge1xyXG4gICAgICAgIGZvciAodmFyIGk9MCxsZW49dGhpcy5sZW5ndGg7IGk8bGVuOyArK2kpIHtcclxuICAgICAgICAgICAgaWYgKCBmbih0aGlzW2ldLCBpLCB0aGlzKSApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCAgcmFuZG9tXHJcbiAgICAgKiDopoHntKDjga7kuK3jgYvjgonjg6njg7Pjg4Djg6Djgaflj5bjgorlh7rjgZlcclxuICAgICAqL1xyXG4gICAgQXJyYXkuZGVmaW5lSW5zdGFuY2VNZXRob2QoXCJyYW5kb21cIiwgZnVuY3Rpb24obWluLCBtYXgpIHtcclxuICAgICAgICBtaW4gPSBtaW4gfHwgMDtcclxuICAgICAgICBtYXggPSBtYXggfHwgdGhpcy5sZW5ndGgtMTtcclxuICAgICAgICByZXR1cm4gdGhpc1sgTWF0aC5yYW5kKG1pbiwgbWF4KSBdO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCAgcGlja3VwXHJcbiAgICAgKiDopoHntKDjga7kuK3jgYvjgonjg6njg7Pjg4Djg6Djgaflj5bjgorlh7rjgZlcclxuICAgICAqL1xyXG4gICAgQXJyYXkuZGVmaW5lSW5zdGFuY2VNZXRob2QoXCJwaWNrdXBcIiwgZnVuY3Rpb24obWluLCBtYXgpIHtcclxuICAgICAgICBtaW4gPSBtaW4gfHwgMDtcclxuICAgICAgICBtYXggPSBtYXggfHwgdGhpcy5sZW5ndGgtMTtcclxuICAgICAgICByZXR1cm4gdGhpc1sgTWF0aC5yYW5kKG1pbiwgbWF4KSBdO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCAgdW5pcVxyXG4gICAgICog6YeN6KSH5YmK6ZmkXHJcbiAgICAgKi9cclxuICAgIEFycmF5LmRlZmluZUluc3RhbmNlTWV0aG9kKFwidW5pcVwiLCBmdW5jdGlvbihkZWVwKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZmlsdGVyKGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgc2VsZikge1xyXG4gICAgICAgICAgICByZXR1cm4gc2VsZi5pbmRleE9mKHZhbHVlKSA9PT0gaW5kZXg7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCAgZmxhdHRlblxyXG4gICAgICog44OV44Op44OD44OILlxyXG4gICAgICogUnVieSDjga7jgoTjgaQuXHJcbiAgICAgKi9cclxuICAgIEFycmF5LmRlZmluZUluc3RhbmNlTWV0aG9kKFwiZmxhdHRlblwiLCBmdW5jdGlvbihsZXZlbCkge1xyXG4gICAgICAgIHZhciBhcnIgPSBudWxsO1xyXG5cclxuICAgICAgICBpZiAobGV2ZWwpIHtcclxuICAgICAgICAgICAgYXJyID0gdGhpcztcclxuICAgICAgICAgICAgZm9yICh2YXIgaT0wOyBpPGxldmVsOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIGFyciA9IEFycmF5LnByb3RvdHlwZS5jb25jYXQuYXBwbHkoW10sIGFycik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIOWujOWFqOODleODqeODg+ODiFxyXG4gICAgICAgICAgICBhcnIgPSB0aGlzLnJlZHVjZShmdW5jdGlvbiAocHJldmlvdXNWYWx1ZSwgY3VyZW50VmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBBcnJheS5pc0FycmF5KGN1cmVudFZhbHVlKSA/XHJcbiAgICAgICAgICAgICAgICAgICAgcHJldmlvdXNWYWx1ZS5jb25jYXQoY3VyZW50VmFsdWUuZmxhdHRlbigpKSA6IHByZXZpb3VzVmFsdWUuY29uY2F0KGN1cmVudFZhbHVlKTtcclxuICAgICAgICAgICAgfSwgW10pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGFycjtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2QgIGNsb25lXHJcbiAgICAgKiDphY3liJfjgpLjgq/jg63jg7zjg7NcclxuICAgICAqL1xyXG4gICAgQXJyYXkuZGVmaW5lSW5zdGFuY2VNZXRob2QoXCJjbG9uZVwiLCBmdW5jdGlvbihkZWVwKSB7XHJcbiAgICAgICAgaWYgKGRlZXAgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICB2YXIgYSA9IEFycmF5KHRoaXMubGVuZ3RoKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaT0wLGxlbj10aGlzLmxlbmd0aDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICAgICAgYVtpXSA9ICh0aGlzW2ldLmNsb25lKSA/IHRoaXNbaV0uY2xvbmUoZGVlcCkgOiB0aGlzW2ldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBhO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseSh0aGlzKTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2QgIGNsZWFyXHJcbiAgICAgKiDjgq/jg6rjgqJcclxuICAgICAqL1xyXG4gICAgQXJyYXkuZGVmaW5lSW5zdGFuY2VNZXRob2QoXCJjbGVhclwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmxlbmd0aCA9IDA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kICBmaWxsXHJcbiAgICAgKiDnibnlrprjga7lgKTjgafmuoDjgZ/jgZlcclxuICAgICAqL1xyXG4gICAgQXJyYXkuZGVmaW5lSW5zdGFuY2VNZXRob2QoXCJmaWxsXCIsIGZ1bmN0aW9uKHZhbHVlLCBzdGFydCwgZW5kKSB7XHJcbiAgICAgICAgc3RhcnQgPSBzdGFydCB8fCAwO1xyXG4gICAgICAgIGVuZCAgID0gZW5kICAgfHwgKHRoaXMubGVuZ3RoKTtcclxuICAgICAgICBcclxuICAgICAgICBmb3IgKHZhciBpPXN0YXJ0OyBpPGVuZDsgKytpKSB7XHJcbiAgICAgICAgICAgIHRoaXNbaV0gPSB2YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9KTtcclxuICAgIFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCAgcmFuZ2VcclxuICAgICAqIHB5dGhvbiDjga7jgoTjgaRcclxuICAgICAqL1xyXG4gICAgQXJyYXkuZGVmaW5lSW5zdGFuY2VNZXRob2QoXCJyYW5nZVwiLCBmdW5jdGlvbihzdGFydCwgZW5kLCBzdGVwKSB7XHJcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMSkge1xyXG4gICAgICAgICAgICB0aGlzLmNsZWFyKCk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGk9MDsgaTxzdGFydDsgKytpKSB0aGlzW2ldID0gaTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoc3RhcnQgPCBlbmQpe1xyXG4gICAgICAgICAgICBzdGVwICA9IHN0ZXAgfHwgMTtcclxuICAgICAgICAgICAgdGhpcy5jbGVhcigpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpPXN0YXJ0LCBpbmRleD0wOyBpPGVuZDsgaSs9c3RlcCwgKytpbmRleCkge1xyXG4gICAgICAgICAgICAgICAgdGhpc1tpbmRleF0gPSBpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBzdGVwICA9IHN0ZXAgfHwgLTE7XHJcbiAgICAgICAgICAgIHRoaXMuY2xlYXIoKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaT1zdGFydCwgaW5kZXg9MDsgaT5lbmQ7IGkrPXN0ZXAsICsraW5kZXgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXNbaW5kZXhdID0gaTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2QgIHNodWZmbGVcclxuICAgICAqIOOCt+ODo+ODg+ODleODq1xyXG4gICAgICovXHJcbiAgICBBcnJheS5kZWZpbmVJbnN0YW5jZU1ldGhvZChcInNodWZmbGVcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaT0wLGxlbj10aGlzLmxlbmd0aDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICB2YXIgaiA9IE1hdGgucmFuZCgwLCBsZW4tMSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoaSAhPSBqKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN3YXAoaSwgaik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2QgIHN1bVxyXG4gICAgICog5ZCI6KiIXHJcbiAgICAgKi9cclxuICAgIEFycmF5LmRlZmluZUluc3RhbmNlTWV0aG9kKFwic3VtXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzdW0gPSAwO1xyXG4gICAgICAgIGZvciAodmFyIGk9MCxsZW49dGhpcy5sZW5ndGg7IGk8bGVuOyArK2kpIHtcclxuICAgICAgICAgICAgc3VtICs9IHRoaXNbaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBzdW07XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2QgIGF2ZXJhZ2VcclxuICAgICAqIOW5s+Wdh1xyXG4gICAgICovXHJcbiAgICBBcnJheS5kZWZpbmVJbnN0YW5jZU1ldGhvZChcImF2ZXJhZ2VcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHN1bSA9IDA7XHJcbiAgICAgICAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoO1xyXG4gICAgICAgIGZvciAodmFyIGk9MDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICBzdW0gKz0gdGhpc1tpXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHN1bS9sZW47XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2QgIGVhY2hcclxuICAgICAqIOe5sOOCiui/lOOBl1xyXG4gICAgICog44OB44Kn44O844Oz44Oh44K944OD44OJ5a++5b+cXHJcbiAgICAgKi9cclxuICAgIEFycmF5LmRlZmluZUluc3RhbmNlTWV0aG9kKFwiZWFjaFwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmZvckVhY2guYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH0pO1xyXG5cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kICB0b1VMRWxlbWVudFxyXG4gICAgICogVUxFbGVtZW50IOOBq+WkieaPm1xyXG4gICAgICovXHJcbiAgICBBcnJheS5kZWZpbmVJbnN0YW5jZU1ldGhvZChcInRvVUxFbGVtZW50XCIsIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgLy8gVE9ETzogXHJcbiAgICB9KTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2QgIHRvT0xFbGVtZW50XHJcbiAgICAgKiBPTEVsZW1lbnQg44Gr5aSJ5o+bXHJcbiAgICAgKi9cclxuICAgIEFycmF5LmRlZmluZUluc3RhbmNlTWV0aG9kKFwidG9PTEVsZW1lbnRcIiwgZnVuY3Rpb24oKXtcclxuICAgICAgICAvLyBUT0RPOlxyXG4gICAgfSk7XHJcblxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEBtZXRob2QgIHJhbmdlXHJcbiAgICAgKiByYW5nZVxyXG4gICAgICovXHJcbiAgICBBcnJheS5kZWZpbmVGdW5jdGlvbihcInJhbmdlXCIsIGZ1bmN0aW9uKHN0YXJ0LCBlbmQsIHN0ZXApIHtcclxuICAgICAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLnJhbmdlLmFwcGx5KFtdLCBhcmd1bWVudHMpO1xyXG4gICAgfSk7XHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG4vKlxyXG4gKiBkYXRlLmpzXHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyAgIGdsb2JhbC5EYXRlXHJcbiAgICAgKiBEYXRlKOaXpeS7mCnjga7mi6HlvLVcclxuICAgICAqL1xyXG4gICAgXHJcbiAgICB2YXIgTU9OVEggPSBbXHJcbiAgICAgICAgXCJKYW51YXJ5XCIsIFwiRmVicnVhcnlcIiwgXCJNYXJjaFwiLCBcIkFwcmlsXCIsIFwiTWF5XCIsIFwiSnVuZVwiLCBcIkp1bHlcIiwgXCJBdWd1c3RcIiwgXCJTZXB0ZW1iZXJcIiwgXCJPY3RvYmVyXCIsIFwiTm92ZW1iZXJcIiwgXCJEZWNlbWJlclwiXHJcbiAgICBdO1xyXG4gICAgXHJcbiAgICB2YXIgV0VFSyA9IFtcclxuICAgICAgICBcIlN1bmRheVwiLCBcIk1vbmRheVwiLCBcIlR1ZXNkYXlcIiwgXCJXZWRuZXNkYXlcIiwgXCJUaHVyc2RheVwiLCBcIkZyaWRheVwiLCBcIlNhdHVyZGF5XCJcclxuICAgIF07XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCAgZm9ybWF0XHJcbiAgICAgKiDml6Xku5jjg5Xjgqnjg7zjg57jg4Pjg4jjgavlkIjjgo/jgZvjgZ/mloflrZfliJfjgpLov5TjgZlcclxuICAgICAqL1xyXG4gICAgRGF0ZS5kZWZpbmVJbnN0YW5jZU1ldGhvZChcImZvcm1hdFwiLCBmdW5jdGlvbihwYXR0ZXJuKSB7XHJcbiAgICAgICAgLypcclxuICAgICAgICB2YXIgc3RyID0gXCJ7eX0ve219L3tkfVwiLmZvcm1hdCh7XHJcbiAgICAgICAgICAgIHk6IHRoaXMuZ2V0WWVhcigpKzE5MDAsXHJcbiAgICAgICAgICAgIG06IHRoaXMuZ2V0TW9udGgoKSsxLFxyXG4gICAgICAgICAgICBkOiB0aGlzLmdldERhdGUoKSxcclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gc3RyO1xyXG4gICAgICAgICovXHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIHllYXIgICAgPSB0aGlzLmdldEZ1bGxZZWFyKCk7XHJcbiAgICAgICAgdmFyIG1vbnRoICAgPSB0aGlzLmdldE1vbnRoKCk7XHJcbiAgICAgICAgdmFyIGRhdGUgICAgPSB0aGlzLmdldERhdGUoKTtcclxuICAgICAgICB2YXIgZGF5ICAgICA9IHRoaXMuZ2V0RGF5KCk7XHJcbiAgICAgICAgdmFyIGhvdXJzICAgPSB0aGlzLmdldEhvdXJzKCk7XHJcbiAgICAgICAgdmFyIG1pbnV0ZXMgPSB0aGlzLmdldE1pbnV0ZXMoKTtcclxuICAgICAgICB2YXIgc2Vjb25kcyA9IHRoaXMuZ2V0U2Vjb25kcygpO1xyXG4gICAgICAgIHZhciBtaWxsc2Vjb25kcyA9IHRoaXMuZ2V0TWlsbGlzZWNvbmRzKCk7XHJcbiAgICAgICAgdmFyIHN0ciA9IFwiXCI7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZm9yICh2YXIgaT0wLGxlbj1wYXR0ZXJuLmxlbmd0aDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICB2YXIgY2ggPSBwYXR0ZXJuLmNoYXJBdChpKTtcclxuICAgICAgICAgICAgdmFyIHRlbXAgPSBcIlwiO1xyXG4gICAgICAgICAgICBzd2l0Y2goY2gpIHtcclxuICAgICAgICAgICAgICAgIC8vIOaXpVxyXG4gICAgICAgICAgICAgICAgY2FzZSBcImRcIjogdGVtcCA9IGRhdGUucGFkZGluZygyLCAnMCcpOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJEXCI6IHRlbXAgPSBXRUVLW2RheV0uc3Vic3RyKDAsIDMpOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJqXCI6IHRlbXAgPSBkYXRlOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJsXCI6IHRlbXAgPSBXRUVLW2RheV07IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgLy8gY2FzZSBcIk5cIjogdGVtcCA9IDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAvLyBjYXNlIFwiU1wiOiB0ZW1wID0gOyBicmVhaztcclxuICAgICAgICAgICAgICAgIC8vIGNhc2UgXCJ3XCI6IHRlbXAgPSA7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgLy8gY2FzZSBcInpcIjogdGVtcCA9IDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIOaciFxyXG4gICAgICAgICAgICAgICAgY2FzZSBcIkZcIjogdGVtcCA9IE1PTlRIW21vbnRoXTsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwibVwiOiB0ZW1wID0gKG1vbnRoKzEpLnBhZGRpbmcoMiwgJzAnKTsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiTVwiOiB0ZW1wID0gTU9OVEhbbW9udGhdLnN1YnN0cigwLCAzKTsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiblwiOiB0ZW1wID0gKG1vbnRoKzEpOyBicmVhaztcclxuICAgICAgICAgICAgICAgIC8vIGNhc2UgXCJ0XCI6IHRlbXAgPSAobW9udGgrMSk7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyDlubRcclxuICAgICAgICAgICAgICAgIC8vIGNhc2UgXCJMXCI6IHRlbXAgPSA7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgLy8gY2FzZSBcIm9cIjogdGVtcCA9IDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiWVwiOiB0ZW1wID0geWVhcjsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwieVwiOiB0ZW1wID0geWVhci50b1N0cmluZygpLnN1YnN0cigyLCAyKTsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8g5pmC6ZaTXHJcbiAgICAgICAgICAgICAgICAvLyBjYXNlIFwiYVwiOiB0ZW1wID0gOyBicmVhaztcclxuICAgICAgICAgICAgICAgIC8vIGNhc2UgXCJBXCI6IHRlbXAgPSA7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgLy8gY2FzZSBcIkJcIjogdGVtcCA9IDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAvLyBjYXNlIFwiZ1wiOiB0ZW1wID0gOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJHXCI6IHRlbXAgPSBob3VyczsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAvLyBjYXNlIFwiaFwiOiB0ZW1wID0gOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJIXCI6IHRlbXAgPSBob3Vycy5wYWRkaW5nKDIsICcwJyk7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcImlcIjogdGVtcCA9IG1pbnV0ZXMucGFkZGluZygyLCAnMCcpOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJzXCI6IHRlbXAgPSBzZWNvbmRzLnBhZGRpbmcoMiwgJzAnKTsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiU1wiOiB0ZW1wID0gbWlsbHNlY29uZHMucGFkZGluZygzLCAnMCcpOyBicmVhaztcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdCA6IHRlbXAgPSBjaDsgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc3RyICs9IHRlbXA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBzdHI7XHJcbiAgICB9KTtcclxuICAgIFxyXG59KSgpO1xyXG5cclxuXHJcbi8qXHJcbiAqIGZ1bmN0aW9uLmpzXHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyAgIGdsb2JhbC5GdW5jdGlvblxyXG4gICAgICogRnVuY3Rpb27jga7mi6HlvLVcclxuICAgICAqL1xyXG4gICAgaWYgKCFGdW5jdGlvbi5wcm90b3R5cGUuYmluZCkge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBtZW1iZXIgIGdsb2JhbC5GdW5jdGlvblxyXG4gICAgICAgICAqIEBtZXRob2QgIGJpbmRcclxuICAgICAgICAgKiDjg5DjgqTjg7Pjg4lcclxuICAgICAgICAgKi9cclxuICAgICAgICBGdW5jdGlvbi5kZWZpbmVJbnN0YW5jZU1ldGhvZChcImJpbmRcIiwgZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuYXBwbHkob2JqLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvLyDplqLmlbDlkI3vvIjnhKHlkI3plqLmlbDjga/nqbrmloflrZfliJfvvInjgpLlj5blvpcgKElF55So44OR44OD44OBKVxyXG4gICAgaWYgKCFGdW5jdGlvbi5wcm90b3R5cGUuJGhhcyhcIm5hbWVcIikpIHtcclxuICAgICAgICBGdW5jdGlvbi5wcm90b3R5cGUuZ2V0dGVyKFwibmFtZVwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICgnJyt0aGlzKS5yZXBsYWNlKC9eXFxzKmZ1bmN0aW9uXFxzKihbXlxcKF0qKVtcXFNcXHNdKyQvaW0sICckMScpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kICB0b0FycmF5RnVuY3Rpb25cclxuICAgICAqIOmWouaVsOOCkumFjeWIl+WvvuW/nOmWouaVsOOBq+WkieaPmy5cclxuICAgICAqIGZvckVhY2gg44Gu6YCG44Ki44OX44Ot44O844OB55qE44Gq5oSf44GYLlxyXG4gICAgICog6YWN5YiX44KS57aZ5om/44GX44Gf44Kv44Op44K544Gq44Gp44Gr5L2/55So44GZ44KLLlxyXG4gICAgICogIyMgRXhhbXBsZVxyXG4gICAgICogICAgICB2YXIgaG9nZSA9IGZ1bmN0aW9uKG4pIHsgY29uc29sZS5sb2codGhpcypuKTsgcmV0dXJuIHRoaXMqbjsgfTtcclxuICAgICAqICAgICAgdmFyIGFyciA9IFs1LCAxMCwgMTVdO1xyXG4gICAgICogICAgICBhcnIuaG9nZUFycmF5ID0gaG9nZS50b0FycmF5RnVuY3Rpb24oKTtcclxuICAgICAqICAgICAgdmFyIHJlc3VsdCA9IGFyci5ob2dlQXJyYXkoMTAwKTtcclxuICAgICAqICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcclxuICAgICAqL1xyXG4gICAgRnVuY3Rpb24uZGVmaW5lSW5zdGFuY2VNZXRob2QoXCJ0b0FycmF5RnVuY3Rpb25cIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdExpc3QgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaT0wLGxlbj10aGlzLmxlbmd0aDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0TGlzdC5wdXNoKCBzZWxmLmFwcGx5KHRoaXNbaV0sIGFyZ3VtZW50cykgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0TGlzdDtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLy8gZm9yRWFjaCDjgoQgbWFwIOOBr+OCguOBhuaomea6luWMluOBleOCjOOBpuOBjeOBpuOCi+OBruOBp+Wun+ijheOBl+OBquOBhOOCiOOCk+KZqlxyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuLypcclxuICogbWF0aC5qc1xyXG4gKi9cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgZ2xvYmFsLk1hdGhcclxuICAgICAqIE1hdGjjga7mi6HlvLVcclxuICAgICAqL1xyXG5cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgREVHX1RPX1JBRFxyXG4gICAgICogRGVncmVlIHRvIFJhZGlhbi5cclxuICAgICAqL1xyXG4gICAgTWF0aC5ERUdfVE9fUkFEID0gTWF0aC5QSS8xODA7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIFJBRF9UT19ERUdcclxuICAgICAqIFJhZGlhbiB0byBEZWdyZWUuXHJcbiAgICAgKi9cclxuICAgIE1hdGguUkFEX1RPX0RFRyA9IDE4MC9NYXRoLlBJO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIERlZ3JlZSDjgpIgUmFkaWFuIOOBq+WkieaPm1xyXG4gICAgICovXHJcbiAgICBNYXRoLmRlZ1RvUmFkID0gZnVuY3Rpb24oZGVnKSB7XHJcbiAgICAgICAgcmV0dXJuIGRlZyAqIE1hdGguREVHX1RPX1JBRDtcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZFxyXG4gICAgICogUmFkaWFuIOOCkiBEZWdyZWUg44Gr5aSJ5o+bXHJcbiAgICAgKi9cclxuICAgIE1hdGgucmFkVG9EZWcgPSBmdW5jdGlvbihyYWQpIHtcclxuICAgICAgICByZXR1cm4gcmFkICogTWF0aC5SQURfVE9fREVHO1xyXG4gICAgfTtcclxuICAgIFxyXG5cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiDjgq/jg6njg7Pjg5dcclxuICAgICAqL1xyXG4gICAgTWF0aC5kZWZpbmVGdW5jdGlvbihcImNsYW1wXCIsIGZ1bmN0aW9uKHZhbHVlLCBtaW4sIG1heCkge1xyXG4gICAgICAgIHJldHVybiAodmFsdWUgPCBtaW4pID8gbWluIDogKCAodmFsdWUgPiBtYXgpID8gbWF4IDogdmFsdWUgKTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIG1pbiA8PSB2YWx1ZSA8PSBtYXgg44Gu44Go44GNIHRydWUg44KS6L+U44GZXHJcbiAgICAgKi9cclxuICAgIE1hdGguZGVmaW5lRnVuY3Rpb24oXCJpbnNpZGVcIiwgZnVuY3Rpb24odmFsdWUsIG1pbiwgbWF4KSB7XHJcbiAgICAgICAgcmV0dXJuICh2YWx1ZSA+PSBtaW4pICYmICh2YWx1ZSkgPD0gbWF4O1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZFxyXG4gICAgICog44Op44Oz44OA44Og44Gq5YCk44KS5oyH5a6a44GV44KM44Gf56+E5Zuy5YaF44Gn55Sf5oiQXHJcbiAgICAgKi9cclxuICAgIE1hdGguZGVmaW5lRnVuY3Rpb24oXCJyYW5kXCIsIGZ1bmN0aW9uKG1pbiwgbWF4KSB7XHJcbiAgICAgICAgcmV0dXJuIHdpbmRvdy5NYXRoLmZsb29yKCBNYXRoLnJhbmRvbSgpKihtYXgtbWluKzEpICkgKyBtaW47XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiDjg6njg7Pjg4Djg6DjgarlgKTjgpLmjIflrprjgZXjgozjgZ/nr4Tlm7LlhoXjgafnlJ/miJBcclxuICAgICAqL1xyXG4gICAgTWF0aC5kZWZpbmVGdW5jdGlvbihcInJhbmRmXCIsIGZ1bmN0aW9uKG1pbiwgbWF4KSB7XHJcbiAgICAgICAgcmV0dXJuIHdpbmRvdy5NYXRoLnJhbmRvbSgpKihtYXgtbWluKSttaW47XHJcbiAgICB9KTtcclxuICAgIFxyXG59KSgpO1xyXG5cclxuXHJcbi8qXHJcbiAqIG51bWJlci5qc1xyXG4gKi9cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgZ2xvYmFsLk51bWJlclxyXG4gICAgICogTnVtYmVy44Gu5ouh5by1XHJcbiAgICAgKi9cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kICByb3VuZFxyXG4gICAgICog5Zub5o2o5LqU5YWlXHJcbiAgICAgKiDmoYHmlbDmjIflrprniYhcclxuICAgICAqL1xyXG4gICAgTnVtYmVyLmRlZmluZUluc3RhbmNlTWV0aG9kKFwicm91bmRcIiwgZnVuY3Rpb24oZmlndXJlKSB7XHJcbiAgICAgICAgZmlndXJlID0gZmlndXJlIHx8IDA7XHJcbiAgICAgICAgdmFyIGJhc2UgPSBNYXRoLnBvdygxMCwgZmlndXJlKTtcclxuICAgICAgICB2YXIgdGVtcCA9IHRoaXMgKiBiYXNlO1xyXG4gICAgICAgIHRlbXAgPSBNYXRoLnJvdW5kKHRlbXApO1xyXG4gICAgICAgIHJldHVybiB0ZW1wL2Jhc2U7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kICBjZWlsXHJcbiAgICAgKiDliIfjgorkuIrjgZIuXHJcbiAgICAgKiDmoYHmlbDmjIflrprniYhcclxuICAgICAqL1xyXG4gICAgTnVtYmVyLmRlZmluZUluc3RhbmNlTWV0aG9kKFwiY2VpbFwiLCAgZnVuY3Rpb24oZmlndXJlKSB7XHJcbiAgICAgICAgZmlndXJlID0gZmlndXJlIHx8IDA7XHJcbiAgICAgICAgdmFyIGJhc2UgPSBNYXRoLnBvdygxMCwgZmlndXJlKTtcclxuICAgICAgICB2YXIgdGVtcCA9IHRoaXMgKiBiYXNlO1xyXG4gICAgICAgIHRlbXAgPSBNYXRoLmNlaWwodGVtcCk7XHJcbiAgICAgICAgcmV0dXJuIHRlbXAvYmFzZTtcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kICBmbG9vclxyXG4gICAgICog5YiH44KK5o2o44GmXHJcbiAgICAgKiDmoYHmlbDmjIflrprniYhcclxuICAgICAqL1xyXG4gICAgTnVtYmVyLmRlZmluZUluc3RhbmNlTWV0aG9kKFwiZmxvb3JcIiwgIGZ1bmN0aW9uKGZpZ3VyZSkge1xyXG4gICAgICAgIGZpZ3VyZSA9IGZpZ3VyZSB8fCAwO1xyXG4gICAgICAgIHZhciBiYXNlID0gTWF0aC5wb3coMTAsIGZpZ3VyZSk7XHJcbiAgICAgICAgdmFyIHRlbXAgPSB0aGlzICogYmFzZTtcclxuICAgICAgICB0ZW1wID0gTWF0aC5mbG9vcih0ZW1wKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyB+fnRoaXNcclxuICAgICAgICAvLyB0aGlzfDBcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gdGVtcC9iYXNlO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCAgdG9JbnRcclxuICAgICAqIGludGVnZXIg5Z6L44Gr5aSJ5o+b44GZ44KLXHJcbiAgICAgKi9cclxuICAgIE51bWJlci5kZWZpbmVJbnN0YW5jZU1ldGhvZChcInRvSW50XCIsICBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMgfCAwKTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2QgIHRvSGV4XHJcbiAgICAgKiAxNumAsuaVsOWMllxyXG4gICAgICovXHJcbiAgICBOdW1iZXIuZGVmaW5lSW5zdGFuY2VNZXRob2QoXCJ0b0hleFwiLCAgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudG9TdHJpbmcoMTYpO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCAgdG9CaW5cclxuICAgICAqIDLpgLLmlbDljJZcclxuICAgICAqL1xyXG4gICAgTnVtYmVyLmRlZmluZUluc3RhbmNlTWV0aG9kKFwidG9CaW5cIiwgIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnRvU3RyaW5nKDIpO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kICB0b1Vuc2lnbmVkXHJcbiAgICAgKiB1bnNpZ25lZCDlnovjgavlpInmj5vjgZnjgotcclxuICAgICAqL1xyXG4gICAgTnVtYmVyLmRlZmluZUluc3RhbmNlTWV0aG9kKFwidG9VbnNpZ25lZFwiLCAgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMgPj4+IDA7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kICBwYWRkaW5nXHJcbiAgICAgKiDmloflrZfln4vjgoFcclxuICAgICAqL1xyXG4gICAgTnVtYmVyLmRlZmluZUluc3RhbmNlTWV0aG9kKFwicGFkZGluZ1wiLCAgZnVuY3Rpb24obiwgY2gpIHtcclxuICAgICAgICB2YXIgc3RyID0gdGhpcysnJztcclxuICAgICAgICBuICA9IG4tc3RyLmxlbmd0aDtcclxuICAgICAgICBjaCA9IGNoIHx8ICcwJztcclxuICAgICAgICBcclxuICAgICAgICB3aGlsZShuLS0gPiAwKSB7IHN0ciA9IGNoICsgc3RyOyB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHN0cjtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2QgIHRpbWVzXHJcbiAgICAgKiDmlbDlgKTliIbnubDjgorov5TjgZlcclxuICAgICAqL1xyXG4gICAgTnVtYmVyLmRlZmluZUluc3RhbmNlTWV0aG9kKFwidGltZXNcIiwgIGZ1bmN0aW9uKGZuLCBzZWxmKSB7XHJcbiAgICAgICAgc2VsZiA9IHNlbGYgfHwgdGhpcztcclxuICAgICAgICBmb3IgKHZhciBpPTA7IGk8dGhpczsgKytpKSB7XHJcbiAgICAgICAgICAgIGZuLmNhbGwoc2VsZiwgaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCAgdXB0b1xyXG4gICAgICog44Kk44Oz44Kv44Oq44Oh44Oz44OI57mw44KK6L+U44GXXHJcbiAgICAgKi9cclxuICAgIE51bWJlci5kZWZpbmVJbnN0YW5jZU1ldGhvZChcInVwdG9cIiwgIGZ1bmN0aW9uKHQsIGZuLCBzZWxmKSB7XHJcbiAgICAgICAgc2VsZiA9IHNlbGYgfHwgdGhpcztcclxuICAgICAgICBmb3IgKHZhciBpPSt0aGlzOyBpPD10OyArK2kpIHtcclxuICAgICAgICAgICAgZm4uY2FsbChzZWxmLCBpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kICB1cHRvXHJcbiAgICAgKiDjg4fjgq/jg6rjg6Hjg7Pjg4jnubDjgorov5TjgZdcclxuICAgICAqL1xyXG4gICAgTnVtYmVyLmRlZmluZUluc3RhbmNlTWV0aG9kKFwiZG93bnRvXCIsICBmdW5jdGlvbih0LCBmbiwgc2VsZikge1xyXG4gICAgICAgIHNlbGYgPSBzZWxmIHx8IHRoaXM7XHJcbiAgICAgICAgZm9yICh2YXIgaT0rdGhpczsgaT49dDsgLS1pKSB7XHJcbiAgICAgICAgICAgIGZuLmNhbGwoc2VsZiwgaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kIHN0ZXBcclxuICAgICAqIOOCueODhuODg+ODl+e5sOOCiui/lOOBlyhmbG9hdOWvvuW/nClcclxuICAgICAqL1xyXG4gICAgTnVtYmVyLmRlZmluZUluc3RhbmNlTWV0aG9kKFwic3RlcFwiLCAgZnVuY3Rpb24obGltaXQsIHN0ZXAsIGZuLCBzZWxmKSB7XHJcbiAgICAgICAgc2VsZiA9IHNlbGYgfHwgdGhpcztcclxuICAgICAgICBmb3IgKHZhciBpPSt0aGlzOyBpPD1saW1pdDsgaSs9c3RlcCkge1xyXG4gICAgICAgICAgICBmbi5jYWxsKHNlbGYsIGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH0pO1xyXG5cclxuICAgIFxyXG59KSgpO1xyXG5cclxuXHJcbi8qXHJcbiAqIHN0cmluZy5qc1xyXG4gKi9cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgZ2xvYmFsLlN0cmluZ1xyXG4gICAgICogU3RyaW5n44Gu5ouh5by1XHJcbiAgICAgKiBgU3RyaW5nYCBpcyBhIGdsb2JhbCBvYmplY3QgdGhhdCBtYXkgYmUgdXNlZCB0byBjb25zdHJ1Y3QgU3RyaW5nIGluc3RhbmNlcy5cclxuICAgICAqL1xyXG4gICAgXHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCAgZm9ybWF0XHJcbiAgICAgKiBcclxuICAgICAqIOODleOCqeODvOODnuODg+ODiFxyXG4gICAgICogXHJcbiAgICAgKiAjIyBleGFtcGxlXHJcbiAgICAgKiBcclxuICAgICAqICAgICAgZG9jdW1lbnQud3JpdGUoXCJ7MH0gKyB7MX0gPSB7Mn1cIi5mb3JtYXQoNSwgMTAsIDUrMTApKTsgICAvLyBcIjUgKyAxMCA9IDE1XCJcclxuICAgICAqICAgICAgZG9jdW1lbnQud3JpdGUoXCJyZ2Ioe3J9LCB7Z30sIHtifSlcIi5mb3JtYXQoeyAgICAgICAgICAgICAvLyBcInJnYigxMjgsIDAsIDI1NSlcIlxyXG4gICAgICogICAgICAgICAgcjogMTI4LFxyXG4gICAgICogICAgICAgICAgZzogMCxcclxuICAgICAqICAgICAgICAgIGI6IDI1NVxyXG4gICAgICogICAgICB9KSk7XHJcbiAgICAgKi9cclxuICAgIFN0cmluZy5kZWZpbmVJbnN0YW5jZU1ldGhvZChcImZvcm1hdFwiLCBmdW5jdGlvbihhcmcpIHtcclxuICAgICAgICAvLyDnva7mj5vjg5XjgqHjg7Pjgq9cclxuICAgICAgICB2YXIgcmVwX2ZuID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIOOCquODluOCuOOCp+OCr+ODiOOBruWgtOWQiFxyXG4gICAgICAgIGlmICh0eXBlb2YgYXJnID09IFwib2JqZWN0XCIpIHtcclxuICAgICAgICAgICAgLyoqIEBpZ25vcmUgKi9cclxuICAgICAgICAgICAgcmVwX2ZuID0gZnVuY3Rpb24obSwgaykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGFyZ1trXSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFyZ1trXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDopIfmlbDlvJXmlbDjgaDjgaPjgZ/loLTlkIhcclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XHJcbiAgICAgICAgICAgIC8qKiBAaWdub3JlICovXHJcbiAgICAgICAgICAgIHJlcF9mbiA9IGZ1bmN0aW9uKG0sIGspIHsgcmV0dXJuIGFyZ3NbIHBhcnNlSW50KGspIF07IH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVwbGFjZSggL1xceyhcXHcrKVxcfS9nLCByZXBfZm4gKTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2QgIHRyaW1cclxuICAgICAqIOODiOODquODoFxyXG4gICAgICogXHJcbiAgICAgKiA8YSBocmVmPVwiaHR0cDovL2phbWVzcm9iZXJ0cy5uYW1lL2Jsb2cvMjAxMC8wMi8yMi9zdHJpbmctZnVuY3Rpb25zLWZvci1qYXZhc2NyaXB0LXRyaW0tdG8tY2FtZWwtY2FzZS10by1kYXNoZWQtYW5kLXRvLXVuZGVyc2NvcmUvXCI+UmVmZXJlbmNlPC9hPlxyXG4gICAgICogXHJcbiAgICAgKi9cclxuICAgIFN0cmluZy5kZWZpbmVJbnN0YW5jZU1ldGhvZChcInRyaW1cIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVwbGFjZSgvXlxccyt8XFxzKyQvZywgXCJcIik7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kICBjYXBpdGFsaXplXHJcbiAgICAgKiDjgq3jg6Pjg5Tjgr/jg6njgqTjgrpcclxuICAgICAqIFxyXG4gICAgICogIyMgUmVmZXJlbmNlXHJcbiAgICAgKiBcclxuICAgICAqIC0gW+OCreODo+ODlOOCv+ODqeOCpOOCuijljZjoqp7jga7lhYjpoK3jga7lpKfmloflrZfljJYp44KS6KGM44GGIC0gb2N0IGluYW9kdV0oaHR0cDovL2QuaGF0ZW5hLm5lLmpwL2JyYXppbC8yMDA1MTIxMi8xMTM0MzY5MDgzKVxyXG4gICAgICogLSBb44OH44K244Kk44Oz44Go44OX44Ot44Kw44Op44Og44Gu54ut6ZaT44GnOiBqYXZhc2NyaXB044Gn44Kt44Oj44OU44K/44Op44Kk44K677yI5LiA5paH5a2X55uu44KS5aSn5paH5a2X44Gr44GZ44KL77yJXShodHRwOi8vZGVzaWduLXByb2dyYW0uYmxvZ3Nwb3QuY29tLzIwMTEvMDIvamF2YXNjcmlwdC5odG1sKVxyXG4gICAgICogXHJcbiAgICAgKi9cclxuICAgIFN0cmluZy5kZWZpbmVJbnN0YW5jZU1ldGhvZChcImNhcGl0YWxpemVcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVwbGFjZSgvXFx3Ky9nLCBmdW5jdGlvbih3b3JkKXtcclxuICAgICAgICAgICAgcmV0dXJuIHdvcmQuY2FwaXRhbGl6ZUZpcnN0TGV0dGVyKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kICBjYXBpdGFsaXplRmlyc3RMZXR0ZXJcclxuICAgICAqIOWFiOmgreaWh+Wtl+OBruOBv+OCreODo+ODlOOCv+ODqeOCpOOCulxyXG4gICAgICovXHJcbiAgICBTdHJpbmcuZGVmaW5lSW5zdGFuY2VNZXRob2QoXCJjYXBpdGFsaXplRmlyc3RMZXR0ZXJcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB0aGlzLnN1YnN0cigxKS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCAgdG9EYXNoXHJcbiAgICAgKiDjg4Djg4Pjgrfjg6VcclxuICAgICAqL1xyXG4gICAgU3RyaW5nLmRlZmluZUluc3RhbmNlTWV0aG9kKFwidG9EYXNoXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlcGxhY2UoLyhbQS1aXSkvZywgZnVuY3Rpb24obSl7IHJldHVybiAnLScrbS50b0xvd2VyQ2FzZSgpOyB9KTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCB0b0hhc2hcclxuICAgICAqIOODj+ODg+OCt+ODpeWApOOBq+WkieaPm1xyXG4gICAgICovXHJcbiAgICBTdHJpbmcuZGVmaW5lSW5zdGFuY2VNZXRob2QoXCJ0b0hhc2hcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudG9DUkMzMigpO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCAgcGFkZGluZ1xyXG4gICAgICog5bem5YG044Gr5oyH5a6a44GV44KM44Gf5paH5a2X44KS6Kmw44KB44Gm5Y+z5a+E44Gb44Gr44GZ44KLXHJcbiAgICAgKi9cclxuICAgIFN0cmluZy5kZWZpbmVJbnN0YW5jZU1ldGhvZChcInBhZGRpbmdcIiwgZnVuY3Rpb24obiwgY2gpIHtcclxuICAgICAgICB2YXIgc3RyID0gdGhpcy50b1N0cmluZygpO1xyXG4gICAgICAgIG4gID0gbi1zdHIubGVuZ3RoO1xyXG4gICAgICAgIGNoID0gY2ggfHwgJyAnO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHdoaWxlKG4tLSA+IDApIHsgc3RyID0gY2ggKyBzdHI7IH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gc3RyO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCAgcGFkZGluZ0xlZnRcclxuICAgICAqIOW3puWBtOOBq+aMh+WumuOBleOCjOOBn+aWh+Wtl+OCkuipsOOCgeOBpuWPs+WvhOOBm+OBq+OBmeOCi1xyXG4gICAgICovXHJcbiAgICBTdHJpbmcuZGVmaW5lSW5zdGFuY2VNZXRob2QoXCJwYWRkaW5nTGVmdFwiLCBmdW5jdGlvbihuLCBjaCkge1xyXG4gICAgICAgIHZhciBzdHIgPSB0aGlzLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgbiAgPSBuLXN0ci5sZW5ndGg7XHJcbiAgICAgICAgY2ggPSBjaCB8fCAnICc7XHJcbiAgICAgICAgXHJcbiAgICAgICAgd2hpbGUobi0tID4gMCkgeyBzdHIgPSBjaCArIHN0cjsgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBzdHI7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kICBwYWRkaW5nUmlnaHRcclxuICAgICAqIOWPs+WBtOOBq+aMh+WumuOBleOCjOOBn+aWh+Wtl+OCkuipsOOCgeOBpuW3puWvhOOBm+OBq+OBmeOCi1xyXG4gICAgICovXHJcbiAgICBTdHJpbmcuZGVmaW5lSW5zdGFuY2VNZXRob2QoXCJwYWRkaW5nUmlnaHRcIiwgZnVuY3Rpb24obiwgY2gpIHtcclxuICAgICAgICB2YXIgc3RyID0gdGhpcy50b1N0cmluZygpO1xyXG4gICAgICAgIG4gID0gbi1zdHIubGVuZ3RoO1xyXG4gICAgICAgIGNoID0gY2ggfHwgJyAnO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHdoaWxlKG4tLSA+IDApIHsgc3RyID0gc3RyICsgY2g7IH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gc3RyO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCAgcXVvdGVtZXRhXHJcbiAgICAgKiDjg6Hjgr/mloflrZfjgpLjgq/jgqnjg7zjg4hcclxuICAgICAqL1xyXG4gICAgU3RyaW5nLmRlZmluZUluc3RhbmNlTWV0aG9kKFwicXVvdGVtZXRhXCIsIGZ1bmN0aW9uKG4pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXBsYWNlKC8oW14wLTlBLVphLXpfXSkvZywgJ1xcXFwkMScpO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCAgcmVwZWF0XHJcbiAgICAgKiDjg6rjg5Tjg7zjg4hcclxuICAgICAqL1xyXG4gICAgU3RyaW5nLmRlZmluZUluc3RhbmNlTWV0aG9kKFwicmVwZWF0XCIsIGZ1bmN0aW9uKG4pIHtcclxuICAgICAgICAvLyBUT0RPOiDnorroqo3jgZnjgotcclxuICAgICAgICB2YXIgYXJyID0gQXJyYXkobik7XHJcbiAgICAgICAgZm9yICh2YXIgaT0wOyBpPG47ICsraSkgYXJyW2ldID0gdGhpcztcclxuICAgICAgICByZXR1cm4gYXJyLmpvaW4oJycpO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZCAgY291bnRcclxuICAgICAqIOODquODlOODvOODiFxyXG4gICAgICovXHJcbiAgICBTdHJpbmcuZGVmaW5lSW5zdGFuY2VNZXRob2QoXCJjb3VudFwiLCBmdW5jdGlvbihzdHIpIHtcclxuICAgICAgICB2YXIgcmUgPSBuZXcgUmVnRXhwKHN0ciwgJ2dtJyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubWF0Y2gocmUpLmxlbmd0aDtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2QgIHRvU3RyaW5nXHJcbiAgICAgKiDphY3liJfjgavlpInmj5tcclxuICAgICAqL1xyXG4gICAgU3RyaW5nLmRlZmluZUluc3RhbmNlTWV0aG9kKFwidG9BcnJheVwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgYXJyID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgaT0wLGxlbj10aGlzLmxlbmd0aDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICBhcnIucHVzaCh0aGlzW2ldKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFycjtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBcclxuICAgIHZhciB0YWJsZSA9IFwiMDAwMDAwMDAgNzcwNzMwOTYgRUUwRTYxMkMgOTkwOTUxQkEgMDc2REM0MTkgNzA2QUY0OEYgRTk2M0E1MzUgOUU2NDk1QTMgMEVEQjg4MzIgNzlEQ0I4QTQgRTBENUU5MUUgOTdEMkQ5ODggMDlCNjRDMkIgN0VCMTdDQkQgRTdCODJEMDcgOTBCRjFEOTEgMURCNzEwNjQgNkFCMDIwRjIgRjNCOTcxNDggODRCRTQxREUgMUFEQUQ0N0QgNkREREU0RUIgRjRENEI1NTEgODNEMzg1QzcgMTM2Qzk4NTYgNjQ2QkE4QzAgRkQ2MkY5N0EgOEE2NUM5RUMgMTQwMTVDNEYgNjMwNjZDRDkgRkEwRjNENjMgOEQwODBERjUgM0I2RTIwQzggNEM2OTEwNUUgRDU2MDQxRTQgQTI2NzcxNzIgM0MwM0U0RDEgNEIwNEQ0NDcgRDIwRDg1RkQgQTUwQUI1NkIgMzVCNUE4RkEgNDJCMjk4NkMgREJCQkM5RDYgQUNCQ0Y5NDAgMzJEODZDRTMgNDVERjVDNzUgRENENjBEQ0YgQUJEMTNENTkgMjZEOTMwQUMgNTFERTAwM0EgQzhENzUxODAgQkZEMDYxMTYgMjFCNEY0QjUgNTZCM0M0MjMgQ0ZCQTk1OTkgQjhCREE1MEYgMjgwMkI4OUUgNUYwNTg4MDggQzYwQ0Q5QjIgQjEwQkU5MjQgMkY2RjdDODcgNTg2ODRDMTEgQzE2MTFEQUIgQjY2NjJEM0QgNzZEQzQxOTAgMDFEQjcxMDYgOThEMjIwQkMgRUZENTEwMkEgNzFCMTg1ODkgMDZCNkI1MUYgOUZCRkU0QTUgRThCOEQ0MzMgNzgwN0M5QTIgMEYwMEY5MzQgOTYwOUE4OEUgRTEwRTk4MTggN0Y2QTBEQkIgMDg2RDNEMkQgOTE2NDZDOTcgRTY2MzVDMDEgNkI2QjUxRjQgMUM2QzYxNjIgODU2NTMwRDggRjI2MjAwNEUgNkMwNjk1RUQgMUIwMUE1N0IgODIwOEY0QzEgRjUwRkM0NTcgNjVCMEQ5QzYgMTJCN0U5NTAgOEJCRUI4RUEgRkNCOTg4N0MgNjJERDFEREYgMTVEQTJENDkgOENEMzdDRjMgRkJENDRDNjUgNERCMjYxNTggM0FCNTUxQ0UgQTNCQzAwNzQgRDRCQjMwRTIgNEFERkE1NDEgM0REODk1RDcgQTREMUM0NkQgRDNENkY0RkIgNDM2OUU5NkEgMzQ2RUQ5RkMgQUQ2Nzg4NDYgREE2MEI4RDAgNDQwNDJENzMgMzMwMzFERTUgQUEwQTRDNUYgREQwRDdDQzkgNTAwNTcxM0MgMjcwMjQxQUEgQkUwQjEwMTAgQzkwQzIwODYgNTc2OEI1MjUgMjA2Rjg1QjMgQjk2NkQ0MDkgQ0U2MUU0OUYgNUVERUY5MEUgMjlEOUM5OTggQjBEMDk4MjIgQzdEN0E4QjQgNTlCMzNEMTcgMkVCNDBEODEgQjdCRDVDM0IgQzBCQTZDQUQgRURCODgzMjAgOUFCRkIzQjYgMDNCNkUyMEMgNzRCMUQyOUEgRUFENTQ3MzkgOUREMjc3QUYgMDREQjI2MTUgNzNEQzE2ODMgRTM2MzBCMTIgOTQ2NDNCODQgMEQ2RDZBM0UgN0E2QTVBQTggRTQwRUNGMEIgOTMwOUZGOUQgMEEwMEFFMjcgN0QwNzlFQjEgRjAwRjkzNDQgODcwOEEzRDIgMUUwMUYyNjggNjkwNkMyRkUgRjc2MjU3NUQgODA2NTY3Q0IgMTk2QzM2NzEgNkU2QjA2RTcgRkVENDFCNzYgODlEMzJCRTAgMTBEQTdBNUEgNjdERDRBQ0MgRjlCOURGNkYgOEVCRUVGRjkgMTdCN0JFNDMgNjBCMDhFRDUgRDZENkEzRTggQTFEMTkzN0UgMzhEOEMyQzQgNEZERkYyNTIgRDFCQjY3RjEgQTZCQzU3NjcgM0ZCNTA2REQgNDhCMjM2NEIgRDgwRDJCREEgQUYwQTFCNEMgMzYwMzRBRjYgNDEwNDdBNjAgREY2MEVGQzMgQTg2N0RGNTUgMzE2RThFRUYgNDY2OUJFNzkgQ0I2MUIzOEMgQkM2NjgzMUEgMjU2RkQyQTAgNTI2OEUyMzYgQ0MwQzc3OTUgQkIwQjQ3MDMgMjIwMjE2QjkgNTUwNTI2MkYgQzVCQTNCQkUgQjJCRDBCMjggMkJCNDVBOTIgNUNCMzZBMDQgQzJEN0ZGQTcgQjVEMENGMzEgMkNEOTlFOEIgNUJERUFFMUQgOUI2NEMyQjAgRUM2M0YyMjYgNzU2QUEzOUMgMDI2RDkzMEEgOUMwOTA2QTkgRUIwRTM2M0YgNzIwNzY3ODUgMDUwMDU3MTMgOTVCRjRBODIgRTJCODdBMTQgN0JCMTJCQUUgMENCNjFCMzggOTJEMjhFOUIgRTVENUJFMEQgN0NEQ0VGQjcgMEJEQkRGMjEgODZEM0QyRDQgRjFENEUyNDIgNjhEREIzRjggMUZEQTgzNkUgODFCRTE2Q0QgRjZCOTI2NUIgNkZCMDc3RTEgMThCNzQ3NzcgODgwODVBRTYgRkYwRjZBNzAgNjYwNjNCQ0EgMTEwMTBCNUMgOEY2NTlFRkYgRjg2MkFFNjkgNjE2QkZGRDMgMTY2Q0NGNDUgQTAwQUUyNzggRDcwREQyRUUgNEUwNDgzNTQgMzkwM0IzQzIgQTc2NzI2NjEgRDA2MDE2RjcgNDk2OTQ3NEQgM0U2RTc3REIgQUVEMTZBNEEgRDlENjVBREMgNDBERjBCNjYgMzdEODNCRjAgQTlCQ0FFNTMgREVCQjlFQzUgNDdCMkNGN0YgMzBCNUZGRTkgQkRCREYyMUMgQ0FCQUMyOEEgNTNCMzkzMzAgMjRCNEEzQTYgQkFEMDM2MDUgQ0RENzA2OTMgNTRERTU3MjkgMjNEOTY3QkYgQjM2NjdBMkUgQzQ2MTRBQjggNUQ2ODFCMDIgMkE2RjJCOTQgQjQwQkJFMzcgQzMwQzhFQTEgNUEwNURGMUIgMkQwMkVGOERcIi5zcGxpdCgnICcpO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2QgIHRvQ1JDMzJcclxuICAgICAqIENSQzMyIOWkieaPm1xyXG4gICAgICovXHJcbiAgICBTdHJpbmcuZGVmaW5lSW5zdGFuY2VNZXRob2QoXCJ0b0NSQzMyXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBjcmMgPSAwLCB4PTAsIHk9MDtcclxuICAgICAgICBcclxuICAgICAgICBjcmMgPSBjcmMgXiAoLTEpO1xyXG4gICAgICAgIGZvciAodmFyIGk9MCwgaVRvcD10aGlzLmxlbmd0aDsgaTxpVG9wOyArK2kpIHtcclxuICAgICAgICAgICAgeSA9IChjcmMgXiB0aGlzLmNoYXJDb2RlQXQoaSkpICYgMHhmZjtcclxuICAgICAgICAgICAgeCA9IFwiMHhcIiArIHRhYmxlW3ldO1xyXG4gICAgICAgICAgICBjcmMgPSAoY3JjID4+PiA4KSBeIHg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiAoY3JjIF4gKC0xKSkgPj4+IDA7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgXHJcbn0pKCk7XHJcblxyXG4vKlxyXG4gKiBldmVudC9ldmVudC5qc1xyXG4gKi9cclxuXHJcbnRtLmV2ZW50ID0gdG0uZXZlbnQgfHwge307XHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLmV2ZW50LkV2ZW50XHJcbiAgICAgKiDjgqTjg5njg7Pjg4jjgq/jg6njgrlcclxuICAgICAqL1xyXG4gICAgdG0uZXZlbnQuRXZlbnQgPSB0bS5jcmVhdGVDbGFzcyh7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqIOOCv+OCpOODlyAqL1xyXG4gICAgICAgIHR5cGU6IG51bGwsXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24odHlwZSkge1xyXG4gICAgICAgICAgICB0aGlzLnR5cGUgPSB0eXBlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICB9KTtcclxuICAgIFxyXG59KSgpO1xyXG5cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZXZlbnQuVHdlZW5FdmVudFxyXG4gICAgICogVHdlZW4gRXZlbnRcclxuICAgICAqIEBleHRlbmRzIHRtLmV2ZW50LkV2ZW50XHJcbiAgICAgKi9cclxuICAgIHRtLmV2ZW50LlR3ZWVuRXZlbnQgPSB0bS5jcmVhdGVDbGFzcyh7XHJcbiAgICAgICAgXHJcbiAgICAgICAgc3VwZXJDbGFzczogdG0uZXZlbnQuRXZlbnQsXHJcblxyXG4gICAgICAgIC8qKiB0aW1lICovXHJcbiAgICAgICAgdGltZTogbnVsbCxcclxuICAgICAgICAvKiogbm93ICovXHJcbiAgICAgICAgbm93OiBudWxsLFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbih0eXBlLCB0aW1lLCBub3cpIHtcclxuICAgICAgICAgICAgdGhpcy5zdXBlckluaXQodHlwZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLnRpbWUgPSB0aW1lO1xyXG4gICAgICAgICAgICB0aGlzLm5vdyAgPSBub3c7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICog44OB44Kn44Oz44K4XHJcbiAgICAgKi9cclxuICAgIHRtLmV2ZW50LlR3ZWVuRXZlbnQuQ0hBTkdFICAgID0gXCJjaGFuZ2VcIjtcclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICog44OV44Kj44OL44OD44K344OlXHJcbiAgICAgKi9cclxuICAgIHRtLmV2ZW50LlR3ZWVuRXZlbnQuRklOSVNIICAgID0gXCJmaW5pc2hcIjtcclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICog44Or44O844OXXHJcbiAgICAgKi9cclxuICAgIHRtLmV2ZW50LlR3ZWVuRXZlbnQuTE9PUCAgICAgID0gXCJsb29wXCI7XHJcbiAgICAvKipcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIOODrOOCuOODpeODvOODoFxyXG4gICAgICovXHJcbiAgICB0bS5ldmVudC5Ud2VlbkV2ZW50LlJFU1VNRSAgICA9IFwicmVzdW1lXCI7XHJcbiAgICAvKipcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIOOCueOCv+ODvOODiFxyXG4gICAgICovXHJcbiAgICB0bS5ldmVudC5Ud2VlbkV2ZW50LlNUQVJUICAgICA9IFwic3RhcnRcIjtcclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICog44K544OI44OD44OXXHJcbiAgICAgKi9cclxuICAgIHRtLmV2ZW50LlR3ZWVuRXZlbnQuU1RPUCAgICAgID0gXCJzdG9wXCI7XHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG5cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZXZlbnQuTW91c2VFdmVudFxyXG4gICAgICogUG9pbnRpbmcgRXZlbnRcclxuICAgICAqIEBleHRlbmRzIHRtLmV2ZW50LkV2ZW50XHJcbiAgICAgKi9cclxuICAgIHRtLmV2ZW50Lk1vdXNlRXZlbnQgPSB0bS5jcmVhdGVDbGFzcyh7XHJcbiAgICAgICAgXHJcbiAgICAgICAgc3VwZXJDbGFzczogdG0uZXZlbnQuRXZlbnQsXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIGFwcFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGFwcDogbnVsbCxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogcG9pbnRpbmdcclxuICAgICAgICAgKi9cclxuICAgICAgICBwb2ludGluZzogbnVsbCxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24odHlwZSwgYXBwLCBwb2ludGluZykge1xyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdCh0eXBlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuYXBwID0gYXBwO1xyXG4gICAgICAgICAgICB0aGlzLnBvaW50aW5nID0gcG9pbnRpbmc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgfSk7XHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG5cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZXZlbnQuVG91Y2hFdmVudFxyXG4gICAgICogUG9pbnRpbmcgRXZlbnRcclxuICAgICAqIEBleHRlbmRzIHRtLmV2ZW50LkV2ZW50XHJcbiAgICAgKi9cclxuICAgIHRtLmV2ZW50LlRvdWNoRXZlbnQgPSB0bS5jcmVhdGVDbGFzcyh7XHJcbiAgICAgICAgXHJcbiAgICAgICAgc3VwZXJDbGFzczogdG0uZXZlbnQuRXZlbnQsXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIGFwcFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGFwcDogbnVsbCxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogcG9pbnRpbmdcclxuICAgICAgICAgKi9cclxuICAgICAgICBwb2ludGluZzogbnVsbCxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24odHlwZSwgYXBwLCBwb2ludGluZykge1xyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdCh0eXBlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuYXBwID0gYXBwO1xyXG4gICAgICAgICAgICB0aGlzLnBvaW50aW5nID0gcG9pbnRpbmc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgfSk7XHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5ldmVudC5Qb2ludGluZ0V2ZW50XHJcbiAgICAgKiBQb2ludGluZyBFdmVudFxyXG4gICAgICogQGV4dGVuZHMgdG0uZXZlbnQuRXZlbnRcclxuICAgICAqL1xyXG4gICAgdG0uZXZlbnQuUG9pbnRpbmdFdmVudCA9IHRtLmNyZWF0ZUNsYXNzKHtcclxuICAgICAgICBcclxuICAgICAgICBzdXBlckNsYXNzOiB0bS5ldmVudC5FdmVudCxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogYXBwXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgYXBwOiBudWxsLFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIHBvaW50aW5nXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcG9pbnRpbmc6IG51bGwsXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24odHlwZSwgYXBwLCBwb2ludGluZykge1xyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdCh0eXBlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuYXBwID0gYXBwO1xyXG4gICAgICAgICAgICB0aGlzLnBvaW50aW5nID0gcG9pbnRpbmc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIHRtLmV2ZW50LlBvaW50aW5nRXZlbnQuQ0hBTkdFICAgID0gXCJjaGFuZ2VcIjtcclxuICAgIC8vIHRtLmV2ZW50LlBvaW50aW5nRXZlbnQuRklOSVNIICAgID0gXCJmaW5pc2hcIjtcclxuICAgIC8vIHRtLmV2ZW50LlBvaW50aW5nRXZlbnQuTE9PUCAgICAgID0gXCJsb29wXCI7XHJcbiAgICAvLyB0bS5ldmVudC5Qb2ludGluZ0V2ZW50LlJFU1VNRSAgICA9IFwicmVzdW1lXCI7XHJcbiAgICAvLyB0bS5ldmVudC5Qb2ludGluZ0V2ZW50LlNUQVJUICAgICA9IFwic3RhcnRcIjtcclxuICAgIC8vIHRtLmV2ZW50LlBvaW50aW5nRXZlbnQuU1RPUCAgICAgID0gXCJzdG9wXCI7XHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG5cclxuLypcclxuICogZXZlbnRkaXNwYXRjaGVyLmpzXHJcbiAqL1xyXG5cclxudG0uZXZlbnQgPSB0bS5ldmVudCB8fCB7fTtcclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZXZlbnQuRXZlbnREaXNwYXRjaGVyXHJcbiAgICAgKiBFdmVudCBEaXNwYXRjaGVyXHJcbiAgICAgKiAjIyMgUmVmZXJlbmNlXHJcbiAgICAgKiAtKEV2ZW50RGlzcGF0Y2hlciAtIEFjdGlvblNjcmlwdCAzLjAg44Kz44Oz44Od44O844ON44Oz44OI44Oq44OV44Kh44Os44Oz44K544Ks44Kk44OJKVtodHRwOi8vbGl2ZWRvY3MuYWRvYmUuY29tL2ZsYXNoLzkuMF9qcC9BY3Rpb25TY3JpcHRMYW5nUmVmVjMvZmxhc2gvZXZlbnRzL0V2ZW50RGlzcGF0Y2hlci5odG1sXVxyXG4gICAgICovXHJcbiAgICB0bS5kZWZpbmUoXCJ0bS5ldmVudC5FdmVudERpc3BhdGNoZXJcIiwge1xyXG5cclxuICAgICAgICAvKiogQHByaXZhdGUgQHByb3BlcnR5IF9saXN0ZW5lcnMgKi9cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xpc3RlbmVycyA9IHt9O1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCpOODmeODs+ODiOODquOCueODiuODvOi/veWKoFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIG9uOiBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lcikge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fbGlzdGVuZXJzW3R5cGVdID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2xpc3RlbmVyc1t0eXBlXSA9IFtdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLl9saXN0ZW5lcnNbdHlwZV0ucHVzaChsaXN0ZW5lcik7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Oq44K544OK44O844KS5YmK6ZmkXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgb2ZmOiBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lcikge1xyXG4gICAgICAgICAgICB2YXIgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzW3R5cGVdO1xyXG4gICAgICAgICAgICB2YXIgaW5kZXggPSBsaXN0ZW5lcnMuaW5kZXhPZihsaXN0ZW5lcik7XHJcbiAgICAgICAgICAgIGlmIChpbmRleCAhPSAtMSkge1xyXG4gICAgICAgICAgICAgICAgbGlzdGVuZXJzLnNwbGljZShpbmRleCwxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCpOODmeODs+ODiOeZuueBq1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZpcmU6IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgZS50YXJnZXQgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgb2xkRXZlbnROYW1lID0gJ29uJyArIGUudHlwZTtcclxuICAgICAgICAgICAgaWYgKHRoaXNbb2xkRXZlbnROYW1lXSkgdGhpc1tvbGRFdmVudE5hbWVdKGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdmFyIGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVyc1tlLnR5cGVdO1xyXG4gICAgICAgICAgICBpZiAobGlzdGVuZXJzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IGxpc3RlbmVycy5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaT0wLGxlbj10ZW1wLmxlbmd0aDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBbaV0uY2FsbCh0aGlzLCBlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLypcclxuICAgICAgICAgKiDjgqTjg5njg7Pjg4jlkI3jgafjgqTjg5njg7Pjg4jnmbrngatcclxuICAgICAgICAgKi9cclxuICAgICAgICBmbGFyZTogZnVuY3Rpb24oZXZlbnROYW1lLCBwYXJhbSkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IHRtLmV2ZW50LkV2ZW50KGV2ZW50TmFtZSk7XHJcbiAgICAgICAgICAgIGlmIChwYXJhbSkge1xyXG4gICAgICAgICAgICAgICAgZS4kZXh0ZW5kKHBhcmFtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmZpcmUoZSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIG9uZTogZnVuY3Rpb24odHlwZSwgbGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdmFyIGZ1bmMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBsaXN0ZW5lci5hcHBseShzZWxmLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5vZmYodHlwZSwgZnVuYyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5vbih0eXBlLCBmdW5jKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIHR5cGUg44Gr55m76Yyy44GV44KM44Gf44Kk44OZ44Oz44OI44GM44GC44KL44GL44KS44OB44Kn44OD44KvXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaGFzRXZlbnRMaXN0ZW5lcjogZnVuY3Rpb24odHlwZSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fbGlzdGVuZXJzW3R5cGVdID09PSB1bmRlZmluZWQgJiYgIXRoaXNbXCJvblwiICsgdHlwZV0pIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiB0eXBlIOOBq+eZu+mMsuOBleOCjOOBpuOBhOOCi+ODquOCueODiuODvOOCkuWFqOOBpuOCr+ODquOColxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGNsZWFyRXZlbnRMaXN0ZW5lcjogZnVuY3Rpb24odHlwZSkge1xyXG4gICAgICAgICAgICB2YXIgb2xkRXZlbnROYW1lID0gJ29uJyArIHR5cGU7XHJcbiAgICAgICAgICAgIGlmICh0aGlzW29sZEV2ZW50TmFtZV0pIGRlbGV0ZSB0aGlzW29sZEV2ZW50TmFtZV07XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9saXN0ZW5lcnNbdHlwZV0gPSBbXTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIHZhciBwcm90byA9IHRtLmV2ZW50LkV2ZW50RGlzcGF0Y2hlci5wcm90b3R5cGU7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1lbWJlciAgdG0uZXZlbnQuRXZlbnREaXNwYXRjaGVyXHJcbiAgICAgKiBAbWV0aG9kICBhZGRFdmVudExpc3RlbmVyXHJcbiAgICAgKiBvbiDjgajlkIzjgZhcclxuICAgICAqL1xyXG4gICAgcHJvdG8uYWRkRXZlbnRMaXN0ZW5lciAgICAgID0gcHJvdG8ub247XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1lbWJlciAgdG0uZXZlbnQuRXZlbnREaXNwYXRjaGVyXHJcbiAgICAgKiBAbWV0aG9kICByZW1vdmVFdmVudExpc3RlbmVyXHJcbiAgICAgKiBvZmYg44Go5ZCM44GYXHJcbiAgICAgKi9cclxuICAgIHByb3RvLnJlbW92ZUV2ZW50TGlzdGVuZXIgICA9IHByb3RvLm9mZjtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWVtYmVyICB0bS5ldmVudC5FdmVudERpc3BhdGNoZXJcclxuICAgICAqIEBtZXRob2QgIGRpc3BhdGNoRXZlbnRcclxuICAgICAqIGZpcmUg44Go5ZCM44GYXHJcbiAgICAgKi9cclxuICAgIHByb3RvLmRpc3BhdGNoRXZlbnQgICAgICAgICA9IHByb3RvLmZpcmU7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1lbWJlciAgdG0uZXZlbnQuRXZlbnREaXNwYXRjaGVyXHJcbiAgICAgKiBAbWV0aG9kICB0cmlnZ2VyXHJcbiAgICAgKiBmaXJlIOOBqOWQjOOBmFxyXG4gICAgICovXHJcbiAgICBwcm90by50cmlnZ2VyID0gcHJvdG8uZmlyZTtcclxuICAgIFxyXG59KSgpO1xyXG5cclxuLypcclxuICogcmFuZG9tLmpzXHJcbiAqL1xyXG5cclxudG0udXRpbCA9IHRtLnV0aWwgfHwge307XHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS51dGlsLlJhbmRvbVxyXG4gICAgICog44Op44Oz44OA44Og44Kv44Op44K5XHJcbiAgICAgKiBcclxuICAgICAqICMjIFJlZmVyZW5jZVxyXG4gICAgICogLSA8aHR0cDovL3d3dy5weXRob24uanAvZG9jLzIuNS9saWIvbW9kdWxlLXJhbmRvbS5odG1sPlxyXG4gICAgICogLSA8aHR0cDovL3d3dy55dWt1bi5pbmZvL2Jsb2cvMjAwOC8wNi9weXRob24tcmFuZG9tLmh0bWw+XHJcbiAgICAgKiAtIDxodHRwOi8vd3d3LnB5dGhvbi1pem0uY29tL2NvbnRlbnRzL2FwcGxpY2F0aW9uL3JhbmRvbS5zaHRtbD5cclxuICAgICAqIC0gPGh0dHA6Ly9saWJjaW5kZXIub3JnL2RvY3MvdjAuOC4zL2NsYXNzY2luZGVyXzFfMV9yYW5kLmh0bWw+XHJcbiAgICAgKiAtIDxodHRwOi8vbGliY2luZGVyLm9yZy9kb2NzL3YwLjguMy9fcmFuZF84aF9zb3VyY2UuaHRtbD5cclxuICAgICAqL1xyXG4gICAgdG0udXRpbC5SYW5kb20gPSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogRHVtbXlcclxuICAgICAgICAgKi9cclxuICAgICAgICByYW5kaW50OiBmdW5jdGlvbihtaW4sIG1heCkge1xyXG4gICAgICAgICAgICByZXR1cm4gd2luZG93Lk1hdGguZmxvb3IoIE1hdGgucmFuZG9tKCkqKG1heC1taW4rMSkgKSArIG1pbjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIER1bW15XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcmFuZGZsb2F0OiBmdW5jdGlvbihtaW4sIG1heCkge1xyXG4gICAgICAgICAgICByZXR1cm4gd2luZG93Lk1hdGgucmFuZG9tKCkqKG1heC1taW4pK21pbjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIER1bW15XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcmFuZGJvb2w6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yYW5kaW50KDAsIDEpID09PSAxO1xyXG4gICAgICAgIH0sXHJcbiAgICB9O1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG4vKlxyXG4gKiBhamF4LmpzXHJcbiAqL1xyXG5cclxudG0udXRpbCA9IHRtLnV0aWwgfHwge307XHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIC8qXHJcbiAgICAgKiBAZW51bVxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgdmFyIEFKQVhfREVGQVVMVF9TRVRUSU5HUyA9IHtcclxuICAgICAgICAvKiBAcHJvcGVydHkgdHlwZSAqL1xyXG4gICAgICAgIHR5cGUgOlwiR0VUXCIsXHJcbiAgICAgICAgLyogQHByb3BlcnR5IGFzeW5jICovXHJcbiAgICAgICAgYXN5bmM6IHRydWUsXHJcbiAgICAgICAgLyogQHByb3BlcnR5IGRhdGEgKi9cclxuICAgICAgICBkYXRhOiBudWxsLFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSBjb250ZW50VHlwZSAqL1xyXG4gICAgICAgIGNvbnRlbnRUeXBlOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyxcclxuICAgICAgICAvKiBAcHJvcGVydHkgZGF0YVR5cGUgKi9cclxuICAgICAgICBkYXRhVHlwZTogJ3RleHQnLFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSBkYXRhVHlwZSAqL1xyXG4gICAgICAgIHJlc3BvbnNlVHlwZTogJycsIC8vIG9yICdhcnJheWJ1ZmZlcidcclxuICAgICAgICAvKiBAcHJvcGVydHkgdXNlcm5hbWUgKi9cclxuICAgICAgICB1c2VybmFtZTogbnVsbCxcclxuICAgICAgICAvKiBAcHJvcGVydHkgcGFzc3dvcmQgKi9cclxuICAgICAgICBwYXNzd29yZDogbnVsbCxcclxuICAgICAgICAvKiBAcHJvcGVydHkgc3VjY2VzcyAqL1xyXG4gICAgICAgIHN1Y2Nlc3MgOiBmdW5jdGlvbihkYXRhKXsgYWxlcnQoXCJzdWNjZXNzISFcXG5cIitkYXRhKTsgfSxcclxuICAgICAgICAvKiBAcHJvcGVydHkgZXJyb3IgKi9cclxuICAgICAgICBlcnJvciAgIDogZnVuY3Rpb24oZGF0YSl7IGFsZXJ0KFwiZXJyb3IhIVwiKTsgfSxcclxuICAgICAgICAvKiBAcHJvcGVydHkgYmVmb3JlU2VuZCAqL1xyXG4gICAgICAgIGJlZm9yZVNlbmQ6IG51bGwsXHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLnV0aWwuQWpheFxyXG4gICAgICogQWpheCDjgq/jg6njgrlcclxuICAgICAqL1xyXG4gICAgdG0udXRpbC5BamF4ID0ge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIGxvYWRcclxuICAgICAgICAgKi9cclxuICAgICAgICBsb2FkOiBmdW5jdGlvbihwYXJhbXMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIEFKQVhfREVGQVVMVF9TRVRUSU5HUykge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zW2tleV0gPSBwYXJhbXNba2V5XSB8fCBBSkFYX0RFRkFVTFRfU0VUVElOR1Nba2V5XTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIGh0dHBSZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgICAgICAgICAgIHZhciBhamF4X3BhcmFtcyA9IFwiXCI7XHJcbiAgICAgICAgICAgIHZhciBjb252X2Z1bmMgPSB0bS51dGlsLkFqYXguREFUQV9DT05WRVJURV9UQUJMRVtwYXJhbXMuZGF0YVR5cGVdO1xyXG5cclxuICAgICAgICAgICAgdmFyIHVybCA9IHBhcmFtcy51cmw7XHJcbiAgICAgICAgICAgIGlmIChwYXJhbXMuZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gXCJcIjtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcGFyYW1zLmRhdGEgPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgICAgICBxdWVyeSA9IHBhcmFtcy5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHF1ZXJ5ID0gZW5jb2RlVVJJQ29tcG9uZW50KHBhcmFtcy5kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5ID0gdG0udXRpbC5RdWVyeVN0cmluZy5zdHJpbmdpZnkocGFyYW1zLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChwYXJhbXMudHlwZSA9PSAnR0VUJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtcy51cmwgKz0gJz8nICsgcXVlcnk7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmRhdGEgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAocGFyYW1zLnR5cGUgPT0gJ1BPU1QnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmRhdGEgPSBxdWVyeTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gaHR0cFJlcXVlc3Qud2l0aENyZWRlbnRpYWxzID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgIC8vIOOCs+ODvOODq+ODkOODg+OCr1xyXG4gICAgICAgICAgICBodHRwUmVxdWVzdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGlmIChodHRwUmVxdWVzdC5yZWFkeVN0YXRlID09IDQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDmiJDlip8oc3RhdHVzID09PSAwIOOBr+ODreODvOOCq+ODq+ODleOCoeOCpOODq+eUqClcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaHR0cFJlcXVlc3Quc3RhdHVzID09PSAyMDAgfHwgaHR0cFJlcXVlc3Quc3RhdHVzID09PSAyMDEgfHwgaHR0cFJlcXVlc3Quc3RhdHVzID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXMucmVzcG9uc2VUeXBlICE9PSBcImFycmF5YnVmZmVyXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOOCv+OCpOODl+WIpeOBq+WkieaPm+OCkuOBi+OBkeOCi1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBjb252X2Z1bmMoaHR0cFJlcXVlc3QucmVzcG9uc2VUZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy5zdWNjZXNzKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g44OQ44Kk44OK44Oq44OH44O844K/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMuc3VjY2Vzcyh0aGlzLnJlc3BvbnNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmVycm9yKGh0dHBSZXF1ZXN0LnJlc3BvbnNlVGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIumAmuS/oeS4rVwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuXHJcblxyXG4gICAgICAgICAgICBodHRwUmVxdWVzdC5vcGVuKHBhcmFtcy50eXBlLCBwYXJhbXMudXJsLCBwYXJhbXMuYXN5bmMsIHBhcmFtcy51c2VybmFtZSwgcGFyYW1zLnBhc3N3b3JkKTsgICAvLyDjgqrjg7zjg5fjg7NcclxuICAgICAgICAgICAgaWYgKHBhcmFtcy50eXBlID09PSBcIlBPU1RcIikge1xyXG4gICAgICAgICAgICAgICAgaHR0cFJlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC1UeXBlJywgcGFyYW1zLmNvbnRlbnRUeXBlKTsgICAgICAgIC8vIOODmOODg+ODgOOCkuOCu+ODg+ODiFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAocGFyYW1zLnJlc3BvbnNlVHlwZSkge1xyXG4gICAgICAgICAgICAgICAgaHR0cFJlcXVlc3QucmVzcG9uc2VUeXBlID0gcGFyYW1zLnJlc3BvbnNlVHlwZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHBhcmFtcy5iZWZvcmVTZW5kKSB7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXMuYmVmb3JlU2VuZChodHRwUmVxdWVzdCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChwYXJhbXMucGFzc3dvcmQpIHtcclxuICAgICAgICAgICAgICAgIGh0dHBSZXF1ZXN0LndpdGhDcmVkZW50aWFscyA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGh0dHBSZXF1ZXN0LnNlbmQocGFyYW1zLmRhdGEpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIGxvYWRKU09OUFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGxvYWRKU09OUDogZnVuY3Rpb24odXJsLCBjYWxsYmFjaykge1xyXG4gICAgICAgICAgICB2YXIgZyA9IHRtLmdsb2JhbDtcclxuICAgICAgICAgICAgZy50bWxpYl9qc19kdW1teV9mdW5jX2NvdW50ID0gdG0uZ2xvYmFsLnRtbGliX2pzX2R1bW15X2Z1bmMgfHwgMDtcclxuICAgICAgICAgICAgdmFyIGR1bW15X2Z1bmNfbmFtZSA9IFwidG1saWJfanNfZHVtbXlfZnVuY1wiICsgKGcudG1saWJfanNfZHVtbXlfZnVuY19jb3VudCsrKTtcclxuICAgICAgICAgICAgZ1tkdW1teV9mdW5jX25hbWVdICA9IGNhbGxiYWNrO1xyXG5cclxuICAgICAgICAgICAgdmFyIGVsbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIik7XHJcbiAgICAgICAgICAgIGVsbS50eXBlID0gXCJ0ZXh0L2phdmFzY3JpcHRcIjtcclxuICAgICAgICAgICAgZWxtLmNoYXJzZXQgPSBcIlVURi04XCI7XHJcbiAgICAgICAgICAgIGVsbS5zcmMgPSB1cmwgKyAodXJsLmluZGV4T2YoXCI/XCIpIDwgMCA/IFwiP1wiIDogXCImXCIpICsgXCJjYWxsYmFjaz1cIiArIGR1bW15X2Z1bmNfbmFtZTtcclxuICAgICAgICAgICAgZWxtLnNldEF0dHJpYnV0ZShcImRlZmVyXCIsIHRydWUpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImhlYWRcIilbMF0uYXBwZW5kQ2hpbGQoZWxtKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8qXHJcbiAgICAgKiBAZW51bSB0bS51dGlsLkFqYXguREFUQV9DT05WRVJURV9UQUJMRVxyXG4gICAgICog44OH44O844K/44Kz44Oz44OQ44O844K/44OG44O844OW44OrXHJcbiAgICAgKi9cclxuICAgIHRtLnV0aWwuQWpheC5EQVRBX0NPTlZFUlRFX1RBQkxFID0ge1xyXG4gICAgICAgIC8qIEBtZXRob2QgKi9cclxuICAgICAgICB1bmRlZmluZWQ6IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyogQG1ldGhvZCAqL1xyXG4gICAgICAgIHRleHQ6IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyogQG1ldGhvZCAqL1xyXG4gICAgICAgIHhtbDogZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgcGFyc2VyID0gbmV3IERPTVBhcnNlcigpO1xyXG4gICAgICAgICAgICB2YXIgeG1sID0gcGFyc2VyLnBhcnNlRnJvbVN0cmluZyhkYXRhLCAndGV4dC94bWwnKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB4bWw7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyogQG1ldGhvZCAqL1xyXG4gICAgICAgIGRvbTogZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICAgICAgZGl2LmlubmVySFRNTCA9IGRhdGE7XHJcbiAgICAgICAgICAgIHJldHVybiB0bS5kb20uRWxlbWVudChkaXYpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qIEBtZXRob2QgKi9cclxuICAgICAgICBqc29uOiBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShkYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaChlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmRpcihlKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZGlyKGRhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyogQG1ldGhvZCAqL1xyXG4gICAgICAgIHNjcmlwdDogZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBldmFsKGRhdGEpO1xyXG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKlxyXG4gICAgICAgICAqIEBtZXRob2RcclxuICAgICAgICAgKiAjIyMgUmVmZXJlbmNlXHJcbiAgICAgICAgICogLSA8aHR0cDovL2VmY2wuaW5mby9hZGlhcnkvSmF2YXNjcmlwdC90cmVhdC1iaW5hcnk+XHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcclxuICAgICAgICAgKi9cclxuICAgICAgICBiaW46IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIGJ5dGVhcnJheSA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpPTAsIGxlbj1kYXRhLmxlbmd0aDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICAgICAgYnl0ZWFycmF5W2ldID0gZGF0YS5jaGFyQ29kZUF0KGkpICYgMHhmZjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gYnl0ZWFycmF5O1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgfTtcclxuXHJcblxyXG4gICAgdG0udXRpbC5BamF4LkRFRkFVTFRfU0VUVElOR1MgPSBBSkFYX0RFRkFVTFRfU0VUVElOR1M7XHJcblxyXG59KSgpO1xyXG5cclxuLypcclxuICogZmlsZS5qc1xyXG4gKi9cclxuXHJcbnRtLnV0aWwgPSB0bS51dGlsIHx8IHt9O1xyXG5cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0udXRpbC5GaWxlXHJcbiAgICAgKiDjg5XjgqHjgqTjg6vjgq/jg6njgrlcclxuICAgICAqL1xyXG4gICAgdG0uZGVmaW5lKFwidG0udXRpbC5GaWxlXCIsIHtcclxuICAgICAgICBzdXBlckNsYXNzOiBcInRtLmV2ZW50LkV2ZW50RGlzcGF0Y2hlclwiLFxyXG5cclxuICAgICAgICAvKiogZGV0YSAqL1xyXG4gICAgICAgIGRhdGE6IG51bGwsXHJcbiAgICAgICAgLyoqIGRldGEgKi9cclxuICAgICAgICBsb2FkZWQ6IGZhbHNlLFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihwYXJhbXMpIHtcclxuICAgICAgICAgICAgdGhpcy5zdXBlckluaXQoKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMubG9hZGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09IDEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubG9hZChwYXJhbXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg63jg7zjg4lcclxuICAgICAgICAgKi9cclxuICAgICAgICBsb2FkOiBmdW5jdGlvbihwYXJhbXMpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBwYXJhbXMgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgdmFyIHVybCA9IHBhcmFtcztcclxuICAgICAgICAgICAgICAgIHBhcmFtcyA9IHsgdXJsOiB1cmwsIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgcGFyYW1zLnN1Y2Nlc3MgPSBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNldERhdGEoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IHRtLmV2ZW50LkV2ZW50KFwibG9hZFwiKTtcclxuICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCggZSApO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0bS51dGlsLkFqYXgubG9hZChwYXJhbXMpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIHNldERhdGFcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXREYXRhOiBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgICAgIHRoaXMubG9hZGVkID0gdHJ1ZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODreODvOOCq+ODq+OCueODiOODrOODvOOCuOOBi+OCieODreODvOODiVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGxvYWRMb2NhbFN0b3JhZ2U6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG5cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG5cclxuLypcclxuICogdG1saW5lLmpzXHJcbiAqL1xyXG5cclxudG0udXRpbCA9IHRtLnV0aWwgfHwge307XHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS51dGlsLlRpbWVsaW5lXHJcbiAgICAgKiDjgr/jgqTjg6Djg6njgqTjg7Pjgq/jg6njgrlcclxuICAgICAqL1xyXG4gICAgdG0udXRpbC5UaW1lbGluZSA9IHRtLmNyZWF0ZUNsYXNzKHtcclxuICAgICAgICBcclxuICAgICAgICAvKiogdGFyZ2V0ICovXHJcbiAgICAgICAgdGFyZ2V0ICA6IG51bGwsXHJcbiAgICAgICAgLyoqIHRhc2tzICovXHJcbiAgICAgICAgdGFza3MgICA6IG51bGwsXHJcbiAgICAgICAgLyoqIGZwcyAqL1xyXG4gICAgICAgIGZwcyAgICAgOiAzMCxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy50YXNrcyA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLnRpbWUgPSAwO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Ki44OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgYXQ6IGZ1bmN0aW9uKHRpbWUsIGFjdGlvbikge1xyXG4gICAgICAgICAgICB0aGlzLnRhc2tzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgdGltZTogdGltZSxcclxuICAgICAgICAgICAgICAgIGFjdGlvbjogYWN0aW9uLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Ki44OV44K/44O8XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgYWZ0ZXI6IGZ1bmN0aW9uKHRpbWUsIGFjdGlvbikge1xyXG4gICAgICAgICAgICB0aGlzLmF0KHRoaXMudGltZSArIHRpbWUsIGFjdGlvbik7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCr+ODquOColxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGNsZWFyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy50YXNrcyA9IFtdO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg6rjg6Djg7zjg5bjgr/jgqTjg6BcclxuICAgICAgICAgKi9cclxuICAgICAgICByZW1vdmVUaW1lOiBmdW5jdGlvbih0aW1lKSB7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IFxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODquODoOODvOODluOCouOCr+OCt+ODp+ODs1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJlbW92ZUFjdGlvbjogZnVuY3Rpb24oYWN0aW9uKSB7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44K544K/44O844OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc3RhcnQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmlzUGxheWluZyA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX3N0YXJ0VGltZSgpO1xyXG4gICAgICAgICAgICB0aGlzLl91cGRhdGVUaW1lKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Os44K444Ol44O844OgXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcmVzdW1lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl9yZXN1bWVUaW1lKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVRpbWUoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgrnjg4jjg4Pjg5dcclxuICAgICAgICAgKi9cclxuICAgICAgICBzdG9wOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSBmYWxzZTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg6zjgqbjgqPjg7Pjg4lcclxuICAgICAgICAgKi9cclxuICAgICAgICByZXdpbmQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLnRpbWUgPSAwO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOabtOaWsFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHVwZGF0ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8vIOOCv+OCueOCr+abtOaWsFxyXG4gICAgICAgICAgICBpZiAodGhpcy50YXNrcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpPTAsbGVuPXRoaXMudGFza3MubGVuZ3RoOyBpPGxlbjsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhc2sgPSB0aGlzLnRhc2tzW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnByZXYgPD0gdGFzay50aW1lICYmIHRhc2sudGltZSA8IHRoaXMudGltZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrLmFjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLnRhc2tzLmVyYXNlKHRhc2spO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3N0YXJ0VGltZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhcnRUaW1lID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9yZXN1bWVUaW1lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5zdGFydFRpbWUgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpIC0gdGhpcy50aW1lO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3VwZGF0ZVRpbWU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pc1BsYXlpbmcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX25leHRUaW1lKCk7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGFyZ3VtZW50cy5jYWxsZWUuYmluZCh0aGlzKSwgMTAwMC90aGlzLmZwcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX25leHRUaW1lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgLy8g5YmN5Zue44Gu5pmC6ZaTXHJcbiAgICAgICAgICAgIHRoaXMucHJldiA9IHRoaXMudGltZTtcclxuICAgICAgICAgICAgLy8g5LuK5Zue44Gu5pmC6ZaTXHJcbiAgICAgICAgICAgIHRoaXMudGltZSA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCkgLSB0aGlzLnN0YXJ0VGltZTtcclxuICAgICAgICAgICAgLy8g5pu05pawXHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgIH0pO1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuLypcclxuICogdXRpbC9kYXRhLmpzXHJcbiAqL1xyXG5cclxudG0udXRpbCA9IHRtLnV0aWwgfHwge307XHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS51dGlsLkRhdGFNYW5hZ2VyXHJcbiAgICAgKiDjg4fjg7zjgr/jg57jg43jg7zjgrjjg6NcclxuICAgICAqL1xyXG4gICAgdG0udXRpbC5EYXRhTWFuYWdlciA9IHtcclxuICAgICAgICBkYXRhOiB7fVxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIOOCu+ODvOODllxyXG4gICAgICovXHJcbiAgICB0bS51dGlsLkRhdGFNYW5hZ2VyLnNhdmUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAvLyBUT0RPOiDjg63jg7zjgqvjg6vjgrnjg4jjg6zjg7zjgrg/XHJcbiAgICAgICAgZm9yICh2YXIga2V5IGluIHRoaXMuZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YVtrZXldO1xyXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Vba2V5XSA9IEpTT04uc3RyaW5naWZ5KCBkYXRhICk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIOODreODvOODiVxyXG4gICAgICovXHJcbiAgICB0bS51dGlsLkRhdGFNYW5hZ2VyLmxvYWQgPSBmdW5jdGlvbihrZXkpIHtcclxuICAgICAgICAvLyBUT0RPOiDjg63jg7zjgqvjg6vjgrnjg4jjg6zjg7zjgrg/XHJcbiAgICAgICAgZm9yICh2YXIga2V5IGluIGxvY2FsU3RvcmFnZSkge1xyXG4gICAgICAgICAgICB0aGlzLmRhdGFba2V5XSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlW2tleV0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiDjgrvjg4Pjg4hcclxuICAgICAqL1xyXG4gICAgdG0udXRpbC5EYXRhTWFuYWdlci5zZXQgPSBmdW5jdGlvbihrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5kYXRhW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiDjgrLjg4Pjg4hcclxuICAgICAqL1xyXG4gICAgdG0udXRpbC5EYXRhTWFuYWdlci5nZXQgPSBmdW5jdGlvbihrZXkpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhW2tleV07XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBcclxuICAgIC8vIHRtLmFkZExvYWRDaGVja0xpc3QodG0udXRpbC5EYXRhTWFuYWdlcik7XHJcbiAgICBcclxufSkoKTtcclxuLypcclxuICogcXVlcnlzdHJpbmcuanNcclxuICovXHJcblxyXG50bS51dGlsID0gdG0udXRpbCB8fCB7fTtcclxuXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLnV0aWwuUXVlcnlTdHJpbmdcclxuICAgICAqIOOCr+OCqOODquaWh+Wtl+WIl+OCr+ODqeOCuVxyXG4gICAgICovXHJcbiAgICB0bS51dGlsLlF1ZXJ5U3RyaW5nID0ge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODkeODvOOCuVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHBhcnNlOiBmdW5jdGlvbihzdHIsIHNlcCwgZXEpIHtcclxuICAgICAgICAgICAgc2VwID0gc2VwIHx8ICcmJztcclxuICAgICAgICAgICAgZXEgID0gZXEgIHx8ICc9JztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciBvYmogPSB7fTtcclxuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHN0ci5zcGxpdChzZXApO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpPTAsbGVuPXBhcmFtcy5sZW5ndGg7IGk8bGVuOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwYXJhbSA9IHBhcmFtc1tpXTtcclxuICAgICAgICAgICAgICAgIHZhciBwb3MgPSBwYXJhbS5pbmRleE9mKGVxKTtcclxuICAgICAgICAgICAgICAgIGlmIChwb3M+MCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBrZXkgPSBwYXJhbS5zdWJzdHJpbmcoMCwgcG9zKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdmFsID0gcGFyYW0uc3Vic3RyaW5nKHBvcysxKTtcclxuICAgICAgICAgICAgICAgICAgICBvYmpba2V5XSA9IHZhbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIG9iajtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCueODiOODquODs+OCsOODleOCoeOCpFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHN0cmluZ2lmeTogZnVuY3Rpb24ob2JqLCBzZXAsIGVxKSB7XHJcbiAgICAgICAgICAgIHNlcCA9IHNlcCB8fCAnJic7XHJcbiAgICAgICAgICAgIGVxICA9IGVxICB8fCAnPSc7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdmFyIHN0ckxpc3QgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIG9iaikge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZW5jb2RlVVJJQ29tcG9uZW50KG9ialtrZXldKTtcclxuICAgICAgICAgICAgICAgIHN0ckxpc3QucHVzaChrZXkgKyBlcSArIHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHN0ckxpc3Quam9pbihzZXApO1xyXG4gICAgICAgIH0sXHJcbiAgICB9O1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuXHJcblxyXG4vKlxyXG4gKiB0eXBlLmpzXHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIEBjbGFzcyB0bS51dGlsLlR5cGVcclxuICog5Z6L44OB44Kn44OD44KvXHJcbiAqL1xyXG50bS5uYW1lc3BhY2UoXCJ0bS51dGlsLlR5cGVcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgdG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQG1ldGhvZCAgaXNPYmplY3RcclxuICAgICAqIGlzIG9iamVjdFxyXG4gICAgICovXHJcbiAgICB0aGlzLmRlZmluZUZ1bmN0aW9uKFwiaXNPYmplY3RcIiwgZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgcmV0dXJuIG9iaiA9PT0gT2JqZWN0KG9iaik7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEBtZXRob2QgIGlzQXJyYXlcclxuICAgICAqIGlzIGFycmF5XHJcbiAgICAgKi9cclxuICAgIHRoaXMuZGVmaW5lRnVuY3Rpb24oXCJpc0FycmF5XCIsIGZ1bmN0aW9uKG9iaikge1xyXG4gICAgICAgIHJldHVybiB0b1N0cmluZy5jYWxsKG9iaikgPT0gJ1tvYmplY3QgQXJyYXldJztcclxuICAgIH0pO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQG1ldGhvZCAgaXNBcmd1bWVudHNcclxuICAgICAqIGlzIGFyZ3VtZW50c1xyXG4gICAgICovXHJcbiAgICB0aGlzLmRlZmluZUZ1bmN0aW9uKFwiaXNBcmd1bWVudHNcIiwgZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgcmV0dXJuIHRvU3RyaW5nLmNhbGwob2JqKSA9PSAnW29iamVjdCBBcmd1bWVudHNdJztcclxuICAgIH0pO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQG1ldGhvZCAgaXNGdW5jdGlvblxyXG4gICAgICogaXMgZnVuY3Rpb25cclxuICAgICAqL1xyXG4gICAgdGhpcy5kZWZpbmVGdW5jdGlvbihcImlzRnVuY3Rpb25cIiwgZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgcmV0dXJuIHRvU3RyaW5nLmNhbGwob2JqKSA9PSAnW29iamVjdCBGdW5jdGlvbl0nO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAbWV0aG9kICBpc1N0cmluZ1xyXG4gICAgICogaXMgc3RyaW5nXHJcbiAgICAgKi9cclxuICAgIHRoaXMuZGVmaW5lRnVuY3Rpb24oXCJpc1N0cmluZ1wiLCBmdW5jdGlvbihvYmopIHtcclxuICAgICAgICByZXR1cm4gdG9TdHJpbmcuY2FsbChvYmopID09ICdbb2JqZWN0IFN0cmluZ10nO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAbWV0aG9kICBpc051bWJlclxyXG4gICAgICogaXMgbnVtYmVyXHJcbiAgICAgKi9cclxuICAgIHRoaXMuZGVmaW5lRnVuY3Rpb24oXCJpc051bWJlclwiLCBmdW5jdGlvbihvYmopIHtcclxuICAgICAgICByZXR1cm4gdG9TdHJpbmcuY2FsbChvYmopID09ICdbb2JqZWN0IE51bWJlcl0nO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAbWV0aG9kICBpc0RhdGVcclxuICAgICAqIGlzIGRhdGVcclxuICAgICAqL1xyXG4gICAgdGhpcy5kZWZpbmVGdW5jdGlvbihcImlzRGF0ZVwiLCBmdW5jdGlvbihvYmopIHtcclxuICAgICAgICByZXR1cm4gdG9TdHJpbmcuY2FsbChvYmopID09ICdbb2JqZWN0IERhdGVdJztcclxuICAgIH0pO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQG1ldGhvZCAgaXNSZWdFeHBcclxuICAgICAqIGlzIFJlZ0V4cFxyXG4gICAgICovXHJcbiAgICB0aGlzLmRlZmluZUZ1bmN0aW9uKFwiaXNSZWdFeHBcIiwgZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgcmV0dXJuIHRvU3RyaW5nLmNhbGwob2JqKSA9PSAnW29iamVjdCBSZWdFeHBdJztcclxuICAgIH0pO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQG1ldGhvZCAgaXNFbXB0eVxyXG4gICAgICogaXMgZW1wdHlcclxuICAgICAqL1xyXG4gICAgdGhpcy5kZWZpbmVGdW5jdGlvbihcImlzRW1wdHlcIiwgZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgaWYgKCFvYmopIHJldHVybiB0cnVlO1xyXG4gICAgICAgIGlmIChzZWxmLmlzQXJyYXkob2JqKSB8fCBzZWxmLmlzU3RyaW5nKG9iaikgfHwgc2VsZi5pc0FyZ3VtZW50cyhvYmopKSByZXR1cm4gb2JqLmxlbmd0aCA9PT0gMDtcclxuICAgICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgICAgIGlmIChrZXkpIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9KTtcclxuXHJcbn0pO1xyXG5cclxuLypcclxuICogZmxvdy5qc1xyXG4gKi9cclxuXHJcbiAgICBcclxuLyoqXHJcbiAqIEBjbGFzcyB0bS51dGlsLkZsb3dcclxuICogQGV4dGVuZHMgdG0uZXZlbnQuRXZlbnREaXNwYXRjaGVyXHJcbiAqIGl0IGlzIGluc3BpcmUgaW4gbWFkZSBmbG93LmpzIG9mIGBAdXVwYWFgXHJcbiAqL1xyXG50bS5kZWZpbmUoXCJ0bS51dGlsLkZsb3dcIiwge1xyXG4gICAgc3VwZXJDbGFzczogXCJ0bS5ldmVudC5FdmVudERpc3BhdGNoZXJcIixcclxuICAgIFxyXG4gICAgLyoqIHdhaXRzICovXHJcbiAgICB3YWl0czogMCxcclxuICAgIC8qKiBjb3VudGVyICovXHJcbiAgICBjb3VudGVyOiAwLFxyXG4gICAgLyoqIGFyZ3MgKi9cclxuICAgIGFyZ3M6IG51bGwsXHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgKi9cclxuICAgIGluaXQ6IGZ1bmN0aW9uKHdhaXRzLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHRoaXMuc3VwZXJJbml0KCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgd2FpdHMgPSB3YWl0cyB8fCAwO1xyXG4gICAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLnNldHVwKHdhaXRzLCBjYWxsYmFjayk7XHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIOOCu+ODg+ODiOOCouODg+ODl1xyXG4gICAgICovXHJcbiAgICBzZXR1cDogZnVuY3Rpb24od2FpdHMsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdGhpcy53YWl0cyA9IHdhaXRzO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjaztcclxuICAgICAgICB0aGlzLmNvdW50ZXIgPSAwO1xyXG4gICAgICAgIHRoaXMuYXJncyA9IHt9O1xyXG5cclxuICAgICAgICB0aGlzLl9jaGVjaygpO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH0sXHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICog44OR44K5XHJcbiAgICAgKi9cclxuICAgIHBhc3M6IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcclxuICAgICAgICArK3RoaXMuY291bnRlcjtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+PSAyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXJnc1trZXldID0gdmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuX2NoZWNrKCk7XHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIOe1guS6huODgeOCp+ODg+OCr1xyXG4gICAgICovXHJcbiAgICBpc0ZpbmlzaDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmNvdW50ZXIgPT09IHRoaXMud2FpdHMpO1xyXG4gICAgfSxcclxuICAgIFxyXG4gICAgX2NoZWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5pc0ZpbmlzaCgpKSB7XHJcbiAgICAgICAgICAgIHZhciBhcmdzID0gdGhpcy5hcmdzO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FsbGJhY2soYXJncyk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHRoaXMuYXJncyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhbGxiYWNrID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdmFyIGUgPSB0bS5ldmVudC5FdmVudChcImZsb3dmaW5pc2hcIik7XHJcbiAgICAgICAgICAgIGUuYXJncyA9IGFyZ3M7XHJcbiAgICAgICAgICAgIHRoaXMuZmlyZShlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pO1xyXG5cclxuXHJcbi8qXHJcbiAqIOOCsOODquODg+ODieOCt+OCueODhuODoFxyXG4gKi9cclxudG0uZGVmaW5lKFwidG0udXRpbC5HcmlkU3lzdGVtXCIsIHtcclxuICAgIHdpZHRoOiA2NDAsIC8vIOW5hVxyXG4gICAgY29sOiAxMiwgICAgLy8g5YiX5pWwXHJcbiAgICBcclxuICAgIGluaXQ6IGZ1bmN0aW9uKHdpZHRoLCBjb2wpIHtcclxuICAgICAgICBpZiAodHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgdmFyIHBhcmFtID0gYXJndW1lbnRzWzBdO1xyXG4gICAgICAgICAgICB3aWR0aCA9IHBhcmFtLndpZHRoO1xyXG4gICAgICAgICAgICBjb2wgPSBwYXJhbS5jb2w7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcclxuICAgICAgICB0aGlzLmNvbCA9IGNvbDtcclxuICAgICAgICB0aGlzLnVuaXRXaWR0aCA9IHRoaXMud2lkdGgvdGhpcy5jb2w7XHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICAvLyDjgrnjg5Hjg7PmjIflrprjgaflgKTjgpLlj5blvpco6LKg5pWw44KCb2spXHJcbiAgICBzcGFuOiBmdW5jdGlvbihpbmRleCkge1xyXG4gICAgICAgIGluZGV4ICs9IHRoaXMuY29sO1xyXG4gICAgICAgIGluZGV4ICU9IHRoaXMuY29sO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy51bml0V2lkdGggKiBpbmRleDtcclxuICAgIH0sXHJcbiAgICBcclxuICAgIC8vIOecn+OCk+S4rVxyXG4gICAgY2VudGVyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy51bml0V2lkdGggKiAodGhpcy5jb2wvMik7XHJcbiAgICB9LFxyXG59KTtcclxuXHJcbi8qXHJcbiAqIHZlY3RvcjIuanNcclxuICovXHJcblxyXG4vKlxyXG4gKiDlub7kvZXlraZcclxuICovXHJcbnRtLmdlb20gPSB0bS5nZW9tIHx8IHt9O1xyXG5cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZ2VvbS5WZWN0b3IyXHJcbiAgICAgKiAy5qyh5YWD44OZ44Kv44OI44OrXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uVmVjdG9yMiA9IHRtLmNyZWF0ZUNsYXNzKHtcclxuICAgICAgICAvKiogeOW6p+aomSAqL1xyXG4gICAgICAgIHg6IDAsXHJcbiAgICAgICAgLyoqIHnluqfmqJkgKi9cclxuICAgICAgICB5OiAwLFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKHgsIHkpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXQoeCwgeSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDopIfoo71cclxuICAgICAgICAgKi9cclxuICAgICAgICBjbG9uZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0bS5nZW9tLlZlY3RvcjIodGhpcy54LCB0aGlzLnkpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog562J44GX44GE44GL44Gp44GG44GL44KS44OB44Kn44OD44KvXHJcbiAgICAgICAgICogQHBhcmFtICAge3RtLmdlb20uVmVjdG9yMn0gICB2ICAg5q+U6LyD5a++6LGh44Go44Gq44KL77yS5qyh5YWD44OZ44Kv44OI44OrXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZXF1YWxzOiBmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAodGhpcy54ID09PSB2LnggJiYgdGhpcy55ID09PSB2LnkpID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5pWw5YCk44Go562J44GX44GE44GL44Gp44GG44GL44KS44OB44Kn44OD44KvXHJcbiAgICAgICAgICogQHBhcmFtICAge051bWJlcn0gICB4ICAgIOavlOi8g+WvvuixoeOBqOOBquOCiyB4IOWApFxyXG4gICAgICAgICAqIEBwYXJhbSAgIHtOdW1iZXJ9ICAgeSAgICDmr5TovIPlr77osaHjgajjgarjgosgeSDlgKRcclxuICAgICAgICAgKi9cclxuICAgICAgICBlcXVhbHNOdW1iZXI6IGZ1bmN0aW9uKHgsIHkpIHtcclxuICAgICAgICAgICAgcmV0dXJuICh0aGlzLnggPT09IHggJiYgdGhpcy55ID09PSB5KSA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOmFjeWIl+OBqOetieOBl+OBhOOBi+OBqeOBhuOBi+OCkuODgeOCp+ODg+OCr1xyXG4gICAgICAgICAqIEBwYXJhbSAgIHtOdW1iZXJ9ICAgYXJyICDmr5TovIPlr77osaHjgajjgarjgovphY3liJdcclxuICAgICAgICAgKi9cclxuICAgICAgICBlcXVhbHNBcnJheTogZnVuY3Rpb24oYXJyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAodGhpcy54ID09PSBhcnJbMF0gJiYgdGhpcy55ID09PSBhcnJbMV0pID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44K744OD44K/44O8XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbih4LCB5KSB7XHJcbiAgICAgICAgICAgIHRoaXMueCA9IHg7XHJcbiAgICAgICAgICAgIHRoaXMueSA9IHk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmlbDlgKTjgYvjgonjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXROdW1iZXI6IGZ1bmN0aW9uKHgsIHkpIHtcclxuICAgICAgICAgICAgdGhpcy54ID0geDtcclxuICAgICAgICAgICAgdGhpcy55ID0geTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6YWN5YiX44GL44KJ44K744OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0QXJyYXk6IGZ1bmN0aW9uKGFycikge1xyXG4gICAgICAgICAgICB0aGlzLnggPSBhcnJbMF07XHJcbiAgICAgICAgICAgIHRoaXMueSA9IGFyclsxXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Kq44OW44K444Kn44Kv44OI44GL44KJ44K744OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0T2JqZWN0OiBmdW5jdGlvbihvYmopIHtcclxuICAgICAgICAgICAgdGhpcy54ID0gb2JqLng7XHJcbiAgICAgICAgICAgIHRoaXMueSA9IG9iai55O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmloflrZfliJfjgYvjgonjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRTdHJpbmc6IGZ1bmN0aW9uKHN0cikge1xyXG4gICAgICAgICAgICB2YXIgbSA9IHN0ci5tYXRjaCgvKC0/XFxkKyhcXC57MX1cXGQrKT8pLFxccyooLT9cXGQrKFxcLnsxfVxcZCspPykvKTtcclxuICAgICAgICAgICAgdGhpcy54ID0gcGFyc2VGbG9hdChtWzFdKTtcclxuICAgICAgICAgICAgdGhpcy55ID0gcGFyc2VGbG9hdChtWzNdKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6LOi44GE44K744OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0U21hcnQ6IGZ1bmN0aW9uKHgsIHkpIHtcclxuICAgICAgICAgICAgdmFyIHYgPSBhcmd1bWVudHNbMF07XHJcbiAgICAgICAgICAgIC8vIHh5elxyXG4gICAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy54ID0geDtcclxuICAgICAgICAgICAgICAgIHRoaXMueSA9IHk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gQXJyYXlcclxuICAgICAgICAgICAgZWxzZSBpZiAodiBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnggPSB2WzBdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy55ID0gdlsxXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBPYmplY3RcclxuICAgICAgICAgICAgZWxzZSBpZiAodiBpbnN0YW5jZW9mIE9iamVjdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy54ID0gdi54O1xyXG4gICAgICAgICAgICAgICAgdGhpcy55ID0gdi55O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIFN0cmluZ1xyXG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YodikgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgdmFyIG0gPSB2Lm1hdGNoKC8oLT9cXGQrKFxcLnsxfVxcZCspPyksXFxzKigtP1xcZCsoXFwuezF9XFxkKyk/KS8pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy54ID0gcGFyc2VGbG9hdChtWzFdKTtcclxuICAgICAgICAgICAgICAgIHRoaXMueSA9IHBhcnNlRmxvYXQobVszXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6KeS5bqm44Go6ZW344GV44Gn44OZ44Kv44OI44Or44KS44K744OD44OIXHJcbiAgICAgICAgICogQW5nbGUg44GvIERlZ3JlZSDlgKTjgafmjIflrppcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRBbmdsZTogZnVuY3Rpb24oYW5nbGUsIGxlbikge1xyXG4gICAgICAgICAgICB2YXIgcmFkID0gYW5nbGUqTWF0aC5ERUdfVE9fUkFEO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbGVuID0gbGVuIHx8IDE7XHJcbiAgICAgICAgICAgIHRoaXMueCA9IE1hdGguY29zKHJhZCkqbGVuO1xyXG4gICAgICAgICAgICB0aGlzLnkgPSBNYXRoLnNpbihyYWQpKmxlbjtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6KeS5bqmKHJhZGlhbinjgajplbfjgZXjgafjg5njgq/jg4jjg6vjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRSYWRpYW46IGZ1bmN0aW9uKHJhZGlhbiwgbGVuKSB7XHJcbiAgICAgICAgICAgIGxlbiA9IGxlbiB8fCAxO1xyXG4gICAgICAgICAgICB0aGlzLnggPSBNYXRoLmNvcyhyYWRpYW4pKmxlbjtcclxuICAgICAgICAgICAgdGhpcy55ID0gTWF0aC5zaW4ocmFkaWFuKSpsZW47XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOinkuW6pihkZWdyZWUp44Go6ZW344GV44Gn44OZ44Kv44OI44Or44KS44K744OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0RGVncmVlOiBmdW5jdGlvbihkZWdyZWUsIGxlbikge1xyXG4gICAgICAgICAgICB2YXIgcmFkID0gZGVncmVlKk1hdGguREVHX1RPX1JBRDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGxlbiA9IGxlbiB8fCAxO1xyXG4gICAgICAgICAgICB0aGlzLnggPSBNYXRoLmNvcyhyYWQpKmxlbjtcclxuICAgICAgICAgICAgdGhpcy55ID0gTWF0aC5zaW4ocmFkKSpsZW47XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODqeODs+ODgOODoOODmeOCr+ODiOODq+OCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFJhbmRvbTogZnVuY3Rpb24obWluLCBtYXgsIGxlbikge1xyXG4gICAgICAgICAgICBtaW4gPSBtaW4gfHwgMDtcclxuICAgICAgICAgICAgbWF4ID0gbWF4IHx8IDM2MDtcclxuICAgICAgICAgICAgbGVuID0gbGVuIHx8IDE7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0RGVncmVlKE1hdGgucmFuZGYobWluLCBtYXgpLCBsZW4pO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWKoOeul1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGFkZDogZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICB0aGlzLnggKz0gdi54O1xyXG4gICAgICAgICAgICB0aGlzLnkgKz0gdi55O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmuJvnrpdcclxuICAgICAgICAgKi9cclxuICAgICAgICBzdWI6IGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgdGhpcy54IC09IHYueDtcclxuICAgICAgICAgICAgdGhpcy55IC09IHYueTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5LmX566XXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbXVsOiBmdW5jdGlvbihuKSB7XHJcbiAgICAgICAgICAgIHRoaXMueCAqPSBuO1xyXG4gICAgICAgICAgICB0aGlzLnkgKj0gbjtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6Zmk566XXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZGl2OiBmdW5jdGlvbihuKSB7XHJcbiAgICAgICAgICAgIC8vY29uc29sZS5hc3NlcnQobiAhPSAwLCBcIjAgZGl2aXNpb24hIVwiKTtcclxuICAgICAgICAgICAgbiA9IG4gfHwgMC4wMTtcclxuICAgICAgICAgICAgdGhpcy54IC89IG47XHJcbiAgICAgICAgICAgIHRoaXMueSAvPSBuO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlj43ou6JcclxuICAgICAgICAgKi9cclxuICAgICAgICBuZWdhdGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLnggPSAtdGhpcy54O1xyXG4gICAgICAgICAgICB0aGlzLnkgPSAtdGhpcy55O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQG1ldGhvZFxyXG4gICAgICAgICAqIOWGheepjS5cclxuICAgICAgICAgKiDmipXlvbHjg5njgq/jg4jjg6vjgpLmsYLjgoHjgZ/jgoosIOmhnuS8vOW6puOBq+S9v+OBo+OBn+OCii5cclxuICAgICAgICAgKi9cclxuICAgICAgICBkb3Q6IGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMueCAqIHYueCArIHRoaXMueSAqIHYueTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAbWV0aG9kXHJcbiAgICAgICAgICog5aSW56mNXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY3Jvc3M6IGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgcmV0dXJuICh0aGlzLngqdi55KSAtICh0aGlzLnkqdi54KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOmVt+OBleOCkuWPluW+l1xyXG4gICAgICAgICAqICMjIyBtZW1vXHJcbiAgICAgICAgICogbWFnbml0dWRlIOOBo+OBpuWQjeWJjeOBruaWueOBjOiJr+OBhOOBi+OCgi4g5qSc6KiO5LitLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGxlbmd0aDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBNYXRoLnNxcnQodGhpcy54KnRoaXMueCArIHRoaXMueSp0aGlzLnkpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogMuS5l+OBleOCjOOBn+mVt+OBleOCkuWPluW+l1xyXG4gICAgICAgICAqIEMjIOOBruWQjeWJjeOCkuW8leeUqFxyXG4gICAgICAgICAqIG9yIGxlbmd0aFNxdWFyZSBvciBsZW5ndGhTcXJ0XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbGVuZ3RoU3F1YXJlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLngqdGhpcy54ICsgdGhpcy55KnRoaXMueTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIO+8kueCuemWk+OBrui3nembouOCkui/lOOBmVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGRpc3RhbmNlOiBmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBNYXRoLnNxcnQoIE1hdGgucG93KHRoaXMueC12LngsIDIpICsgTWF0aC5wb3codGhpcy55LXYueSwgMikgKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIO+8kueCuemWk+OBrui3nembouOCkui/lOOBmVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGRpc3RhbmNlU3F1YXJlZDogZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICByZXR1cm4gTWF0aC5wb3codGhpcy54LXYueCwgMikgKyBNYXRoLnBvdyh0aGlzLnktdi55LCAyKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOato+imj+WMllxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIG5vcm1hbGl6ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aCgpO1xyXG4gICAgICAgICAgICB0aGlzLmRpdihsZW5ndGgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDop5LluqYocmFkaWFuKeOBq+WkieaPm1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRvQW5nbGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gTWF0aC5hdGFuMih0aGlzLnksIHRoaXMueCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44K544K/44Kk44Or5paH5a2X5YiX44Gr5aSJ5o+bXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdG9TdHlsZVN0cmluZzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBcInt4Ont4fSwgeTp7eX19XCIuZm9ybWF0KHRoaXMpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaWh+Wtl+WIl+OBq+WkieaPm1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFwie3g6e3h9LCB5Ont5fX1cIi5mb3JtYXQodGhpcyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBY5YCk44KS44K744OD44OIXHJcbiAgICAgICAgICog44OB44Kn44O844Oz44Oh44K944OD44OJ55So44K744OD44K/44O8XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0WDogZnVuY3Rpb24oeCkge1xyXG4gICAgICAgICAgICB0aGlzLnggPSB4O1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFnlgKTjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKiDjg4Hjgqfjg7zjg7Pjg6Hjgr3jg4Pjg4nnlKjjgrvjg4Pjgr/jg7xcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRZOiBmdW5jdGlvbih5KSB7XHJcbiAgICAgICAgICAgIHRoaXMueSA9IHk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIG1pblxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlZlY3RvcjIubWluID0gZnVuY3Rpb24obGhzLCByaHMpIHtcclxuICAgICAgICByZXR1cm4gdG0uZ2VvbS5WZWN0b3IyKFxyXG4gICAgICAgICAgICAobGhzLnggPCByaHMueCkgPyBsaHMueCA6IHJocy54LFxyXG4gICAgICAgICAgICAobGhzLnkgPCByaHMueSkgPyBsaHMueSA6IHJocy55XHJcbiAgICAgICAgKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZFxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogbWF4XHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uVmVjdG9yMi5tYXggPSBmdW5jdGlvbihsaHMsIHJocykge1xyXG4gICAgICAgIHJldHVybiB0bS5nZW9tLlZlY3RvcjIoXHJcbiAgICAgICAgICAgIChsaHMueCA+IHJocy54KSA/IGxocy54IDogcmhzLngsXHJcbiAgICAgICAgICAgIChsaHMueSA+IHJocy55KSA/IGxocy55IDogcmhzLnlcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiDliqDnrpdcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5WZWN0b3IyLmFkZCA9IGZ1bmN0aW9uKGxocywgcmhzKSB7XHJcbiAgICAgICAgcmV0dXJuIHRtLmdlb20uVmVjdG9yMihsaHMueCtyaHMueCwgbGhzLnkrcmhzLnkpO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiDmuJvnrpdcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5WZWN0b3IyLnN1YiA9IGZ1bmN0aW9uKGxocywgcmhzKSB7XHJcbiAgICAgICAgcmV0dXJuIHRtLmdlb20uVmVjdG9yMihsaHMueC1yaHMueCwgbGhzLnktcmhzLnkpO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiDkuZfnrpdcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5WZWN0b3IyLm11bCA9IGZ1bmN0aW9uKHYsIG4pIHtcclxuICAgICAgICByZXR1cm4gdG0uZ2VvbS5WZWN0b3IyKHYueCpuLCB2Lnkqbik7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIOWJsueul1xyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlZlY3RvcjIuZGl2ID0gZnVuY3Rpb24odiwgbikge1xyXG4gICAgICAgIHJldHVybiB0bS5nZW9tLlZlY3RvcjIodi54L24sIHYueS9uKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZFxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICog5Y+N6LuiXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uVmVjdG9yMi5uZWdhdGUgPSBmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgcmV0dXJuIHRtLmdlb20uVmVjdG9yMigtdi54LCAtdi55KTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZFxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICog5YaF56mNLlxyXG4gICAgICog5oqV5b2x44OZ44Kv44OI44Or44KS5rGC44KB44Gf44KKLCDpoZ7kvLzluqbjgavkvb/jgaPjgZ/jgoouXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uVmVjdG9yMi5kb3QgPSBmdW5jdGlvbihsaHMsIHJocykge1xyXG4gICAgICAgIHJldHVybiBsaHMueCAqIHJocy54ICsgbGhzLnkgKiByaHMueTtcclxuICAgIH07XHJcbiAgICBcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIOWkluepjVxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlZlY3RvcjIuY3Jvc3MgPSBmdW5jdGlvbihsaHMsIHJocykge1xyXG4gICAgICAgIHJldHVybiAobGhzLngqcmhzLnkpIC0gKGxocy55KnJocy54KTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZFxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICog77yS54K56ZaT44Gu6Led6Zui44KS6L+U44GZXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uVmVjdG9yMi5kaXN0YW5jZSA9IGZ1bmN0aW9uKGxocywgcmhzKSB7XHJcbiAgICAgICAgcmV0dXJuIE1hdGguc3FydCggTWF0aC5wb3cobGhzLngtcmhzLngsIDIpICsgTWF0aC5wb3cobGhzLnktcmhzLnksIDIpICk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIO+8kueCuemWk+OBrui3nembouOCkui/lOOBmVxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlZlY3RvcjIuZGlzdGFuY2VTcXVhcmVkID0gZnVuY3Rpb24obGhzLCByaHMpIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5wb3cobGhzLngtcmhzLngsIDIpICsgTWF0aC5wb3cobGhzLnktcmhzLnksIDIpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIOODnuODs+ODj+ODg+OCv+ODs+i3nembolxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlZlY3RvcjIubWFuaGF0dGFuRGlzdGFuY2UgPSBmdW5jdGlvbihsaHMsIHJocykge1xyXG4gICAgICAgIHJldHVybiBNYXRoLmFicyhsaHMueC1yaHMueCkgKyBNYXRoLmFicyhsaHMueS1yaHMueSk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIOWPjeWwhOODmeOCr+ODiOODq1xyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlZlY3RvcjIucmVmbGVjdCA9IGZ1bmN0aW9uKHYsIG5vcm1hbCkge1xyXG4gICAgICAgIHZhciBsZW4gPSBWZWN0b3IyLmRvdCh2LCBub3JtYWwpO1xyXG4gICAgICAgIHZhciB0ZW1wPSBWZWN0b3IyLm11bChub3JtYWwsIDIqbGVuKTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gdG0uZ2VvbS5WZWN0b3IyLnN1Yih2LCB0ZW1wKTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiDoo5zplpMuXHJcbiAgICAgKiAwLjUg44GnIGxocyDjgaggcmhzIOOBruS4remWk+ODmeOCr+ODiOODq+OCkuaxguOCgeOCi+OBk+OBqOOBjOOBp+OBjeOBvuOBmS5cclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5WZWN0b3IyLmxlcnAgPSBmdW5jdGlvbihsaHMsIHJocywgdCkge1xyXG4gICAgICAgIC8vIFRPRE86IFxyXG4gICAgICAgIHJldHVybiB0bS5nZW9tLlZlY3RvcjIoXHJcbiAgICAgICAgICAgIGxocy54ICsgKHJocy54LWxocy54KSp0LFxyXG4gICAgICAgICAgICBsaHMueSArIChyaHMueS1saHMueSkqdFxyXG4gICAgICAgICk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZFxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICog6KOc6ZaTXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uVmVjdG9yMi5zbGVycCA9IGZ1bmN0aW9uKGxocywgcmhzLCB0KSB7XHJcbiAgICAgICAgLy8gVE9ETzpcclxuICAgICAgICAvLyBjb3MuLi5cclxuICAgIH07XHJcbiAgICBcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIG1pbiB+IG1heCDjga7plpPjgafjg6njg7Pjg4Djg6DjgarmlrnlkJHjga7jg5njgq/jg4jjg6vjgpLnlJ/miJDjgZnjgosuIGxlbiDjgafplbfjgZXmjIflrpouXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uVmVjdG9yMi5yYW5kb20gPSBmdW5jdGlvbihtaW4sIG1heCwgbGVuKSB7XHJcbiAgICAgICAgbWluID0gbWluIHx8IDA7XHJcbiAgICAgICAgbWF4ID0gbWF4IHx8IDM2MDtcclxuICAgICAgICBsZW4gPSBsZW4gfHwgMTtcclxuICAgICAgICByZXR1cm4gdG0uZ2VvbS5WZWN0b3IyKCkuc2V0RGVncmVlKE1hdGgucmFuZGYobWluLCBtYXgpLCBsZW4pO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eVxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogemVyb1xyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlZlY3RvcjIuWkVSTyAgICA9IHRtLmdlb20uVmVjdG9yMiggMCwgMCk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5XHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBsZWZ0XHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uVmVjdG9yMi5MRUZUICAgID0gdG0uZ2VvbS5WZWN0b3IyKC0xLCAwKTtcclxuICAgIFxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eVxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogcmlnaHRcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5WZWN0b3IyLlJJR0hUICAgPSB0bS5nZW9tLlZlY3RvcjIoIDEsIDApO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eVxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogdXBcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5WZWN0b3IyLlVQICAgICAgPSB0bS5nZW9tLlZlY3RvcjIoIDAsIDEpO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eVxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogZG93blxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlZlY3RvcjIuRE9XTiAgICA9IHRtLmdlb20uVmVjdG9yMiggMCwtMSk7XHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG4vKlxyXG4gKiB2ZWN0b3IzLmpzXHJcbiAqL1xyXG5cclxuLypcclxuICog5bm+5L2V5a2mXHJcbiAqL1xyXG50bS5nZW9tID0gdG0uZ2VvbSB8fCB7fTtcclxuXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLmdlb20uVmVjdG9yM1xyXG4gICAgICogM+asoeWFg+ODmeOCr+ODiOODq1xyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlZlY3RvcjMgPSB0bS5jcmVhdGVDbGFzcyh7XHJcbiAgICAgICAgLyoqIHgg5bqn5qiZICovXHJcbiAgICAgICAgeDogMCxcclxuICAgICAgICAvKiogeSDluqfmqJkgKi9cclxuICAgICAgICB5OiAwLFxyXG4gICAgICAgIC8qKiB6IOW6p+aomSAqL1xyXG4gICAgICAgIHo6IDAsXHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqIC0gW1Rlc3QgUHJvZ3JhbV0oaHR0cDovL3RtbGliLWpzLmdvb2dsZWNvZGUuY29tL3N2bi90cnVuay90ZXN0L2dlb20vdmVjdG9yLXRlc3QuaHRtbClcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbih4LCB5LCB6KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0KHgsIHksIHopO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44K744OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbih4LCB5LCB6KSB7XHJcbiAgICAgICAgICAgIHRoaXMueCA9IHg7XHJcbiAgICAgICAgICAgIHRoaXMueSA9IHk7XHJcbiAgICAgICAgICAgIHRoaXMueiA9IHo7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaVsOWApOOBi+OCieOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldE51bWJlcjogZnVuY3Rpb24oeCwgeSwgeikge1xyXG4gICAgICAgICAgICB0aGlzLnggPSB4O1xyXG4gICAgICAgICAgICB0aGlzLnkgPSB5O1xyXG4gICAgICAgICAgICB0aGlzLnogPSB6O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDphY3liJfjgYvjgonjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRBcnJheTogZnVuY3Rpb24oYXJyKSB7XHJcbiAgICAgICAgICAgIHRoaXMueCA9IGFyclswXTtcclxuICAgICAgICAgICAgdGhpcy55ID0gYXJyWzFdO1xyXG4gICAgICAgICAgICB0aGlzLnogPSBhcnJbMl07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCquODluOCuOOCp+OCr+ODiOOBi+OCieOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldE9iamVjdDogZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgIHRoaXMueCA9IG9iai54O1xyXG4gICAgICAgICAgICB0aGlzLnkgPSBvYmoueTtcclxuICAgICAgICAgICAgdGhpcy56ID0gb2JqLno7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaWh+Wtl+WIl+OBi+OCieOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFN0cmluZzogZnVuY3Rpb24oc3RyKSB7XHJcbiAgICAgICAgICAgIHZhciBtID0gc3RyLm1hdGNoKC8oLT9cXGQrKFxcLnsxfVxcZCspPyksXFxzKigtP1xcZCsoXFwuezF9XFxkKyk/KSxcXHMqKC0/XFxkKyhcXC57MX1cXGQrKT8pLyk7XHJcbiAgICAgICAgICAgIHRoaXMueCA9IHBhcnNlRmxvYXQobVsxXSk7XHJcbiAgICAgICAgICAgIHRoaXMueSA9IHBhcnNlRmxvYXQobVszXSk7XHJcbiAgICAgICAgICAgIHRoaXMueiA9IHBhcnNlRmxvYXQobVs1XSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOinkuW6pihyYWRpYW4p44Go6ZW344GV44Gn44OZ44Kv44OI44Or44KS44K744OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0QW5nbGU6IGZ1bmN0aW9uKHRoZXRhUmFkLCBwaGlSYWQsIGxlbikge1xyXG4gICAgICAgICAgICBsZW4gPSBsZW4gfHwgMTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMueCA9IGxlbiAqIE1hdGguY29zKHRoZXRhUmFkKSAqIE1hdGguc2luKHBoaVJhZCk7XHJcbiAgICAgICAgICAgIHRoaXMueSA9IGxlbiAqIE1hdGguc2luKHRoZXRhUmFkKTtcclxuICAgICAgICAgICAgdGhpcy56ID0gbGVuICogTWF0aC5jb3ModGhldGFSYWQpICogTWF0aC5jb3MocGhpUmFkKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6KeS5bqmKHJhZGlhbinjgajplbfjgZXjgafjg5njgq/jg4jjg6vjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRSYWRpYW46IGZ1bmN0aW9uKHRoZXRhUmFkLCBwaGlSYWQsIGxlbikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRBbmdsZSh0aGV0YVJhZCwgcGhpUmFkLCBsZW4pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6KeS5bqmKGRlZ3JlZSnjgajplbfjgZXjgafjg5njgq/jg4jjg6vjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXREZWdyZWU6IGZ1bmN0aW9uKHRoZXRhRGVncmVlLCBwaGlEZWdyZWUsIGxlbikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRBbmdsZSh0aGV0YURlZ3JlZSpNYXRoLkRFR19UT19SQUQsIHBoaURlZ3JlZSpNYXRoLkRFR19UT19SQUQsIGxlbik7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDos6LjgYTjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRTbWFydDogZnVuY3Rpb24oeCwgeSwgeikge1xyXG4gICAgICAgICAgICB2YXIgdiA9IGFyZ3VtZW50c1swXTtcclxuICAgICAgICAgICAgLy8geHl6XHJcbiAgICAgICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAzKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnggPSB4O1xyXG4gICAgICAgICAgICAgICAgdGhpcy55ID0geTtcclxuICAgICAgICAgICAgICAgIHRoaXMueiA9IHo7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gQXJyYXlcclxuICAgICAgICAgICAgZWxzZSBpZiAodiBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnggPSB2WzBdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy55ID0gdlsxXTtcclxuICAgICAgICAgICAgICAgIHRoaXMueiA9IHZbMl07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gT2JqZWN0XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHYgaW5zdGFuY2VvZiBPYmplY3QpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMueCA9IHYueDtcclxuICAgICAgICAgICAgICAgIHRoaXMueSA9IHYueTtcclxuICAgICAgICAgICAgICAgIHRoaXMueiA9IHYuejtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBTdHJpbmdcclxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mKHYpID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBtID0gdi5tYXRjaCgvKC0/XFxkKyhcXC57MX1cXGQrKT8pLFxccyooLT9cXGQrKFxcLnsxfVxcZCspPyksXFxzKigtP1xcZCsoXFwuezF9XFxkKyk/KS8pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy54ID0gcGFyc2VGbG9hdChtWzFdKTtcclxuICAgICAgICAgICAgICAgIHRoaXMueSA9IHBhcnNlRmxvYXQobVszXSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnogPSBwYXJzZUZsb2F0KG1bNV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWKoOeul1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGFkZDogZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICB0aGlzLnggKz0gdi54O1xyXG4gICAgICAgICAgICB0aGlzLnkgKz0gdi55O1xyXG4gICAgICAgICAgICB0aGlzLnogKz0gdi56O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmuJvnrpdcclxuICAgICAgICAgKi9cclxuICAgICAgICBzdWI6IGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgdGhpcy54IC09IHYueDtcclxuICAgICAgICAgICAgdGhpcy55IC09IHYueTtcclxuICAgICAgICAgICAgdGhpcy56IC09IHYuejtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5LmX566XXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbXVsOiBmdW5jdGlvbihuKSB7XHJcbiAgICAgICAgICAgIHRoaXMueCAqPSBuO1xyXG4gICAgICAgICAgICB0aGlzLnkgKj0gbjtcclxuICAgICAgICAgICAgdGhpcy56ICo9IG47XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOmZpOeul1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGRpdjogZnVuY3Rpb24obikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmFzc2VydChuICE9IDAsIFwiMCBkaXZpc2lvbiEhXCIpO1xyXG4gICAgICAgICAgICB0aGlzLnggLz0gbjtcclxuICAgICAgICAgICAgdGhpcy55IC89IG47XHJcbiAgICAgICAgICAgIHRoaXMueiAvPSBuO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlj43ou6JcclxuICAgICAgICAgKi9cclxuICAgICAgICBuZWdhdGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLnggPSAtdGhpcy54O1xyXG4gICAgICAgICAgICB0aGlzLnkgPSAtdGhpcy55O1xyXG4gICAgICAgICAgICB0aGlzLnogPSAtdGhpcy56O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5YaF56mNLlxyXG4gICAgICAgICAqIOaKleW9seODmeOCr+ODiOODq+OCkuaxguOCgeOBn+OCiiwg6aGe5Ly85bqm44Gr5L2/44Gj44Gf44KKLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGRvdDogZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy54ICogdi54ICsgdGhpcy55ICogdi55ICsgdGhpcy56ICogdi56O1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWkluepjVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGNyb3NzOiBmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgIHZhciB4ID0gdGhpcy55KnYueiAtIHRoaXMueip2Lnk7XHJcbiAgICAgICAgICAgIHZhciB5ID0gdGhpcy56KnYueCAtIHRoaXMueCp2Lno7XHJcbiAgICAgICAgICAgIHZhciB6ID0gdGhpcy54KnYueSAtIHRoaXMueSp2Lng7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNldCh4LCB5LCB6KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6ZW344GV44KS5Y+W5b6XXHJcbiAgICAgICAgICogb3IgbWFnbml0dWRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbGVuZ3RoOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIE1hdGguc3FydCh0aGlzLngqdGhpcy54ICsgdGhpcy55KnRoaXMueSArIHRoaXMueip0aGlzLnopO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogMuS5l+OBleOCjOOBn+mVt+OBleOCkuWPluW+l1xyXG4gICAgICAgICAqIEMjIOOBruWQjeWJjeOCkuW8leeUqFxyXG4gICAgICAgICAqIG9yIGxlbmd0aFNxdWFyZSBvciBsZW5ndGhTcXJ0XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbGVuZ3RoU3F1YXJlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLngqdGhpcy54ICsgdGhpcy55KnRoaXMueSArIHRoaXMueip0aGlzLno7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmraPopo/ljJZcclxuICAgICAgICAgKi9cclxuICAgICAgICBub3JtYWxpemU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGgoKTtcclxuICAgICAgICAgICAgdGhpcy5kaXYobGVuZ3RoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog77yS5qyh5YWD44OZ44Kv44OI44Or44Gr5aSJ5o+bXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdG9WZWN0b3IyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgLy8gVE9ETzpcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDop5LluqYocmFkaWFuKeOBq+WkieaPm1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRvQW5nbGVYWTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBNYXRoLmF0YW4yKHRoaXMueSwgdGhpcy54KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIDNE5YyW44GZ44KLXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdG8zRDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IDNk5YyW44GZ44KLXHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDnrYnjgZfjgYTjgYtcclxuICAgICAgICAgKi9cclxuICAgICAgICBlcXVhbHM6IGZ1bmN0aW9uKHgsIHksIHopIHtcclxuICAgICAgICAgICAgcmV0dXJuICggKHRoaXMueCA9PT0geCkgJiYgKHRoaXMueSA9PT0geSkgJiYgKHRoaXMueiA9PT0geikgKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8vIGVxdWFsczogZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgIC8vIHJldHVybiB0aGlzLmVxdWFscyhvYmoueCwgb2JqLnksIG9iai56KTtcclxuICAgICAgICAvLyB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOmFjeWIl+OBqOetieOBl+OBhOOBi1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGVxdWFsc0FycmF5OiBmdW5jdGlvbihhcnIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZXF1YWxzKGFyclswXSwgYXJyWzFdLCBhcnJbMl0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Kq44OW44K444Kn44Kv44OI44Go562J44GX44GE44GLXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZXF1YWxzT2JqZWN0OiBmdW5jdGlvbihvYmopIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZXF1YWxzKG9iai54LCBvYmoueSwgb2JqLnopO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6LOi44GE5q+U6LyDXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZXF1YWxzU21hcnQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyBUT0RPOiBcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgrnjgr/jgqTjg6vmloflrZfliJfjgavlpInmj5tcclxuICAgICAgICAgKi9cclxuICAgICAgICB0b1N0eWxlU3RyaW5nOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFwie3g6e3h9LCB5Ont5fSwgejp7en19XCIuZm9ybWF0KHRoaXMpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaWh+Wtl+WIl+OBq+WkieaPm1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFwie3g6e3h9LCB5Ont5fSwgejp7en19XCIuZm9ybWF0KHRoaXMpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogWOWApOOCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqIOODgeOCp+ODvOODs+ODoeOCveODg+ODieeUqOOCu+ODg+OCv+ODvFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFg6IGZ1bmN0aW9uKHgpIHtcclxuICAgICAgICAgICAgdGhpcy54ID0geDtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBZ5YCk44KS44K744OD44OIXHJcbiAgICAgICAgICog44OB44Kn44O844Oz44Oh44K944OD44OJ55So44K744OD44K/44O8XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0WTogZnVuY3Rpb24oeSkge1xyXG4gICAgICAgICAgICB0aGlzLnkgPSB5O1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFrlgKTjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKiDjg4Hjgqfjg7zjg7Pjg6Hjgr3jg4Pjg4nnlKjjgrvjg4Pjgr/jg7xcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRaOiBmdW5jdGlvbih6KSB7XHJcbiAgICAgICAgICAgIHRoaXMueiA9IHo7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBtaW5cclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5WZWN0b3IzLm1pbiA9IGZ1bmN0aW9uKGxocywgcmhzKSB7XHJcbiAgICAgICAgcmV0dXJuIFZlY3RvcjMoXHJcbiAgICAgICAgICAgIChsaHMueCA8IHJocy54KSA/IGxocy54IDogcmhzLngsXHJcbiAgICAgICAgICAgIChsaHMueSA8IHJocy55KSA/IGxocy55IDogcmhzLnksXHJcbiAgICAgICAgICAgIChsaHMueiA8IHJocy56KSA/IGxocy56IDogcmhzLnpcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBtYXhcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5WZWN0b3IzLm1heCA9IGZ1bmN0aW9uKGxocywgcmhzKSB7XHJcbiAgICAgICAgcmV0dXJuIFZlY3RvcjMoXHJcbiAgICAgICAgICAgIChsaHMueCA+IHJocy54KSA/IGxocy54IDogcmhzLngsXHJcbiAgICAgICAgICAgIChsaHMueSA+IHJocy55KSA/IGxocy55IDogcmhzLnksXHJcbiAgICAgICAgICAgIChsaHMueiA+IHJocy56KSA/IGxocy56IDogcmhzLnpcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiDliqDnrpdcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5WZWN0b3IzLmFkZCA9IGZ1bmN0aW9uKGxocywgcmhzKSB7XHJcbiAgICAgICAgcmV0dXJuIHRtLmdlb20uVmVjdG9yMyhsaHMueCtyaHMueCwgbGhzLnkrcmhzLnksIGxocy56K3Jocy56KTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZFxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICog5rib566XXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uVmVjdG9yMy5zdWIgPSBmdW5jdGlvbihsaHMsIHJocykge1xyXG4gICAgICAgIHJldHVybiB0bS5nZW9tLlZlY3RvcjMobGhzLngtcmhzLngsIGxocy55LXJocy55LCBsaHMuei1yaHMueik7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIOS5l+eul1xyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlZlY3RvcjMubXVsID0gZnVuY3Rpb24odiwgbikge1xyXG4gICAgICAgIHJldHVybiB0bS5nZW9tLlZlY3RvcjModi54Km4sIHYueSpuLCB2Lnoqbik7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIOWJsueul1xyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlZlY3RvcjMuZGl2ID0gZnVuY3Rpb24odiwgbikge1xyXG4gICAgICAgIHJldHVybiB0bS5nZW9tLlZlY3RvcjModi54L24sIHYueS9uLCB2Lnovbik7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIOWGheepjS5cclxuICAgICAqIOaKleW9seODmeOCr+ODiOODq+OCkuaxguOCgeOBn+OCiiwg6aGe5Ly85bqm44Gr5L2/44Gj44Gf44KKLlxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlZlY3RvcjMuZG90ID0gZnVuY3Rpb24obGhzLCByaHMpIHtcclxuICAgICAgICByZXR1cm4gbGhzLnggKiByaHMueCArIGxocy55ICogcmhzLnkgKyBsaHMueiAqIHJocy56O1xyXG4gICAgfTtcclxuICAgIFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZFxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICog5aSW56mNXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uVmVjdG9yMy5jcm9zcyA9IGZ1bmN0aW9uKGxocywgcmhzKSB7XHJcbiAgICAgICAgcmV0dXJuIHRtLmdlb20uVmVjdG9yMyhcclxuICAgICAgICAgICAgbGhzLnkqcmhzLnogLSBsaHMueipyaHMueSxcclxuICAgICAgICAgICAgbGhzLnoqcmhzLnggLSBsaHMueCpyaHMueixcclxuICAgICAgICAgICAgbGhzLngqcmhzLnkgLSBsaHMueSpyaHMueFxyXG4gICAgICAgICk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIOWPjei7olxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlZlY3RvcjMubmVnYXRlID0gZnVuY3Rpb24odikge1xyXG4gICAgICAgIHJldHVybiB0bS5nZW9tLlZlY3RvcjMoLXYueCwgLXYueSwgLXYueik7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIO+8kueCuemWk+OBrui3nembouOCkui/lOOBmVxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlZlY3RvcjMuZGlzdGFuY2UgPSBmdW5jdGlvbihsaHMsIHJocykge1xyXG4gICAgICAgIHJldHVybiBNYXRoLnNxcnQoIE1hdGgucG93KGxocy54LXJocy54LCAyKSArIE1hdGgucG93KGxocy55LXJocy55LCAyKSArIE1hdGgucG93KGxocy56LXJocy56LCAyKSApO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiDvvJLngrnplpPjga7ot53pm6LjgpLov5TjgZlcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5WZWN0b3IzLmRpc3RhbmNlU3F1YXJlZCA9IGZ1bmN0aW9uKGxocywgcmhzKSB7XHJcbiAgICAgICAgcmV0dXJuIE1hdGgucG93KGxocy54LXJocy54LCAyKSArIE1hdGgucG93KGxocy55LXJocy55LCAyKSArIE1hdGgucG93KGxocy56LXJocy56LCAyKTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiDjg57jg7Pjg4/jg4Pjgr/jg7Pot53pm6JcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5WZWN0b3IzLm1hbmhhdHRhbkRpc3RhbmNlID0gZnVuY3Rpb24obGhzLCByaHMpIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5hYnMobGhzLngtcmhzLngpICsgTWF0aC5hYnMobGhzLnktcmhzLnkpICsgTWF0aC5hYnMobGhzLnotcmhzLnopO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiDlj43lsITjg5njgq/jg4jjg6tcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5WZWN0b3IzLnJlZmxlY3QgPSBmdW5jdGlvbih2LCBub3JtYWwpIHtcclxuICAgICAgICB2YXIgbGVuID0gVmVjdG9yMy5kb3Qodiwgbm9ybWFsKTtcclxuICAgICAgICB2YXIgdGVtcD0gVmVjdG9yMy5tdWwobm9ybWFsLCAyKmxlbik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIFZlY3RvcjMuc3ViKHYsIHRlbXApO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIOijnOmWky5cclxuICAgICAqIDAuNSDjgacgbGhzIOOBqCByaHMg44Gu5Lit6ZaT44OZ44Kv44OI44Or44KS5rGC44KB44KL44GT44Go44GM44Gn44GN44G+44GZLlxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlZlY3RvcjMubGVycCA9IGZ1bmN0aW9uKGxocywgcmhzLCB0KSB7XHJcbiAgICAgICAgcmV0dXJuIHRtLmdlb20uVmVjdG9yMyhcclxuICAgICAgICAgICAgbGhzLnggKyAocmhzLngtbGhzLngpKnQsXHJcbiAgICAgICAgICAgIGxocy55ICsgKHJocy55LWxocy55KSp0LFxyXG4gICAgICAgICAgICBsaHMueiArIChyaHMuei1saHMueikqdFxyXG4gICAgICAgICk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZFxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICog6KOc6ZaTXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uVmVjdG9yMy5zbGVycCA9IGZ1bmN0aW9uKGxocywgcmhzLCB0KSB7XHJcbiAgICAgICAgLy8gVE9ETzpcclxuICAgICAgICAvLyBjb3MuLi5cclxuICAgIH07XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZFxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogbWluIH4gbWF4IOOBrumWk+OBp+ODqeODs+ODgOODoOOBquaWueWQkeOBruODmeOCr+ODiOODq+OCkueUn+aIkOOBmeOCiy4gbGVuIOOBp+mVt+OBleaMh+Wumi5cclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5WZWN0b3IzLnJhbmRvbSA9IGZ1bmN0aW9uKHRoZXRhTWluLCB0aGV0YU1heCwgcGhpTWluLCBwaGlNYXgsIGxlbikge1xyXG4gICAgICAgIHRoZXRhTWluPSB0aGV0YU1pbiB8fCAwO1xyXG4gICAgICAgIHRoZXRhTWF4PSB0aGV0YU1heCB8fCAzNjA7XHJcbiAgICAgICAgcGhpTWluICA9IHBoaU1pbiB8fCAwO1xyXG4gICAgICAgIHBoaU1heCAgPSBwaGlNYXggfHwgMzYwO1xyXG4gICAgICAgIGxlbiA9IGxlbiB8fCAxO1xyXG4gICAgICAgIHJldHVybiBUTS5HZW9tLlZlY3RvcjMoKS5zZXRGcm9tRGVncmVlKFRNLnJhbmRvbWYodGhldGFNaW4sIHRoZXRhTWF4KSwgVE0ucmFuZG9tZihwaGlNaW4sIHBoaU1heCksIGxlbik7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBcclxuICAgIFxyXG4gICAgLypcclxuICAgIFZlY3RvcjMucHJvdG90eXBlLmFjY2Vzc29yKFwibGVuZ3RoXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgIHsgcmV0dXJuIHRoaXMubGVuZ3RoKCk7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24obGVuKSB7IHRoaXMubm9ybWFsaXplKCkubXVsKGxlbik7IH1cclxuICAgIH0pO1xyXG4gICAgKi9cclxuICAgIFxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eVxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogemVyb1xyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlZlY3RvcjMuWkVSTyAgICA9IHRtLmdlb20uVmVjdG9yMyggMCwgMCwgMCk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5XHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBsZWZ0XHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uVmVjdG9yMy5MRUZUICAgID0gdG0uZ2VvbS5WZWN0b3IzKC0xLCAwLCAwKTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHlcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIHJpZ2h0XHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uVmVjdG9yMy5SSUdIVCAgID0gdG0uZ2VvbS5WZWN0b3IzKCAxLCAwLCAwKTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHlcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIHVwXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uVmVjdG9yMy5VUCAgICAgID0gdG0uZ2VvbS5WZWN0b3IzKCAwLCAxLCAwKTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHlcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIGRvd25cclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5WZWN0b3IzLkRPV04gICAgPSB0bS5nZW9tLlZlY3RvcjMoIDAsLTEsIDApO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eVxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogZm9yd2FyZFxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlZlY3RvcjMuRk9SV0FSRCA9IHRtLmdlb20uVmVjdG9yMyggMCwgMCwtMSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5XHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBiYWNrd2FyZFxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlZlY3RvcjMuQkFDS1dBUkQ9IHRtLmdlb20uVmVjdG9yMyggMCwgMCwgMSk7XHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG4vKlxyXG4gKiBtYXRyaXgzMy5qc1xyXG4gKi9cclxuXHJcbnRtLmdlb20gPSB0bS5nZW9tIHx8IHt9O1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyAgIHRtLmdlb20uTWF0cml4MzNcclxuICAgICAqIDMqMyDjg57jg4jjg6rjg4Pjgq/jgrnjgq/jg6njgrlcclxuICAgICAqL1xyXG4gICAgdG0uZGVmaW5lKFwidG0uZ2VvbS5NYXRyaXgzM1wiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6KaB57SgXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbTogbnVsbCxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5tID0gW107XHJcbiAgICAgICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID49IDkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlkZW50aXR5KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCr+ODreODvOODs1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGNsb25lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIG0gPSB0aGlzLm07XHJcbiAgICAgICAgICAgIHJldHVybiB0bS5nZW9tLk1hdHJpeDMzKFxyXG4gICAgICAgICAgICAgICAgbVswXSwgbVszXSwgbVs2XSxcclxuICAgICAgICAgICAgICAgIG1bMV0sIG1bNF0sIG1bN10sXHJcbiAgICAgICAgICAgICAgICBtWzJdLCBtWzVdLCBtWzhdXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgrvjg4Pjgr/jg7xcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uKG0wMCwgbTAxLCBtMDIsIG0xMCwgbTExLCBtMTIsIG0yMCwgbTIxLCBtMjIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5hc3NlcnQoYXJndW1lbnRzLmxlbmd0aD49OSwgXCJcIik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyB8bTAwLCBtMDEsIG0wMnxcclxuICAgICAgICAgICAgLy8gfG0xMCwgbTExLCBtMTJ8XHJcbiAgICAgICAgICAgIC8vIHxtMjAsIG0yMSwgbTIyfFxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gfG1bMF0sIG1bM10sIG1bNl18XHJcbiAgICAgICAgICAgIC8vIHxtWzFdLCBtWzRdLCBtWzddfFxyXG4gICAgICAgICAgICAvLyB8bVsyXSwgbVs1XSwgbVs4XXxcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIHxhLCBiLCB0eHxcclxuICAgICAgICAgICAgLy8gfGMsIGQsIHR5fFxyXG4gICAgICAgICAgICAvLyB8MCwgMCwgIDF8XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLm0wMCA9IG0wMDsgdGhpcy5tMDEgPSBtMDE7IHRoaXMubTAyID0gbTAyO1xyXG4gICAgICAgICAgICB0aGlzLm0xMCA9IG0xMDsgdGhpcy5tMTEgPSBtMTE7IHRoaXMubTEyID0gbTEyO1xyXG4gICAgICAgICAgICB0aGlzLm0yMCA9IG0yMDsgdGhpcy5tMjEgPSBtMjE7IHRoaXMubTIyID0gbTIyO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDphY3liJfjgYvjgonjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRBcnJheTogZnVuY3Rpb24oYXJyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0KFxyXG4gICAgICAgICAgICAgICAgYXJyWzBdLCBhcnJbM10sIGFycls2XSxcclxuICAgICAgICAgICAgICAgIGFyclsxXSwgYXJyWzRdLCBhcnJbN10sXHJcbiAgICAgICAgICAgICAgICBhcnJbMl0sIGFycls1XSwgYXJyWzhdXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCquODluOCuOOCp+OCr+ODiOOBi+OCieOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldE9iamVjdDogZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0KFxyXG4gICAgICAgICAgICAgICAgb2JqLm0wMCwgb2JqLm0wMSwgb2JqLm0wMixcclxuICAgICAgICAgICAgICAgIG9iai5tMTAsIG9iai5tMTEsIG9iai5tMTIsXHJcbiAgICAgICAgICAgICAgICBvYmoubTIwLCBvYmoubTIxLCBvYmoubTIyXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWNmOS9jeihjOWIl1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGlkZW50aXR5OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIG0gPSB0aGlzLm07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBtWzBdID0gMTsgbVszXSA9IDA7IG1bNl0gPSAwO1xyXG4gICAgICAgICAgICBtWzFdID0gMDsgbVs0XSA9IDE7IG1bN10gPSAwO1xyXG4gICAgICAgICAgICBtWzJdID0gMDsgbVs1XSA9IDA7IG1bOF0gPSAxO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDou6Lnva5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0cmFuc3Bvc2U6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLm0uc3dhcCgxLCAzKTtcclxuICAgICAgICAgICAgdGhpcy5tLnN3YXAoMiwgNik7XHJcbiAgICAgICAgICAgIHRoaXMubS5zd2FwKDUsIDcpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDpgIbooYzliJdcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbnZlcnQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgbSA9IHRoaXMubTtcclxuICAgICAgICAgICAgdmFyIG0wMCA9IG1bMF0sIG0wMSA9IG1bM10sIG0wMiA9IG1bNl07XHJcbiAgICAgICAgICAgIHZhciBtMTAgPSBtWzFdLCBtMTEgPSBtWzRdLCBtMTIgPSBtWzddO1xyXG4gICAgICAgICAgICB2YXIgbTIwID0gbVsyXSwgbTIxID0gbVs1XSwgbTIyID0gbVs4XTtcclxuICAgICAgICAgICAgdmFyIGRldCA9IHRoaXMuZGV0ZXJtaW5hbnQoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIHxtMDAsIG0wMSwgbTAyfFxyXG4gICAgICAgICAgICAvLyB8bTEwLCBtMTEsIG0xMnxcclxuICAgICAgICAgICAgLy8gfG0yMCwgbTIxLCBtMjJ8XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLm0wMCA9IChtMTEqbTIyLW0xMiptMjEpL2RldDtcclxuICAgICAgICAgICAgdGhpcy5tMDEgPSAobTEwKm0yMi1tMTIqbTIwKS9kZXQqLTE7XHJcbiAgICAgICAgICAgIHRoaXMubTAyID0gKG0xMCptMjEtbTExKm0yMCkvZGV0O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5tMTAgPSAobTAxKm0yMi1tMDIqbTIxKS9kZXQqLTE7XHJcbiAgICAgICAgICAgIHRoaXMubTExID0gKG0wMCptMjItbTAyKm0yMCkvZGV0O1xyXG4gICAgICAgICAgICB0aGlzLm0xMiA9IChtMDAqbTIxLW0wMSptMjApL2RldCotMTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMubTIwID0gKG0wMSptMTItbTAyKm0xMSkvZGV0O1xyXG4gICAgICAgICAgICB0aGlzLm0yMSA9IChtMDAqbTEyLW0wMiptMTApL2RldCotMTtcclxuICAgICAgICAgICAgdGhpcy5tMjIgPSAobTAwKm0xMS1tMDEqbTEwKS9kZXQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9zZSgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6KGM5YiX5byPXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZGV0ZXJtaW5hbnQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgbSA9IHRoaXMubTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciBtMDAgPSBtWzBdLCBtMDEgPSBtWzNdLCBtMDIgPSBtWzZdO1xyXG4gICAgICAgICAgICB2YXIgbTEwID0gbVsxXSwgbTExID0gbVs0XSwgbTEyID0gbVs3XTtcclxuICAgICAgICAgICAgdmFyIG0yMCA9IG1bMl0sIG0yMSA9IG1bNV0sIG0yMiA9IG1bOF07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gbTAwKm0xMSptMjIgKyBtMTAqbTIxKm0wMiArIG0wMSptMTIqbTIwIC0gbTAyKm0xMSptMjAgLSBtMDEqbTEwKm0yMiAtIG0xMiptMjEqbTAwO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44K844Ot44Kv44Oq44KiXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgemVybzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0KFxyXG4gICAgICAgICAgICAgICAgMCwgMCwgMCxcclxuICAgICAgICAgICAgICAgIDAsIDAsIDAsXHJcbiAgICAgICAgICAgICAgICAwLCAwLCAwXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOenu+WLlVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRyYW5zbGF0ZTogZnVuY3Rpb24oeCwgeSkge1xyXG4gICAgICAgICAgICB2YXIgbSA9IHRoaXMubTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIG1bNl0gPSBtWzBdICogeCArIG1bM10gKiB5ICsgbVs2XTtcclxuICAgICAgICAgICAgbVs3XSA9IG1bMV0gKiB4ICsgbVs0XSAqIHkgKyBtWzddO1xyXG4gICAgICAgICAgICBtWzhdID0gbVsyXSAqIHggKyBtWzVdICogeSArIG1bOF07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm11bHRpcGx5KCB0bS5nZW9tLk1hdHJpeDMzLnRyYW5zbGF0ZSh4LCB5KSApO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogWOi7uOWbnui7olxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJvdGF0ZVg6IGZ1bmN0aW9uKHJhZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tdWx0aXBseSggdG0uZ2VvbS5NYXRyaXgzMy5yb3RhdGVYKHJhZCkgKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFnou7jlm57ou6JcclxuICAgICAgICAgKi9cclxuICAgICAgICByb3RhdGVZOiBmdW5jdGlvbihyYWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubXVsdGlwbHkoIHRtLmdlb20uTWF0cml4MzMucm90YXRlWShyYWQpICk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBa6Lu45Zue6LuiXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcm90YXRlWjogZnVuY3Rpb24ocmFkKSB7XHJcbiAgICAgICAgICAgIHZhciBzID0gTWF0aC5zaW4ocmFkKTtcclxuICAgICAgICAgICAgdmFyIGMgPSBNYXRoLmNvcyhyYWQpO1xyXG4gICAgICAgICAgICB2YXIgbSA9IHRoaXMubTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciBtMDAgPSBtWzBdO1xyXG4gICAgICAgICAgICB2YXIgbTEwID0gbVsxXTtcclxuICAgICAgICAgICAgdmFyIG0yMCA9IG1bMl07XHJcbiAgICAgICAgICAgIHZhciBtMDEgPSBtWzNdO1xyXG4gICAgICAgICAgICB2YXIgbTExID0gbVs0XTtcclxuICAgICAgICAgICAgdmFyIG0yMSA9IG1bNV07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubXVsdGlwbHkoIHRtLmdlb20uTWF0cml4MzMucm90YXRlWihyYWQpICk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgrnjgrHjg7zjg6rjg7PjgrBcclxuICAgICAgICAgKi9cclxuICAgICAgICBzY2FsZTogZnVuY3Rpb24oeCwgeSkge1xyXG4gICAgICAgICAgICB2YXIgbSA9IHRoaXMubTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIG1bMF0gKj0geDsgbVszXSAqPSB5O1xyXG4gICAgICAgICAgICBtWzFdICo9IHg7IG1bNF0gKj0geTtcclxuICAgICAgICAgICAgbVsyXSAqPSB4OyBtWzVdICo9IHk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubXVsdGlwbHkoIHRtLmdlb20uTWF0cml4MzMuc2NhbGUoeCwgeSkgKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaOm+OBkeeul1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIG11bHRpcGx5OiBmdW5jdGlvbihtYXQpIHtcclxuICAgICAgICAgICAgdmFyIHRtID0gdGhpcy5tO1xyXG4gICAgICAgICAgICB2YXIgb20gPSBtYXQubTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciBhMDAgPSB0bVswXSwgYTAxID0gdG1bM10sIGEwMiA9IHRtWzZdO1xyXG4gICAgICAgICAgICB2YXIgYTEwID0gdG1bMV0sIGExMSA9IHRtWzRdLCBhMTIgPSB0bVs3XTtcclxuICAgICAgICAgICAgdmFyIGEyMCA9IHRtWzJdLCBhMjEgPSB0bVs1XSwgYTIyID0gdG1bOF07XHJcbiAgICAgICAgICAgIHZhciBiMDAgPSBvbVswXSwgYjAxID0gb21bM10sIGIwMiA9IG9tWzZdO1xyXG4gICAgICAgICAgICB2YXIgYjEwID0gb21bMV0sIGIxMSA9IG9tWzRdLCBiMTIgPSBvbVs3XTtcclxuICAgICAgICAgICAgdmFyIGIyMCA9IG9tWzJdLCBiMjEgPSBvbVs1XSwgYjIyID0gb21bOF07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdG1bMF0gPSBhMDAqYjAwICsgYTAxKmIxMCArIGEwMipiMjA7XHJcbiAgICAgICAgICAgIHRtWzNdID0gYTAwKmIwMSArIGEwMSpiMTEgKyBhMDIqYjIxO1xyXG4gICAgICAgICAgICB0bVs2XSA9IGEwMCpiMDIgKyBhMDEqYjEyICsgYTAyKmIyMjtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRtWzFdID0gYTEwKmIwMCArIGExMSpiMTAgKyBhMTIqYjIwO1xyXG4gICAgICAgICAgICB0bVs0XSA9IGExMCpiMDEgKyBhMTEqYjExICsgYTEyKmIyMTtcclxuICAgICAgICAgICAgdG1bN10gPSBhMTAqYjAyICsgYTExKmIxMiArIGExMipiMjI7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0bVsyXSA9IGEyMCpiMDAgKyBhMjEqYjEwICsgYTIyKmIyMDtcclxuICAgICAgICAgICAgdG1bNV0gPSBhMjAqYjAxICsgYTIxKmIxMSArIGEyMipiMjE7XHJcbiAgICAgICAgICAgIHRtWzhdID0gYTIwKmIwMiArIGEyMSpiMTIgKyBhMjIqYjIyO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg5njgq/jg4jjg6vjgajjga7mjpvjgZHnrpdcclxuICAgICAgICAgKi9cclxuICAgICAgICBtdWx0aXBseVZlY3RvcjI6IGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgdmFyIHZ4ID0gdGhpcy5tMDAqdi54ICsgdGhpcy5tMDEqdi55ICsgdGhpcy5tMDI7XHJcbiAgICAgICAgICAgIHZhciB2eSA9IHRoaXMubTEwKnYueCArIHRoaXMubTExKnYueSArIHRoaXMubTEyO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRtLmdlb20uVmVjdG9yMih2eCwgdnkpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44OZ44Kv44OI44Or44Go44Gu5o6b44GR566XXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbXVsdGlwbHlWZWN0b3IzOiBmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgIHZhciB2eCA9IHRoaXMubTAwKnYueCArIHRoaXMubTAxKnYueSArIHRoaXMubTAyKnYuejtcclxuICAgICAgICAgICAgdmFyIHZ5ID0gdGhpcy5tMTAqdi54ICsgdGhpcy5tMTEqdi55ICsgdGhpcy5tMTIqdi56O1xyXG4gICAgICAgICAgICB2YXIgdnogPSB0aGlzLm0yMCp2LnggKyB0aGlzLm0yMSp2LnkgKyB0aGlzLm0yMip2Lno7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdG0uZ2VvbS5WZWN0b3IzKHZ4LCB2eSwgdnopO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6YWN5YiX44Gr5aSJ5o+bXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdG9BcnJheTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm0uc2xpY2UoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaWh+Wtl+WIl+WMllxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFwifHttMDB9LCB7bTAxfSwge20wMn18XFxufHttMTB9LCB7bTExfSwge20xMn18XFxufHttMjB9LCB7bTIxfSwge20yMn18XCIuZm9ybWF0KHRoaXMpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgXHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIG0wMFxyXG4gICAgICog6KaB57SgXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uTWF0cml4MzMucHJvdG90eXBlLmFjY2Vzc29yKFwibTAwXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5tWzBdOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMubVswXSA9IHY7ICAgIH1cclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgbTEwXHJcbiAgICAgKiDopoHntKBcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5NYXRyaXgzMy5wcm90b3R5cGUuYWNjZXNzb3IoXCJtMTBcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLm1bMV07IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5tWzFdID0gdjsgICAgfVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBtMjBcclxuICAgICAqIOimgee0oFxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLk1hdHJpeDMzLnByb3RvdHlwZS5hY2Nlc3NvcihcIm0yMFwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMubVsyXTsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLm1bMl0gPSB2OyAgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgbTAxXHJcbiAgICAgKiDopoHntKBcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5NYXRyaXgzMy5wcm90b3R5cGUuYWNjZXNzb3IoXCJtMDFcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLm1bM107IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5tWzNdID0gdjsgICAgfVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBtMTFcclxuICAgICAqIOimgee0oFxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLk1hdHJpeDMzLnByb3RvdHlwZS5hY2Nlc3NvcihcIm0xMVwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMubVs0XTsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLm1bNF0gPSB2OyAgICB9XHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIG0yMVxyXG4gICAgICog6KaB57SgXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uTWF0cml4MzMucHJvdG90eXBlLmFjY2Vzc29yKFwibTIxXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5tWzVdOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMubVs1XSA9IHY7ICAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBtMDJcclxuICAgICAqIOimgee0oFxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLk1hdHJpeDMzLnByb3RvdHlwZS5hY2Nlc3NvcihcIm0wMlwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMubVs2XTsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLm1bNl0gPSB2OyAgICB9XHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIG0xMlxyXG4gICAgICog6KaB57SgXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uTWF0cml4MzMucHJvdG90eXBlLmFjY2Vzc29yKFwibTEyXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5tWzddOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMubVs3XSA9IHY7ICAgIH1cclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgbTIyXHJcbiAgICAgKiDopoHntKBcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5NYXRyaXgzMy5wcm90b3R5cGUuYWNjZXNzb3IoXCJtMjJcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLm1bOF07IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5tWzhdID0gdjsgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgYVxyXG4gICAgICog6KaB57SgXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uTWF0cml4MzMucHJvdG90eXBlLmFjY2Vzc29yKFwiYVwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMubVswXTsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLm1bMF0gPSB2OyAgICB9XHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGJcclxuICAgICAqIOimgee0oFxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLk1hdHJpeDMzLnByb3RvdHlwZS5hY2Nlc3NvcihcImJcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLm1bM107IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5tWzNdID0gdjsgICAgfVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBjXHJcbiAgICAgKiDopoHntKBcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5NYXRyaXgzMy5wcm90b3R5cGUuYWNjZXNzb3IoXCJjXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5tWzFdOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMubVsxXSA9IHY7ICAgIH1cclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgZFxyXG4gICAgICog6KaB57SgXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uTWF0cml4MzMucHJvdG90eXBlLmFjY2Vzc29yKFwiZFwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMubVs0XTsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLm1bNF0gPSB2OyAgICB9XHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIHR4XHJcbiAgICAgKiDopoHntKBcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5NYXRyaXgzMy5wcm90b3R5cGUuYWNjZXNzb3IoXCJ0eFwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMubVs2XTsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLm1bNl0gPSB2OyAgICB9XHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIHR5XHJcbiAgICAgKiDopoHntKBcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5NYXRyaXgzMy5wcm90b3R5cGUuYWNjZXNzb3IoXCJ0eVwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMubVs3XTsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLm1bN10gPSB2OyAgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQG1ldGhvZFxyXG4gICAgICog56e75YuVXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uTWF0cml4MzMudHJhbnNsYXRlID0gZnVuY3Rpb24oeCwgeSkge1xyXG4gICAgICAgIHJldHVybiB0bS5nZW9tLk1hdHJpeDMzKFxyXG4gICAgICAgICAgICAxLCAwLCB4LFxyXG4gICAgICAgICAgICAwLCAxLCB5LFxyXG4gICAgICAgICAgICAwLCAwLCAxXHJcbiAgICAgICAgKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQG1ldGhvZFxyXG4gICAgICogWOi7uOWbnui7olxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLk1hdHJpeDMzLnJvdGF0ZVggPSBmdW5jdGlvbihyYWQpIHtcclxuICAgICAgICB2YXIgYyA9IE1hdGguY29zKHJhZCk7XHJcbiAgICAgICAgdmFyIHMgPSBNYXRoLnNpbihyYWQpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB0bS5nZW9tLk1hdHJpeDMzKFxyXG4gICAgICAgICAgICAxLCAwLCAwLFxyXG4gICAgICAgICAgICAwLCBjLC1zLFxyXG4gICAgICAgICAgICAwLCBzLCBjXHJcbiAgICAgICAgKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQG1ldGhvZFxyXG4gICAgICogWei7uOWbnui7olxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLk1hdHJpeDMzLnJvdGF0ZVkgPSBmdW5jdGlvbihyYWQpIHtcclxuICAgICAgICB2YXIgYyA9IE1hdGguY29zKHJhZCk7XHJcbiAgICAgICAgdmFyIHMgPSBNYXRoLnNpbihyYWQpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB0bS5nZW9tLk1hdHJpeDMzKFxyXG4gICAgICAgICAgICAgYywgMCwgcyxcclxuICAgICAgICAgICAgIDAsIDEsIDAsXHJcbiAgICAgICAgICAgIC1zLCAwLCBjXHJcbiAgICAgICAgKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQG1ldGhvZFxyXG4gICAgICogWui7uOWbnui7olxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLk1hdHJpeDMzLnJvdGF0ZVogPSBmdW5jdGlvbihyYWQpIHtcclxuICAgICAgICB2YXIgYyA9IE1hdGguY29zKHJhZCk7XHJcbiAgICAgICAgdmFyIHMgPSBNYXRoLnNpbihyYWQpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB0bS5nZW9tLk1hdHJpeDMzKFxyXG4gICAgICAgICAgICBjLC1zLCAwLFxyXG4gICAgICAgICAgICBzLCBjLCAwLFxyXG4gICAgICAgICAgICAwLCAwLCAxXHJcbiAgICAgICAgKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQG1ldGhvZFxyXG4gICAgICog44K544Kx44O844Oq44Oz44KwXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uTWF0cml4MzMuc2NhbGUgPSBmdW5jdGlvbih4LCB5KSB7XHJcbiAgICAgICAgdmFyIG1hdCA9IHRtLmdlb20uTWF0cml4MzMoKTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoeSA9PSB1bmRlZmluZWQpIHkgPSB4O1xyXG4gICAgICAgIFxyXG4gICAgICAgIG1hdC5zZXQoXHJcbiAgICAgICAgICAgIHgsIDAsIDAsXHJcbiAgICAgICAgICAgIDAsIHksIDAsXHJcbiAgICAgICAgICAgIDAsIDAsIDFcclxuICAgICAgICApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBtYXQ7XHJcbiAgICB9O1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4vKlxyXG4gKiBtYXRyaXg0NC5qc1xyXG4gKi9cclxuXHJcbnRtLmdlb20gPSB0bS5nZW9tIHx8IHt9O1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzc1xyXG4gICAgICogNCo0IOODnuODiOODquODg+OCr+OCueOCr+ODqeOCuVxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLk1hdHJpeDQ0ID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIC8qKiDopoHntKAgKi9cclxuICAgICAgICBtOiBudWxsLFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5tID0gW107XHJcbiAgICAgICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID49IDE2KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pZGVudGl0eSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uKG0wMCwgbTAxLCBtMDIsIG0wMywgbTEwLCBtMTEsIG0xMiwgbTEzLCBtMjAsIG0yMSwgbTIyLCBtMjMsIG0zMCwgbTMxLCBtMzIsIG0zMykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmFzc2VydChhcmd1bWVudHMubGVuZ3RoPj0xNiwgXCJcIik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyB8bTAwLCBtMDEsIG0wMiwgbTAzfFxyXG4gICAgICAgICAgICAvLyB8bTEwLCBtMTEsIG0xMiwgbTEzfFxyXG4gICAgICAgICAgICAvLyB8bTIwLCBtMjEsIG0yMiwgbTIzfFxyXG4gICAgICAgICAgICAvLyB8bTMwLCBtMzEsIG0zMiwgbTMzfFxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5tMDAgPSBtMDA7IHRoaXMubTAxID0gbTAxOyB0aGlzLm0wMiA9IG0wMjsgdGhpcy5tMDMgPSBtMDM7XHJcbiAgICAgICAgICAgIHRoaXMubTEwID0gbTEwOyB0aGlzLm0xMSA9IG0xMTsgdGhpcy5tMTIgPSBtMTI7IHRoaXMubTEzID0gbTEzO1xyXG4gICAgICAgICAgICB0aGlzLm0yMCA9IG0yMDsgdGhpcy5tMjEgPSBtMjE7IHRoaXMubTIyID0gbTIyOyB0aGlzLm0yMyA9IG0yMztcclxuICAgICAgICAgICAgdGhpcy5tMzAgPSBtMzA7IHRoaXMubTMxID0gbTMxOyB0aGlzLm0zMiA9IG0zMjsgdGhpcy5tMzMgPSBtMzM7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOmFjeWIl+OBi+OCieOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldEFycmF5OiBmdW5jdGlvbihhcnIpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXQoXHJcbiAgICAgICAgICAgICAgICBhcnJbMF0sIGFycls0XSwgIGFycls4XSwgYXJyWzEyXSxcclxuICAgICAgICAgICAgICAgIGFyclsxXSwgYXJyWzVdLCAgYXJyWzldLCBhcnJbMTNdLFxyXG4gICAgICAgICAgICAgICAgYXJyWzJdLCBhcnJbNl0sIGFyclsxMF0sIGFyclsxNF0sXHJcbiAgICAgICAgICAgICAgICBhcnJbM10sIGFycls3XSwgYXJyWzExXSwgYXJyWzE1XVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgqrjg5bjgrjjgqfjgq/jg4jjgYvjgonjgrvjg4Pjg4guXHJcbiAgICAgICAgICogTWF0cml4NDQg44KC44GT44GE44Gk44Gn44GE44GR44KLISFcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRPYmplY3Q6IGZ1bmN0aW9uKG9iaikge1xyXG4gICAgICAgICAgICB0aGlzLnNldChcclxuICAgICAgICAgICAgICAgIG9iai5tMDAsIG9iai5tMDEsIG9iai5tMDIsIG9iai5tMDMsXHJcbiAgICAgICAgICAgICAgICBvYmoubTEwLCBvYmoubTExLCBvYmoubTEyLCBvYmoubTEzLFxyXG4gICAgICAgICAgICAgICAgb2JqLm0yMCwgb2JqLm0yMSwgb2JqLm0yMiwgb2JqLm0yMyxcclxuICAgICAgICAgICAgICAgIG9iai5tMzAsIG9iai5tMzEsIG9iai5tMzIsIG9iai5tMzNcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5Y2Y5L2N6KGM5YiXXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaWRlbnRpdHk6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLnNldChcclxuICAgICAgICAgICAgICAgIDEsIDAsIDAsIDAsXHJcbiAgICAgICAgICAgICAgICAwLCAxLCAwLCAwLFxyXG4gICAgICAgICAgICAgICAgMCwgMCwgMSwgMCxcclxuICAgICAgICAgICAgICAgIDAsIDAsIDAsIDFcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDou6Lnva5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0cmFuc3Bvc2U6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLm0uc3dhcCgxLCA0KTtcclxuICAgICAgICAgICAgdGhpcy5tLnN3YXAoMiwgOCk7XHJcbiAgICAgICAgICAgIHRoaXMubS5zd2FwKDMsIDEyKTtcclxuICAgICAgICAgICAgdGhpcy5tLnN3YXAoNiwgOSk7XHJcbiAgICAgICAgICAgIHRoaXMubS5zd2FwKDcsIDEzKTtcclxuICAgICAgICAgICAgdGhpcy5tLnN3YXAoMTEsIDE0KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog56e75YuVXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdHJhbnNsYXRlOiBmdW5jdGlvbih4LCB5LCB6KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm11bHRpcGx5KCB0bS5nZW9tLk1hdHJpeDQ0LnRyYW5zbGF0ZSh4LCB5LCB6KSApO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5Zue6LuiXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcm90YXRlOiBmdW5jdGlvbihhbmdsZSkge1xyXG4gICAgICAgICAgICAvLyBUT0RPOiDjgYTjgaTjgYvlrp/oo4XjgZnjgotcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIlVuaW1wbGVtZW50ZWRcIik7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBY6Lu444KS5Z+66Lu444Gr5Zue6Lui44GZ44KLXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcm90YXRlWDogZnVuY3Rpb24ocmFkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm11bHRpcGx5KCB0bS5nZW9tLk1hdHJpeDQ0LnJvdGF0ZVgocmFkKSApO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogWei7uOOCkuWfuui7uOOBq+Wbnui7ouOBmeOCi1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJvdGF0ZVk6IGZ1bmN0aW9uKHJhZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tdWx0aXBseSggdG0uZ2VvbS5NYXRyaXg0NC5yb3RhdGVZKHJhZCkgKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFrou7jjgpLln7rou7jjgavlm57ou6LjgZnjgotcclxuICAgICAgICAgKi9cclxuICAgICAgICByb3RhdGVaOiBmdW5jdGlvbihyYWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubXVsdGlwbHkoIHRtLmdlb20uTWF0cml4NDQucm90YXRlWihyYWQpICk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgrnjgrHjg7zjg6rjg7PjgrBcclxuICAgICAgICAgKi9cclxuICAgICAgICBzY2FsZTogZnVuY3Rpb24oeCwgeSwgeikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tdWx0aXBseSggdG0uZ2VvbS5NYXRyaXg0NC5zY2FsZSh4LCB5LCB6KSApO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44K844OtXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgemVybzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0KDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDApO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOS5l+eul1xyXG4gICAgICAgICAqIHRoaXMgKiBtYXRcclxuICAgICAgICAgKi9cclxuICAgICAgICBtdWx0aXBseTogZnVuY3Rpb24obWF0KSB7XHJcbiAgICAgICAgICAgIHZhciBtMDAgPSB0aGlzLm0wMCptYXQubTAwICsgdGhpcy5tMDEqbWF0Lm0xMCArIHRoaXMubTAyKm1hdC5tMjAgKyB0aGlzLm0wMyptYXQubTMwO1xyXG4gICAgICAgICAgICB2YXIgbTAxID0gdGhpcy5tMDAqbWF0Lm0wMSArIHRoaXMubTAxKm1hdC5tMTEgKyB0aGlzLm0wMiptYXQubTIxICsgdGhpcy5tMDMqbWF0Lm0zMTtcclxuICAgICAgICAgICAgdmFyIG0wMiA9IHRoaXMubTAwKm1hdC5tMDIgKyB0aGlzLm0wMSptYXQubTEyICsgdGhpcy5tMDIqbWF0Lm0yMiArIHRoaXMubTAzKm1hdC5tMzI7XHJcbiAgICAgICAgICAgIHZhciBtMDMgPSB0aGlzLm0wMCptYXQubTAzICsgdGhpcy5tMDEqbWF0Lm0xMyArIHRoaXMubTAyKm1hdC5tMjMgKyB0aGlzLm0wMyptYXQubTMzO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdmFyIG0xMCA9IHRoaXMubTEwKm1hdC5tMDAgKyB0aGlzLm0xMSptYXQubTEwICsgdGhpcy5tMTIqbWF0Lm0yMCArIHRoaXMubTEzKm1hdC5tMzA7XHJcbiAgICAgICAgICAgIHZhciBtMTEgPSB0aGlzLm0xMCptYXQubTAxICsgdGhpcy5tMTEqbWF0Lm0xMSArIHRoaXMubTEyKm1hdC5tMjEgKyB0aGlzLm0xMyptYXQubTMxO1xyXG4gICAgICAgICAgICB2YXIgbTEyID0gdGhpcy5tMTAqbWF0Lm0wMiArIHRoaXMubTExKm1hdC5tMTIgKyB0aGlzLm0xMiptYXQubTIyICsgdGhpcy5tMTMqbWF0Lm0zMjtcclxuICAgICAgICAgICAgdmFyIG0xMyA9IHRoaXMubTEwKm1hdC5tMDMgKyB0aGlzLm0xMSptYXQubTEzICsgdGhpcy5tMTIqbWF0Lm0yMyArIHRoaXMubTEzKm1hdC5tMzM7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgbTIwID0gdGhpcy5tMjAqbWF0Lm0wMCArIHRoaXMubTIxKm1hdC5tMTAgKyB0aGlzLm0yMiptYXQubTIwICsgdGhpcy5tMjMqbWF0Lm0zMDtcclxuICAgICAgICAgICAgdmFyIG0yMSA9IHRoaXMubTIwKm1hdC5tMDEgKyB0aGlzLm0yMSptYXQubTExICsgdGhpcy5tMjIqbWF0Lm0yMSArIHRoaXMubTIzKm1hdC5tMzE7XHJcbiAgICAgICAgICAgIHZhciBtMjIgPSB0aGlzLm0yMCptYXQubTAyICsgdGhpcy5tMjEqbWF0Lm0xMiArIHRoaXMubTIyKm1hdC5tMjIgKyB0aGlzLm0yMyptYXQubTMyO1xyXG4gICAgICAgICAgICB2YXIgbTIzID0gdGhpcy5tMjAqbWF0Lm0wMyArIHRoaXMubTIxKm1hdC5tMTMgKyB0aGlzLm0yMiptYXQubTIzICsgdGhpcy5tMjMqbWF0Lm0zMztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciBtMzAgPSB0aGlzLm0zMCptYXQubTAwICsgdGhpcy5tMzEqbWF0Lm0xMCArIHRoaXMubTMyKm1hdC5tMjAgKyB0aGlzLm0zMyptYXQubTMwO1xyXG4gICAgICAgICAgICB2YXIgbTMxID0gdGhpcy5tMzAqbWF0Lm0wMSArIHRoaXMubTMxKm1hdC5tMTEgKyB0aGlzLm0zMiptYXQubTIxICsgdGhpcy5tMzMqbWF0Lm0zMTtcclxuICAgICAgICAgICAgdmFyIG0zMiA9IHRoaXMubTMwKm1hdC5tMDIgKyB0aGlzLm0zMSptYXQubTEyICsgdGhpcy5tMzIqbWF0Lm0yMiArIHRoaXMubTMzKm1hdC5tMzI7XHJcbiAgICAgICAgICAgIHZhciBtMzMgPSB0aGlzLm0zMCptYXQubTAzICsgdGhpcy5tMzEqbWF0Lm0xMyArIHRoaXMubTMyKm1hdC5tMjMgKyB0aGlzLm0zMyptYXQubTMzO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0KFxyXG4gICAgICAgICAgICAgICAgbTAwLCBtMDEsIG0wMiwgbTAzLFxyXG4gICAgICAgICAgICAgICAgbTEwLCBtMTEsIG0xMiwgbTEzLFxyXG4gICAgICAgICAgICAgICAgbTIwLCBtMjEsIG0yMiwgbTIzLFxyXG4gICAgICAgICAgICAgICAgbTMwLCBtMzEsIG0zMiwgbTMzXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKlxyXG4gICAgICAgIGdldEF4aXNYOiBmdW5jdGlvbigpIHsgcmV0dXJuIFRNLkdlb20uVmVjdG9yMyh0aGlzLm0wMCwgdGhpcy5tMTAsIHRoaXMubTIwKTsgfSxcclxuICAgICAgICBnZXRBeGlzWTogZnVuY3Rpb24oKSB7IHJldHVybiBUTS5HZW9tLlZlY3RvcjModGhpcy5tMDEsIHRoaXMubTExLCB0aGlzLm0yMSk7IH0sXHJcbiAgICAgICAgZ2V0QXhpc1o6IGZ1bmN0aW9uKCkgeyByZXR1cm4gVE0uR2VvbS5WZWN0b3IzKHRoaXMubTAyLCB0aGlzLm0xMiwgdGhpcy5tMjIpOyB9LFxyXG4gICAgICAgICovXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogWOi7uOODmeOCr+ODiOODq+OCkuOCsuODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldEF4aXNYOiBmdW5jdGlvbigpIHsgcmV0dXJuIFRNLkdlb20uVmVjdG9yMyh0aGlzLm0wMCwgdGhpcy5tMDEsIHRoaXMubTAyKTsgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBZ6Lu444OZ44Kv44OI44Or44KS44Ky44OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0QXhpc1k6IGZ1bmN0aW9uKCkgeyByZXR1cm4gVE0uR2VvbS5WZWN0b3IzKHRoaXMubTEwLCB0aGlzLm0xMSwgdGhpcy5tMTIpOyB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFrou7jjg5njgq/jg4jjg6vjgpLjgrLjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRBeGlzWjogZnVuY3Rpb24oKSB7IHJldHVybiBUTS5HZW9tLlZlY3RvcjModGhpcy5tMjAsIHRoaXMubTIxLCB0aGlzLm0yMik7IH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFjou7jjg5njgq/jg4jjg6vjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRBeGlzWDogZnVuY3Rpb24odikgeyB0aGlzLm0wMD12LngsIHRoaXMubTAxPXYueSwgdGhpcy5tMDI9di56OyB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFnou7jjg5njgq/jg4jjg6vjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRBeGlzWTogZnVuY3Rpb24odikgeyB0aGlzLm0xMD12LngsIHRoaXMubTExPXYueSwgdGhpcy5tMTI9di56OyB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFrou7jjg5njgq/jg4jjg6vjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRBeGlzWjogZnVuY3Rpb24odikgeyB0aGlzLm0yMD12LngsIHRoaXMubTIxPXYueSwgdGhpcy5tMjI9di56OyB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIE1hdHJpeDMzIOOBq+WkieaPm1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRvTWF0cml4MzM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyBUT0RPOlxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6YWN5YiX44Gr5aSJ5o+bXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdG9BcnJheTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm0uc2xpY2UoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaWh+Wtl+WIl+WMllxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFwifHttMDB9LCB7bTAxfSwge20wMn0sIHttMDN9fFxcbnx7bTEwfSwge20xMX0sIHttMTJ9LCB7bTEzfXxcXG58e20yMH0sIHttMjF9LCB7bTIyfSwge20yM318XFxufHttMzB9LCB7bTMxfSwge20zMn0sIHttMzN9fFwiLmZvcm1hdCh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBtMDBcclxuICAgICAqIOimgee0oFxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLk1hdHJpeDQ0LnByb3RvdHlwZS5hY2Nlc3NvcihcIm0wMFwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMubVswXTsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLm1bMF0gPSB2OyAgICB9XHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIG0wMVxyXG4gICAgICog6KaB57SgXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uTWF0cml4NDQucHJvdG90eXBlLmFjY2Vzc29yKFwibTEwXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5tWzFdOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMubVsxXSA9IHY7ICAgIH1cclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgbTAyXHJcbiAgICAgKiDopoHntKBcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5NYXRyaXg0NC5wcm90b3R5cGUuYWNjZXNzb3IoXCJtMjBcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLm1bMl07IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5tWzJdID0gdjsgICAgfVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBtMDNcclxuICAgICAqIOimgee0oFxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLk1hdHJpeDQ0LnByb3RvdHlwZS5hY2Nlc3NvcihcIm0zMFwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMubVszXTsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLm1bM10gPSB2OyAgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgbTEwXHJcbiAgICAgKiDopoHntKBcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5NYXRyaXg0NC5wcm90b3R5cGUuYWNjZXNzb3IoXCJtMDFcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLm1bNF07IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5tWzRdID0gdjsgICAgfVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBtMTFcclxuICAgICAqIOimgee0oFxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLk1hdHJpeDQ0LnByb3RvdHlwZS5hY2Nlc3NvcihcIm0xMVwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMubVs1XTsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLm1bNV0gPSB2OyAgICB9XHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIG0xMlxyXG4gICAgICog6KaB57SgXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uTWF0cml4NDQucHJvdG90eXBlLmFjY2Vzc29yKFwibTIxXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5tWzZdOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMubVs2XSA9IHY7ICAgIH1cclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgbTEzXHJcbiAgICAgKiDopoHntKBcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5NYXRyaXg0NC5wcm90b3R5cGUuYWNjZXNzb3IoXCJtMzFcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLm1bN107IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5tWzddID0gdjsgICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIG0yMFxyXG4gICAgICog6KaB57SgXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uTWF0cml4NDQucHJvdG90eXBlLmFjY2Vzc29yKFwibTAyXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5tWzhdOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMubVs4XSA9IHY7ICAgIH1cclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgbTIxXHJcbiAgICAgKiDopoHntKBcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5NYXRyaXg0NC5wcm90b3R5cGUuYWNjZXNzb3IoXCJtMTJcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLm1bOV07IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5tWzldID0gdjsgICAgfVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBtMjJcclxuICAgICAqIOimgee0oFxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLk1hdHJpeDQ0LnByb3RvdHlwZS5hY2Nlc3NvcihcIm0yMlwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMubVsxMF07IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5tWzEwXSA9IHY7ICAgIH1cclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgbTIzXHJcbiAgICAgKiDopoHntKBcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5NYXRyaXg0NC5wcm90b3R5cGUuYWNjZXNzb3IoXCJtMzJcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLm1bMTFdOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMubVsxMV0gPSB2OyAgICB9XHJcbiAgICB9KTtcclxuICAgICAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIG0zMFxyXG4gICAgICog6KaB57SgXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uTWF0cml4NDQucHJvdG90eXBlLmFjY2Vzc29yKFwibTAzXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5tWzEyXTsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLm1bMTJdID0gdjsgICAgfVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBtMzFcclxuICAgICAqIOimgee0oFxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLk1hdHJpeDQ0LnByb3RvdHlwZS5hY2Nlc3NvcihcIm0xM1wiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMubVsxM107IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5tWzEzXSA9IHY7ICAgIH1cclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgbTMyXHJcbiAgICAgKiDopoHntKBcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5NYXRyaXg0NC5wcm90b3R5cGUuYWNjZXNzb3IoXCJtMjNcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLm1bMTRdOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMubVsxNF0gPSB2OyAgICB9XHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIG0zM1xyXG4gICAgICog6KaB57SgXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uTWF0cml4NDQucHJvdG90eXBlLmFjY2Vzc29yKFwibTMzXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5tWzE1XTsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLm1bMTVdID0gdjsgICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIFxyXG4gICAgXHJcbiAgICBcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIOenu+WLlVxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLk1hdHJpeDQ0LnRyYW5zbGF0ZSA9IGZ1bmN0aW9uKHgsIHksIHopIHtcclxuICAgICAgICByZXR1cm4gdG0uZ2VvbS5NYXRyaXg0NChcclxuICAgICAgICAgICAgMSwgMCwgMCwgeCxcclxuICAgICAgICAgICAgMCwgMSwgMCwgeSxcclxuICAgICAgICAgICAgMCwgMCwgMSwgeixcclxuICAgICAgICAgICAgMCwgMCwgMCwgMVxyXG4gICAgICAgICk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIFjou7jlm57ou6JcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5NYXRyaXg0NC5yb3RhdGVYID0gZnVuY3Rpb24ocmFkKSB7XHJcbiAgICAgICAgdmFyIGMgPSBNYXRoLmNvcyhyYWQpO1xyXG4gICAgICAgIHZhciBzID0gTWF0aC5zaW4ocmFkKTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gdG0uZ2VvbS5NYXRyaXg0NChcclxuICAgICAgICAgICAgMSwgMCwgMCwgMCxcclxuICAgICAgICAgICAgMCwgYywtcywgMCxcclxuICAgICAgICAgICAgMCwgcywgYywgMCxcclxuICAgICAgICAgICAgMCwgMCwgMCwgMVxyXG4gICAgICAgICk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIFnou7jlm57ou6JcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5NYXRyaXg0NC5yb3RhdGVZID0gZnVuY3Rpb24ocmFkKSB7XHJcbiAgICAgICAgdmFyIGMgPSBNYXRoLmNvcyhyYWQpO1xyXG4gICAgICAgIHZhciBzID0gTWF0aC5zaW4ocmFkKTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gdG0uZ2VvbS5NYXRyaXg0NChcclxuICAgICAgICAgICAgIGMsIDAsIHMsIDAsXHJcbiAgICAgICAgICAgICAwLCAxLCAwLCAwLFxyXG4gICAgICAgICAgICAtcywgMCwgYywgMCxcclxuICAgICAgICAgICAgIDAsIDAsIDAsIDFcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiBa6Lu45Zue6LuiXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uTWF0cml4NDQucm90YXRlWiA9IGZ1bmN0aW9uKHJhZCkge1xyXG4gICAgICAgIHZhciBjID0gTWF0aC5jb3MocmFkKTtcclxuICAgICAgICB2YXIgcyA9IE1hdGguc2luKHJhZCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHRtLmdlb20uTWF0cml4NDQoXHJcbiAgICAgICAgICAgIGMsLXMsIDAsIDAsXHJcbiAgICAgICAgICAgIHMsIGMsIDAsIDAsXHJcbiAgICAgICAgICAgIDAsIDAsIDEsIDAsXHJcbiAgICAgICAgICAgIDAsIDAsIDAsIDFcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiDjgrnjgrHjg7zjg6rjg7PjgrBcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5NYXRyaXg0NC5zY2FsZSA9IGZ1bmN0aW9uKHgsIHksIHopIHtcclxuICAgICAgICB2YXIgbWF0ID0gdG0uZ2VvbS5NYXRyaXg0NCgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICh5ID09IHVuZGVmaW5lZCkgeSA9IHg7XHJcbiAgICAgICAgaWYgKHogPT0gdW5kZWZpbmVkKSB6ID0geDtcclxuICAgICAgICBcclxuICAgICAgICBtYXQuc2V0KFxyXG4gICAgICAgICAgICB4LCAwLCAwLCAwLFxyXG4gICAgICAgICAgICAwLCB5LCAwLCAwLFxyXG4gICAgICAgICAgICAwLCAwLCB6LCAwLFxyXG4gICAgICAgICAgICAwLCAwLCAwLCAxXHJcbiAgICAgICAgKTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gbWF0O1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIHBlcnNwZWN0aXZlXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uTWF0cml4NDQucGVyc3BlY3RpdmUgPSBmdW5jdGlvbihmb3Z5LCBhc3BlY3QsIHpuZWFyLCB6ZmFyKSB7XHJcbiAgICAgICAgdmFyIHlzY2FsZSA9IDEuMCAvIE1hdGgudGFuKDAuNSpmb3Z5Kk1hdGguUEkvMTgwKTtcclxuICAgICAgICB2YXIgeHNjYWxlID0geXNjYWxlIC8gYXNwZWN0O1xyXG5cclxuICAgICAgICByZXR1cm4gdG0uZ2VvbS5NYXRyaXg0NChcclxuICAgICAgICAgICAgeHNjYWxlLCAwLjAsIDAuMCwgMC4wLFxyXG4gICAgICAgICAgICAwLjAsIHlzY2FsZSwgMC4wLCAwLjAsXHJcbiAgICAgICAgICAgIDAuMCwgMC4wLCB6ZmFyLyh6ZmFyLXpuZWFyKSwgem5lYXIqemZhci8oem5lYXItemZhciksXHJcbiAgICAgICAgICAgIDAuMCwgMC4wLCAxLjAsIDAuMFxyXG4gICAgICAgICk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIG9ydGhvXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uTWF0cml4NDQub3J0aG8gPSBmdW5jdGlvbihsZWZ0LCByaWdodCwgYm90dG9tLCB0b3AsIG5lYXIsIGZhcikge1xyXG4gICAgICAgIC8qXHJcbiAgICAgICAgdmFyIGxyID0gMSAvIChsZWZ0IC0gcmlnaHQpLFxyXG4gICAgICAgICAgICBidCA9IDEgLyAoYm90dG9tIC0gdG9wKSxcclxuICAgICAgICAgICAgbmYgPSAxIC8gKG5lYXIgLSBmYXIpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB0bS5nZW9tLk1hdHJpeDQ0KFxyXG4gICAgICAgICAgICAtMipsciwgMCwgMCwgMCxcclxuICAgICAgICAgICAgMCwgLTIqYnQsIDAsIDAsXHJcbiAgICAgICAgICAgIDAsIDAsIDIqbmYsIDAsXHJcbiAgICAgICAgICAgIChsZWZ0K3JpZ2h0KSpsciwgKHRvcCtib3R0b20pKmJ0LCAoZmFyK25lYXIpKm5mLCAxXHJcbiAgICAgICAgKTtcclxuICAgICAgICAqL1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBybCA9IChyaWdodCAtIGxlZnQpLFxyXG4gICAgICAgICAgICB0YiA9ICh0b3AgLSBib3R0b20pLFxyXG4gICAgICAgICAgICBmbiA9IChmYXIgLSBuZWFyKTtcclxuICAgICAgICByZXR1cm4gdG0uZ2VvbS5NYXRyaXg0NChcclxuICAgICAgICAgICAgMi4wL3JsLCAgICAgIDAsICAgICAwLCAwLFxyXG4gICAgICAgICAgICAgICAwLjAsIDIuMC90YiwgICAgIDAsIDAsXHJcbiAgICAgICAgICAgICAgICAgMCwgICAgICAwLCAtMi4wL2ZuLCAwLFxyXG4gICAgICAgICAgICAtKGxlZnQrcmlnaHQpL3JsLCAtKHRvcCtib3R0b20pL3RiLCAtKGZhcituZWFyKS9mbiwgMVxyXG4gICAgICAgICkudHJhbnNwb3NlKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiBsb29rQXRcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5NYXRyaXg0NC5sb29rQXQgPSBmdW5jdGlvbihleWUsIHRhcmdldCwgdXApIHtcclxuICAgICAgICB2YXIgYXhpc196ID0gdG0uZ2VvbS5WZWN0b3IzLnN1YihleWUsIHRhcmdldCkubm9ybWFsaXplKCk7XHJcbiAgICAgICAgdmFyIGF4aXNfeCA9IHRtLmdlb20uVmVjdG9yMy5jcm9zcyh1cCwgYXhpc196KS5ub3JtYWxpemUoKTtcclxuICAgICAgICB2YXIgYXhpc195ID0gdG0uZ2VvbS5WZWN0b3IzLmNyb3NzKGF4aXNfeiwgYXhpc194KS5ub3JtYWxpemUoKTtcclxuICAgICAgICBcclxuICAgICAgICAvKlxyXG4gICAgICAgIHJldHVybiB0bS5nZW9tLk1hdHJpeDQ0KFxyXG4gICAgICAgICAgICBheGlzX3gueCwgYXhpc194LnksIGF4aXNfeC56LCAtdG0uZ2VvbS5WZWN0b3IzLmRvdChleWUsIGF4aXNfeCksXHJcbiAgICAgICAgICAgIGF4aXNfeS54LCBheGlzX3kueSwgYXhpc195LnosIC10bS5nZW9tLlZlY3RvcjMuZG90KGV5ZSwgYXhpc195KSxcclxuICAgICAgICAgICAgYXhpc196LngsIGF4aXNfei55LCBheGlzX3oueiwgLXRtLmdlb20uVmVjdG9yMy5kb3QoZXllLCBheGlzX3opLFxyXG4gICAgICAgICAgICAwLCAwLCAwLCAxXHJcbiAgICAgICAgKTtcclxuICAgICAgICAqL1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8qXHJcbiAgICAgICAgcmV0dXJuIHRtLmdlb20uTWF0cml4NDQoXHJcbiAgICAgICAgICAgIGF4aXNfeC54LCBheGlzX3kueCwgYXhpc196LngsIDAsXHJcbiAgICAgICAgICAgIGF4aXNfeC55LCBheGlzX3kueSwgYXhpc196LnksIDAsXHJcbiAgICAgICAgICAgIGF4aXNfeC56LCBheGlzX3kueiwgYXhpc196LnosIDAsXHJcbiAgICAgICAgICAgIC10bS5nZW9tLlZlY3RvcjMuZG90KGV5ZSwgYXhpc194KSwgLXRtLmdlb20uVmVjdG9yMy5kb3QoZXllLCBheGlzX3kpLCAtdG0uZ2VvbS5WZWN0b3IzLmRvdChleWUsIGF4aXNfeiksIDFcclxuICAgICAgICApO1xyXG4gICAgICAgICovXHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIG9yaWVudGF0aW9uID0gdG0uZ2VvbS5NYXRyaXg0NChcclxuICAgICAgICAgICAgYXhpc194LngsIGF4aXNfeS54LCBheGlzX3oueCwgMCxcclxuICAgICAgICAgICAgYXhpc194LnksIGF4aXNfeS55LCBheGlzX3oueSwgMCxcclxuICAgICAgICAgICAgYXhpc194LnosIGF4aXNfeS56LCBheGlzX3oueiwgMCxcclxuICAgICAgICAgICAgMCwgMCwgMCwgMVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgdmFyIHRyYW5zbGF0aW9uID0gdG0uZ2VvbS5NYXRyaXg0NChcclxuICAgICAgICAgICAgMSwgMCwgMCwgMCxcclxuICAgICAgICAgICAgMCwgMSwgMCwgMCxcclxuICAgICAgICAgICAgMCwgMCwgMSwgMCxcclxuICAgICAgICAgICAgLWV5ZS54LCAtZXllLnksIC1leWUueiwgMVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIHJldHVybiB0cmFuc2xhdGlvbi5tdWx0aXBseShvcmllbnRhdGlvbik7XHJcbiAgICB9O1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuLypcclxuICogcmVjdC5qc1xyXG4gKi9cclxuXHJcbnRtLmdlb20gPSB0bS5nZW9tIHx8IHt9O1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5nZW9tLlJlY3RcclxuICAgICAqIOWbm+inkuW9ouOCr+ODqeOCuVxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlJlY3QgPSB0bS5jcmVhdGVDbGFzcyh7XHJcbiAgICAgICAgLyoqIHggKi9cclxuICAgICAgICB4OiAwLFxyXG4gICAgICAgIC8qKiB5ICovXHJcbiAgICAgICAgeTogMCxcclxuICAgICAgICAvKiog5bmFICovXHJcbiAgICAgICAgd2lkdGg6IDAsXHJcbiAgICAgICAgLyoqIOmrmOOBlSAqL1xyXG4gICAgICAgIGhlaWdodDogMCxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbih4LCB5LCB3aWR0aCwgaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0KHgsIHksIHdpZHRoLCBoZWlnaHQpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44K744OD44K/44O8XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbih4LCB5LCB3aWR0aCwgaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMueCA9IHg7XHJcbiAgICAgICAgICAgIHRoaXMueSA9IHk7XHJcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcclxuICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDnp7vli5VcclxuICAgICAgICAgKi9cclxuICAgICAgICBtb3ZlOiBmdW5jdGlvbih4LCB5KSB7XHJcbiAgICAgICAgICAgIHRoaXMueCA9IHg7XHJcbiAgICAgICAgICAgIHRoaXMueSA9IHk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog54++5Zyo5L2N572u44KS5Z+65rqW44Gr56e75YuVXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbW92ZUJ5OiBmdW5jdGlvbih4LCB5KSB7XHJcbiAgICAgICAgICAgIHRoaXMueCArPSB4O1xyXG4gICAgICAgICAgICB0aGlzLnkgKz0geTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg6rjgrXjgqTjgrpcclxuICAgICAgICAgKi9cclxuICAgICAgICByZXNpemU6IGZ1bmN0aW9uKHcsIGgpIHtcclxuICAgICAgICAgICAgdGhpcy53aWR0aCA9IHc7XHJcbiAgICAgICAgICAgIHRoaXMuaGVpZ2h0PSBoO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOePvuWcqOOBruOCteOCpOOCuuOCkuWfuua6luOBq+ODquOCteOCpOOCulxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJlc2l6ZUJ5OiBmdW5jdGlvbih3LCBoKSB7XHJcbiAgICAgICAgICAgIHRoaXMud2lkdGggKz0gdztcclxuICAgICAgICAgICAgdGhpcy5oZWlnaHQrPSBoO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODkeODh+OCo+ODs+OCsC5cclxuICAgICAgICAgKiDnuK7jgoHjgZ/jgorjgarjgakuIOeUu+mdouODj+ODn+WHuuOBl+ODgeOCp+ODg+OCr+aZguOBquOBqeOBq+S+v+WIqVxyXG4gICAgICAgICAqICMjIGV4YW1wbGVcclxuICAgICAgICAgKiAgICAgdmFyIGNpcmNsZSA9IFRNLiRDaXJjbGUoMTAsIDEwLCAxMCk7XHJcbiAgICAgICAgICogICAgIHZhciB3aW5kb3dSZWN0ID0gVE0uJFJlY3QoMCwgMCwgd2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhpZWhndCk7XHJcbiAgICAgICAgICogICAgIHdpbmRvd1JlY3QucGFkZGluZyhjaXJjbGUucmFkaXVzKTtcclxuICAgICAgICAgKiAgICAgaWYgKGNpcmNsZS54IDwgd2luZG93UmVjdC5sZWZ0KSB7XHJcbiAgICAgICAgICogICAgICAgICAvLyDlt6bjgavjga/jgb/lh7rjgZfjgZ/mmYLjga7lh6bnkIZcclxuICAgICAgICAgKiAgICAgfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHBhZGRpbmc6IGZ1bmN0aW9uKHRvcCwgcmlnaHQsIGJvdHRvbSwgbGVmdCkge1xyXG4gICAgICAgICAgICAvLyBjc3Mg44GuIHBhZGRpbmcg44Gr5ZCI44KP44Gb44Gm5pmC6KiI5Zue44KK44Gr44OR44Op44Oh44O844K/6Kq/5pW0XHJcbiAgICAgICAgICAgIHN3aXRjaCAoYXJndW1lbnRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgIHRvcCA9IHJpZ2h0ID0gYm90dG9tID0gbGVmdCA9IGFyZ3VtZW50c1swXTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICB0b3AgICAgID0gYm90dG9tID0gYXJndW1lbnRzWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0ICAgPSBsZWZ0ICAgPSBhcmd1bWVudHNbMV07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgdG9wICAgICA9IGFyZ3VtZW50c1swXTtcclxuICAgICAgICAgICAgICAgICAgICByaWdodCAgID0gbGVmdCA9IGFyZ3VtZW50c1sxXTtcclxuICAgICAgICAgICAgICAgICAgICBib3R0b20gID0gYXJndW1lbnRzWzJdO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLnggKz0gbGVmdDtcclxuICAgICAgICAgICAgdGhpcy55ICs9IHRvcDtcclxuICAgICAgICAgICAgdGhpcy53aWR0aCAtPSBsZWZ0K3JpZ2h0O1xyXG4gICAgICAgICAgICB0aGlzLmhlaWdodC09IHRvcCArYm90dG9tO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgY29udGFpbnM6IGZ1bmN0aW9uKHgsIHkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubGVmdCA8PSB4ICYmIHggPD0gdGhpcy5yaWdodCAmJiB0aGlzLnRvcCA8PSB5ICYmIHkgPD0gdGhpcy5ib3R0b207XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Kv44Ot44O844OzXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY2xvbmU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdG0uZ2VvbS5SZWN0KHRoaXMueCwgdGhpcy55LCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlhobjgavlpInmj5tcclxuICAgICAgICAgKi9cclxuICAgICAgICB0b0NpcmNsZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0bS5nZW9tLkNpcmNsZShcclxuICAgICAgICAgICAgICAgIHRoaXMuY2VudGVyWCxcclxuICAgICAgICAgICAgICAgIHRoaXMuY2VudGVyWSxcclxuICAgICAgICAgICAgICAgICgodGhpcy53aWR0aCA8IHRoaXMuaGVpZ2h0KSA/IHRoaXMud2lkdGggOiB0aGlzLmhlaWdodCkvMlxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDphY3liJfjgavlpInmj5tcclxuICAgICAgICAgKi9cclxuICAgICAgICB0b0FycmF5OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFt0aGlzLngsIHRoaXMueSwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHRdO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBsZWZ0XHJcbiAgICAgKiBsZWZ0XHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uUmVjdC5wcm90b3R5cGUuYWNjZXNzb3IoXCJsZWZ0XCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy54OyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMud2lkdGggLT0gdi10aGlzLng7IHRoaXMueCA9IHY7IH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICB0b3BcclxuICAgICAqIHRvcFxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlJlY3QucHJvdG90eXBlLmFjY2Vzc29yKFwidG9wXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy55OyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMuaGVpZ2h0IC09IHYtdGhpcy55OyB0aGlzLnkgPSB2OyB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgcmlnaHRcclxuICAgICAqIHJpZ2h0XHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uUmVjdC5wcm90b3R5cGUuYWNjZXNzb3IoXCJyaWdodFwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMueCArIHRoaXMud2lkdGg7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy53aWR0aCArPSB2LXRoaXMucmlnaHQ7IH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBib3R0b21cclxuICAgICAqIGJvdHRvbVxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlJlY3QucHJvdG90eXBlLmFjY2Vzc29yKFwiYm90dG9tXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy55ICsgdGhpcy5oZWlnaHQ7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5oZWlnaHQgKz0gdi10aGlzLmJvdHRvbTsgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGNlbnRlclhcclxuICAgICAqIGNlbnRlclhcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5SZWN0LnByb3RvdHlwZS5hY2Nlc3NvcihcImNlbnRlclhcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLnggKyB0aGlzLndpZHRoLzI7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHtcclxuICAgICAgICAgICAgLy8gVE9ETzog44Gp44GG44GX44KI44GG44GL44GqPz9cclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgY2VudGVyWVxyXG4gICAgICogY2VudGVyWVxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLlJlY3QucHJvdG90eXBlLmFjY2Vzc29yKFwiY2VudGVyWVwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMueSArIHRoaXMuaGVpZ2h0LzI7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHtcclxuICAgICAgICAgICAgLy8gVE9ETzog44Gp44GG44GX44KI44GG44GL44GqPz9cclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG59KSgpO1xyXG5cclxuXHJcbi8qXHJcbiAqIGNpcmNsZS5qc1xyXG4gKi9cclxuXHJcbnRtLmdlb20gPSB0bS5nZW9tIHx8IHt9O1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5nZW9tLkNpcmNsZVxyXG4gICAgICog5YaG44Kv44Op44K5XHJcbiAgICAgKi9cclxuICAgIHRtLmRlZmluZShcInRtLmdlb20uQ2lyY2xlXCIsIHtcclxuICAgICAgICAvKiogeCAqL1xyXG4gICAgICAgIHg6IDAsXHJcbiAgICAgICAgLyoqIHkgKi9cclxuICAgICAgICB5OiAwLFxyXG4gICAgICAgIC8qKiDljYrlvoQgKi9cclxuICAgICAgICByYWRpdXM6IDAsXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oeCwgeSwgcmFkaXVzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0KHgsIHksIHJhZGl1cyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgrvjg4Pjgr/jg7xcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uKHgsIHksIHJhZGl1cykge1xyXG4gICAgICAgICAgICB0aGlzLnggPSB4O1xyXG4gICAgICAgICAgICB0aGlzLnkgPSB5O1xyXG4gICAgICAgICAgICB0aGlzLnJhZGl1cyA9IHJhZGl1cztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog56e75YuVXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbW92ZTogZnVuY3Rpb24oeCwgeSkge1xyXG4gICAgICAgICAgICB0aGlzLnggPSB4O1xyXG4gICAgICAgICAgICB0aGlzLnkgPSB5O1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOePvuWcqOS9jee9ruOCkuWfuua6luOBq+enu+WLlVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIG1vdmVCeTogZnVuY3Rpb24oeCwgeSkge1xyXG4gICAgICAgICAgICB0aGlzLnggKz0geDtcclxuICAgICAgICAgICAgdGhpcy55ICs9IHk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Oq44K144Kk44K6XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcmVzaXplOiBmdW5jdGlvbihzaXplKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmFkaXVzID0gc2l6ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDnj77lnKjjga7jgrXjgqTjgrrjgpLln7rmupbjgavjg6rjgrXjgqTjgrpcclxuICAgICAgICAgKi9cclxuICAgICAgICByZXNpemVCeTogZnVuY3Rpb24oc2l6ZSkge1xyXG4gICAgICAgICAgICB0aGlzLnJhZGl1cyArPSBzaXplO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBcclxuICAgICAgICAgKi9cclxuICAgICAgICBjb250YWluczogZnVuY3Rpb24oeCwgeSkge1xyXG4gICAgICAgICAgICB2YXIgbGVuWCA9IHRoaXMueC14O1xyXG4gICAgICAgICAgICB2YXIgbGVuWSA9IHRoaXMueS15O1xyXG4gICAgICAgICAgICB2YXIgbGVuU3F1YXJlZCA9IChsZW5YKmxlblgpKyhsZW5ZKmxlblkpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGxlblNxdWFyZWQgPD0gdGhpcy5yYWRpdXMqdGhpcy5yYWRpdXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Kv44Ot44O844Oz5L2c5oiQXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY2xvbmU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdG0uZ2VvbS5DaXJjbGUodGhpcy54LCB0aGlzLnksIHRoaXMucmFkaXVzKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWbm+inkuW9ouOBq+WkieaPm1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRvUmVjdDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0bS5nZW9tLlJlY3QoXHJcbiAgICAgICAgICAgICAgICB0aGlzLnggLSB0aGlzLnJhZGl1cyxcclxuICAgICAgICAgICAgICAgIHRoaXMueSAtIHRoaXMucmFkaXVzLFxyXG4gICAgICAgICAgICAgICAgdGhpcy5yYWRpdXMqMiwgdGhpcy5yYWRpdXMqMlxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOmFjeWIl+OBq+WkieaPm1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRvQXJyYXk6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gW3RoaXMueCwgdGhpcy55LCB0aGlzLnJhZGl1c107XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGxlZnRcclxuICAgICAqIGxlZnRcclxuICAgICAqL1xyXG4gICAgdG0uZ2VvbS5DaXJjbGUucHJvdG90eXBlLmdldHRlcihcImxlZnRcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMueCAtIHRoaXMucmFkaXVzO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIHRvcFxyXG4gICAgICogdG9wXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uQ2lyY2xlLnByb3RvdHlwZS5nZXR0ZXIoXCJ0b3BcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMueSAtIHRoaXMucmFkaXVzO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIHJpZ2h0XHJcbiAgICAgKiByaWdodFxyXG4gICAgICovXHJcbiAgICB0bS5nZW9tLkNpcmNsZS5wcm90b3R5cGUuZ2V0dGVyKFwicmlnaHRcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMueCArIHRoaXMucmFkaXVzO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGJvdHRvbVxyXG4gICAgICogYm90dG9tXHJcbiAgICAgKi9cclxuICAgIHRtLmdlb20uQ2lyY2xlLnByb3RvdHlwZS5nZXR0ZXIoXCJib3R0b21cIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMueSArIHRoaXMucmFkaXVzO1xyXG4gICAgfSk7XHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG4vKlxyXG4gKiBjb2xsaXNpb24uanNcclxuICovXHJcblxyXG50bS5jb2xsaXNpb24gPSB0bS5jb2xsaXNpb24gfHwge307XHJcbiBcclxuKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLmNvbGxpc2lvblxyXG4gICAgICog6KGd56qB5Yik5a6aXHJcbiAgICAgKi9cclxuICAgIHRtLmNvbGxpc2lvbjtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kIHRlc3RDaXJjbGVDaXJjbGVcclxuICAgICAqIOWGhuWQjOWjq+OBruihneeqgeWIpOWumlxyXG4gICAgICovXHJcbiAgICB0bS5jb2xsaXNpb24udGVzdENpcmNsZUNpcmNsZSA9IGZ1bmN0aW9uKGNpcmNsZTAsIGNpcmNsZTEpIHtcclxuICAgICAgICB2YXIgZGlzdGFuY2VTcXVhcmVkID0gdG0uZ2VvbS5WZWN0b3IyLmRpc3RhbmNlU3F1YXJlZChjaXJjbGUwLCBjaXJjbGUxKTtcclxuICAgICAgICByZXR1cm4gZGlzdGFuY2VTcXVhcmVkIDw9IE1hdGgucG93KGNpcmNsZTAucmFkaXVzICsgY2lyY2xlMS5yYWRpdXMsIDIpO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kIHRlc3RSZWN0UmVjdFxyXG4gICAgICog55+p5b2i5ZCM5aOr44Gu6KGd56qB5Yik5a6aXHJcbiAgICAgKi9cclxuICAgIHRtLmNvbGxpc2lvbi50ZXN0UmVjdFJlY3QgPSBmdW5jdGlvbihyZWN0MCwgcmVjdDEpIHtcclxuICAgICAgICByZXR1cm4gKHJlY3QwLmxlZnQgPCByZWN0MS5yaWdodCkgJiYgKHJlY3QwLnJpZ2h0ID4gcmVjdDEubGVmdCkgJiZcclxuICAgICAgICAgICAgICAgKHJlY3QwLnRvcCA8IHJlY3QxLmJvdHRvbSkgJiYgKHJlY3QwLmJvdHRvbSA+IHJlY3QxLnRvcCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHRtLmNvbGxpc2lvbi50ZXN0Q2lyY2xlUmVjdCA9IGZ1bmN0aW9uKGNpcmNsZSwgcmVjdCkge1xyXG4gICAgICAgIC8vIOOBvuOBmuOBr+Wkp+OBjeOBquefqeW9ouOBp+WIpOWumijpq5jpgJ/ljJYpXHJcbiAgICAgICAgdmFyIGJpZ1JlY3QgPSB0bS5nZW9tLlJlY3QocmVjdC5sZWZ0LWNpcmNsZS5yYWRpdXMsIHJlY3QudG9wLWNpcmNsZS5yYWRpdXMsIHJlY3Qud2lkdGgrY2lyY2xlLnJhZGl1cyoyLCByZWN0LmhlaWdodCtjaXJjbGUucmFkaXVzKjIpO1xyXG4gICAgICAgIGlmIChiaWdSZWN0LmNvbnRhaW5zKGNpcmNsZS54LCBjaXJjbGUueSkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyAy56iu6aGe44Gu55+p5b2i44Go6KGd56qB5Yik5a6aXHJcbiAgICAgICAgdmFyIHIgPSB0bS5nZW9tLlJlY3QocmVjdC5sZWZ0LWNpcmNsZS5yYWRpdXMsIHJlY3QudG9wLCByZWN0LndpZHRoK2NpcmNsZS5yYWRpdXMqMiwgcmVjdC5oZWlnaHQpO1xyXG4gICAgICAgIGlmIChyLmNvbnRhaW5zKGNpcmNsZS54LCBjaXJjbGUueSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHIuc2V0KHJlY3QubGVmdCwgcmVjdC50b3AtY2lyY2xlLnJhZGl1cywgcmVjdC53aWR0aCwgcmVjdC5oZWlnaHQrY2lyY2xlLnJhZGl1cyoyKTtcclxuICAgICAgICBpZiAoci5jb250YWlucyhjaXJjbGUueCwgY2lyY2xlLnkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyDlhobjgajnn6nlvaLjga7vvJTngrnjga7liKTlrppcclxuICAgICAgICB2YXIgYyA9IHRtLmdlb20uQ2lyY2xlKGNpcmNsZS54LCBjaXJjbGUueSwgY2lyY2xlLnJhZGl1cyk7XHJcbiAgICAgICAgLy8gbGVmdCB0b3BcclxuICAgICAgICBpZiAoYy5jb250YWlucyhyZWN0LmxlZnQsIHJlY3QudG9wKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gcmlnaHQgdG9wXHJcbiAgICAgICAgaWYgKGMuY29udGFpbnMocmVjdC5yaWdodCwgcmVjdC50b3ApKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyByaWdodCBib3R0b21cclxuICAgICAgICBpZiAoYy5jb250YWlucyhyZWN0LnJpZ2h0LCByZWN0LmJvdHRvbSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGxlZnQgYm90dG9tXHJcbiAgICAgICAgaWYgKGMuY29udGFpbnMocmVjdC5sZWZ0LCByZWN0LmJvdHRvbSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcblxyXG4gICAgdG0uY29sbGlzaW9uLnRlc3RSZWN0Q2lyY2xlID0gZnVuY3Rpb24ocmVjdCwgY2lyY2xlKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudGVzdENpcmNsZVJlY3QoY2lyY2xlLCByZWN0KTtcclxuICAgIH07XHJcbiBcclxufSkoKTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4vKlxyXG4gKiBlbGVtZW50LmpzXHJcbiAqL1xyXG5cclxuXHJcbnRtLmRvbSA9IHRtLmRvbSB8fCB7fTtcclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3NcclxuICAgICAqIEVsZW1lbnQg44Kv44Op44K5XHJcbiAgICAgKi9cclxuICAgIHRtLmRvbS5FbGVtZW50ID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKiDjgqjjg6zjg6Hjg7Pjg4ggKi9cclxuICAgICAgICBlbGVtZW50OiBudWxsLFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLnNldC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44K744OD44K/44O8XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbihxKSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgcSA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChxICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gcTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOODh+ODleOCqeODq+ODiOOBr+ODieOCreODpeODoeODs+ODiFxyXG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlrZDkvpvjga7mnIDlvozlsL7jgavov73liqBcclxuICAgICAgICAgKi9cclxuICAgICAgICBhcHBlbmQ6IGZ1bmN0aW9uKGNoaWxkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZChjaGlsZC5lbGVtZW50KTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlrZDkvpvjga7lhYjpoK3jgavov73liqBcclxuICAgICAgICAgKi9cclxuICAgICAgICBwcmVwZW5kOiBmdW5jdGlvbihjaGlsZCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuaW5zZXJ0QmVmb3JlKGNoaWxkLmVsZW1lbnQsIHRoaXMuZWxlbWVudC5maXJzdENoaWxkKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDoh6rliIbjga7lvozjgavov73liqBcclxuICAgICAgICAgKi9cclxuICAgICAgICBhZnRlcjogZnVuY3Rpb24oY2hpbGQpIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGNoaWxkLmVsZW1lbnQsIHRoaXMuZWxlbWVudC5uZXh0U2libGluZyk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6Ieq5YiG44Gu5YmN44Gr6L+95YqgXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgYmVmb3JlOiBmdW5jdGlvbihjaGlsZCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoY2hpbGQuZWxlbWVudCwgdGhpcy5lbGVtZW50KTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlvJXmlbDjgavmuKHjgZXjgozjgZ/opoHntKDjgavoh6rliIbjgpIgYXBwZW5kXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgYXBwZW5kVG86IGZ1bmN0aW9uKHBhcmVudCkge1xyXG4gICAgICAgICAgICBwYXJlbnQuYXBwZW5kKHRoaXMpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOW8leaVsOOBq+a4oeOBleOCjOOBn+imgee0oOOBq+iHquWIhuOCkiBwcmVwZW5kXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcHJlcGVuZFRvOiBmdW5jdGlvbihwYXJlbnQpIHtcclxuICAgICAgICAgICAgcGFyZW50LnByZXBlbmQodGhpcyk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6KSH6KO9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY2xvbmU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdG0uZG9tLkVsZW1lbnQodGhpcy5lbGVtZW50LmNsb25lTm9kZSh0cnVlKSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDopqrjgYvjgonoh6rliIbjgpLlvJXjgaPjgbrjgYzjgZlcclxuICAgICAgICAgKi9cclxuICAgICAgICByZW1vdmU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmVsZW1lbnQpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOimgee0oOeUn+aIkFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGNyZWF0ZTogZnVuY3Rpb24odGFnLCBhZGRGdW5jTmFtZSkge1xyXG4gICAgICAgICAgICAvLyDopoHntKDjgpLnlJ/miJBcclxuICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSB0bS5kb20uRWxlbWVudChkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRhZykpO1xyXG4gICAgICAgICAgICAvLyDjg4fjg5Xjgqnjg6vjg4jjga7ov73liqDmlrnms5Xjga8gYXBwZW5kXHJcbiAgICAgICAgICAgIGlmICghYWRkRnVuY05hbWUpIHsgYWRkRnVuY05hbWU9XCJhcHBlbmRcIjsgfVxyXG4gICAgICAgICAgICAvLyDoh6rliIbjga7lrZDkvpvjgajjgZfjgabov73liqBcclxuICAgICAgICAgICAgdGhpc1thZGRGdW5jTmFtZV0oZWxlbWVudCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIHF1ZXJ5XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcXVlcnk6IGZ1bmN0aW9uKHF1ZXJ5LCBpbmRleCkge1xyXG4gICAgICAgICAgICB2YXIgZWxtID0gKGluZGV4KSA/XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChxdWVyeSlbaW5kZXhdIDogXHJcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihxdWVyeSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdG0uZG9tLkVsZW1lbnQoZWxtKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIHF1ZXJ5QWxsXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcXVlcnlBbGw6IGZ1bmN0aW9uKHF1ZXJ5KSB7XHJcbiAgICAgICAgICAgIHZhciBsaXN0ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwocXVlcnkpO1xyXG4gICAgICAgICAgICByZXR1cm4gdG0uZG9tLkVsZW1lbnRMaXN0KGxpc3QpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5Zu65a6a5YyWXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZml4ZWQ6IGZ1bmN0aW9uKHgsIHksIHdpZHRoLCBoZWlnaHQpIHtcclxuICAgICAgICAgICAgdGhpcy5zdHlsZS5zZXQoXCJwb3NpdGlvblwiLCBcImZpeGVkXCIpO1xyXG4gICAgICAgICAgICBpZiAoeCkgdGhpcy54ID0geDtcclxuICAgICAgICAgICAgaWYgKHkpIHRoaXMueSA9IHk7XHJcbiAgICAgICAgICAgIGlmICh3aWR0aCkgdGhpcy53aWR0aCA9IHdpZHRoO1xyXG4gICAgICAgICAgICBpZiAoaGVpZ2h0KSB0aGlzLmhlaWdodCA9IGhlaWdodDtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBhYnNvbHV0ZSDljJZcclxuICAgICAgICAgKi9cclxuICAgICAgICBhYnNvbHV0ZTogZnVuY3Rpb24oeCwgeSwgd2lkdGgsIGhlaWdodCkge1xyXG4gICAgICAgICAgICB0aGlzLnN0eWxlLnNldChcInBvc2l0aW9uXCIsIFwiYWJzb2x1dGVcIik7XHJcbiAgICAgICAgICAgIGlmICh4KSB0aGlzLnggPSB4O1xyXG4gICAgICAgICAgICBpZiAoeSkgdGhpcy55ID0geTtcclxuICAgICAgICAgICAgaWYgKHdpZHRoKSB0aGlzLndpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgICAgIGlmIChoZWlnaHQpIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODleODq+OCueOCr+ODquODvOODs+WMllxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bGxTY3JlZW46IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQud2Via2l0UmVxdWVzdEZ1bGxTY3JlZW4oKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDooajnpLpcclxuICAgICAgICAgKi9cclxuICAgICAgICBzaG93OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy52aXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDpnZ7ooajnpLpcclxuICAgICAgICAgKi9cclxuICAgICAgICBoaWRlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy52aXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmloflrZfliJfjgavlpInmj5tcclxuICAgICAgICAgKi9cclxuICAgICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBcInRtLmRvbS5lbGVtZW50XCI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDopoHntKDjgpLlj5blvpdcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRFbGVtZW50OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIFxyXG4gICAgXHJcbiAgICAvKiogQHByb3BlcnR5IGh0bWwgIGh0bWwg44Gu5YCkICovXHJcbiAgICB0bS5kb20uRWxlbWVudC5wcm90b3R5cGUuYWNjZXNzb3IoXCJodG1sXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgICAgIHsgcmV0dXJuIHRoaXMuZWxlbWVudC5pbm5lckhUTUw7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24oaHRtbCkgICB7IHRoaXMuZWxlbWVudC5pbm5lckhUTUwgPSBodG1sOyB9XHJcbiAgICB9KTtcclxuICAgIC8qKiBAcHJvcGVydHkgdmFsdWUgIHZhbHVlIOOBruWApCAqL1xyXG4gICAgdG0uZG9tLkVsZW1lbnQucHJvdG90eXBlLmFjY2Vzc29yKFwidmFsdWVcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICAgICAgeyByZXR1cm4gdGhpcy5lbGVtZW50LnZhbHVlOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHZhbHVlKSAgIHsgdGhpcy5lbGVtZW50LnZhbHVlID0gdmFsdWU7IH1cclxuICAgIH0pO1xyXG4gICAgLyoqIEBwcm9wZXJ0eSB4ICB45YCkICovXHJcbiAgICB0bS5kb20uRWxlbWVudC5wcm90b3R5cGUuYWNjZXNzb3IoXCJ4XCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gTnVtYmVyKCB0aGlzLmVsZW1lbnQuc3R5bGUubGVmdC5yZXBsYWNlKFwicHhcIiwgJycpICk7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24oeCkgIHsgdGhpcy5lbGVtZW50LnN0eWxlLmxlZnQgPSB4K1wicHhcIjsgfVxyXG4gICAgfSk7XHJcbiAgICAvKiogQHByb3BlcnR5IHkgIHnlgKQgKi9cclxuICAgIHRtLmRvbS5FbGVtZW50LnByb3RvdHlwZS5hY2Nlc3NvcihcInlcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiBOdW1iZXIoIHRoaXMuZWxlbWVudC5zdHlsZS50b3AucmVwbGFjZShcInB4XCIsICcnKSApOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHkpICB7IHRoaXMuZWxlbWVudC5zdHlsZS50b3AgPSB5K1wicHhcIjsgfVxyXG4gICAgfSk7XHJcbiAgICAvKiogQHByb3BlcnR5IHdpZHRoICDluYUgKi9cclxuICAgIHRtLmRvbS5FbGVtZW50LnByb3RvdHlwZS5hY2Nlc3NvcihcIndpZHRoXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gTnVtYmVyKCB0aGlzLmVsZW1lbnQuc3R5bGUud2lkdGgucmVwbGFjZShcInB4XCIsICcnKSApOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHcpICB7IHRoaXMuZWxlbWVudC5zdHlsZS53aWR0aCA9IHcrXCJweFwiOyB9XHJcbiAgICB9KTtcclxuICAgIC8qKiBAcHJvcGVydHkgaGVpZ2h0ICDpq5jjgZUgKi9cclxuICAgIHRtLmRvbS5FbGVtZW50LnByb3RvdHlwZS5hY2Nlc3NvcihcImhlaWdodFwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIE51bWJlciggdGhpcy5lbGVtZW50LnN0eWxlLmhlaWdodC5yZXBsYWNlKFwicHhcIiwgJycpICk7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24oaCkgIHsgdGhpcy5lbGVtZW50LnN0eWxlLmhlaWdodCA9IGgrXCJweFwiOyB9XHJcbiAgICB9KTtcclxuICAgIC8qKiBAcHJvcGVydHkgY29sb3IgIOiJsiAqL1xyXG4gICAgdG0uZG9tLkVsZW1lbnQucHJvdG90eXBlLmFjY2Vzc29yKFwiY29sb3JcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICAgICAgeyByZXR1cm4gdGhpcy5lbGVtZW50LnN0eWxlLmNvbG9yOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKGNvbG9yKSAgeyB0aGlzLmVsZW1lbnQuc3R5bGUuY29sb3IgPSBjb2xvcjsgfVxyXG4gICAgfSk7XHJcbiAgICAvKiogQHByb3BlcnR5IGJhY2tncm91bmRDb2xvciAg6IOM5pmv6ImyICovXHJcbiAgICB0bS5kb20uRWxlbWVudC5wcm90b3R5cGUuYWNjZXNzb3IoXCJiYWNrZ3JvdW5kQ29sb3JcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICAgICAgeyByZXR1cm4gdGhpcy5lbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvcjsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbihjb2xvcikgIHsgdGhpcy5lbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNvbG9yOyB9XHJcbiAgICB9KTtcclxuICAgIC8qKiBAcHJvcGVydHkgdmlzaWJsZSAg6KGo56S6L+mdnuihqOekuiAqL1xyXG4gICAgdG0uZG9tLkVsZW1lbnQucHJvdG90eXBlLmFjY2Vzc29yKFwidmlzaWJsZVwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMuZWxlbWVudC5zdHlsZS52aXNpYmlsaXR5ICE9IFwiaGlkZGVuXCI7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5lbGVtZW50LnN0eWxlLnZpc2liaWxpdHkgPSAodj09dHJ1ZSkgPyBcInZpc2libGVcIiA6IFwiaGlkZGVuXCI7IH1cclxuICAgIH0pO1xyXG4gICAgLyoqIEBwcm9wZXJ0eSB0ZXh0ICDjg4bjgq3jgrnjg4ggKi9cclxuICAgIHRtLmRvbS5FbGVtZW50LnByb3RvdHlwZS5hY2Nlc3NvcihcInRleHRcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLmVsZW1lbnQuaW5uZXJUZXh0IHx8IHRoaXMuZWxlbWVudC50ZXh0Q29udGVudDsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5lbGVtZW50LmlubmVyVGV4dCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmlubmVyVGV4dCA9IHY7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQudGV4dENvbnRlbnQgPSB2O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICAvKiogQHByb3BlcnR5IGNsYXNzTGlzdCAg44Kv44Op44K544Oq44K544OIICovXHJcbiAgICB0bS5kb20uRWxlbWVudC5wcm90b3R5cGUuZ2V0dGVyKFwiY2xhc3NMaXN0XCIsIGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0OyB9KTtcclxuICAgIC8qKiBAcHJvcGVydHkgcGFyZW50ICovXHJcbiAgICB0bS5kb20uRWxlbWVudC5wcm90b3R5cGUuZ2V0dGVyKFwicGFyZW50XCIsIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmVsZW1lbnQucGFyZW50Tm9kZSAhPSB1bmRlZmluZWQpID8gdG0uZG9tLkVsZW1lbnQodGhpcy5lbGVtZW50LnBhcmVudE5vZGUpIDogbnVsbDtcclxuICAgIH0pO1xyXG4gICAgLyoqIEBwcm9wZXJ0eSBwcmV2ICovXHJcbiAgICB0bS5kb20uRWxlbWVudC5wcm90b3R5cGUuZ2V0dGVyKFwicHJldlwiLCBmdW5jdGlvbigpe1xyXG4gICAgICAgIHJldHVybiAodGhpcy5lbGVtZW50LnByZXZpb3VzU2libGluZyAhPSB1bmRlZmluZWQpID8gdG0uZG9tLkVsZW1lbnQodGhpcy5lbGVtZW50LnByZXZpb3VzU2libGluZykgOiBudWxsO1xyXG4gICAgfSk7XHJcbiAgICAvKiogQHByb3BlcnR5IG5leHQgKi9cclxuICAgIHRtLmRvbS5FbGVtZW50LnByb3RvdHlwZS5nZXR0ZXIoXCJuZXh0XCIsIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmVsZW1lbnQubmV4dFNpYmxpbmcgIT0gdW5kZWZpbmVkKSA/IHRtLmRvbS5FbGVtZW50KHRoaXMuZWxlbWVudC5uZXh0U2libGluZykgOiBudWxsO1xyXG4gICAgfSk7XHJcbiAgICAvKiogQHByb3BlcnR5IGNoaWxkcmVuICovXHJcbiAgICB0bS5kb20uRWxlbWVudC5wcm90b3R5cGUuZ2V0dGVyKFwiY2hpbGRyZW5cIiwgZnVuY3Rpb24oKXtcclxuICAgICAgICByZXR1cm4gdG0uZG9tLkVsZW1lbnRMaXN0KHRoaXMuZWxlbWVudC5jaGlsZHJlbik7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuKGZ1bmN0aW9uKCl7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLmRvbS5FbGVtZW50TGlzdFxyXG4gICAgICog44Ko44Os44Oh44Oz44OI44Oq44K544OIXHJcbiAgICAgKiBAZXh0ZW5kcyBnbG9iYWwuQXJyYXlcclxuICAgICAqL1xyXG4gICAgdG0uZG9tLkVsZW1lbnRMaXN0ID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IEFycmF5LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqIFRNLkRPTS5FbGVtZW50IOeUqOmFjeWIl1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKGFycikge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGFyZ3VtZW50c1swXSA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcXVlcnkgPSBhcmd1bWVudHNbMF07XHJcbiAgICAgICAgICAgICAgICBhcnIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHF1ZXJ5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChhcnIgPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBmb3IgKHZhciBpPTAsbGVuPWFyci5sZW5ndGg7IGk8bGVuOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucHVzaCggdG0uZG9tLkVsZW1lbnQoYXJyW2ldKSApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmloflrZfliJfjgavlpInmj5tcclxuICAgICAgICAgKi9cclxuICAgICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuLypcclxuICogZG9tL2V2bmV0LmpzXHJcbiAqL1xyXG5cclxudG0uZG9tID0gdG0uZG9tIHx8IHt9O1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyBnbG9iYWwuRXZlbnRcclxuICAgICAqIOaXouWtmOOBrkV2ZW5044Kq44OW44K444Kn44Kv44OI5ouh5by1XHJcbiAgICAgKi9cclxuICAgIFxyXG4gICAgLy8g5LuV5pa544Gq44GX44GuIElFIOWvvuW/nCjjgZPjgozlvJXjgaPjgYvjgYvjgaPjgZ/jgonku5bjga7jgoLjg4Djg6HjgaDjgYvjgonlv4XopoHjgarjgYTjgYvjgoIpXHJcbiAgICBpZiAoIUV2ZW50LnByb3RvdHlwZS5zdG9wUHJvcGFnYXRpb24pIHtcclxuICAgICAgICAvKiogQG1ldGhvZCAqL1xyXG4gICAgICAgIEV2ZW50LnByb3RvdHlwZS5zdG9wUHJvcGFnYXRpb24gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5jYW5jZWxCdWJibGUgPSB0cnVlO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICBpZiAoIUV2ZW50LnByb3RvdHlwZS5wcmV2ZW50RGVmYXVsdCkge1xyXG4gICAgICAgIC8qKiBAbWV0aG9kICovXHJcbiAgICAgICAgRXZlbnQucHJvdG90eXBlLnByZXZlbnREZWZhdWx0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmV0dXJuVmFsdWUgPSBmYWxzZTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2Qgc3RvcFxyXG4gICAgICog44Kk44OZ44Oz44OI44Gu44OH44OV44Kp44Or44OI5Yem55CGICYg5Lyd6YGU44KS5q2i44KB44KLXHJcbiAgICAgKi9cclxuICAgIEV2ZW50LnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy8g44Kk44OZ44Oz44OI44Kt44Oj44Oz44K744OrXHJcbiAgICAgICAgdGhpcy5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIC8vIOOCpOODmeODs+ODiOS8nemBlOOCkuatouOCgeOCi1xyXG4gICAgICAgIHRoaXMuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB9O1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyBnbG9iYWwuS2V5Ym9hcmRFdmVudFxyXG4gICAgICogS2V5Ym9hcmRFdmVudCDjgq/jg6njgrlcclxuICAgICAqL1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2QgICAgY2hhcmFjdGVyXHJcbiAgICAgKiDmirzjgZfjgZ/jgq3jg7zjga7mloflrZfjgpLlj5blvpdcclxuICAgICAqL1xyXG4gICAgS2V5Ym9hcmRFdmVudC5wcm90b3R5cGUuZ2V0dGVyKFwiY2hhcmFjdGVyXCIsIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUodGhpcy5rZXlDb2RlKTtcclxuICAgIH0pO1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyBnbG9iYWwuTW91c2VFdmVudFxyXG4gICAgICogTW91c2VFdmVudCDjgq/jg6njgrlcclxuICAgICAqL1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2QgICAgcG9pbnRYXHJcbiAgICAgKiDjg57jgqbjgrnjga5Y5bqn5qiZLlxyXG4gICAgICovXHJcbiAgICBNb3VzZUV2ZW50LnByb3RvdHlwZS5nZXR0ZXIoXCJwb2ludFhcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2xpZW50WCAtIHRoaXMudGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQ7XHJcbi8vICAgICAgICByZXR1cm4gdGhpcy5wYWdlWCAtIHRoaXMudGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQgLSB3aW5kb3cuc2Nyb2xsWDtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2QgICAgcG9pbnRZXHJcbiAgICAgKiDjg57jgqbjgrnjga5Z5bqn5qiZLlxyXG4gICAgICovXHJcbiAgICBNb3VzZUV2ZW50LnByb3RvdHlwZS5nZXR0ZXIoXCJwb2ludFlcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2xpZW50WSAtIHRoaXMudGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcDtcclxuLy8gICAgICAgIHJldHVybiB0aGlzLnBhZ2VZIC0gdGhpcy50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wIC0gd2luZG93LnNjcm9sbFk7XHJcbiAgICB9KTtcclxuICAgIFxyXG59KSgpO1xyXG5cclxuXHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICBpZiAod2luZG93LlRvdWNoRXZlbnQgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gOyB9XHJcbiAgICBcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgZ2xvYmFsLlRvdWNoRXZlbnRcclxuICAgICAqIFRvdWNoRXZlbnQg44Kv44Op44K5XHJcbiAgICAgKi9cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kICAgIHBvaW50WFxyXG4gICAgICog44K/44OD44OB44Kk44OZ44Oz44OILlxyXG4gICAgICovXHJcbiAgICBUb3VjaEV2ZW50LnByb3RvdHlwZS5nZXR0ZXIoXCJwb2ludFhcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudG91Y2hlc1swXS5jbGllbnRYIC0gdGhpcy50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdDtcclxuLy8gICAgICAgIHJldHVybiB0aGlzLnRvdWNoZXNbMF0ucGFnZVggLSB0aGlzLnRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0IC0gdG0uZ2xvYmFsLnNjcm9sbFg7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWV0aG9kICAgIHBvaW50WVxyXG4gICAgICog44K/44OD44OB44Kk44OZ44Oz44OILlxyXG4gICAgICovXHJcbiAgICBUb3VjaEV2ZW50LnByb3RvdHlwZS5nZXR0ZXIoXCJwb2ludFlcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudG91Y2hlc1swXS5jbGllbnRZIC0gdGhpcy50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xyXG4vLyAgICAgICAgcmV0dXJuIHRoaXMudG91Y2hlc1swXS5wYWdlWSAtIHRoaXMudGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCAtIHRtLmdsb2JhbC5zY3JvbGxZO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIFxyXG59KSgpO1xyXG5cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZG9tLkV2ZW50XHJcbiAgICAgKiBFdmVudCDjgq/jg6njgrlcclxuICAgICAqL1xyXG4gICAgdG0uZG9tLkV2ZW50ID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG5cclxuICAgICAgICAvKiogRE9N44Ko44Os44Oh44Oz44OIICovXHJcbiAgICAgICAgZWxlbWVudCAgICAgOiBudWxsLFxyXG4gICAgICAgIC8qKiDjgqTjg5njg7Pjg4jnmbrngavmmYLjgavlrp/ooYzjgZnjgovplqLmlbDjg6rjgrnjg4ggKi9cclxuICAgICAgICBmdW5jTGlzdCAgICA6IG51bGwsXHJcbiAgICAgICAgLyoqIOmWouaVsOODquOCueODiOOBruOCpOODs+ODh+ODg+OCr+OCueOAgOacquS9v+eUqO+8nyAqL1xyXG4gICAgICAgIGZ1bmNJbmRleCAgIDogMCxcclxuICAgICAgICAvKiogQHByb3BlcnR5IGRvbUVsZW1lbnQgKi9cclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihlbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcbiAgICAgICAgICAgIHRoaXMuZG9tRWxlbWVudCA9IGVsZW1lbnQuZWxlbWVudDtcclxuICAgICAgICAgICAgdGhpcy5mdW5jTGlzdCA9IHt9O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Kk44OZ44Oz44OI44KS6L+95YqgXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgYWRkOiBmdW5jdGlvbih0eXBlLCBmbiwgaWQpIHtcclxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgZWxtICA9IHRoaXMuZWxlbWVudDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciB0ZW1wX2ZuID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIGZuLmFwcGx5KHNlbGYsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gZm4uYXBwbHkoZWxtLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0ID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOODh+ODleOCqeODq+ODiOOCpOODmeODs+ODiOOCkuOCreODo+ODs+OCu+ODq1xyXG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBlLnJldHVyblZhbHVlID0gZmFsc2U7ICAvLyBJRVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIOOCpOODmeODs+ODiOS8nemBlOOCkuOCreODo+ODs+OCu+ODq1xyXG4gICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuX2Z1bmNJbmRleCA9IHRoaXMuX2Z1bmNJbmRleCB8fCAwO1xyXG4gICAgICAgICAgICBpZCA9IGlkIHx8IHRoaXMuX2Z1bmNJbmRleCsrO1xyXG4gICAgICAgICAgICB0aGlzLmZ1bmNMaXN0W3R5cGVdID0gdGhpcy5mdW5jTGlzdFt0eXBlXSB8fCB7fTtcclxuICAgICAgICAgICAgdGhpcy5mdW5jTGlzdFt0eXBlXVtpZF0gPSB0ZW1wX2ZuO1xyXG4gICAgICAgICAgICBmbi5faWQgPSBpZDsgICAgLy8g44GX44KM44Gj44Go6KiY6YyyXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCB0ZW1wX2ZuLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Kk44OZ44Oz44OI44KS6Kej6ZmkXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcmVtb3ZlOiBmdW5jdGlvbih0eXBlLCBmbl9vcl9pZCkge1xyXG4gICAgICAgICAgICB2YXIgaWQgPSAodHlwZW9mKGZuX29yX2lkKSA9PT0gXCJmdW5jdGlvblwiKSA/IGZuX29yX2lkLl9pZCA6IGZuX29yX2lkO1xyXG4gICAgICAgICAgICB2YXIgZm4gPSB0aGlzLmdldEZ1bmModHlwZSwgaWQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5kb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgZm4sIGZhbHNlKTtcclxuICAgICAgICAgICAgZGVsZXRlIHRoaXMuZnVuY0xpc3RbdHlwZV1baWRdO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Kv44Oq44OD44Kv44Kk44OZ44Oz44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKGZuLCBpZCkge1xyXG4gICAgICAgICAgICB0aGlzLmFkZChcImNsaWNrXCIsIGZuLCBpZCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Of44OJ44Or44Kv44Oq44OD44Kv44Kk44OZ44Oz44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbWRsY2xpY2s6IGZ1bmN0aW9uKGZuLCBpZCkge1xyXG4gICAgICAgICAgICB2YXIgdGVtcF9mbiA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlLmJ1dHRvbiA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm4oZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5hZGQoXCJjbGlja1wiLCB0ZW1wX2ZuLCBpZCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg53jgqTjg7Pjg4bjgqPjg7PjgrDjgrnjgr/jg7zjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBwb2ludHN0YXJ0OiBmdW5jdGlvbihmbiwgaWQpIHtcclxuICAgICAgICAgICAgdGhpcy5hZGQodG0uZG9tLkV2ZW50LlBPSU5UX1NUQVJULCBmbiwgaWQpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Od44Kk44Oz44OG44Kj44Oz44Kw5LitXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcG9pbnRtb3ZlOiBmdW5jdGlvbihmbiwgaWQpIHtcclxuICAgICAgICAgICAgdGhpcy5hZGQodG0uZG9tLkV2ZW50LlBPSU5UX01PVkUsIGZuLCBpZCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg53jgqTjg7Pjg4bjgqPjg7PjgrDjgqjjg7Pjg4lcclxuICAgICAgICAgKi9cclxuICAgICAgICBwb2ludGVuZDogZnVuY3Rpb24oZm4sIGlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkKHRtLmRvbS5FdmVudC5QT0lOVF9FTkQsIGZuLCBpZCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg5vjg5Djg7zjgqTjg5njg7Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBob3ZlcjogZnVuY3Rpb24oZm4sIGlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkKFwibW91c2VvdmVyXCIsIGZuLCBpZCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5LiA5bqm44Gg44GR5ZG844Gw44KM44KL44Kk44OZ44Oz44OI44KS55m76YyyXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgb25lOiBmdW5jdGlvbih0eXBlLCBmbiwgaWQpIHtcclxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgZWxtICA9IHRoaXMuZWxlbWVudDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciB0ZW1wX2ZuID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gZm4uYXBwbHkoZWxtLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5yZW1vdmUodHlwZSwgdGVtcF9mbik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5hZGQodHlwZSwgdGVtcF9mbiwgaWQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg4jjgrDjg6vjgqTjg5njg7Pjg4jnmbvpjLJcclxuICAgICAgICAgKi9cclxuICAgICAgICB0b2dnbGU6IGZ1bmN0aW9uKHR5cGUsIGZuX2xpc3QpIHtcclxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgZWxtICA9IHRoaXMuZWxlbWVudDtcclxuICAgICAgICAgICAgdmFyIHRlbXBfbGlzdCA9IFtdO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZm9yICh2YXIgaT0wOyBpPGZuX2xpc3QubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0ZW1wX2ZuID0gKGZ1bmN0aW9uKGkpe1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gZm5fbGlzdFtpXS5hcHBseShlbG0sIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0ICE9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gKGkrMSklZm5fbGlzdC5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm9uZSh0eXBlLCB0ZW1wX2xpc3RbaW5kZXhdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pKGkpO1xyXG4gICAgICAgICAgICAgICAgdGVtcF9saXN0LnB1c2godGVtcF9mbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMub25lKHR5cGUsIHRlbXBfbGlzdFswXSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaMh+WumuOBl+OBn+OCpOODmeODs+ODiOOCv+OCpOODlyAmIGlkIOOBrumWouaVsOOCkuWPluW+l1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldEZ1bmM6IGZ1bmN0aW9uKHR5cGUsIGlkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZ1bmNMaXN0W3R5cGVdW2lkXTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKiBAc3RhdGljIEBwcm9wZXJ0eSAqL1xyXG4gICAgdG0uZG9tLkV2ZW50LlBPSU5UX1NUQVJUICAgID0gKHRtLmlzTW9iaWxlKSA/IFwidG91Y2hzdGFydFwiIDogXCJtb3VzZWRvd25cIjtcclxuICAgIC8qKiBAc3RhdGljIEBwcm9wZXJ0eSAqL1xyXG4gICAgdG0uZG9tLkV2ZW50LlBPSU5UX01PVkUgICAgID0gKHRtLmlzTW9iaWxlKSA/IFwidG91Y2htb3ZlXCIgOiBcIm1vdXNlbW92ZVwiO1xyXG4gICAgLyoqIEBzdGF0aWMgQHByb3BlcnR5ICovXHJcbiAgICB0bS5kb20uRXZlbnQuUE9JTlRfRU5EICAgICAgPSAodG0uaXNNb2JpbGUpID8gXCJ0b3VjaGVuZFwiIDogXCJtb3VzZXVwXCI7XHJcbiAgICBcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWVtYmVyICAgICAgdG0uZG9tLkVsZW1lbnRcclxuICAgICAqIEBwcm9wZXJ0eSAgICBldmVudFxyXG4gICAgICog44K544K/44Kk44Or44Kv44Op44K5XHJcbiAgICAgKi9cclxuICAgIHRtLmRvbS5FbGVtZW50LnByb3RvdHlwZS5nZXR0ZXIoXCJldmVudFwiLCBmdW5jdGlvbigpe1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9ldmVudCB8fCAoIHRoaXMuX2V2ZW50ID0gdG0uZG9tLkV2ZW50KHRoaXMpICk7XHJcbiAgICB9KTtcclxuICAgIFxyXG59KSgpO1xyXG5cclxuXHJcblxyXG5cclxuLypcclxuICogYXR0ci5qc1xyXG4gKi9cclxuXHJcbnRtLmRvbSA9IHRtLmRvbSB8fCB7fTtcclxuXHJcbihmdW5jdGlvbigpe1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5kb20uQXR0clxyXG4gICAgICog5bGe5oCn44Kv44Op44K5XHJcbiAgICAgKi9cclxuICAgIHRtLmRvbS5BdHRyID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCqOODrOODoeODs+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGVsZW1lbnQ6IG51bGwsXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oZWxlbWVudCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5bGe5oCn44KS44K744OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKG5hbWUsIHZhbHVlKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlsZ7mgKfjgpLov73liqBcclxuICAgICAgICAgKi9cclxuICAgICAgICBhZGQ6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHZhciBub3cgPSB0aGlzLmdldChuYW1lKTtcclxuICAgICAgICAgICAgdmFsdWUgPSAobm93KSA/IG5vdyArICcgJyArIHZhbHVlIDogdmFsdWU7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUobmFtZSwgdmFsdWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWxnuaAp+OCkuWJiumZpFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJlbW92ZTogZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgLy8gdmFsdWUg44GM44GC44KL44Go44GN44Gv44Gd44KM44Gu44G/44KS5YmK6Zmk44GZ44KLXHJcbiAgICAgICAgICAgIGlmICh2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG5vdyA9IHRoaXMuZ2V0KG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgdmFyIG5leHQ9IChub3cpID8gbm93LnJlcGxhY2UodmFsdWUsICcnKS5yZXBsYWNlKCcgICcsICcgJykgOiAnJztcclxuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUobmFtZSwgbmV4dC50cmltKCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOOBquOBhOOBqOOBjeOBr+WxnuaAp+OBneOBruOCguOBruOCkuWJiumZpOOBmeOCi1xyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUobmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlsZ7mgKfjgpLlj5blvpdcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUobmFtZSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5bGe5oCn44Gu5a2Y5Zyo44OB44Kn44OD44KvXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY29udGFpbnM6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHZhciBub3cgPSB0aGlzLmdldChuYW1lKTtcclxuICAgICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vdyAhPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICgnICcrbm93KycgJykuaW5kZXhPZignICcrdmFsdWUrJyAnKSA+IC0xO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44OI44Kw44OrXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdG9nZ2xlOiBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jb250YWlucyhuYW1lLCB2YWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlKG5hbWUsIHZhbHVlKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRkKG5hbWUsIHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBBdHRyIOOCr+ODqeOCuVxyXG4gICAgICogQHByb3BlcnR5ICAgIGF0dHJcclxuICAgICAqL1xyXG4gICAgdG0uZG9tLkVsZW1lbnQucHJvdG90eXBlLmdldHRlcihcImF0dHJcIiwgZnVuY3Rpb24oKXtcclxuICAgICAgICByZXR1cm4gdGhpcy5fYXR0ciB8fCAoIHRoaXMuX2F0dHIgPSB0bS5kb20uQXR0cih0aGlzLmVsZW1lbnQpICk7XHJcbiAgICB9KTtcclxuICAgIFxyXG59KSgpO1xyXG5cclxuXHJcbi8qXHJcbiAqIHN0eWxlLmpzXHJcbiAqL1xyXG5cclxudG0uZG9tID0gdG0uZG9tIHx8IHt9O1xyXG5cclxuKGZ1bmN0aW9uKCl7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLmRvbS5TdHlsZVxyXG4gICAgICog44K544K/44Kk44OrXHJcbiAgICAgKi9cclxuICAgIHRtLmRvbS5TdHlsZSA9IHRtLmNyZWF0ZUNsYXNzKHtcclxuICAgICAgICBcclxuICAgICAgICAvKiog44Ko44Os44Oh44Oz44OIICovXHJcbiAgICAgICAgZWxlbWVudDogbnVsbCxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihlbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZVtuYW1lXSA9IHZhbHVlO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWJiumZpFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJlbW92ZTogZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUucmVtb3ZlUHJvcGVydHkobmFtZSk7XHJcbiAgICAgICAgICAgIC8vIGRlbGV0ZSB0aGlzLmVsZW1lbnQuc3R5bGVbbmFtZV07XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Kv44Oq44KiXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY2xlYXI6IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5Y+W5b6XXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQuc3R5bGVbbmFtZV07XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDU1Mg44Gu5YCk44KC6ICD5oWu44GX44Gf5LiK44Gn44Gu5YCk44KS5Y+W5b6XXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0UHJvcFZhbHVlOiBmdW5jdGlvbihwcm9wX25hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRvY3VtZW50LmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUodGhpcy5lbGVtZW50LCAnJykuZ2V0UHJvcGVydHlWYWx1ZShwcm9wX25hbWUpO1xyXG4gICAgICAgIH0sXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiDjgrnjgr/jgqTjg6vjgq/jg6njgrlcclxuICAgICAqIEBtZW1iZXIgICAgICB0bS5kb20uRWxlbWVudFxyXG4gICAgICogQHByb3BlcnR5ICAgIHN0eWxlXHJcbiAgICAgKi9cclxuICAgIHRtLmRvbS5FbGVtZW50LnByb3RvdHlwZS5nZXR0ZXIoXCJzdHlsZVwiLCBmdW5jdGlvbigpe1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zdHlsZSB8fCAoIHRoaXMuX3N0eWxlID0gdG0uZG9tLlN0eWxlKHRoaXMuZWxlbWVudCkgKTtcclxuICAgIH0pO1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuLypcclxuICogYW5pbS5qc1xyXG4gKi9cclxuXHJcbnRtLmRvbSA9IHRtLmRvbSB8fCB7fTtcclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgdmFyIHByZWZpeCA9IHRtLlZFTkRFUl9QUkVGSVg7XHJcbiAgICBcclxuICAgIHZhciBBTklNQVRJT04gICAgICAgICAgICAgICAgICAgPSBwcmVmaXggKyBcIkFuaW1hdGlvblwiO1xyXG4gICAgdmFyIEFOSU1BVElPTl9FTkQgICAgICAgICAgICAgICA9IHByZWZpeCArIFwiQW5pbWF0aW9uRW5kXCI7XHJcbiAgICB2YXIgQU5JTUFUSU9OX1BMQVlfU1RBVEUgICAgICAgID0gcHJlZml4ICsgXCJBbmltYXRpb25QbGF5U3RhdGVcIjtcclxuICAgIHZhciBBTklNQVRJT05fTkFNRSAgICAgICAgICAgICAgPSBwcmVmaXggKyBcIkFuaW1hdGlvbk5hbWVcIjtcclxuICAgIHZhciBBTklNQVRJT05fRFVSQVRJT04gICAgICAgICAgPSBwcmVmaXggKyBcIkFuaW1hdGlvbkR1cmF0aW9uXCI7XHJcbiAgICB2YXIgQU5JTUFUSU9OX1RJTUlOR19GVU5DVElPTiAgID0gcHJlZml4ICsgXCJBbmltYXRpb25UaW1pbmdGdW5jdGlvblwiO1xyXG4gICAgdmFyIEFOSU1BVElPTl9ERUxBWSAgICAgICAgICAgICA9IHByZWZpeCArIFwiQW5pbWF0aW9uRGVsYXlcIjtcclxuICAgIHZhciBBTklNQVRJT05fRElSRUNUSU9OICAgICAgICAgPSBwcmVmaXggKyBcIkFuaW1hdGlvbkRpcmVjdGlvblwiO1xyXG4gICAgdmFyIEFOSU1BVElPTl9JVEVSQVRJT05fQ09VTlQgICA9IHByZWZpeCArIFwiQW5pbWF0aW9uSXRlcmF0aW9uQ291bnRcIjtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZG9tLkFuaW1cclxuICAgICAqIOOCouODi+ODoeODvOOCt+ODp+ODs+OCr+ODqeOCuVxyXG4gICAgICovXHJcbiAgICB0bS5kb20uQW5pbSA9IHRtLmNyZWF0ZUNsYXNzKHtcclxuICAgICAgICBcclxuICAgICAgICAvKiogQHByb3BlcnR5IGVsZW1lbnQgKi9cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oZWxlbWVudCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8g44Ki44OL44Oh44O844K344On44Oz44GM57WC5LqG44GX44Gf44KJ44K544OG44O844OI44KSIFwicGF1c2VkXCIg44Gr44GZ44KLKOS9leW6puOCguWGjeeUn+OBp+OBjeOCi+OCiOOBhuOBq+OBmeOCi+eCuilcclxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihBTklNQVRJT05fRU5ELCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuc3RvcCgpO1xyXG4gICAgICAgICAgICB9LCBmYWxzZSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgqLjg4vjg6Hjg7zjgrfjg6fjg7Pplovlp4tcclxuICAgICAgICAgKi9cclxuICAgICAgICBzdGFydDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZVtBTklNQVRJT05fUExBWV9TVEFURV0gPSBcInJ1bm5pbmdcIjtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgqLjg4vjg6Hjg7zjgrfjg6fjg7PntYLkuoZcclxuICAgICAgICAgKi9cclxuICAgICAgICBzdG9wOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlW0FOSU1BVElPTl9QTEFZX1NUQVRFXSA9IFwicGF1c2VkXCI7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44OX44Ot44OR44OG44Kj44KS44K744OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0UHJvcGVydHk6IGZ1bmN0aW9uKHByb3ApIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBwcm9wID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZVtBTklNQVRJT05dID0gcHJvcDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBwcm9wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZuID0gQU5JTV9TRVRURVJfRlVOQ19OQU1FX01BUFtrZXldO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHByb3Bba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICBmbi5jYWxsKHRoaXMsIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWQjeWJjeOCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldE5hbWU6IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlW0FOSU1BVElPTl9OQU1FXSA9IG5hbWU7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Ki44OL44Oh44O844K344On44Oz5pmC6ZaT44Gu6ZW344GV44KS44K744OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0RHVyYXRpb246IGZ1bmN0aW9uKHMpIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlW0FOSU1BVElPTl9EVVJBVElPTl0gPSBzO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOijnOmWk+mWouaVsOOCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFRpbWluZ0Z1bmN0aW9uOiBmdW5jdGlvbihmdW5jKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZVtBTklNQVRJT05fVElNSU5HX0ZVTkNUSU9OXSA9IGZ1bmM7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Kk44OG44Os44O844K/44Kr44Km44Oz44OI44KS44K744OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0SXRlcmF0aW9uQ291bnQ6IGZ1bmN0aW9uKG4pIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlW0FOSU1BVElPTl9JVEVSQVRJT05fQ09VTlRdID0gbjtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgqLjg4vjg6Hjg7zjgrfjg6fjg7Pplovlp4vlvoXjgaHmmYLplpPjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXREZWxheTogZnVuY3Rpb24ocykge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGVbQU5JTUFUSU9OX0RFTEFZXSA9IHM7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5Yik5a6a5YaN55Sf44GV44Gb44KL44GL44Gp44GG44GL44KS5oyH5a6aXHJcbiAgICAgICAgICogXCJub3JtYWxcIiBvciBcImFsdGVybmF0ZVwiXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0RGlyZWN0aW9uOiBmdW5jdGlvbih0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZVtBTklNQVRJT05fRFVSQVRJT05dID0gdDtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICB2YXIgQU5JTV9TRVRURVJfRlVOQ19OQU1FX01BUCA9IHtcclxuICAgICAgICAvLyDlsI/mloflrZflr77lv5xcclxuICAgICAgICBcIm5hbWVcIiAgICAgICAgICA6IHRtLmRvbS5BbmltLnByb3RvdHlwZS5zZXROYW1lLFxyXG4gICAgICAgIFwiZHVyYXRpb25cIiAgICAgIDogdG0uZG9tLkFuaW0ucHJvdG90eXBlLnNldER1cmF0aW9uLFxyXG4gICAgICAgIFwidGltaW5nRnVuY3Rpb25cIjogdG0uZG9tLkFuaW0ucHJvdG90eXBlLnNldFRpbWluZ0Z1bmN0aW9uLFxyXG4gICAgICAgIFwiaXRlcmF0aW9uQ291bnRcIjogdG0uZG9tLkFuaW0ucHJvdG90eXBlLnNldEl0ZXJhdGlvbkNvdW50LFxyXG4gICAgICAgIFwiZGVsYXlcIiAgICAgICAgIDogdG0uZG9tLkFuaW0ucHJvdG90eXBlLnNldERlbGF5LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIOWkp+aWh+Wtl+WvvuW/nFxyXG4gICAgICAgIFwiTmFtZVwiICAgICAgICAgIDogdG0uZG9tLkFuaW0ucHJvdG90eXBlLnNldE5hbWUsXHJcbiAgICAgICAgXCJEdXJhdGlvblwiICAgICAgOiB0bS5kb20uQW5pbS5wcm90b3R5cGUuc2V0RHVyYXRpb24sXHJcbiAgICAgICAgXCJUaW1pbmdGdW5jdGlvblwiOiB0bS5kb20uQW5pbS5wcm90b3R5cGUuc2V0VGltaW5nRnVuY3Rpb24sXHJcbiAgICAgICAgXCJJdGVyYXRpb25Db3VudFwiOiB0bS5kb20uQW5pbS5wcm90b3R5cGUuc2V0SXRlcmF0aW9uQ291bnQsXHJcbiAgICAgICAgXCJEZWxheVwiICAgICAgICAgOiB0bS5kb20uQW5pbS5wcm90b3R5cGUuc2V0RGVsYXksXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBhbmltXHJcbiAgICAgKi9cclxuICAgIHRtLmRvbS5FbGVtZW50LnByb3RvdHlwZS5nZXR0ZXIoXCJhbmltXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9hbmltIHx8ICh0aGlzLl9hbmltID0gdG0uZG9tLkFuaW0odGhpcy5lbGVtZW50KSk7XHJcbiAgICB9KTtcclxuICAgIFxyXG59KSgpO1xyXG5cclxuXHJcbihmdW5jdGlvbigpe1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5kb20uVHJhbnNcclxuICAgICAqIOODiOODqeODs+OCuVxyXG4gICAgICovXHJcbiAgICB0bS5kb20uVHJhbnMgPSB0bS5jcmVhdGVDbGFzcyh7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqIOOCqOODrOODoeODs+ODiCAqL1xyXG4gICAgICAgIGVsZW1lbnQ6IG51bGwsXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oZWxlbWVudCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5aSJ5o+b6ZaL5aeLXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdG86IGZ1bmN0aW9uKHByb3BzLCB0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0KHByb3BzKS5kdXJhdGlvbih0fHwxMDAwKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44K744OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbihwcm9wcykge1xyXG4gICAgICAgICAgICB2YXIgc3R5bGUgPSB0aGlzLmVsZW1lbnQuc3R5bGU7XHJcbiAgICAgICAgICAgIHZhciBuYW1lcyA9IFtdO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHByb3BzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IF9jaGVja1N0eWxlUHJvcGVydHkoa2V5KTtcclxuICAgICAgICAgICAgICAgIG5hbWVzLnB1c2goIG5hbWUudG9EYXNoKCkgKTtcclxuICAgICAgICAgICAgICAgIHN0eWxlW25hbWVdID0gcHJvcHNba2V5XSArIFwiXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHN0eWxlW3RtLmRvbS5UcmFucy5QUk9QRVJUWV0gPSBuYW1lcy5qb2luKCcsICcpOyAgIC8vIG5vbmU7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDplpPplqJcclxuICAgICAgICAgKi9cclxuICAgICAgICBkdXJhdGlvbjogZnVuY3Rpb24odCkge1xyXG4gICAgICAgICAgICB2YXIgc3R5bGUgPSB0aGlzLmVsZW1lbnQuc3R5bGU7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdCA9PSBcIm51bWJlclwiKSB0ID0gdCArIFwibXNcIjtcclxuICAgICAgICAgICAgc3R5bGVbdG0uZG9tLlRyYW5zLkRVUkFUSU9OXSA9IHQ7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCpOODvOOCuOODs+OCsFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGVhc2luZzogZnVuY3Rpb24oZWFzZSkge1xyXG4gICAgICAgICAgICB2YXIgc3R5bGUgPSB0aGlzLmVsZW1lbnQuc3R5bGU7XHJcbiAgICAgICAgICAgIHN0eWxlW3RtLmRvbS5UcmFucy5USU1JTkdfRlVOQ1RJT05dID0gZnVuYztcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog57WC5LqGXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZW5kOiBmdW5jdGlvbihmbikge1xyXG4gICAgICAgICAgICB2YXIgZWxtICA9IHRtLmRvbS5FbGVtZW50KHRoaXMuZWxlbWVudCk7XHJcbiAgICAgICAgICAgIGVsbS5ldmVudC5hZGQodG0uZG9tLlRyYW5zLkVORF9FVkVOVCwgZm4pO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg6rjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICByZXNldDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBzdHlsZSA9IHRoaXMuZWxlbWVudC5zdHlsZTtcclxuICAgICAgICAgICAgc3R5bGVbdG0uZG9tLlRyYW5zLlBST1BFUlRZXSA9IFwibm9uZVwiO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDnp7vli5VcclxuICAgICAgICAgKi9cclxuICAgICAgICB0cmFuc2xhdGU6IGZ1bmN0aW9uKHgsIHksIHQpIHtcclxuICAgICAgICAgICAgdGhpcy50byh7XCJ0cmFuc2Zvcm1cIjogXCJ0cmFuc2xhdGUoezB9cHgsezF9cHgpXCIuZm9ybWF0KHgsIHkpfSwgdCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOenu+WLlTNEXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdHJhbnNsYXRlM2Q6IGZ1bmN0aW9uKHgsIHksIHosIHQpIHtcclxuICAgICAgICAgICAgdGhpcy50byh7XCJ0cmFuc2Zvcm1cIjogXCJ0cmFuc2xhdGUzZCh7MH1weCx7MX1weCx7Mn1weClcIi5mb3JtYXQoeCwgeSwgeil9LCB0KTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5Zue6LuiXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcm90YXRlOiBmdW5jdGlvbihkZWcsIHQpIHtcclxuICAgICAgICAgICAgdGhpcy50byh7XCJ0cmFuc2Zvcm1cIjogXCJyb3RhdGUoezB9ZGVnKVwiLmZvcm1hdChkZWcpfSwgdCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWbnui7ojNEXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcm90YXRlM2Q6IGZ1bmN0aW9uKHgsIHksIHosIGRlZywgdCkge1xyXG4gICAgICAgICAgICB0aGlzLnRvKHtcInRyYW5zZm9ybVwiOiBcInJvdGF0ZTNkKHswfSx7MX0sezJ9LHszfWRlZylcIi5mb3JtYXQoeCwgeSwgeiwgZGVnKX0sIHQpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgrnjgrHjg7zjg6tcclxuICAgICAgICAgKi9cclxuICAgICAgICBzY2FsZTogZnVuY3Rpb24oeCwgeSwgdCkge1xyXG4gICAgICAgICAgICB0aGlzLnRvKHtcInRyYW5zZm9ybVwiOiBcInNjYWxlKHswfSx7MX0pXCIuZm9ybWF0KHgsIHkpfSwgdCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOihjOWIl+WkieaPm1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRyYW5zZm9ybTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IOWun+ijheOBmeOCi1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODl+ODreODkeODhuOCo+OCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFByb3A6IGZ1bmN0aW9uKHByb3ApIHtcclxuICAgICAgICAgICAgdmFyIHN0eWxlID0gdGhpcy5lbGVtZW50LnN0eWxlO1xyXG4gICAgICAgICAgICB2YXIgcHJvcF9saXN0ID0gW107XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gcHJvcCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBfY2hlY2tTdHlsZVByb3BlcnR5KGtleSk7XHJcbiAgICAgICAgICAgICAgICBwcm9wX2xpc3QucHVzaCggbmFtZS50b0Rhc2goKSApO1xyXG4gICAgICAgICAgICAgICAgc3R5bGVbbmFtZV0gPSBwcm9wW2tleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHN0eWxlW3RtLmRvbS5UcmFucy5QUk9QRVJUWV0gPSBwcm9wX2xpc3Quam9pbignLCAnKTsgICAvLyBub25lO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6ZaT6Zai44KS44K744OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0RHVyYXRpb246IGZ1bmN0aW9uKHQpIHtcclxuICAgICAgICAgICAgdmFyIHN0eWxlID0gdGhpcy5lbGVtZW50LnN0eWxlO1xyXG4gICAgICAgICAgICBzdHlsZVt0bS5kb20uVHJhbnMuRFVSQVRJT05dID0gdDtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44K/44Kk44Of44Oz44Kw44OV44Kh44Oz44Kv44KS44K744OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0VGltaW5nRnVuY3Rpb246IGZ1bmN0aW9uKGZ1bmMpIHtcclxuICAgICAgICAgICAgdmFyIHN0eWxlID0gdGhpcy5lbGVtZW50LnN0eWxlO1xyXG4gICAgICAgICAgICBzdHlsZVt0bS5kb20uVHJhbnMuVElNSU5HX0ZVTkNUSU9OXSA9IGZ1bmM7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODquOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJlc2V0UHJvcDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBzdHlsZSA9IHRoaXMuZWxlbWVudC5zdHlsZTtcclxuICAgICAgICAgICAgc3R5bGVbdG0uZG9tLlRyYW5zLlBST1BFUlRZXSA9IFwibm9uZVwiO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDntYLkuobmmYLplqLmlbDjgpLnmbvpjLJcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRFbmRGdW5jdGlvbjogZnVuY3Rpb24oZm4pIHtcclxuICAgICAgICAgICAgdmFyIGVsbSAgPSB0bS5kb20uRWxlbWVudCh0aGlzLmVsZW1lbnQpO1xyXG4gICAgICAgICAgICBlbG0uZXZlbnQuYWRkKHRtLmRvbS5UcmFucy5FTkRfRVZFTlQsIGZuKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKiogQHN0YXRpYyBAcHJvcGVydHkgKi9cclxuICAgIHRtLmRvbS5UcmFucy5QUk9QRVJUWSAgICAgICAgPSB0bS5WRU5ERVJfUFJFRklYICsgXCJUcmFuc2l0aW9uUHJvcGVydHlcIjtcclxuICAgIC8qKiBAc3RhdGljIEBwcm9wZXJ0eSAqL1xyXG4gICAgdG0uZG9tLlRyYW5zLkRVUkFUSU9OICAgICAgICA9IHRtLlZFTkRFUl9QUkVGSVggKyBcIlRyYW5zaXRpb25EdXJhdGlvblwiO1xyXG4gICAgLyoqIEBzdGF0aWMgQHByb3BlcnR5ICovXHJcbiAgICB0bS5kb20uVHJhbnMuVElNSU5HX0ZVTkNUSU9OID0gdG0uVkVOREVSX1BSRUZJWCArIFwiVHJhbnNpdGlvblRpbWluZ0Z1bmN0aW9uXCI7XHJcbiAgICAvKiogQHN0YXRpYyBAcHJvcGVydHkgKi9cclxuICAgIHRtLmRvbS5UcmFucy5ERUxBWSAgICAgICAgICAgPSB0bS5WRU5ERVJfUFJFRklYICsgXCJUcmFuc2l0aW9uRGVsYXlcIjtcclxuICAgIC8qKiBAc3RhdGljIEBtZXRob2QgQG1lbWJlciB0bS5kb20uVHJhbnMgKi9cclxuICAgIHRtLmRvbS5UcmFucy5FTkRfRVZFTlQgICAgICAgPSAoZnVuY3Rpb24oKXtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBcIndlYmtpdFwiOiBcIndlYmtpdFRyYW5zaXRpb25FbmRcIixcclxuICAgICAgICAgICAgXCJtb3pcIiAgIDogXCJ0cmFuc2l0aW9uZW5kXCIsXHJcbiAgICAgICAgICAgIFwib1wiICAgICA6IFwib1RyYW5zaXRpb25FbmRcIixcclxuICAgICAgICB9W3RtLlZFTkRFUl9QUkVGSVhdO1xyXG4gICAgfSkoKTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgdHJhbnNcclxuICAgICAqL1xyXG4gICAgdG0uZG9tLkVsZW1lbnQucHJvdG90eXBlLmdldHRlcihcInRyYW5zXCIsIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RyYW5zIHx8ICggdGhpcy5fdHJhbnMgPSB0bS5kb20uVHJhbnModGhpcy5lbGVtZW50KSApO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIHZhciBfc3R5bGVMaXN0ID0ge1xyXG4gICAgICAgIFwidHJhbnNmb3JtXCI6IHRydWUsXHJcbiAgICB9O1xyXG4gICAgdmFyIF9jaGVja1N0eWxlUHJvcGVydHkgPSBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgaWYgKF9zdHlsZUxpc3RbbmFtZV0gPT09IHRydWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuICctJyt0bS5WRU5ERVJfUFJFRklYICsgbmFtZS5jYXBpdGFsaXplRmlyc3RMZXR0ZXIoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5hbWU7XHJcbiAgICB9O1xyXG59KSgpO1xyXG4vKlxyXG4gKiBkb20vZGF0YS5qc1xyXG4gKi9cclxuXHJcbihmdW5jdGlvbigpe1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5kb20uRGF0YVxyXG4gICAgICovXHJcbiAgICB0bS5kZWZpbmUoXCJ0bS5kb20uRGF0YVwiLCB7XHJcblxyXG4gICAgICAgIC8qKiDjgqjjg6zjg6Hjg7Pjg4ggKi9cclxuICAgICAgICBlbGVtZW50OiBudWxsLFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWxnuaAp+OCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldDogZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcclxuICAgICAgICBcdHZhciBrZXkgPSBcImRhdGEtXCIgKyBuYW1lLnRvRGFzaCgpO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKGtleSwgdmFsdWUpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlsZ7mgKfjgpLjgrLjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XHJcbiAgICAgICAgXHR2YXIga2V5ID0gXCJkYXRhLVwiICsgbmFtZS50b0Rhc2goKTtcclxuICAgICAgICBcdHJldHVybiB0aGlzLmVsZW1lbnQuYXR0cmlidXRlc1trZXldLnZhbHVlO1xyXG4gICAgICAgIH0sXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBBdHRyIOOCr+ODqeOCuVxyXG4gICAgICogQHByb3BlcnR5ICAgIGRhdGFcclxuICAgICAqL1xyXG4gICAgdG0uZG9tLkVsZW1lbnQucHJvdG90eXBlLmdldHRlcihcImRhdGFcIiwgZnVuY3Rpb24oKXtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZGF0YSB8fCAoIHRoaXMuX2RhdGEgPSB0bS5kb20uRGF0YSh0aGlzLmVsZW1lbnQpICk7XHJcbiAgICB9KTtcclxuXHJcbn0pKCk7XHJcbi8qXHJcbiAqIG1hbmFnZXIuanNcclxuICovXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgdG0uYXNzZXQgPSB0bS5hc3NldCB8fCB7fTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiDjgqLjgrvjg4Pjg4jjg57jg43jg7zjgrjjg6Pjg7xcclxuICAgICAqL1xyXG4gICAgdG0uYXNzZXQuTWFuYWdlciA9IHtcclxuICAgICAgICAvKiog44Ki44K744OD44OIICovXHJcbiAgICAgICAgYXNzZXRzOiB7fSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgqLjgrvjg4Pjg4jjga7jgrLjg4Pjg4hcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0ga2V5XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbihrZXkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXNzZXRzW2tleV07XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Ki44K744OD44OI44Gu44K744OD44OIXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGtleVxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBhc3NldFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldDogZnVuY3Rpb24oa2V5LCBhc3NldCkge1xyXG4gICAgICAgICAgICB0aGlzLmFzc2V0c1trZXldID0gYXNzZXQ7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCreODvOOBqOS4gOiHtOOBmeOCi+OCouOCu+ODg+ODiOOCkuWQq+OCk+OBp+OBhOOCi+OBi1xyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBrZXlcclxuICAgICAgICAgKi9cclxuICAgICAgICBjb250YWluczogZnVuY3Rpb24oa2V5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5hc3NldHNba2V5XSkgPyB0cnVlIDogZmFsc2U7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICB9O1xyXG5cclxufSkoKTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbihmdW5jdGlvbigpIHtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5hc3NldC5Mb2FkZXJcclxuICAgICAqIEBleHRlbmRzIHRtLmV2ZW50LkV2ZW50RGlzcGF0Y2hlclxyXG4gICAgICog44Ki44K744OD44OI44Ot44O844OA44O8XHJcbiAgICAgKi9cclxuICAgIHRtLmRlZmluZShcInRtLmFzc2V0LkxvYWRlclwiLCB7XHJcbiAgICAgICAgc3VwZXJDbGFzczogXCJ0bS5ldmVudC5FdmVudERpc3BhdGNoZXJcIixcclxuXHJcbiAgICAgICAgLyoqIEBwcm9wZXJ0eSBhc3NldHMgIOOCouOCu+ODg+ODiCAqL1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdCgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5hc3NldHMgPSB7fTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCreODvOOBqOS4gOiHtOOBmeOCi+OCouOCu+ODg+ODiOOCkuWQq+OCk+OBp+OBhOOCi+OBi1xyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBrZXlcclxuICAgICAgICAgKi9cclxuICAgICAgICBjb250YWluczogZnVuY3Rpb24oa2V5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5hc3NldHNba2V5XSkgPyB0cnVlIDogZmFsc2U7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgqLjgrvjg4Pjg4jjga7jg63jg7zjg4nlrp/ooYxcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gYXJnXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbG9hZDogZnVuY3Rpb24oYXJnKSB7XHJcbiAgICAgICAgICAgIGlmICh0bS51dGlsLlR5cGUuaXNPYmplY3QoYXJnKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbG9hZEJ5T2JqZWN0KGFyZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9sb2FkU3RyaW5nKGFyZ3VtZW50c1swXSwgYXJndW1lbnRzWzFdLCBhcmd1bWVudHNbMl0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgqLjgrvjg4Pjg4jjga7jgrLjg4Pjg4hcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0ga2V5XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbihrZXkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXNzZXRzW2tleV07XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Ki44K744OD44OI44Gu44K744OD44OIXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGtleVxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBhc3NldFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldDogZnVuY3Rpb24oa2V5LCBhc3NldCkge1xyXG4gICAgICAgICAgICB0aGlzLmFzc2V0c1trZXldID0gYXNzZXQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBtYW5hZ2VyIOOBruaWueOBq+OCguOCu+ODg+ODiOOBmeOCi1xyXG4gICAgICAgICAgICB0bS5hc3NldC5NYW5hZ2VyLnNldChrZXksIGFzc2V0KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Ki44K744OD44OI44Gu44Ot44O844OJXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0ga2V5XHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHBhdGhcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gdHlwZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9sb2FkOiBmdW5jdGlvbihrZXksIHBhdGgsIHR5cGUpIHtcclxuICAgICAgICAgICAgLy8gaWYgKHRtLmFzc2V0Lk1hbmFnZXIuY29udGFpbnMoa2V5KSkge1xyXG4gICAgICAgICAgICAvLyAgICAgcmV0dXJuIHRtLmFzc2V0Lk1hbmFnZXIuZ2V0KGtleSk7XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHBhdGggPSBwYXRoIHx8IGtleTtcclxuICAgICAgICAgICAgLy8gdHlwZSDjgYznnIHnlaXjgZXjgozjgabjgYTjgovloLTlkIjjga/mi6HlvLXlrZDjgYvjgonliKTlrprjgZnjgotcclxuICAgICAgICAgICAgdHlwZSA9IHR5cGUgfHwgcGF0aC5zcGxpdCgnPycpWzBdLnNwbGl0KCcjJylbMF0uc3BsaXQoJy4nKS5sYXN0O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdmFyIGFzc2V0ID0gdG0uYXNzZXQuTG9hZGVyLl9mdW5jc1t0eXBlXShwYXRoLCBrZXkpO1xyXG4gICAgICAgICAgICB0aGlzLnNldChrZXksIGFzc2V0KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiBhc3NldDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaWh+Wtl+WIl+aMh+WumuOBruOCouOCu+ODg+ODiOOBruODreODvOODiVxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGtleVxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwYXRoXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHR5cGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfbG9hZFN0cmluZzogZnVuY3Rpb24oa2V5LCBwYXRoLCB0eXBlKSB7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgaGFzaCA9IHt9O1xyXG4gICAgICAgICAgICBoYXNoW2tleV0gPSB7XHJcbiAgICAgICAgICAgICAgICB1cmw6IHBhdGgsXHJcbiAgICAgICAgICAgICAgICB0eXBlOiB0eXBlLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLl9sb2FkQnlPYmplY3QoaGFzaCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgqrjg5bjgrjjgqfjgq/jg4jmjIflrprjga7jgqLjgrvjg4Pjg4jjga7jg63jg7zjg4lcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBoYXNoXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX2xvYWRCeU9iamVjdDogZnVuY3Rpb24oaGFzaCkge1xyXG4gICAgICAgICAgICB2YXIgZmxvdyA9IHRtLnV0aWwuRmxvdyhPYmplY3Qua2V5cyhoYXNoKS5sZW5ndGgsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGUgPSB0bS5ldmVudC5FdmVudChcImxvYWRcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZSk7XHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgbG9hZEFzc2V0ID0gZnVuY3Rpb24oYXNzZXQsIGtleSkge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBlID0gdG0uZXZlbnQuRXZlbnQoXCJwcm9ncmVzc1wiKTtcclxuICAgICAgICAgICAgICAgIGUua2V5ID0ga2V5O1xyXG4gICAgICAgICAgICAgICAgZS5hc3NldCA9IGFzc2V0O1xyXG4gICAgICAgICAgICAgICAgZS5wcm9ncmVzcyA9IChmbG93LmNvdW50ZXIrMSkvZmxvdy53YWl0czsgLy8gdG9kb1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGUpO1xyXG5cclxuICAgICAgICAgICAgICAgIGZsb3cucGFzcygpO1xyXG4gICAgICAgICAgICB9LmJpbmQodGhpcyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBPYmplY3Qua2V5cyhoYXNoKS5lYWNoKGZ1bmN0aW9uKGtleSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gaGFzaFtrZXldO1xyXG4gICAgICAgICAgICAgICAgdmFyIGFzc2V0ID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXQgPSB0aGlzLl9sb2FkKGtleSwgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXQgPSB0aGlzLl9sb2FkKGtleSwgdmFsdWVbJ3VybCddIHx8IHZhbHVlWydzcmMnXSB8fCB2YWx1ZVsncGF0aCddLCB2YWx1ZVsndHlwZSddKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKGFzc2V0LmxvYWRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxvYWRBc3NldChhc3NldCwga2V5KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGFzc2V0Lm9uKFwibG9hZFwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZEFzc2V0KGFzc2V0LCBrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgIH0sXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgXHJcbiAgICB0bS5hc3NldC5Mb2FkZXIuX2Z1bmNzID0gW107XHJcbiAgICB0bS5hc3NldC5Mb2FkZXIuZGVmaW5lRnVuY3Rpb24oXCJyZWdpc3RlclwiLCBmdW5jdGlvbih0eXBlLCBmdW5jKSB7XHJcbiAgICAgICAgdGhpcy5fZnVuY3NbdHlwZV0gPSBmdW5jO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIFxyXG4gICAgdmFyIF90ZXh0dXJlRnVuYyA9IGZ1bmN0aW9uKHBhdGgpIHtcclxuICAgICAgICB2YXIgdGV4dHVyZSA9IHRtLmFzc2V0LlRleHR1cmUocGF0aCk7XHJcbiAgICAgICAgcmV0dXJuIHRleHR1cmU7XHJcbiAgICB9O1xyXG4gICAgdmFyIF9zb3VuZEZ1bmMgPSBmdW5jdGlvbihwYXRoKSB7XHJcbiAgICAgICAgdmFyIGF1ZGlvID0gdG0uc291bmQuV2ViQXVkaW8ocGF0aCk7XHJcbiAgICAgICAgcmV0dXJuIGF1ZGlvO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIF90bXhGdW5jID0gZnVuY3Rpb24ocGF0aCkge1xyXG4gICAgICAgIHZhciBtYXBTaGVldCA9IHRtLmFzc2V0Lk1hcFNoZWV0KHBhdGgpO1xyXG4gICAgICAgIHJldHVybiBtYXBTaGVldDtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBfdG1zc0Z1bmMgPSBmdW5jdGlvbihwYXRoKSB7XHJcbiAgICAgICAgdmFyIHNzID0gdG0uYXNzZXQuU3ByaXRlU2hlZXQocGF0aCk7XHJcbiAgICAgICAgcmV0dXJuIHNzO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgX2pzb25GdW5jID0gZnVuY3Rpb24ocGF0aCkge1xyXG4gICAgICAgIHZhciBmaWxlID0gdG0udXRpbC5GaWxlKCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHR5cGVvZiBwYXRoID09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIGZpbGUubG9hZCh7XHJcbiAgICAgICAgICAgICAgICB1cmw6IHBhdGgsXHJcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gcGF0aDtcclxuICAgICAgICAgICAgZmlsZS5zZXREYXRhKHBhdGgpO1xyXG4gICAgICAgICAgICBmaWxlLmxvYWRlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmlsZTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIF9sb2FkU2NyaXB0ID0gZnVuY3Rpb24ocGF0aCkge1xyXG4gICAgICAgIHZhciBzY3JpcHQgPSB0bS5hc3NldC5TY3JpcHQocGF0aCk7XHJcblxyXG4gICAgICAgIHJldHVybiBzY3JpcHQ7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIGltYWdlXHJcbiAgICB0bS5hc3NldC5Mb2FkZXIucmVnaXN0ZXIoXCJwbmdcIiwgX3RleHR1cmVGdW5jKTtcclxuICAgIHRtLmFzc2V0LkxvYWRlci5yZWdpc3RlcihcImdpZlwiLCBfdGV4dHVyZUZ1bmMpO1xyXG4gICAgdG0uYXNzZXQuTG9hZGVyLnJlZ2lzdGVyKFwianBnXCIsIF90ZXh0dXJlRnVuYyk7XHJcbiAgICB0bS5hc3NldC5Mb2FkZXIucmVnaXN0ZXIoXCJqcGVnXCIsIF90ZXh0dXJlRnVuYyk7XHJcblxyXG4gICAgLy8gc291bmRcclxuICAgIHRtLmFzc2V0LkxvYWRlci5yZWdpc3RlcihcIndhdlwiLCBfc291bmRGdW5jKTtcclxuICAgIHRtLmFzc2V0LkxvYWRlci5yZWdpc3RlcihcIm1wM1wiLCBfc291bmRGdW5jKTtcclxuICAgIHRtLmFzc2V0LkxvYWRlci5yZWdpc3RlcihcIm9nZ1wiLCBfc291bmRGdW5jKTtcclxuICAgIHRtLmFzc2V0LkxvYWRlci5yZWdpc3RlcihcIm00YVwiLCBfc291bmRGdW5jKTtcclxuXHJcbiAgICAvLyBqc29uXHJcbiAgICB0bS5hc3NldC5Mb2FkZXIucmVnaXN0ZXIoXCJqc29uXCIsIF9qc29uRnVuYyk7XHJcblxyXG4gICAgLy8gbWFwIGRhdGFcclxuICAgIHRtLmFzc2V0LkxvYWRlci5yZWdpc3RlcihcInRteFwiLCBfdG14RnVuYyk7XHJcbiAgICBcclxuICAgIC8vIHNwcml0ZXNoZWV0IGZvciB0bWxpYi5qc1xyXG4gICAgdG0uYXNzZXQuTG9hZGVyLnJlZ2lzdGVyKFwidG1zc1wiLCBfdG1zc0Z1bmMpO1xyXG4gICAgXHJcbiAgICAvLyBzY3JpcHQgZmlsZVxyXG4gICAgdG0uYXNzZXQuTG9hZGVyLnJlZ2lzdGVyKFwianNcIiwgX2xvYWRTY3JpcHQpO1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuLypcclxuICogdGV4dHVyZS5qc1xyXG4gKi9cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uYXNzZXQuVGV4dHVyZVxyXG4gICAgICog44OG44Kv44K544OB44Oj44Kv44Op44K5XHJcbiAgICAgKiBAZXh0ZW5kcyB0bS5ldmVudC5FdmVudERpc3BhdGNoZXJcclxuICAgICAqL1xyXG4gICAgdG0uZGVmaW5lKFwidG0uYXNzZXQuVGV4dHVyZVwiLCB7XHJcbiAgICAgICAgc3VwZXJDbGFzczogXCJ0bS5ldmVudC5FdmVudERpc3BhdGNoZXJcIixcclxuICAgICAgICBcclxuICAgICAgICAvKiogd2luZG93LmRvY3VtZW50LkltYWdlICovXHJcbiAgICAgICAgZWxlbWVudDogbnVsbCxcclxuXHJcbiAgICAgICAgLyoqIOODreODvOODiea4iOOBv+OBi+OBqeOBhuOBiyAqL1xyXG4gICAgICAgIGxvYWRlZDogZmFsc2UsXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oc3JjKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3VwZXJJbml0KCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQgPSBuZXcgSW1hZ2UoKTtcclxuICAgICAgICAgICAgaWYgKCAhdG0uaXNMb2NhbCgpICYmICEoL15kYXRhOi8udGVzdChzcmMpKSApIHtcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMuZWxlbWVudC5jcm9zc09yaWdpbiA9IFwiYW5vbnltb3VzXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnNyYyA9IHNyYztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50Lm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5sb2FkZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdmFyIGUgPSB0bS5ldmVudC5FdmVudChcImxvYWRcIik7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoIGUgKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5vbmVycm9yID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIlt0bWxpYl0gezB944Gu6Kqt44G/6L6844G/44Gr5aSx5pWXIVwiLmZvcm1hdChzcmMpKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgdmFyIGtleSA9IHNyYy5zcGxpdCgnLycpLmxhc3QucmVwbGFjZSgnLnBuZycsICcnKS5zcGxpdCgnPycpLmZpcnN0LnNwbGl0KCcjJykuZmlyc3Q7XHJcbiAgICAgICAgICAgICAgICB2YXIgZWxtID0gZS50YXJnZXQ7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGVsbS5zcmMgPSBcImh0dHA6Ly9kdW1teWltYWdlLmNvbS8xMjh4MTI4LzQ0NDQ0NC9lZWVlZWUmdGV4dD1cIiArIGtleTtcclxuICAgICAgICAgICAgICAgIGVsbS5vbmVycm9yID0gbnVsbDtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIHdpbmRvdy5kb2N1bWVudC5JbWFnZSDjgq/jg6njgrnjga7jgqTjg7Pjgrnjgr/jg7PjgrnjgpLov5TjgZlcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRFbGVtZW50OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudDtcclxuICAgICAgICB9LFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIHdpZHRoXHJcbiAgICAgKiDluYVcclxuICAgICAqL1xyXG4gICAgdG0uYXNzZXQuVGV4dHVyZS5wcm90b3R5cGUuZ2V0dGVyKFwid2lkdGhcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC53aWR0aDtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBoZWlnaHRcclxuICAgICAqIOmrmOOBlVxyXG4gICAgICovXHJcbiAgICB0bS5hc3NldC5UZXh0dXJlLnByb3RvdHlwZS5nZXR0ZXIoXCJoZWlnaHRcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC5oZWlnaHQ7XHJcbiAgICB9KTtcclxuICAgIFxyXG59KSgpO1xyXG5cclxuKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgLypcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqICMjIyByZWZcclxuICAgICAqIGh0dHA6Ly9kdW1teWltYWdlLmNvbS9cclxuICAgICAqL1xyXG4gICAgLypcclxuICAgIHRtLmdyYXBoaWNzLlRleHR1cmVNYW5hZ2VyLmxvYWREdW1teSA9IGZ1bmN0aW9uKGtleSwgcGFyYW0pIHtcclxuICAgICAgICBwYXJhbSA9IHBhcmFtIHx8IHt9O1xyXG5cclxuICAgICAgICB2YXIgcGF0aHMgPSBbXCJodHRwOi8vZHVtbXlpbWFnZS5jb21cIl07XHJcbiAgICAgICAgcGF0aHMucHVzaChwYXJhbS5zaXplIHx8IDI1Nik7XHJcbiAgICAgICAgcGF0aHMucHVzaChwYXJhbS5iZ0NvbG9yIHx8IFwiYWFhXCIpO1xyXG4gICAgICAgIHBhdGhzLnB1c2gocGFyYW0uY29sb3IgfHwgXCIwMDBcIik7XHJcbiAgICAgICAgcGF0aHMucHVzaChwYXJhbS5mb3JtYXQgfHwgXCJwbmdcIik7XHJcblxyXG4gICAgICAgIHZhciBzcmMgPSBwYXRocy5qb2luKCcvJyk7XHJcbiAgICAgICAgaWYgKHBhcmFtLnRleHQpIHtcclxuICAgICAgICAgICAgc3JjICs9ICcmdGV4dD0nICsgcGFyYW0udGV4dDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMudGV4dHVyZXNba2V5XSA9IHRtLmdyYXBoaWNzLlRleHR1cmUoc3JjKTtcclxuICAgICAgICB0aGlzLmxvYWRlZCA9IGZhbHNlO1xyXG4gICAgfTtcclxuICAgICovXHJcblxyXG59KSgpO1xyXG5cclxuXHJcblxyXG4vKlxyXG4gKiBzcHJpdGVzaGVldC5qc1xyXG4gKi9cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uYXNzZXQuU3ByaXRlU2hlZXRcclxuICAgICAqIOODnuODg+ODl+OCt+ODvOODiFxyXG4gICAgICogQGV4dGVuZHMgdG0uZXZlbnQuRXZlbnREaXNwYXRjaGVyXHJcbiAgICAgKi9cclxuICAgIHRtLmRlZmluZShcInRtLmFzc2V0LlNwcml0ZVNoZWV0XCIsIHtcclxuICAgICAgICBzdXBlckNsYXNzOiBcInRtLmV2ZW50LkV2ZW50RGlzcGF0Y2hlclwiLFxyXG5cclxuICAgICAgICAvKiog44Ot44O844OJ5riI44G/44GL44Gp44GG44GLICovXHJcbiAgICAgICAgbG9hZGVkOiBmYWxzZSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oc3JjKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3VwZXJJbml0KCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmxvYWRlZCA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBzcmMgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBcdHRoaXMubG9hZChzcmMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG5cdCAgICAgICAgICAgIHRoaXMucGFyc2Uoc3JjKTtcclxuICAgIFx0XHRcdHRoaXMubG9hZGVkID0gdHJ1ZTtcclxuICAgIFx0XHRcdHRoaXMuZGlzcGF0Y2hFdmVudCh0bS5ldmVudC5FdmVudChcImxvYWRcIikpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODreODvOODiVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGxvYWQ6IGZ1bmN0aW9uKHBhdGgpIHtcclxuICAgICAgICBcdHRtLnV0aWwuQWpheC5sb2FkKHtcclxuICAgICAgICBcdFx0dXJsOiBwYXRoLFxyXG4gICAgICAgIFx0XHRkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgXHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGQpIHtcclxuICAgICAgICBcdFx0XHR0aGlzLnBhcnNlKGQpO1xyXG4gICAgICAgIFx0XHRcdHRoaXMubG9hZGVkID0gdHJ1ZTtcclxuICAgICAgICBcdFx0fS5iaW5kKHRoaXMpLFxyXG4gICAgICAgIFx0fSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44OR44O844K5XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcGFyc2U6IGZ1bmN0aW9uKHBhcmFtKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZnJhbWUgPSBwYXJhbS5mcmFtZTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgcGFyYW0uaW1hZ2UgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0bS5hc3NldC5NYW5hZ2VyLmNvbnRhaW5zKHBhcmFtLmltYWdlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2FkZXIgPSB0bS5hc3NldC5Mb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICBsb2FkZXIubG9hZChwYXJhbS5pbWFnZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmltYWdlID0gdG0uYXNzZXQuTWFuYWdlci5nZXQocGFyYW0uaW1hZ2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbWFnZSA9IHBhcmFtLmltYWdlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5pbWFnZS5sb2FkZWQgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NhbGNGcmFtZXMocGFyYW0uZnJhbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlID0gdG0uZXZlbnQuRXZlbnQoXCJsb2FkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChlKTtcclxuICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2FsY0ZyYW1lcyhwYXJhbS5mcmFtZSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IHRtLmV2ZW50LkV2ZW50KFwibG9hZFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChlKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5fY2FsY0FuaW0ocGFyYW0uYW5pbWF0aW9ucyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44OV44Os44O844Og44KS5Y+W5b6XXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0RnJhbWU6IGZ1bmN0aW9uKGluZGV4KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZyYW1lc1tpbmRleF07XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgqLjg4vjg6Hjg7zjgrfjg6fjg7PjgpLlj5blvpdcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRBbmltYXRpb246IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYW5pbWF0aW9uc1tuYW1lXTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX2NhbGNGcmFtZXM6IGZ1bmN0aW9uKGZyYW1lKSB7XHJcbiAgICAgICAgICAgIHZhciBmcmFtZXMgPSB0aGlzLmZyYW1lcyA9IFtdO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdmFyIHcgPSBmcmFtZS53aWR0aDtcclxuICAgICAgICAgICAgdmFyIGggPSBmcmFtZS5oZWlnaHQ7XHJcbiAgICAgICAgICAgIHZhciByb3cgPSB+fih0aGlzLmltYWdlLndpZHRoIC8gdyk7XHJcbiAgICAgICAgICAgIHZhciBjb2wgPSB+fih0aGlzLmltYWdlLmhlaWdodC8gaCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoIWZyYW1lLmNvdW50KSBmcmFtZS5jb3VudCA9IHJvdypjb2w7XHJcblxyXG4gICAgICAgICAgICBmb3IgKHZhciBpPTAsbGVuPWZyYW1lLmNvdW50OyBpPGxlbjsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgeCAgID0gaSVyb3c7XHJcbiAgICAgICAgICAgICAgICB2YXIgeSAgID0gKGkvcm93KXwwO1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlY3QgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgeDp4KncsXHJcbiAgICAgICAgICAgICAgICAgICAgeTp5KmgsXHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHcsXHJcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBoXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgZnJhbWVzLnB1c2gocmVjdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9jYWxjQW5pbTogZnVuY3Rpb24oYW5pbWF0aW9ucykge1xyXG4gICAgICAgICAgICB0aGlzLmFuaW1hdGlvbnMgPSB7fTtcclxuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGFuaW1hdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhbmltID0gYW5pbWF0aW9uc1trZXldO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChhbmltIGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFuaW1hdGlvbnNba2V5XSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZnJhbWVzOiBbXS5yYW5nZShhbmltWzBdLCBhbmltWzFdKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dDogYW5pbVsyXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZnJlcXVlbmN5OiBhbmltWzNdIHx8IDFcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIGFuaW0gPT0gXCJudW1iZXJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uc1trZXldID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmcmFtZXM6IFthbmltXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dDogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZnJlcXVlbmN5OiAxXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uc1trZXldID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmcmFtZXM6IGFuaW0uZnJhbWVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0OiBhbmltLm5leHQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZyZXF1ZW5jeTogYW5pbS5mcmVxdWVuY3kgfHwgMVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIOODh+ODleOCqeODq+ODiOOCouODi+ODoeODvOOCt+ODp+ODs1xyXG4gICAgICAgICAgICB0aGlzLmFuaW1hdGlvbnNbXCJkZWZhdWx0XCJdID0ge1xyXG4gICAgICAgICAgICAgICAgZnJhbWVzOiBbXS5yYW5nZSgwLCB0aGlzLmZyYW1lLmNvdW50KSxcclxuICAgICAgICAgICAgICAgIG5leHQ6IFwiZGVmYXVsdFwiLFxyXG4gICAgICAgICAgICAgICAgZnJlcXVlbmN5OiAxLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9KTtcclxuXHJcbn0pKCk7XHJcblxyXG4vKlxyXG4gKiBtYXBzaGVldC5qc1xyXG4gKi9cclxuXHJcbihmdW5jdGlvbigpIHtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5hc3NldC5NYXBTaGVldFxyXG4gICAgICog44Oe44OD44OX44K344O844OIXHJcbiAgICAgKiBAZXh0ZW5kcyB0bS5ldmVudC5FdmVudERpc3BhdGNoZXJcclxuICAgICAqL1xyXG4gICAgdG0uZGVmaW5lKFwidG0uYXNzZXQuTWFwU2hlZXRcIiwge1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IFwidG0uZXZlbnQuRXZlbnREaXNwYXRjaGVyXCIsXHJcblxyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgbG9hZGVkICAqL1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihwYXRoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3VwZXJJbml0KCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmxvYWRlZCA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBwYXRoID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgIHRtLnV0aWwuQWpheC5sb2FkKHtcclxuICAgICAgICAgICAgICAgICAgICB1cmw6IHBhdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuX3BhcnNlKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRleHRlbmQoZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW1hZ2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB9LmJpbmQodGhpcyksXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuJGV4dGVuZChhcmd1bWVudHNbMF0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW1hZ2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODkeODvOOCuVxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3BhcnNlOiBmdW5jdGlvbihzdHIpIHtcclxuICAgICAgICAgICAgdmFyIGVhY2ggPSBBcnJheS5wcm90b3R5cGUuZm9yRWFjaDtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSB7fTtcclxuICAgICAgICAgICAgdmFyIHBhcnNlciA9IG5ldyBET01QYXJzZXIoKTtcclxuICAgICAgICAgICAgdmFyIHhtbCA9IHBhcnNlci5wYXJzZUZyb21TdHJpbmcoc3RyLCAndGV4dC94bWwnKTtcclxuICAgICAgICAgICAgdmFyIG1hcCA9IHRoaXMuX2F0dHJUb0pTT04oeG1sLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdtYXAnKVswXSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLiRleHRlbmQobWFwKTtcclxuXHJcbiAgICAgICAgICAgIC8vIHRpbGVzZXRzKGltYWdlKVxyXG4gICAgICAgICAgICBkYXRhLnRpbGVzZXRzID0gdGhpcy5fcGFyc2VUaWxlc2V0cyh4bWwpO1xyXG5cclxuICAgICAgICAgICAgLy8gbGF5ZXJcclxuICAgICAgICAgICAgZGF0YS5sYXllcnMgPSB0aGlzLl9wYXJzZUxheWVycyh4bWwpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfcGFyc2VUaWxlc2V0czogZnVuY3Rpb24oeG1sKSB7XHJcbiAgICAgICAgICAgIHZhciBlYWNoID0gQXJyYXkucHJvdG90eXBlLmZvckVhY2g7XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBbXTtcclxuICAgICAgICAgICAgdmFyIHRpbGVzZXRzID0geG1sLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0aWxlc2V0Jyk7XHJcbiAgICAgICAgICAgIGVhY2guY2FsbCh0aWxlc2V0cywgZnVuY3Rpb24odGlsZXNldCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHQgPSB7fTtcclxuICAgICAgICAgICAgICAgIHZhciBwcm9wcyA9IHNlbGYuX3Byb3BlcnRpZXNUb0pzb24odGlsZXNldCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHByb3BzLnNyYykge1xyXG4gICAgICAgICAgICAgICAgICAgIHQuaW1hZ2UgPSBwcm9wcy5zcmM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0LmltYWdlID0gdGlsZXNldC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW1hZ2UnKVswXS5nZXRBdHRyaWJ1dGUoJ3NvdXJjZScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZGF0YS5wdXNoKHQpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3BhcnNlTGF5ZXJzOiBmdW5jdGlvbih4bWwpIHtcclxuICAgICAgICAgICAgdmFyIGVhY2ggPSBBcnJheS5wcm90b3R5cGUuZm9yRWFjaDtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIHZhciBtYXAgPSB4bWwuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJtYXBcIilbMF07XHJcbiAgICAgICAgICAgIHZhciBsYXllcnMgPSBbXTtcclxuICAgICAgICAgICAgZWFjaC5jYWxsKG1hcC5jaGlsZE5vZGVzLCBmdW5jdGlvbihlbG0pIHtcclxuICAgICAgICAgICAgICAgIGlmIChlbG0udGFnTmFtZSA9PSBcImxheWVyXCIgfHwgZWxtLnRhZ05hbWUgPT0gXCJvYmplY3Rncm91cFwiIHx8IGVsbS50YWdOYW1lID09IFwiaW1hZ2VsYXllclwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5ZXJzLnB1c2goZWxtKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBsYXllcnMuZWFjaChmdW5jdGlvbihsYXllcikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGxheWVyLnRhZ05hbWUgPT0gXCJsYXllclwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBsYXllci5nZXRFbGVtZW50c0J5VGFnTmFtZSgnZGF0YScpWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlbmNvZGluZyA9IGQuZ2V0QXR0cmlidXRlKFwiZW5jb2RpbmdcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGwgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwibGF5ZXJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogbGF5ZXIuZ2V0QXR0cmlidXRlKFwibmFtZVwiKSxcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZW5jb2RpbmcgPT0gXCJjc3ZcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsLmRhdGEgPSB0aGlzLl9wYXJzZUNTVihkLnRleHRDb250ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZW5jb2RpbmcgPT0gXCJiYXNlNjRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsLmRhdGEgPSB0aGlzLl9wYXJzZUJhc2U2NChkLnRleHRDb250ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBhdHRyID0gdGhpcy5fYXR0clRvSlNPTihsYXllcik7XHJcbiAgICAgICAgICAgICAgICAgICAgbC4kZXh0ZW5kKGF0dHIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBkYXRhLnB1c2gobCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChsYXllci50YWdOYW1lID09IFwib2JqZWN0Z3JvdXBcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBsID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdGdyb3VwXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdHM6IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBsYXllci5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgZWFjaC5jYWxsKGxheWVyLmNoaWxkTm9kZXMsIGZ1bmN0aW9uKGVsbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWxtLm5vZGVUeXBlID09IDMpIHJldHVybiA7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMuX2F0dHJUb0pTT04oZWxtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZC5wcm9wZXJ0aWVzID0gdGhpcy5fcHJvcGVydGllc1RvSnNvbihlbG0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgbC5vYmplY3RzLnB1c2goZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5wdXNoKGwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAobGF5ZXIudGFnTmFtZSA9PSBcImltYWdlbGF5ZXJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBsID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImltYWdlbGF5ZXJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogbGF5ZXIuZ2V0QXR0cmlidXRlKFwibmFtZVwiKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeDogbGF5ZXIuZ2V0QXR0cmlidXRlKFwieFwiKSB8fCAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB5OiBsYXllci5nZXRBdHRyaWJ1dGUoXCJ5XCIpIHx8IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhOiBsYXllci5nZXRBdHRyaWJ1dGUoXCJvcGFjaXR5XCIpIHx8IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IChsYXllci5nZXRBdHRyaWJ1dGUoXCJ2aXNpYmxlXCIpID09PSB1bmRlZmluZWQgfHwgbGF5ZXIuZ2V0QXR0cmlidXRlKFwidmlzaWJsZVwiKSAhPSAwKSxcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbWFnZUVsbSA9IGxheWVyLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW1hZ2VcIilbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgbC5pbWFnZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiBpbWFnZUVsbS5nZXRBdHRyaWJ1dGUoXCJzb3VyY2VcIilcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBkYXRhLnB1c2gobCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9wYXJzZUNTVjogZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YUxpc3QgPSBkYXRhLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgICAgIHZhciBsYXllciA9IFtdO1xyXG5cclxuICAgICAgICAgICAgZGF0YUxpc3QuZWFjaChmdW5jdGlvbihlbG0sIGkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBudW0gPSBwYXJzZUludChlbG0sIDEwKSAtIDE7XHJcbiAgICAgICAgICAgICAgICBsYXllci5wdXNoKG51bSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGxheWVyO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIGh0dHA6Ly90aGVrYW5ub24tc2VydmVyLmFwcHNwb3QuY29tL2hlcnBpdHktZGVycGl0eS5hcHBzcG90LmNvbS9wYXN0ZWJpbi5jb20vNzVLa3MwV0hcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9wYXJzZUJhc2U2NDogZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YUxpc3QgPSBhdG9iKGRhdGEudHJpbSgpKTtcclxuICAgICAgICAgICAgdmFyIHJzdCA9IFtdO1xyXG5cclxuICAgICAgICAgICAgZGF0YUxpc3QgPSBkYXRhTGlzdC5zcGxpdCgnJykubWFwKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlLmNoYXJDb2RlQXQoMCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgaT0wLGxlbj1kYXRhTGlzdC5sZW5ndGgvNDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG4gPSBkYXRhTGlzdFtpKjRdO1xyXG4gICAgICAgICAgICAgICAgcnN0W2ldID0gcGFyc2VJbnQobiwgMTApIC0gMTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHJzdDtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9wcm9wZXJ0aWVzVG9Kc29uOiBmdW5jdGlvbihlbG0pIHtcclxuICAgICAgICAgICAgdmFyIHByb3BlcnRpZXMgPSBlbG0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJwcm9wZXJ0aWVzXCIpWzBdO1xyXG4gICAgICAgICAgICB2YXIgb2JqID0ge307XHJcbiAgICAgICAgICAgIGlmIChwcm9wZXJ0aWVzID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBvYmo7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7ayA8IHByb3BlcnRpZXMuY2hpbGROb2Rlcy5sZW5ndGg7aysrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcCA9IHByb3BlcnRpZXMuY2hpbGROb2Rlc1trXTtcclxuICAgICAgICAgICAgICAgIGlmIChwLnRhZ05hbWUgPT09IFwicHJvcGVydHlcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIG9ialtwLmdldEF0dHJpYnV0ZSgnbmFtZScpXSA9IHAuZ2V0QXR0cmlidXRlKCd2YWx1ZScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gb2JqO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX2F0dHJUb0pTT046IGZ1bmN0aW9uKHNvdXJjZSkge1xyXG4gICAgICAgICAgICB2YXIgb2JqID0ge307XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc291cmNlLmF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWwgPSBzb3VyY2UuYXR0cmlidXRlc1tpXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIHZhbCA9IGlzTmFOKHBhcnNlRmxvYXQodmFsKSk/IHZhbDogcGFyc2VGbG9hdCh2YWwpO1xyXG4gICAgICAgICAgICAgICAgb2JqW3NvdXJjZS5hdHRyaWJ1dGVzW2ldLm5hbWVdID0gdmFsO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gb2JqO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX2NoZWNrSW1hZ2U6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBpbWFnZVNvcnVjZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIC8vIGZvciB0aWxlIHNldFxyXG4gICAgICAgICAgICBpZiAodGhpcy50aWxlc2V0cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KGltYWdlU29ydWNlcywgdGhpcy50aWxlc2V0cy5tYXAoZnVuY3Rpb24odGlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aWxlLmltYWdlO1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBmb3IgaW1hZ2UgbGF5ZXJcclxuICAgICAgICAgICAgdGhpcy5sYXllcnMuZWFjaChmdW5jdGlvbihsYXllcikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGxheWVyLnR5cGUgPT0gXCJpbWFnZWxheWVyXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpbWFnZVNvcnVjZXMucHVzaChsYXllci5pbWFnZS5zb3VyY2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChpbWFnZVNvcnVjZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaSA9IDA7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGVuID0gaW1hZ2VTb3J1Y2VzLmxlbmd0aDtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgX29ubG9hZGltYWdlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpPT1sZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IHRtLmV2ZW50LkV2ZW50KFwibG9hZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpbWFnZVNvcnVjZXMuZWFjaChmdW5jdGlvbihpbWFnZU5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW1hZ2UgPSB0bS5hc3NldC5NYW5hZ2VyLmdldChpbWFnZU5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoaW1hZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGltYWdlLmxvYWRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g44Ot44O844OJ5riI44G/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICArK2k7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaT09bGVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlID0gdG0uZXZlbnQuRXZlbnQoXCJsb2FkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIF9vbmxvYWRpbWFnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2FkZXIgPSB0bS5hc3NldC5Mb2FkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGVyLmxvYWQoaW1hZ2VOYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHR1cmUgPSB0bS5hc3NldC5NYW5hZ2VyLmdldChpbWFnZU5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0dXJlLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIF9vbmxvYWRpbWFnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdmFyIGUgPSB0bS5ldmVudC5FdmVudChcImxvYWRcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgfSk7XHJcblxyXG59KSgpO1xyXG50bS5hc3NldCA9IHRtLmFzc2V0IHx8IHt9O1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIHRtLmRlZmluZShcInRtLmFzc2V0LkZvbnRcIiwge1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IFwidG0uZXZlbnQuRXZlbnREaXNwYXRjaGVyXCIsXHJcblxyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKHBhdGgsIGtleSwgZm9ybWF0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3VwZXJJbml0KCk7XHJcblxyXG4gICAgICAgICAgICB2YXIgZm9udEZhY2VTdHlsZUVsZW1lbnQgPSB0bS5kb20uRWxlbWVudChcImhlYWRcIikuY3JlYXRlKFwic3R5bGVcIik7XHJcbiAgICAgICAgICAgIGZvbnRGYWNlU3R5bGVFbGVtZW50LnRleHQgPSBcIkBmb250LWZhY2UgeyBmb250LWZhbWlseTogJ3swfSc7IHNyYzogdXJsKHsxfSkgZm9ybWF0KCd7Mn0nKTsgfVwiLmZvcm1hdChrZXksIHBhdGgsIGZvcm1hdCk7XHJcblxyXG4gICAgICAgICAgICB0bS5hc3NldC5Gb250LmNoZWNrTG9hZGVkKGtleSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZsYXJlKFwibG9hZFwiKTtcclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgICAgICB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgdG0uYXNzZXQuRm9udC5jaGVja0xvYWRlZCA9IGZ1bmN0aW9uKGZvbnQsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIGVsZW1lbnQgPSB0bS5kb20uRWxlbWVudChcImJvZHlcIikuY3JlYXRlKFwic3BhblwiKTtcclxuICAgICAgICBlbGVtZW50LnN0eWxlXHJcbiAgICAgICAgICAgIC5zZXQoXCJjb2xvclwiLCBcInJnYmEoMCwgMCwgMCwgMClcIilcclxuICAgICAgICAgICAgLnNldChcImZvbnRTaXplXCIsIFwiNDBweFwiKTtcclxuICAgICAgICBlbGVtZW50LnRleHQgPSBcIlFXQEhoc1hKPS8oKeOBguOBhOOBhuOBiOOBiu+8ne+8ne+8ne+8ne+8ne+8ne+8ne+8ne+8ne+8ne+8ne+8ne+8ne+8ne+8ne+8ne+8ne+8ne+8ne+8ne+8ne+8ne+8nVwiO1xyXG5cclxuICAgICAgICB2YXIgYmVmb3JlID0gZWxlbWVudC5lbGVtZW50Lm9mZnNldFdpZHRoO1xyXG4gICAgICAgIGVsZW1lbnQuc3R5bGVcclxuICAgICAgICAgICAgLnNldChcImZvbnRGYW1pbHlcIiwgXCInezB9JywgJ21vbm9zcGFjZSdcIi5mb3JtYXQoZm9udCkpO1xyXG5cclxuICAgICAgICB2YXIgY2hlY2tMb2FkRm9udCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoZWxlbWVudC5lbGVtZW50Lm9mZnNldFdpZHRoICE9PSBiZWZvcmUpIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayAmJiBjYWxsYmFjaygpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChjaGVja0xvYWRGb250LCAxMDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBzZXRUaW1lb3V0KGNoZWNrTG9hZEZvbnQsIDEwMCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHRtLmFzc2V0LkxvYWRlci5yZWdpc3RlcihcInR0ZlwiLCBmdW5jdGlvbihwYXRoLCBrZXkpIHtcclxuICAgICAgICByZXR1cm4gdG0uYXNzZXQuRm9udChwYXRoLCBrZXksIFwidHJ1ZXR5cGVcIik7XHJcbiAgICB9KTtcclxuICAgIHRtLmFzc2V0LkxvYWRlci5yZWdpc3RlcihcIm90ZlwiLCBmdW5jdGlvbihwYXRoLCBrZXkpIHtcclxuICAgICAgICByZXR1cm4gdG0uYXNzZXQuRm9udChwYXRoLCBrZXksIFwib3BlbnR5cGVcIik7XHJcbiAgICB9KTtcclxuICAgIHRtLmFzc2V0LkxvYWRlci5yZWdpc3RlcihcIndvZmZcIiwgZnVuY3Rpb24ocGF0aCwga2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIHRtLmFzc2V0LkZvbnQocGF0aCwga2V5LCBcIndvZmZcIik7XHJcbiAgICB9KTtcclxuICAgIHRtLmFzc2V0LkxvYWRlci5yZWdpc3RlcihcIndvZmYyXCIsIGZ1bmN0aW9uKHBhdGgsIGtleSkge1xyXG4gICAgICAgIHJldHVybiB0bS5hc3NldC5Gb250KHBhdGgsIGtleSwgXCJ3b2ZmMlwiKTtcclxuICAgIH0pO1xyXG5cclxufSkoKTtcclxuXHJcbi8qXHJcbiAqIHNjcmlwdC5qc1xyXG4gKi9cclxuXHJcbnRtLnV0aWwgPSB0bS51dGlsIHx8IHt9O1xyXG5cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uYXNzZXQuU2NyaXB0XHJcbiAgICAgKiDjgrnjgq/jg6rjg5fjg4jjgq/jg6njgrlcclxuICAgICAqL1xyXG5cclxuICAgIHRtLmRlZmluZShcInRtLmFzc2V0LlNjcmlwdFwiLCB7XHJcblxyXG4gICAgICAgIHN1cGVyQ2xhc3M6IFwidG0uZXZlbnQuRXZlbnREaXNwYXRjaGVyXCIsXHJcblxyXG4gICAgICAgIC8qKiBlbGVtZW50ICovXHJcbiAgICAgICAgZWxlbWVudDogbnVsbCxcclxuICAgICAgICAvKiogbG9hZGVkICovXHJcbiAgICAgICAgbG9hZGVkOiBmYWxzZSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihzcmMpIHtcclxuICAgICAgICAgICAgdGhpcy5zdXBlckluaXQoKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMubG9hZGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIik7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC50eXBlID0gXCJ0ZXh0L2phdmFzY3JpcHRcIjtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnNyYyA9IHNyYztcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmNoYXJzZXQgPSBcIlVURi04XCI7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJkZWZlclwiLCB0cnVlKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQub25sb2FkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmxvYWRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmZpcmUodG0uZXZlbnQuRXZlbnQoXCJsb2FkXCIpKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIGdldEVsZW1lbnRcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRFbGVtZW50OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgfSk7XHJcblxyXG4gICAgdG0uYXNzZXQuU2NyaXB0LmxvYWQgPSBmdW5jdGlvbihzcmMpIHtcclxuICAgICAgICB2YXIgc2NyaXB0ID0gdG0uYXNzZXQuU2NyaXB0KHNyYyk7XHJcblxyXG4gICAgICAgIHJldHVybiBzY3JpcHQ7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQG1ldGhvZFxyXG4gICAgICogU3RhdHMg44KS5YuV55qE44Ot44O844OJXHJcbiAgICAgKi9cclxuICAgIHRtLmFzc2V0LlNjcmlwdC5sb2FkU3RhdHMgPSBmdW5jdGlvbih2ZXJzaW9uKSB7XHJcbiAgICAgICAgdmVyc2lvbiA9IHZlcnNpb24gfHwgXCJyMTFcIjtcclxuICAgICAgICB2YXIgcGF0aCA9IG51bGw7XHJcbiAgICAgICAgaWYgKFtcInI2XCIsIFwicjdcIiwgXCJyOFwiLCBcInI5XCIsIFwiMTBcIl0uaW5kZXhPZih2ZXJzaW9uKSAhPSAtMSkge1xyXG4gICAgICAgICAgICBwYXRoID0gXCJodHRwczovL2Nkbi5yYXdnaXQuY29tL21yZG9vYi9zdGF0cy5qcy9cIiArIHZlcnNpb24gKyBcIi9idWlsZC9TdGF0cy5qc1wiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcGF0aCA9IFwiaHR0cDovL2Nkbi5yYXdnaXQuY29tL21yZG9vYi9zdGF0cy5qcy9cIiArIHZlcnNpb24gKyBcIi9idWlsZC9zdGF0cy5taW4uanNcIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmxvYWQocGF0aCk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQG1ldGhvZFxyXG4gICAgICogZGF0R1VJIOOCkuWLleeahOODreODvOODiVxyXG4gICAgICovXHJcbiAgICB0bS5hc3NldC5TY3JpcHQubG9hZERhdEdVSSA9IGZ1bmN0aW9uKHZlcnNpb24pIHtcclxuICAgICAgICAvLyBodHRwOi8vZGF0LWd1aS5nb29nbGVjb2RlLmNvbS9naXQvYnVpbGQvZGF0Lmd1aS5taW4uanNcclxuICAgICAgICAvLyBodHRwczovL2RhdC1ndWkuZ29vZ2xlY29kZS5jb20vZ2l0LWhpc3RvcnkvMC41L2J1aWxkL2RhdC5ndWkubWluLmpzXHJcblxyXG4gICAgICAgIHZlcnNpb24gPSB2ZXJzaW9uIHx8IFwiMC41XCI7XHJcbi8vICAgICAgICB2YXIgcGF0aCA9IFwiaHR0cHM6Ly9kYXQtZ3VpLmdvb2dsZWNvZGUuY29tL2dpdC1oaXN0b3J5L1wiICsgdmVyc2lvbiArIFwiL2J1aWxkL2RhdC5ndWkubWluLmpzXCI7XHJcbi8vICAgICAgICB2YXIgcGF0aCA9IFwiaHR0cDovL2RhdC1ndWkuZ29vZ2xlY29kZS5jb20vZ2l0L2J1aWxkL2RhdC5ndWkubWluLmpzXCI7XHJcbiAgICAgICAgdmFyIHBhdGggPSBcImh0dHA6Ly9kYXQtZ3VpLmdvb2dsZWNvZGUuY29tL2dpdC9idWlsZC9kYXQuZ3VpLmpzXCI7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubG9hZChwYXRoKTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiBUaHJlZS5qcyDjgpLli5XnmoTjg63jg7zjg4lcclxuICAgICAqL1xyXG4gICAgdG0uYXNzZXQuU2NyaXB0LmxvYWRUaHJlZSA9IGZ1bmN0aW9uKHZlcnNpb24pIHtcclxuICAgICAgICB2YXIgVEhSRUVfSlNfVVJMID0gXCJodHRwOi8vY2RuLnJhd2dpdC5jb20vbXJkb29iL3RocmVlLmpzL3t2ZXJzaW9ufS9idWlsZC90aHJlZS5qc1wiO1xyXG4vLyAgICAgICAgdmFyIFRIUkVFX0pTX1VSTCA9IFwiaHR0cHM6Ly9yYXcuZ2l0aHViLmNvbS9tcmRvb2IvdGhyZWUuanMve3ZlcnNpb259L2J1aWxkL3RocmVlLm1pbi5qc1wiO1xyXG4gICAgICAgIHZlcnNpb24gPSB2ZXJzaW9uIHx8IFwicjU1XCI7XHJcblxyXG4gICAgICAgIHZhciBwYXRoID0gVEhSRUVfSlNfVVJMLmZvcm1hdCh7dmVyc2lvbjogdmVyc2lvbn0pO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5sb2FkKHBhdGgpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIEJ1bGxldE1MLmpzIOOCkuWLleeahOODreODvOODiVxyXG4gICAgICovXHJcbiAgICB0bS5hc3NldC5TY3JpcHQubG9hZEJ1bGxldE1MID0gZnVuY3Rpb24odmVyc2lvbikge1xyXG4gICAgICAgIHZhciBCVUxMRVRNTF9GT1JfVE1MSUJfSlNfVVJMICAgPSBcImh0dHA6Ly9jZG4ucmF3Z2l0LmNvbS9kYWlzaGlobXIvYnVsbGV0bWwuanMve3ZlcnNpb259L3RhcmdldC9idWxsZXRtbC5mb3IudG1saWIuanNcIjtcclxuICAgICAgICB2ZXJzaW9uID0gdmVyc2lvbiB8fCBcInYwLjQuMlwiO1xyXG4gICAgICAgIHZhciBwYXRoID0gQlVMTEVUTUxfRk9SX1RNTElCX0pTX1VSTC5mb3JtYXQoe3ZlcnNpb246IHZlcnNpb259KTsgICAgICAgIFxyXG4gICAgICAgIHJldHVybiB0aGlzLmxvYWQocGF0aCk7XHJcbiAgICB9O1xyXG5cclxuXHJcbn0pKCk7XHJcblxyXG4vKlxyXG4gKiBrZXlib2FyZC5qc1xyXG4gKi9cclxuXHJcbnRtLmlucHV0ID0gdG0uaW5wdXQgfHwge307XHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5pbnB1dC5LZXlib2FyZFxyXG4gICAgICog44Kt44O844Oc44O844OJ44Kv44Op44K5XHJcbiAgICAgKiBcclxuICAgICAqICAgICAgQGV4YW1wbGVcclxuICAgICAqICAgICAgXHJcbiAgICAgKi9cclxuICAgIHRtLmlucHV0LktleWJvYXJkID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKiB0YXJnZXQgZWxlbWVudCAqL1xyXG4gICAgICAgIGVsZW1lbnQ6IG51bGwsXHJcbiAgICAgICAgLyoqIGtleSAqL1xyXG4gICAgICAgIGtleTogbnVsbCxcclxuICAgICAgICAvKiog5oq844GX44Gm44GE44KL44Kt44O8ICovXHJcbiAgICAgICAgcHJlc3MgICA6IG51bGwsXHJcbiAgICAgICAgLyoqIOaKvOOBl+OBn+OCreODvCAqL1xyXG4gICAgICAgIGRvd24gICAgOiBudWxsLFxyXG4gICAgICAgIC8qKiDpm6LjgZfjgZ/jgq3jg7wgKi9cclxuICAgICAgICB1cCAgICAgIDogbnVsbCxcclxuICAgICAgICAvKiog5oq844GX44Gm44GE44Gf44Kt44O8ICovXHJcbiAgICAgICAgbGFzdCAgICA6IG51bGwsXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICogPGEgaHJlZj1cImh0dHA6Ly90bWxpYi1qcy5nb29nbGVjb2RlLmNvbS9zdm4vdHJ1bmsvdGVzdC9pbnB1dC9rZXlib2FyZC10ZXN0Lmh0bWxcIj5UZXN0IFByb2dyYW08L2E+LlxyXG4gICAgICAgICAqICMjIyBFeGFtcGxlXHJcbiAgICAgICAgICogVE0ubG9hZFNjcmlwdChcImlucHV0XCIsIFwia2V5Ym9hcmRcIik7XHJcbiAgICAgICAgICogIFxyXG4gICAgICAgICAqIFRNLm1haW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICogICAgIHZhciBrID0gVE0uJEtleShkb2N1bWVudCk7XHJcbiAgICAgICAgICogICAgIGsucnVuKCk7XHJcbiAgICAgICAgICogICAgIFRNLnNldExvb3AoZnVuY3Rpb24oKXtcclxuICAgICAgICAgKiAgICAgICAgIGlmIChrLmdldEtleSgnYScpKSB7IGNvbnNvbGUubG9nKFwicHJlc3MgJ2EnISFcIik7IH1cclxuICAgICAgICAgKiAgICAgfSk7XHJcbiAgICAgICAgICogfSk7XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oZWxlbWVudCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50IHx8IGRvY3VtZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5rZXkgPSB7fTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMucHJlc3MgID0ge307XHJcbiAgICAgICAgICAgIHRoaXMuZG93biAgID0ge307XHJcbiAgICAgICAgICAgIHRoaXMudXAgICAgID0ge307XHJcbiAgICAgICAgICAgIHRoaXMubGFzdCAgID0ge307XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBmdW5jdGlvbihlKXtcclxuICAgICAgICAgICAgICAgIHNlbGYua2V5W2Uua2V5Q29kZV0gPSB0cnVlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBmdW5jdGlvbihlKXtcclxuICAgICAgICAgICAgICAgIC8vIGRlbGV0ZSBzZWxmLmtleVtlLmtleUNvZGVdO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5rZXlbZS5rZXlDb2RlXSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgLy8gc2VsZi5idXR0b24gfD0gMTw8ZS5idXR0b247XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXByZXNzXCIsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICAgICAgICAgICAgLy8gc2VsZi5idXR0b24gJj0gfigxPDxlLmJ1dHRvbik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogcnVuLlxyXG4gICAgICAgICAqIOiHquWLleOBp+ODnuOCpuOCueaDheWgseOCkuabtOaWsOOBl+OBn+OBhOmam+OBq+S9v+eUqOOBmeOCi1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJ1bjogZnVuY3Rpb24oZnBzKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgZnBzID0gZnBzIHx8IDMwO1xyXG4gICAgICAgICAgICB0bS5zZXRMb29wKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICBzZWxmLl91cGRhdGUoKTtcclxuICAgICAgICAgICAgICAgIGlmIChzZWxmLnVwZGF0ZSkgc2VsZi51cGRhdGUoKTtcclxuICAgICAgICAgICAgfSwgMTAwMC9mcHMpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5oOF5aCx5pu05paw5Yem55CGXHJcbiAgICAgICAgICog44Oe44Kk44OV44Os44O844Og5ZG844KT44Gn5LiL44GV44GELlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3VwZGF0ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IOS4gOaLrOODk+ODg+ODiOa8lOeul+OBp+ihjOOBhuOCiOOBhuS/ruato+OBmeOCi1xyXG4gICAgICAgICAgICBmb3IgKHZhciBrIGluIHRoaXMua2V5KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxhc3Rba10gICAgPSB0aGlzLnByZXNzW2tdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wcmVzc1trXSAgID0gdGhpcy5rZXlba107XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHRoaXMuZG93bltrXSA9ICh0aGlzLnByZXNzW2tdIF4gdGhpcy5sYXN0W2tdKSAmIHRoaXMucHJlc3Nba107XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwW2tdID0gKHRoaXMucHJlc3Nba10gXiB0aGlzLmxhc3Rba10pICYgdGhpcy5sYXN0W2tdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCreODvOOCkuaKvOOBl+OBpuOBhOOCi+OBi+OCkuODgeOCp+ODg+OCr1xyXG4gICAgICAgICAqIEBwYXJhbSAgIHtOdW1iZXIvU3RyaW5nfSBrZXkga2V5Q29kZSBvciBrZXlOYW1lXHJcbiAgICAgICAgICogQHJldHVybnMge0Jvb2xlYW59ICAg44OB44Kn44OD44Kv57WQ5p6cXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0S2V5OiBmdW5jdGlvbihrZXkpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZihrZXkpID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgIGtleSA9IEtFWV9DT0RFW2tleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJlc3Nba2V5XSA9PSB0cnVlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Kt44O844KS5oq844GX44Gf44GL44KS44OB44Kn44OD44KvXHJcbiAgICAgICAgICogQHBhcmFtICAge051bWJlci9TdHJpbmd9IGtleSBrZXlDb2RlIG9yIGtleU5hbWVcclxuICAgICAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gICDjg4Hjgqfjg4Pjgq/ntZDmnpxcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRLZXlEb3duOiBmdW5jdGlvbihrZXkpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZihrZXkpID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgIGtleSA9IEtFWV9DT0RFW2tleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZG93bltrZXldID09IHRydWU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgq3jg7zjgpLpm6LjgZfjgZ/jgYvjgpLjg4Hjgqfjg4Pjgq9cclxuICAgICAgICAgKiBAcGFyYW0gICB7TnVtYmVyL1N0cmluZ30ga2V5IGtleUNvZGUgb3Iga2V5TmFtZVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtCb29sZWFufSAgIOODgeOCp+ODg+OCr+e1kOaenFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldEtleVVwOiBmdW5jdGlvbihrZXkpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZihrZXkpID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgIGtleSA9IEtFWV9DT0RFW2tleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudXBba2V5XSA9PSB0cnVlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Kt44O844Gu5pa55ZCR44KSIEFuZ2xlKERlZ3JlZSkg44Gn5Y+W5b6XXHJcbiAgICAgICAgICogQHJldHVybnMge0Jvb2xlYW59ICAg6KeS5bqmKERlZ3JlZSlcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRLZXlBbmdsZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBhbmdsZSA9IG51bGw7XHJcbiAgICAgICAgICAgIHZhciBhcnJvd0JpdCA9XHJcbiAgICAgICAgICAgICAgICAodGhpcy5nZXRLZXkoXCJsZWZ0XCIpICAgPDwgMykgfCAvLyAxMDAwXHJcbiAgICAgICAgICAgICAgICAodGhpcy5nZXRLZXkoXCJ1cFwiKSAgICAgPDwgMikgfCAvLyAwMTAwXHJcbiAgICAgICAgICAgICAgICAodGhpcy5nZXRLZXkoXCJyaWdodFwiKSAgPDwgMSkgfCAvLyAwMDEwXHJcbiAgICAgICAgICAgICAgICAodGhpcy5nZXRLZXkoXCJkb3duXCIpKTsgICAgICAgICAvLyAwMDAxXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoYXJyb3dCaXQgIT0gMCAmJiBBUlJPV19CSVRfVE9fQU5HTEVfVEFCTEUuaGFzT3duUHJvcGVydHkoYXJyb3dCaXQpKSB7XHJcbiAgICAgICAgICAgICAgICBhbmdsZSA9IEFSUk9XX0JJVF9UT19BTkdMRV9UQUJMRVthcnJvd0JpdF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiBhbmdsZTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgq3jg7zjga7mirzjgZfjgabjgYTjgovlkJHjgY3jgpLlj5blvpdcclxuICAgICAgICAgKiDmraPopo/ljJbjgZXjgozjgabjgYTjgotcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRLZXlEaXJlY3Rpb246IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgZGlyZWN0aW9uID0gdG0uZ2VvbS5WZWN0b3IyKDAsIDApO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuZ2V0S2V5KFwibGVmdFwiKSkge1xyXG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uLnggPSAtMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLmdldEtleShcInJpZ2h0XCIpKSB7XHJcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb24ueCA9IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuZ2V0S2V5KFwidXBcIikpIHtcclxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbi55ID0gLTE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5nZXRLZXkoXCJkb3duXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb24ueSA9IDE7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChkaXJlY3Rpb24ueCAmJiBkaXJlY3Rpb24ueSkge1xyXG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uLmRpdihNYXRoLlNRUlQyKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGRpcmVjdGlvbjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCreODvOOBrueKtuaFi+OCkuioreWumuOBmeOCi1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldEtleTogZnVuY3Rpb24oa2V5LCBmbGFnKSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2Yoa2V5KSA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICBrZXkgPSBLRVlfQ09ERVtrZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMua2V5W2tleV0gPSBmbGFnO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Kt44O844KS5YWo44Gm6Zui44GX44Gf44GT44Go44Gr44GZ44KLXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY2xlYXJLZXk6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmtleSA9IHt9O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgIH0pO1xyXG5cclxuICAgIC8qXHJcbiAgICAgKiBAZW51bSBBUlJPV19CSVRfVE9fQU5HTEVfVEFCTEVcclxuICAgICAqIOaWueWQkeOBruOCouODs+OCsOODqyBqc2R1Y2vjgafjga/mlbDlrZfjgpLjg5fjg63jg5Hjg4bjgqPjgavmjIflrprjgafjgY3jgarjgYTvvJ9cclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIHZhciBBUlJPV19CSVRfVE9fQU5HTEVfVEFCTEUgPSB7XHJcbiAgICAgICAgLyogQHByb3BlcnR5IOS4iyAqL1xyXG4gICAgICAgIDB4MDE6IDI3MCxcclxuICAgICAgICAvKiBAcHJvcGVydHkg5Y+zICovXHJcbiAgICAgICAgMHgwMjogICAwLFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSDkuIogKi9cclxuICAgICAgICAweDA0OiAgOTAsXHJcbiAgICAgICAgLyogQHByb3BlcnR5IOW3piAqL1xyXG4gICAgICAgIDB4MDg6IDE4MCxcclxuXHJcbiAgICAgICAgLyogQHByb3BlcnR5IOWPs+S4iiAqL1xyXG4gICAgICAgIDB4MDY6ICA0NSxcclxuICAgICAgICAvKiBAcHJvcGVydHkg5Y+z5LiLICovXHJcbiAgICAgICAgMHgwMzogMzE1LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSDlt6bkuIogKi9cclxuICAgICAgICAweDBjOiAxMzUsXHJcbiAgICAgICAgLyogQHByb3BlcnR5IOW3puS4iyAqL1xyXG4gICAgICAgIDB4MDk6IDIyNSxcclxuXHJcbiAgICAgICAgLy8g5LiJ5pa55ZCR5ZCM5pmC5oq844GX5a++5b+cXHJcbiAgICAgICAgLy8g5oOz5a6a5aSW44Gu5pON5L2c44Gg44GM5a++5b+c44GX44Go44GE44Gf44G744GG44GM54Sh6ZujXHJcbiAgICAgICAgLyogQHByb3BlcnR5IOWPs+S4iuW3piAqL1xyXG4gICAgICAgIDB4MGU6ICA5MCxcclxuICAgICAgICAvKiBAcHJvcGVydHkg5LiK5bem5LiLICovXHJcbiAgICAgICAgMHgwZDogMTgwLFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSDlt6bkuIvlj7MgKi9cclxuICAgICAgICAweDBiOiAyNzAsXHJcbiAgICAgICAgLyogQHByb3BlcnR5IOS4i+WPs+S4iiAqL1xyXG4gICAgICAgIDB4MDc6ICAgMCxcclxuICAgIH07XHJcblxyXG4gICAgLypcclxuICAgICAqIEBlbnVtIEtFWV9DT0RFXHJcbiAgICAgKiDjgq3jg7znlarlj7dcclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIHZhciBLRVlfQ09ERSA9IHtcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcImJhY2tzcGFjZVwiIDogOCxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcInRhYlwiICAgICAgIDogOSxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcImVudGVyXCIgICAgIDogMTMsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJyZXR1cm5cIiAgICA6IDEzLFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwic2hpZnRcIiAgICAgOiAxNixcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcImN0cmxcIiAgICAgIDogMTcsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJhbHRcIiAgICAgICA6IDE4LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwicGF1c2VcIiAgICAgOiAxOSxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcImNhcHNsb2NrXCIgIDogMjAsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJlc2NhcGVcIiAgICA6IDI3LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwicGFnZXVwXCIgICAgOiAzMyxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcInBhZ2Vkb3duXCIgIDogMzQsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJlbmRcIiAgICAgICA6IDM1LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiaG9tZVwiICAgICAgOiAzNixcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcImxlZnRcIiAgICAgIDogMzcsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJ1cFwiICAgICAgICA6IDM4LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwicmlnaHRcIiAgICAgOiAzOSxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcImRvd25cIiAgICAgIDogNDAsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJpbnNlcnRcIiAgICA6IDQ1LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiZGVsZXRlXCIgICAgOiA0NixcclxuICAgICAgICBcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIjBcIiA6IDQ4LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiMVwiIDogNDksXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCIyXCIgOiA1MCxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIjNcIiA6IDUxLFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiNFwiIDogNTIsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCI1XCIgOiA1MyxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIjZcIiA6IDU0LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiN1wiIDogNTUsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCI4XCIgOiA1NixcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIjlcIiA6IDU3LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFxyXG4gICAgICAgIFwiYVwiIDogNjUsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJBXCIgOiA2NSxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcImJcIiA6IDY2LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiQlwiIDogNjYsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJjXCIgOiA2NyxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIkNcIiA6IDY3LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiZFwiIDogNjgsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJEXCIgOiA2OCxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcImVcIiA6IDY5LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiRVwiIDogNjksXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJmXCIgOiA3MCxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIkZcIiA6IDcwLFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiZ1wiIDogNzEsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJHXCIgOiA3MSxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcImhcIiA6IDcyLFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiSFwiIDogNzIsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJpXCIgOiA3MyxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIklcIiA6IDczLFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwialwiIDogNzQsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJKXCIgOiA3NCxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcImtcIiA6IDc1LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiS1wiIDogNzUsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJsXCIgOiA3NixcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIkxcIiA6IDc2LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwibVwiIDogNzcsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJNXCIgOiA3NyxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIm5cIiA6IDc4LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiTlwiIDogNzgsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJvXCIgOiA3OSxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIk9cIiA6IDc5LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwicFwiIDogODAsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJQXCIgOiA4MCxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcInFcIiA6IDgxLFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiUVwiIDogODEsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJyXCIgOiA4MixcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIlJcIiA6IDgyLFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwic1wiIDogODMsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJTXCIgOiA4MyxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcInRcIiA6IDg0LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiVFwiIDogODQsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJ1XCIgOiA4NSxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIlVcIiA6IDg1LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwidlwiIDogODYsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJWXCIgOiA4NixcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIndcIiA6IDg3LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiV1wiIDogODcsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJ4XCIgOiA4OCxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIlhcIiA6IDg4LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwieVwiIDogODksXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJZXCIgOiA4OSxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcInpcIiA6IDkwLFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiWlwiIDogOTAsXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJudW1wYWQwXCIgOiA5NixcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIm51bXBhZDFcIiA6IDk3LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwibnVtcGFkMlwiIDogOTgsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJudW1wYWQzXCIgOiA5OSxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIm51bXBhZDRcIiA6IDEwMCxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIm51bXBhZDVcIiA6IDEwMSxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIm51bXBhZDZcIiA6IDEwMixcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIm51bXBhZDdcIiA6IDEwMyxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIm51bXBhZDhcIiA6IDEwNCxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIm51bXBhZDlcIiA6IDEwNSxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIm11bHRpcGx5XCIgICAgICA6IDEwNixcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcImFkZFwiICAgICAgICAgICA6IDEwNyxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcInN1YnRyYWN0XCIgICAgICA6IDEwOSxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcImRlY2ltYWxwb2ludFwiICA6IDExMCxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcImRpdmlkZVwiICAgICAgICA6IDExMSxcclxuXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJmMVwiICAgIDogMTEyLFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiZjJcIiAgICA6IDExMyxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcImYzXCIgICAgOiAxMTQsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJmNFwiICAgIDogMTE1LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiZjVcIiAgICA6IDExNixcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcImY2XCIgICAgOiAxMTcsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJmN1wiICAgIDogMTE4LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiZjhcIiAgICA6IDExOSxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcImY5XCIgICAgOiAxMjAsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJmMTBcIiAgIDogMTIxLFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiZjExXCIgICA6IDEyMixcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcImYxMlwiICAgOiAxMjMsXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJudW1sb2NrXCIgICA6IDE0NCxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcInNjcm9sbGxvY2tcIjogMTQ1LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwic2VtaWNvbG9uXCIgOiAxODYsXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJlcXVhbHNpZ25cIiA6IDE4NyxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcImNvbW1hXCIgICAgIDogMTg4LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiZGFzaFwiICAgICAgOiAxODksXHJcbiAgICAgICAgLyogQHByb3BlcnR5ICovXHJcbiAgICAgICAgXCJwZXJpb2RcIiAgICA6IDE5MCxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcImZvcndhcmQgc2xhc2hcIiA6IDE5MSxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcIi9cIjogMTkxLFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiZ3JhdmUgYWNjZW50XCIgIDogMTkyLFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwib3BlbiBicmFja2V0XCIgIDogMjE5LFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiYmFjayBzbGFzaFwiICAgIDogMjIwLFxyXG4gICAgICAgIC8qIEBwcm9wZXJ0eSAqL1xyXG4gICAgICAgIFwiY2xvc2UgYnJhY2tldFwiICA6IDIyMSxcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcInNpbmdsZSBxdW90ZVwiICA6IDIyMixcclxuICAgICAgICAvKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBcInNwYWNlXCIgICAgICAgICA6IDMyXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG4vKlxyXG4gKiBtb3VzZS5qc1xyXG4gKi9cclxuXHJcbnRtLmlucHV0ID0gdG0uaW5wdXQgfHwge307XHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5pbnB1dC5Nb3VzZVxyXG4gICAgICog44Oe44Km44K544Kv44Op44K5XHJcbiAgICAgKi9cclxuICAgIHRtLmlucHV0Lk1vdXNlID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIC8qKiBlbGVtZW50ICovXHJcbiAgICAgICAgZWxlbWVudDogbnVsbCxcclxuICAgICAgICBcclxuICAgICAgICAvKiogQHByb3BlcnR5ICBwb3NpdGlvbiAqL1xyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgIGRlbHRhUG9zaXRpb24gKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5ICBwcmV2UG9zaXRpb24gKi9cclxuICAgICAgICAvKiogQHByaXZhdGUgQHByb3BlcnR5ICBfeCAqL1xyXG4gICAgICAgIC8qKiBAcHJpdmF0ZSBAcHJvcGVydHkgIF95ICovXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudCB8fCB3aW5kb3cuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLnBvc2l0aW9uICAgICAgID0gdG0uZ2VvbS5WZWN0b3IyKDAsIDApO1xyXG4gICAgICAgICAgICB0aGlzLmRlbHRhUG9zaXRpb24gID0gdG0uZ2VvbS5WZWN0b3IyKDAsIDApO1xyXG4gICAgICAgICAgICB0aGlzLnByZXZQb3NpdGlvbiAgID0gdG0uZ2VvbS5WZWN0b3IyKDAsIDApO1xyXG4gICAgICAgICAgICB0aGlzLl94ID0gMDtcclxuICAgICAgICAgICAgdGhpcy5feSA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMudG91Y2hlcyA9IFtdO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBmdW5jdGlvbihlKXtcclxuICAgICAgICAgICAgICAgIHNlbGYuX21vdXNlbW92ZShlKTtcclxuICAgICAgICAgICAgICAgIHNlbGYucHJldlBvc2l0aW9uLnNldChzZWxmLl94LCBzZWxmLl95KTsgICAgLy8gcHJldlBvc3Rpb24g44KS44Oq44K744OD44OIXHJcbiAgICAgICAgICAgICAgICBzZWxmLmJ1dHRvbiB8PSAxPDxlLmJ1dHRvbjtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBmdW5jdGlvbihlKXtcclxuICAgICAgICAgICAgICAgIHNlbGYuYnV0dG9uICY9IH4oMTw8ZS5idXR0b24pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgZnVuY3Rpb24oZSl7XHJcbiAgICAgICAgICAgICAgICAvLyDluqfmqJnmm7TmlrBcclxuICAgICAgICAgICAgICAgIHNlbGYuX21vdXNlbW92ZShlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBydW5cclxuICAgICAgICAgKiDoh6rli5Xjgafjg57jgqbjgrnmg4XloLHjgpLmm7TmlrDjgZfjgZ/jgYTpmpvjgavkvb/nlKjjgZnjgotcclxuICAgICAgICAgKi9cclxuICAgICAgICBydW46IGZ1bmN0aW9uKGZwcykge1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIGZwcyA9IGZwcyB8fCAzMDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRtLnNldExvb3AoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnVwZGF0ZSgpO1xyXG4gICAgICAgICAgICB9LCAxMDAwL2Zwcyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaDheWgseabtOaWsOWHpueQhlxyXG4gICAgICAgICAqIOODnuOCpOODleODrOODvOODoOWRvOOCk+OBp+S4i+OBleOBhC5cclxuICAgICAgICAgKi9cclxuICAgICAgICB1cGRhdGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmxhc3QgPSB0aGlzLnByZXNzO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5wcmVzcyA9IHRoaXMuYnV0dG9uO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5kb3duID0gKHRoaXMucHJlc3MgXiB0aGlzLmxhc3QpICYgdGhpcy5wcmVzcztcclxuICAgICAgICAgICAgdGhpcy51cCAgID0gKHRoaXMucHJlc3MgXiB0aGlzLmxhc3QpICYgdGhpcy5sYXN0O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8g5aSJ5YyW5YCk44KS5pu05pawXHJcbiAgICAgICAgICAgIHRoaXMuZGVsdGFQb3NpdGlvbi54ID0gdGhpcy5feCAtIHRoaXMucG9zaXRpb24ueDtcclxuICAgICAgICAgICAgdGhpcy5kZWx0YVBvc2l0aW9uLnkgPSB0aGlzLl95IC0gdGhpcy5wb3NpdGlvbi55O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8g5YmN5Zue44Gu5bqn5qiZ44KS5pu05pawXHJcbiAgICAgICAgICAgIHRoaXMucHJldlBvc2l0aW9uLnNldE9iamVjdCh0aGlzLnBvc2l0aW9uKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIOePvuWcqOOBruS9jee9ruOCkuabtOaWsFxyXG4gICAgICAgICAgICB0aGlzLnBvc2l0aW9uLnNldCh0aGlzLl94LCB0aGlzLl95KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODnOOCv+ODs+WPluW+l1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldEJ1dHRvbjogZnVuY3Rpb24oYnV0dG9uKSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YoYnV0dG9uKSA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICBidXR0b24gPSBCVVRUT05fTUFQW2J1dHRvbl07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5wcmVzcyAmIGJ1dHRvbikgIT0gMDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODnOOCv+ODs+ODgOOCpuODs+WPluW+l1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldEJ1dHRvbkRvd246IGZ1bmN0aW9uKGJ1dHRvbikge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mKGJ1dHRvbikgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uID0gQlVUVE9OX01BUFtidXR0b25dO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gKHRoaXMuZG93biAmIGJ1dHRvbikgIT0gMDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODnOOCv+ODs+OCouODg+ODl+WPluW+l1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldEJ1dHRvblVwOiBmdW5jdGlvbihidXR0b24pIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZihidXR0b24pID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbiA9IEJVVFRPTl9NQVBbYnV0dG9uXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuICh0aGlzLnVwICYgYnV0dG9uKSAhPSAwO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX21vdXNlbW92ZTogZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICB2YXIgcmVjdCA9IGUudGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgICAgICB0aGlzLl94ID0gZS5jbGllbnRYIC0gcmVjdC5sZWZ0O1xyXG4gICAgICAgICAgICB0aGlzLl95ID0gZS5jbGllbnRZIC0gcmVjdC50b3A7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfbW91c2Vtb3ZlTm9ybWFsOiBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIHZhciByZWN0ID0gZS50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgIHRoaXMuX3ggPSBlLmNsaWVudFggLSByZWN0LmxlZnQ7XHJcbiAgICAgICAgICAgIHRoaXMuX3kgPSBlLmNsaWVudFkgLSByZWN0LnRvcDtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9tb3VzZW1vdmVTY2FsZTogZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICB2YXIgcmVjdCA9IGUudGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgICAgICB0aGlzLl94ID0gZS5jbGllbnRYIC0gcmVjdC5sZWZ0O1xyXG4gICAgICAgICAgICB0aGlzLl95ID0gZS5jbGllbnRZIC0gcmVjdC50b3A7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvL2lmIChlLnRhcmdldCBpbnN0YW5jZW9mIEhUTUxDYW52YXNFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAvLyDjgrnjgrHjg7zjg6vjgpLogIPmha7jgZfjgZ/mi6HnuK5cclxuICAgICAgICAgICAgICAgIGlmIChlLnRhcmdldC5zdHlsZS53aWR0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3ggKj0gZS50YXJnZXQud2lkdGggLyBwYXJzZUludChlLnRhcmdldC5zdHlsZS53aWR0aCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZS50YXJnZXQuc3R5bGUuaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5feSAqPSBlLnRhcmdldC5oZWlnaHQgLyBwYXJzZUludChlLnRhcmdldC5zdHlsZS5oZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL31cclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKiBAc3RhdGljIEBwcm9wZXJ0eSAqL1xyXG4gICAgdG0uaW5wdXQuTW91c2UuQlVUVE9OX0xFRlQgICAgICA9IDB4MTtcclxuICAgIC8qKiBAc3RhdGljIEBwcm9wZXJ0eSAqL1xyXG4gICAgdG0uaW5wdXQuTW91c2UuQlVUVE9OX01JRERMRSAgICA9IDB4MjtcclxuICAgIC8qKiBAc3RhdGljIEBwcm9wZXJ0eSAqL1xyXG4gICAgdG0uaW5wdXQuTW91c2UuQlVUVE9OX1JJR0hUICAgICA9IDB4NDtcclxuICAgIFxyXG4gICAgLypcclxuICAgICAqIFxyXG4gICAgICovXHJcbiAgICB2YXIgQlVUVE9OX01BUCA9IHtcclxuICAgICAgICBcImxlZnRcIiAgOiB0bS5pbnB1dC5Nb3VzZS5CVVRUT05fTEVGVCxcclxuICAgICAgICBcIm1pZGRsZVwiOiB0bS5pbnB1dC5Nb3VzZS5CVVRUT05fTUlERExFLFxyXG4gICAgICAgIFwicmlnaHRcIiA6IHRtLmlucHV0Lk1vdXNlLkJVVFRPTl9SSUdIVFxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICB4XHJcbiAgICAgKiB45bqn5qiZ5YCkXHJcbiAgICAgKi9cclxuICAgIHRtLmlucHV0Lk1vdXNlLnByb3RvdHlwZS5hY2Nlc3NvcihcInhcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLnBvc2l0aW9uLng7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5wb3NpdGlvbi54ID0gdjsgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIHlcclxuICAgICAqIHnluqfmqJnlgKRcclxuICAgICAqL1xyXG4gICAgdG0uaW5wdXQuTW91c2UucHJvdG90eXBlLmFjY2Vzc29yKFwieVwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMucG9zaXRpb24ueTsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLnBvc2l0aW9uLnkgPSB2OyB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgZHhcclxuICAgICAqIGR45YCkXHJcbiAgICAgKi9cclxuICAgIHRtLmlucHV0Lk1vdXNlLnByb3RvdHlwZS5hY2Nlc3NvcihcImR4XCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5kZWx0YVBvc2l0aW9uLng7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5kZWx0YVBvc2l0aW9uLnggPSB2OyB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgZHlcclxuICAgICAqIGR55YCkXHJcbiAgICAgKi9cclxuICAgIHRtLmlucHV0Lk1vdXNlLnByb3RvdHlwZS5hY2Nlc3NvcihcImR5XCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5kZWx0YVBvc2l0aW9uLnk7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5kZWx0YVBvc2l0aW9uLnkgPSB2OyB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEBtZXRob2QgZ2V0UG9pbnRpbmdcclxuICAgICAqIOODneOCpOODs+ODhuOCo+ODs+OCsOeKtuaFi+WPluW+lyh0b3VjaCDjgajjga7lt67nlbDlr77nrZYpXHJcbiAgICAgKi9cclxuICAgIHRtLmlucHV0Lk1vdXNlLnByb3RvdHlwZS5nZXRQb2ludGluZyAgICAgICAgPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXMuZ2V0QnV0dG9uKFwibGVmdFwiKTsgfTtcclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQG1ldGhvZCBnZXRQb2ludGluZ1N0YXJ0XHJcbiAgICAgKiDjg53jgqTjg7Pjg4bjgqPjg7PjgrDjgpLplovlp4vjgZfjgZ/jgYvjgpLlj5blvpcodG91Y2gg44Go44Gu5beu55Ww5a++562WKVxyXG4gICAgICovXHJcbiAgICB0bS5pbnB1dC5Nb3VzZS5wcm90b3R5cGUuZ2V0UG9pbnRpbmdTdGFydCAgID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzLmdldEJ1dHRvbkRvd24oXCJsZWZ0XCIpOyB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAbWV0aG9kIGdldFBvaW50aW5nRW5kXHJcbiAgICAgKiDjg53jgqTjg7Pjg4bjgqPjg7PjgrDjgpLntYLkuobjgZfjgZ/jgYvjgpLlj5blvpcodG91Y2gg44Go44Gu5beu55Ww5a++562WKVxyXG4gICAgICovXHJcbiAgICB0bS5pbnB1dC5Nb3VzZS5wcm90b3R5cGUuZ2V0UG9pbnRpbmdFbmQgICAgID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzLmdldEJ1dHRvblVwKFwibGVmdFwiKTsgfTtcclxuICAgIFxyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuLypcclxuICogdG91Y2guanNcclxuICovXHJcblxyXG50bS5pbnB1dCA9IHRtLmlucHV0IHx8IHt9O1xyXG5cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uaW5wdXQuVG91Y2hcclxuICAgICAqIOOCv+ODg+ODgeOCr+ODqeOCuVxyXG4gICAgICovXHJcbiAgICB0bS5pbnB1dC5Ub3VjaCA9IHRtLmNyZWF0ZUNsYXNzKHtcclxuICAgICAgICAvKiogZWxlbWVudCAqL1xyXG4gICAgICAgIGVsZW1lbnQ6IG51bGwsXHJcbiAgICAgICAgLyoqIHRvdWNoZWQgKi9cclxuICAgICAgICB0b3VjaGVkOiBmYWxzZSxcclxuXHJcbiAgICAgICAgLyoqIEBwcm9wZXJ0eSBwb3NpdGlvbiAqL1xyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgZGVsdGFQb3NpdGlvbiAqL1xyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgcHJldlBvc2l0aW9uICovXHJcbiAgICAgICAgLyoqIEBwcml2YXRlIEBwcm9wZXJ0eSBfeCAqL1xyXG4gICAgICAgIC8qKiBAcHJpdmF0ZSBAcHJvcGVydHkgX3kgKi9cclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKiA8YSBocmVmPVwiaHR0cDovL3RtbGliLWpzLmdvb2dsZWNvZGUuY29tL3N2bi90cnVuay90ZXN0L2lucHV0L3RvdWNoLXRlc3QuaHRtbFwiPlRlc3QgUHJvZ3JhbTwvYT4uXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oZWxlbWVudCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50IHx8IHdpbmRvdy5kb2N1bWVudDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMucG9zaXRpb24gICAgICAgPSB0bS5nZW9tLlZlY3RvcjIoMCwgMCk7XHJcbiAgICAgICAgICAgIHRoaXMuZGVsdGFQb3NpdGlvbiAgPSB0bS5nZW9tLlZlY3RvcjIoMCwgMCk7XHJcbiAgICAgICAgICAgIHRoaXMucHJldlBvc2l0aW9uICAgPSB0bS5nZW9tLlZlY3RvcjIoMCwgMCk7XHJcbiAgICAgICAgICAgIHRoaXMuX3ggPSAwO1xyXG4gICAgICAgICAgICB0aGlzLl95ID0gMDtcclxuICAgICAgICAgICAgdGhpcy50b3VjaGVzID0gW107XHJcblxyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCBmdW5jdGlvbihlKXtcclxuICAgICAgICAgICAgICAgIHNlbGYudG91Y2hlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHNlbGYuX3RvdWNobW92ZShlKTtcclxuICAgICAgICAgICAgICAgIC8vIOacgOWIneOBoOOBkeOCu+ODg+ODiFxyXG4gICAgICAgICAgICAgICAgc2VsZi5wb3NpdGlvbi5zZXQoc2VsZi5feCwgc2VsZi5feSk7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnByZXZQb3NpdGlvbi5zZXQoc2VsZi5feCwgc2VsZi5feSk7ICAgIC8vIHByZXZQb3N0aW9uIOOCkuODquOCu+ODg+ODiFxyXG5cclxuICAgICAgICAgICAgICAgIHNlbGYuX3NldFRvdWNoZXMoZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoZW5kXCIsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICAgICAgICAgICAgc2VsZi50b3VjaGVkID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgc2VsZi5fc2V0VG91Y2hlcyhlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2htb3ZlXCIsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICAgICAgICAgICAgc2VsZi5fdG91Y2htb3ZlKGUpO1xyXG4gICAgICAgICAgICAgICAgLy8g55S76Z2i56e75YuV44KS5q2i44KB44KLXHJcbiAgICAgICAgICAgICAgICBlLnN0b3AoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBzZWxmLl9zZXRUb3VjaGVzKGUpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgLy8gdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgLy8gICAgIGlmIChzZWxmLl90b3VjaCkgcmV0dXJuIDtcclxuICAgICAgICAgICAgLy8gICAgIHNlbGYuX3RvdWNoID0gZS5jaGFuZ2VkVG91Y2hlc1swXTtcclxuXHJcbiAgICAgICAgICAgIC8vICAgICAvLyBjaGFuZ2VkVG91Y2hlcztcclxuICAgICAgICAgICAgLy8gICAgIC8vIHRhcmdldFRvdWNoZXM7XHJcbiAgICAgICAgICAgIC8vICAgICBzZWxmLl90b3VjaG1vdmUoZSk7XHJcbiAgICAgICAgICAgIC8vICAgICBzZWxmLnByZXZQb3NpdGlvbi5zZXRPYmplY3Qoc2VsZi5wb3NpdGlvbik7XHJcblxyXG4gICAgICAgICAgICAvLyAgICAgc2VsZi50b3VjaGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy8gfSk7XHJcbiAgICAgICAgICAgIC8vIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hlbmRcIiwgZnVuY3Rpb24oZSl7XHJcbiAgICAgICAgICAgIC8vICAgICBpZiAoc2VsZi5fdG91Y2ggPT0gZS5jaGFuZ2VkVG91Y2hlc1swXSkge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIHNlbGYudG91Y2hlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAvLyB9KTtcclxuICAgICAgICAgICAgLy8gdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaG1vdmVcIiwgZnVuY3Rpb24oZSl7XHJcbiAgICAgICAgICAgIC8vICAgICBzZWxmLl90b3VjaG1vdmUoZSk7XHJcbiAgICAgICAgICAgIC8vICAgICAvLyDnlLvpnaLnp7vli5XjgpLmraLjgoHjgotcclxuICAgICAgICAgICAgLy8gICAgIGUuc3RvcCgpO1xyXG4gICAgICAgICAgICAvLyB9KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIHJ1bi5cclxuICAgICAgICAgKiDoh6rli5Xjgafjg57jgqbjgrnmg4XloLHjgpLmm7TmlrDjgZfjgZ/jgYTpmpvjgavkvb/nlKjjgZnjgotcclxuICAgICAgICAgKi9cclxuICAgICAgICBydW46IGZ1bmN0aW9uKGZwcykge1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIGZwcyA9IGZwcyB8fCAzMDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRtLnNldExvb3AoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHNlbGYudXBkYXRlKCk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgfSwgMTAwMC9mcHMpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmg4XloLHmm7TmlrDlh6bnkIZcclxuICAgICAgICAgKiDjg57jgqTjg5Xjg6zjg7zjg6DlkbzjgpPjgafkuIvjgZXjgYQuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdXBkYXRlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5sYXN0ICAgPSB0aGlzLm5vdztcclxuICAgICAgICAgICAgdGhpcy5ub3cgICAgPSBOdW1iZXIodGhpcy50b3VjaGVkKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuc3RhcnQgID0gKHRoaXMubm93IF4gdGhpcy5sYXN0KSAmIHRoaXMubm93O1xyXG4gICAgICAgICAgICB0aGlzLmVuZCAgICA9ICh0aGlzLm5vdyBeIHRoaXMubGFzdCkgJiB0aGlzLmxhc3Q7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDlpInljJblgKTjgpLmm7TmlrBcclxuICAgICAgICAgICAgdGhpcy5kZWx0YVBvc2l0aW9uLnggPSB0aGlzLl94IC0gdGhpcy5wb3NpdGlvbi54O1xyXG4gICAgICAgICAgICB0aGlzLmRlbHRhUG9zaXRpb24ueSA9IHRoaXMuX3kgLSB0aGlzLnBvc2l0aW9uLnk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDliY3lm57jga7luqfmqJnjgpLmm7TmlrBcclxuICAgICAgICAgICAgdGhpcy5wcmV2UG9zaXRpb24uc2V0T2JqZWN0KHRoaXMucG9zaXRpb24pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8g54++5Zyo44Gu5L2N572u44KS5pu05pawXHJcbiAgICAgICAgICAgIHRoaXMucG9zaXRpb24uc2V0KHRoaXMuX3gsIHRoaXMuX3kpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44K/44OD44OB44GX44Gm44GE44KL44GL44KS5Yik5a6aXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0VG91Y2g6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy50b3VjaGVkICE9IDA7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgr/jg4Pjg4Hplovlp4vmmYLjgasgdHJ1ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldFRvdWNoU3RhcnQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdGFydCAhPSAwO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44K/44OD44OB57WC5LqG5pmC44GrIHRydWVcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRUb3VjaEVuZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmVuZCAhPSAwO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3RvdWNobW92ZTogZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICB2YXIgdCA9IGUudG91Y2hlc1swXTtcclxuICAgICAgICAgICAgdmFyIHIgPSBlLnRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICAgICAgdGhpcy5feCA9IHQuY2xpZW50WCAtIHIubGVmdDtcclxuICAgICAgICAgICAgdGhpcy5feSA9IHQuY2xpZW50WSAtIHIudG9wO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3RvdWNobW92ZVNjYWxlOiBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIHZhciB0ID0gZS50b3VjaGVzWzBdO1xyXG4gICAgICAgICAgICB2YXIgciA9IGUudGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgICAgICB0aGlzLl94ID0gdC5jbGllbnRYIC0gci5sZWZ0O1xyXG4gICAgICAgICAgICB0aGlzLl95ID0gdC5jbGllbnRZIC0gci50b3A7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoZS50YXJnZXQuc3R5bGUud2lkdGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3ggKj0gZS50YXJnZXQud2lkdGggLyBwYXJzZUludChlLnRhcmdldC5zdHlsZS53aWR0aCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGUudGFyZ2V0LnN0eWxlLmhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5feSAqPSBlLnRhcmdldC5oZWlnaHQgLyBwYXJzZUludChlLnRhcmdldC5zdHlsZS5oZWlnaHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX2dldEFkanVzdFBvaW50OiBmdW5jdGlvbihwKSB7XHJcbiAgICAgICAgICAgIHZhciBlbG0gPSB0aGlzLmVsZW1lbnQ7XHJcbiAgICAgICAgICAgIHZhciBzdHlsZSA9IGVsbS5zdHlsZTtcclxuICAgICAgICAgICAgdmFyIHIgPSBlbG0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgIHZhciBwID0ge1xyXG4gICAgICAgICAgICAgICAgeDogcC5jbGllbnRYIC0gci5sZWZ0LFxyXG4gICAgICAgICAgICAgICAgeTogcC5jbGllbnRZIC0gci50b3AsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoc3R5bGUud2lkdGgpIHtcclxuICAgICAgICAgICAgICAgIHAueCAqPSBlbG0ud2lkdGggLyBwYXJzZUludChzdHlsZS53aWR0aCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHN0eWxlLmhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgcC55ICo9IGVsbS5oZWlnaHQgLyBwYXJzZUludChzdHlsZS5oZWlnaHQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcDtcclxuICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX3NldFRvdWNoZXM6IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgdmFyIHRvdWNoZXMgPSBlLnRvdWNoZXM7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnRvdWNoZXMuY2xlYXIoKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaT0wLGxlbj10b3VjaGVzLmxlbmd0aDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHAgPSB0aGlzLl9nZXRBZGp1c3RQb2ludCh0b3VjaGVzW2ldKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudG91Y2hlcy5wdXNoKHApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgeFxyXG4gICAgICogeOW6p+aomeWApFxyXG4gICAgICovXHJcbiAgICB0bS5pbnB1dC5Ub3VjaC5wcm90b3R5cGUuYWNjZXNzb3IoXCJ4XCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5wb3NpdGlvbi54OyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMucG9zaXRpb24ueCA9IHY7IH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICB5XHJcbiAgICAgKiB55bqn5qiZ5YCkXHJcbiAgICAgKi9cclxuICAgIHRtLmlucHV0LlRvdWNoLnByb3RvdHlwZS5hY2Nlc3NvcihcInlcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLnBvc2l0aW9uLnk7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5wb3NpdGlvbi55ID0gdjsgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGR4XHJcbiAgICAgKiBkeOWApFxyXG4gICAgICovXHJcbiAgICB0bS5pbnB1dC5Ub3VjaC5wcm90b3R5cGUuYWNjZXNzb3IoXCJkeFwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMuZGVsdGFQb3NpdGlvbi54OyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMuZGVsdGFQb3NpdGlvbi54ID0gdjsgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGR5XHJcbiAgICAgKiBkeeWApFxyXG4gICAgICovXHJcbiAgICB0bS5pbnB1dC5Ub3VjaC5wcm90b3R5cGUuYWNjZXNzb3IoXCJkeVwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMuZGVsdGFQb3NpdGlvbi55OyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMuZGVsdGFQb3NpdGlvbi55ID0gdjsgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIFxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIOODneOCpOODs+ODhuOCo+ODs+OCsOeKtuaFi+WPluW+lyhtb3VzZSDjgajjga7lt67nlbDlr77nrZYpXHJcbiAgICAgKi9cclxuICAgIHRtLmlucHV0LlRvdWNoLnByb3RvdHlwZS5nZXRQb2ludGluZyAgICAgICAgPSB0bS5pbnB1dC5Ub3VjaC5wcm90b3R5cGUuZ2V0VG91Y2g7XHJcbiAgICAvKipcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIOODneOCpOODs+ODhuOCo+ODs+OCsOOCkumWi+Wni+OBl+OBn+OBi+OCkuWPluW+lyhtb3VzZSDjgajjga7lt67nlbDlr77nrZYpXHJcbiAgICAgKi9cclxuICAgIHRtLmlucHV0LlRvdWNoLnByb3RvdHlwZS5nZXRQb2ludGluZ1N0YXJ0ICAgPSB0bS5pbnB1dC5Ub3VjaC5wcm90b3R5cGUuZ2V0VG91Y2hTdGFydDtcclxuICAgIC8qKlxyXG4gICAgICogQG1ldGhvZFxyXG4gICAgICog44Od44Kk44Oz44OG44Kj44Oz44Kw44KS57WC5LqG44GX44Gf44GL44KS5Y+W5b6XKG1vdXNlIOOBqOOBruW3rueVsOWvvuetlilcclxuICAgICAqL1xyXG4gICAgdG0uaW5wdXQuVG91Y2gucHJvdG90eXBlLmdldFBvaW50aW5nRW5kICAgICA9IHRtLmlucHV0LlRvdWNoLnByb3RvdHlwZS5nZXRUb3VjaEVuZDtcclxuICAgIFxyXG59KSgpO1xyXG5cclxuXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLmlucHV0LlRvdWNoZXNcclxuICAgICAqIOODnuODq+ODgeOCv+ODg+ODgeWvvuW/nOOCr+ODqeOCuVxyXG4gICAgICogQGV4dGVuZHMgZ2xvYmFsLkFycmF5XHJcbiAgICAgKi9cclxuICAgIHRtLmRlZmluZShcInRtLmlucHV0LlRvdWNoZXNcIiwge1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IEFycmF5LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihlbG0sIGxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbG07XHJcbiAgICAgICAgICAgIGZvciAodmFyIGk9MDsgaTxsZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRvdWNoID0gdG0uaW5wdXQuVG91Y2godGhpcy5lbGVtZW50KTtcclxuICAgICAgICAgICAgICAgIHRoaXMucHVzaCh0b3VjaCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaT0wOyBpPGxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzZWxmW2ldLl90b3VjaCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQgPSBzZWxmW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRhcmdldCkgcmV0dXJuIDtcclxuXHJcbiAgICAgICAgICAgICAgICB0YXJnZXQuX3RvdWNoID0gZS5jaGFuZ2VkVG91Y2hlc1swXTtcclxuXHJcbiAgICAgICAgICAgICAgICB0YXJnZXQuX3RvdWNobW92ZShlKTtcclxuICAgICAgICAgICAgICAgIHRhcmdldC5wcmV2UG9zaXRpb24uc2V0T2JqZWN0KHRhcmdldC5wb3NpdGlvbik7XHJcblxyXG4gICAgICAgICAgICAgICAgdGFyZ2V0LnRvdWNoZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgLy8gY2hhbmdlZFRvdWNoZXM7XHJcbiAgICAgICAgICAgICAgICAvLyB0YXJnZXRUb3VjaGVzO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCBmdW5jdGlvbihlKXtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGk9MDsgaTxsZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxmW2ldLl90b3VjaCA9PSBlLmNoYW5nZWRUb3VjaGVzWzBdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGZbaV0uX3RvdWNoID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZltpXS50b3VjaGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaG1vdmVcIiwgZnVuY3Rpb24oZSl7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpPTA7IGk8bGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZltpXS5fdG91Y2gpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZltpXS5fdG91Y2htb3ZlKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIOeUu+mdouenu+WLleOCkuatouOCgeOCi1xyXG4gICAgICAgICAgICAgICAgZS5zdG9wKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOabtOaWsFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHVwZGF0ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbih0b3VjaCkge1xyXG4gICAgICAgICAgICAgICAgdG91Y2gudXBkYXRlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxufSkoKTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuLypcclxuICogYWNjZWxlcm9tZXRlci5qc1xyXG4gKi9cclxuXHJcbnRtLmlucHV0ID0gdG0uaW5wdXQgfHwge307XHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5pbnB1dC5BY2NlbGVyb21ldGVyXHJcbiAgICAgKiDjgrnjg57jg7zjg4jjg5Xjgqnjg7Pjga7jgrvjg7PjgrXjg7zmg4XloLFcclxuICAgICAqL1xyXG4gICAgdG0uaW5wdXQuQWNjZWxlcm9tZXRlciA9IHRtLmNyZWF0ZUNsYXNzKHtcclxuXHJcbiAgICAgICAgLyoqIEBwcm9wZXJ0eSAgZ3Jhdml0eSDph43lipvjgrvjg7PjgrXjg7wgKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5ICBhY2NlbGVyYXRpb24g5Yqg6YCf5bqm44K744Oz44K144O8ICovXHJcbiAgICAgICAgLyoqIEBwcm9wZXJ0eSAgcm90YXRpb24g5Zue6Lui5Yqg6YCf5bqm44K744Oz44K144O8ICovXHJcbiAgICAgICAgLyoqIEBwcm9wZXJ0eSAgb3JpZW50YXRpb24g44K544Oe44O844OI44OV44Kp44Oz44Gu5YK+44GNICovXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICogIyMjIEV4YW1wbGVcclxuICAgICAgICAgKiA8YSBocmVmPVwiaHR0cDovL3RtbGliLWpzLmdvb2dsZWNvZGUuY29tL3N2bi90cnVuay90ZXN0L2lucHV0L3RvdWNoLXRlc3QuaHRtbFwiPlRlc3QgUHJvZ3JhbTwvYT4uXHJcbiAgICAgICAgICogXHJcbiAgICAgICAgICogIyMjIFJlZmVyZW5jZVxyXG4gICAgICAgICAqIC0gPGh0dHA6Ly90bWxpZmUubmV0L3Byb2dyYW1taW5nL2phdmFzY3JpcHQvamF2YXNjcmlwdC1pcGhvbmUtYWNjZWxlcmF0aW9uLmh0bWw+XHJcbiAgICAgICAgICogLSA8aHR0cDovL2hpZGVrYXRzdS5jb20vaHRtbDUvYXJjaGl2ZXMvMTEzPlxyXG4gICAgICAgICAqIC0gPGh0dHA6Ly9kLmhhdGVuYS5uZS5qcC9uYWthbXVyYTAwMS8yMDExMDIwOS8xMjk3MjI5MDYyPlxyXG4gICAgICAgICAqIC0gPGh0dHA6Ly9kLmhhdGVuYS5uZS5qcC9uYWthbXVyYTAwMS8yMDEwMTEyOC8xMjkwOTQ2OTY2PlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuZ3Jhdml0eSAgICAgICAgPSB0bS5nZW9tLlZlY3RvcjMoMCwgMCwgMCk7XHJcbiAgICAgICAgICAgIHRoaXMuYWNjZWxlcmF0aW9uICAgPSB0bS5nZW9tLlZlY3RvcjMoMCwgMCwgMCk7XHJcbiAgICAgICAgICAgIHRoaXMucm90YXRpb24gICAgICAgPSB0bS5nZW9tLlZlY3RvcjMoMCwgMCwgMCk7XHJcbiAgICAgICAgICAgIHRoaXMub3JpZW50YXRpb24gICAgPSB0bS5nZW9tLlZlY3RvcjMoMCwgMCwgMCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiZGV2aWNlbW90aW9uXCIsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhY2NlbGVyYXRpb24gPSBzZWxmLmFjY2VsZXJhdGlvbjtcclxuICAgICAgICAgICAgICAgIHZhciBncmF2aXR5ID0gc2VsZi5ncmF2aXR5O1xyXG4gICAgICAgICAgICAgICAgdmFyIHJvdGF0aW9uID0gc2VsZi5yb3RhdGlvbjtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKGUuYWNjZWxlcmF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWNjZWxlcmF0aW9uLnggPSBlLmFjY2VsZXJhdGlvbi54O1xyXG4gICAgICAgICAgICAgICAgICAgIGFjY2VsZXJhdGlvbi55ID0gZS5hY2NlbGVyYXRpb24ueTtcclxuICAgICAgICAgICAgICAgICAgICBhY2NlbGVyYXRpb24ueiA9IGUuYWNjZWxlcmF0aW9uLno7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZS5hY2NlbGVyYXRpb25JbmNsdWRpbmdHcmF2aXR5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eS54ID0gZS5hY2NlbGVyYXRpb25JbmNsdWRpbmdHcmF2aXR5Lng7XHJcbiAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eS55ID0gZS5hY2NlbGVyYXRpb25JbmNsdWRpbmdHcmF2aXR5Lnk7XHJcbiAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eS56ID0gZS5hY2NlbGVyYXRpb25JbmNsdWRpbmdHcmF2aXR5Lno7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZS5yb3RhdGlvblJhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICByb3RhdGlvbi54ID0gcm90YXRpb24uYmV0YSAgPSBlLnJvdGF0aW9uUmF0ZS5iZXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIHJvdGF0aW9uLnkgPSByb3RhdGlvbi5nYW1tYSA9IGUucm90YXRpb25SYXRlLmdhbW1hO1xyXG4gICAgICAgICAgICAgICAgICAgIHJvdGF0aW9uLnogPSByb3RhdGlvbi5hbHBoYSA9IGUucm90YXRpb25SYXRlLmFscGhhO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiZGV2aWNlb3JpZW50YXRpb25cIiwgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG9yaWVudGF0aW9uID0gc2VsZi5vcmllbnRhdGlvbjtcclxuICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uLmFscGhhICAgPSBlLmFscGhhOyAgLy8geigwfjM2MClcclxuICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uLmJldGEgICAgPSBlLmJldGE7ICAgLy8geCgtMTgwfjE4MClcclxuICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uLmdhbW1hICAgPSBlLmdhbW1hOyAgLy8geSgtOTB+OTApXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICB9KTtcclxuICAgIFxyXG59KSgpO1xyXG5cclxuXHJcbi8qXHJcbiAqIGNvbG9yLmpzXHJcbiAqL1xyXG5cclxudG0uZ3JhcGhpY3MgPSB0bS5ncmFwaGljcyB8fCB7fTtcclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZ3JhcGhpY3MuQ29sb3JcclxuICAgICAqIOOCq+ODqeODvOOCr+ODqeOCuVxyXG4gICAgICovXHJcbiAgICB0bS5ncmFwaGljcy5Db2xvciA9IHRtLmNyZWF0ZUNsYXNzKHtcclxuICAgICAgICAvKiogUuWApCAqL1xyXG4gICAgICAgIHI6IDI1NSxcclxuICAgICAgICAvKiogR+WApCAqL1xyXG4gICAgICAgIGc6IDI1NSxcclxuICAgICAgICAvKiogQuWApCAqL1xyXG4gICAgICAgIGI6IDI1NSxcclxuICAgICAgICAvKiogQeWApCAqL1xyXG4gICAgICAgIGE6IDEuMCxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihyLCBnLCBiLCBhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44K744OD44K/44O8LlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldDogZnVuY3Rpb24ociwgZywgYiwgYSkge1xyXG4gICAgICAgICAgICB0aGlzLnIgPSByO1xyXG4gICAgICAgICAgICB0aGlzLmcgPSBnO1xyXG4gICAgICAgICAgICB0aGlzLmIgPSBiO1xyXG4gICAgICAgICAgICB0aGlzLmEgPSAoYSAhPT0gdW5kZWZpbmVkKSA/IGEgOiAxLjA7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5pWw5YCk44Gr44KI44KL44K744OD44K/44O8LlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldEZyb21OdW1iZXI6IGZ1bmN0aW9uKHIsIGcsIGIsIGEpIHtcclxuICAgICAgICAgICAgdGhpcy5yID0gcjtcclxuICAgICAgICAgICAgdGhpcy5nID0gZztcclxuICAgICAgICAgICAgdGhpcy5iID0gYjtcclxuICAgICAgICAgICAgdGhpcy5hID0gKGEgIT09IHVuZGVmaW5lZCkgPyBhIDogMS4wO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOmFjeWIl+OBq+OCiOOCi+OCu+ODg+OCv+ODvFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldEZyb21BcnJheTogZnVuY3Rpb24oYXJyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldC5hcHBseSh0aGlzLCBhcnIpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Kq44OW44K444Kn44Kv44OI44Gr44KI44KL44K744OD44K/44O8XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0RnJvbU9iamVjdDogZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldChvYmouciwgb2JqLmcsIG9iai5iLCBvYmouYSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmloflrZfliJfjgavjgojjgovjgrvjg4Pjgr/jg7xcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRGcm9tU3RyaW5nOiBmdW5jdGlvbihzdHIpIHtcclxuICAgICAgICAgICAgdmFyIGNvbG9yID0gdG0uZ3JhcGhpY3MuQ29sb3Iuc3RyaW5nVG9OdW1iZXIoc3RyKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0KGNvbG9yWzBdLCBjb2xvclsxXSwgY29sb3JbMl0sIGNvbG9yWzNdKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOizouOBhOOCu+ODg+OCv+ODvFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFNtYXJ0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGFyZyA9IGFyZ3VtZW50c1swXTtcclxuICAgICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPj0gMykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoYXJndW1lbnRzLnIsIGFyZ3VtZW50cy5nLCBhcmd1bWVudHMuYiwgYXJndW1lbnRzLmEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGFyZyBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldEZyb21BcnJheShhcmcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGFyZyBpbnN0YW5jZW9mIE9iamVjdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRGcm9tT2JqZWN0KGFyZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mKGFyZykgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRGcm9tU3RyaW5nKGFyZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ1NTIOeUqCAxNumAsuaVsOaWh+Wtl+WIl+OBq+WkieaPm1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRvU3R5bGVBc0hleDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBcIiN7MH17MX17Mn1cIi5mb3JtYXQoXHJcbiAgICAgICAgICAgICAgICB0aGlzLnIudG9TdHJpbmcoMTYpLnBhZGRpbmcoMiwgJzAnKSxcclxuICAgICAgICAgICAgICAgIHRoaXMuZy50b1N0cmluZygxNikucGFkZGluZygyLCAnMCcpLFxyXG4gICAgICAgICAgICAgICAgdGhpcy5iLnRvU3RyaW5nKDE2KS5wYWRkaW5nKDIsICcwJylcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIENTUyDnlKggUkdC5paH5a2X5YiX44Gr5aSJ5o+bXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdG9TdHlsZUFzUkdCOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFwicmdiKHtyfSx7Z30se2J9KVwiLmZvcm1hdCh7XHJcbiAgICAgICAgICAgICAgICByOiB+fnRoaXMucixcclxuICAgICAgICAgICAgICAgIGc6IH5+dGhpcy5nLFxyXG4gICAgICAgICAgICAgICAgYjogfn50aGlzLmJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDU1Mg55SoIFJHQkHmloflrZfliJfjgavlpInmj5tcclxuICAgICAgICAgKi9cclxuICAgICAgICB0b1N0eWxlQXNSR0JBOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFwicmdiYSh7cn0se2d9LHtifSx7YX0pXCIuZm9ybWF0KHtcclxuICAgICAgICAgICAgICAgIHI6IH5+dGhpcy5yLFxyXG4gICAgICAgICAgICAgICAgZzogfn50aGlzLmcsXHJcbiAgICAgICAgICAgICAgICBiOiB+fnRoaXMuYixcclxuICAgICAgICAgICAgICAgIGE6IHRoaXMuYVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDU1Mg55SoIFJHQkEg5paH5a2X5YiX44Gr5aSJ5o+bXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdG9TdHlsZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBcInJnYmEoe3J9LHtnfSx7Yn0se2F9KVwiLmZvcm1hdCh7XHJcbiAgICAgICAgICAgICAgICByOiB+fnRoaXMucixcclxuICAgICAgICAgICAgICAgIGc6IH5+dGhpcy5nLFxyXG4gICAgICAgICAgICAgICAgYjogfn50aGlzLmIsXHJcbiAgICAgICAgICAgICAgICBhOiB0aGlzLmFcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICB2YXIgTUFUQ0hfU0VUX0xJU1QgPSB7XHJcbiAgICAgICAgXCJoZXgxMTFcIjoge1xyXG4gICAgICAgICAgICByZWc6IC9eIyhcXHd7MX0pKFxcd3sxfSkoXFx3ezF9KSQvLFxyXG4gICAgICAgICAgICBleGVjOiBmdW5jdGlvbihtKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KG1bMV0rbVsxXSwgMTYpLFxyXG4gICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KG1bMl0rbVsyXSwgMTYpLFxyXG4gICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KG1bM10rbVszXSwgMTYpXHJcbiAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcImhleDIyMlwiOiB7XHJcbiAgICAgICAgICAgIHJlZzogL14jKFxcd3syfSkoXFx3ezJ9KShcXHd7Mn0pJC8sXHJcbiAgICAgICAgICAgIGV4ZWM6IGZ1bmN0aW9uKG0pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQobVsxXSwgMTYpLFxyXG4gICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KG1bMl0sIDE2KSxcclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludChtWzNdLCAxNilcclxuICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIFwicmdiXCI6IHtcclxuICAgICAgICAgICAgcmVnOiAvXnJnYlxcKChcXGR7MSwzfSksXFxzKihcXGR7MSwzfSksXFxzKihcXGR7MSwzfSlcXCkkLyxcclxuICAgICAgICAgICAgZXhlYzogZnVuY3Rpb24obSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludChtWzFdKSxcclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludChtWzJdKSxcclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludChtWzNdKVxyXG4gICAgICAgICAgICAgICAgXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXCJyZ2JhXCI6IHtcclxuICAgICAgICAgICAgcmVnOiAvXnJnYmFcXCgoXFxkezEsM30pLFxccyooXFxkezEsM30pLFxccyooXFxkezEsM30pLFxccyooXFxkezF9KFxcLnsxfVxcZCspPylcXCkkLyxcclxuICAgICAgICAgICAgZXhlYzogZnVuY3Rpb24obSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludChtWzFdKSxcclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludChtWzJdKSxcclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludChtWzNdKSxcclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KG1bNF0pXHJcbiAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcImhzbFwiOiB7XHJcbiAgICAgICAgICAgIHJlZzogL15oc2xcXCgoXFxkezEsM30pLFxccyooXFxkezEsM30pJSxcXHMqKFxcZHsxLDN9KSVcXCkkLyxcclxuICAgICAgICAgICAgZXhlYzogZnVuY3Rpb24obSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRtLmdyYXBoaWNzLkNvbG9yLkhTTHRvUkdCKG1bMV0sIG1bMl0sIG1bM10pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcImhzbGFcIjoge1xyXG4gICAgICAgICAgICByZWc6IC9ecmdiYVxcKChcXGR7MSwzfSksXFxzKihcXGR7MSwzfSksXFxzKihcXGR7MSwzfSksXFxzKihcXGR7MX0oXFwuezF9XFxkKyk/KVxcKSQvLFxyXG4gICAgICAgICAgICBleGVjOiBmdW5jdGlvbihtKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gQ29sb3IuSFNMQXRvUkdCQShtWzFdLCBtWzJdLCBtWzNdLCBtWzRdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICog44Kr44Op44O844Oq44K544OIXHJcbiAgICAgKi9cclxuICAgIHRtLmdyYXBoaWNzLkNvbG9yLkNPTE9SX0xJU1QgPSB7XHJcbiAgICAgICAgLyoqIEBwcm9wZXJ0eSBibGFjayAqL1xyXG4gICAgICAgIFwiYmxhY2tcIiAgICAgOiBbMHgwMCwgMHgwMCwgMHgwMF0sXHJcbiAgICAgICAgLyoqIEBwcm9wZXJ0eSBzaWx2ZXIgKi9cclxuICAgICAgICBcInNpbHZlclwiICAgIDogWzB4YzAsIDB4YzAsIDB4YzBdLFxyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgZ3JheSAqL1xyXG4gICAgICAgIFwiZ3JheVwiICAgICAgOiBbMHg4MCwgMHg4MCwgMHg4MF0sXHJcbiAgICAgICAgLyoqIEBwcm9wZXJ0eSB3aGl0ZSAqL1xyXG4gICAgICAgIFwid2hpdGVcIiAgICAgOiBbMHhmZiwgMHhmZiwgMHhmZl0sXHJcbiAgICAgICAgLyoqIEBwcm9wZXJ0eSBtYXJvb24gKi9cclxuICAgICAgICBcIm1hcm9vblwiICAgIDogWzB4ODAsIDB4MDAsIDB4MDBdLFxyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgcmVkICovXHJcbiAgICAgICAgXCJyZWRcIiAgICAgICA6IFsweGZmLCAweDAwLCAweDAwXSxcclxuICAgICAgICAvKiogQHByb3BlcnR5IHB1cnBsZSAqL1xyXG4gICAgICAgIFwicHVycGxlXCIgICAgOiBbMHg4MCwgMHgwMCwgMHg4MF0sXHJcbiAgICAgICAgLyoqIEBwcm9wZXJ0eSBmdWNoc2lhICovXHJcbiAgICAgICAgXCJmdWNoc2lhXCIgICA6IFsweGZmLCAweDAwLCAweGZmXSxcclxuICAgICAgICAvKiogQHByb3BlcnR5IGdyZWVuICovXHJcbiAgICAgICAgXCJncmVlblwiICAgICA6IFsweDAwLCAweDgwLCAweDAwXSxcclxuICAgICAgICAvKiogQHByb3BlcnR5IGxpbWUgKi9cclxuICAgICAgICBcImxpbWVcIiAgICAgIDogWzB4MDAsIDB4ZmYsIDB4MDBdLFxyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgb2xpdmUgKi9cclxuICAgICAgICBcIm9saXZlXCIgICAgIDogWzB4ODAsIDB4ODAsIDB4MDBdLFxyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgeWVsbG93ICovXHJcbiAgICAgICAgXCJ5ZWxsb3dcIiAgICA6IFsweGZmLCAweGZmLCAweDAwXSxcclxuICAgICAgICAvKiogQHByb3BlcnR5IG5hdnkgKi9cclxuICAgICAgICBcIm5hdnlcIiAgICAgIDogWzB4MDAsIDB4MDAsIDB4ODBdLFxyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgYmx1ZSAqL1xyXG4gICAgICAgIFwiYmx1ZVwiICAgICAgOiBbMHgwMCwgMHgwMCwgMHhmZl0sXHJcbiAgICAgICAgLyoqIEBwcm9wZXJ0eSB0ZWFsICovXHJcbiAgICAgICAgXCJ0ZWFsXCIgICAgICA6IFsweDAwLCAweDgwLCAweDgwXSxcclxuICAgICAgICAvKiogQHByb3BlcnR5IGFxdWEgKi9cclxuICAgICAgICBcImFxdWFcIiAgICAgIDogWzB4MDAsIDB4ZmYsIDB4ZmZdLFxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEBtZW1iZXIgdG0uZ3JhcGhpY3MuQ29sb3JcclxuICAgICAqIEBtZXRob2Qgc3RyVG9OdW1cclxuICAgICAqL1xyXG4gICAgdG0uZ3JhcGhpY3MuQ29sb3Iuc3RyVG9OdW0gPSB0bS5ncmFwaGljcy5Db2xvci5zdHJpbmdUb051bWJlciA9IGZ1bmN0aW9uKHN0cil7XHJcbiAgICAgICAgdmFyIHZsYXVlID0gbnVsbDtcclxuICAgICAgICB2YXIgdHlwZSA9IG51bGw7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHN0clswXSA9PT0gJyMnKSB7XHJcbiAgICAgICAgICAgIHR5cGUgPSAoc3RyLmxlbmd0aCA9PSA0KSA/ICBcImhleDExMVwiIDogXCJoZXgyMjJcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoc3RyWzBdID09PSAncicgJiYgc3RyWzFdID09PSAnZycgJiYgc3RyWzJdID09PSAnYicpIHtcclxuICAgICAgICAgICAgdHlwZSA9IChzdHJbM10gPT0gJ2EnKSA/IFwicmdiYVwiIDogXCJyZ2JcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoc3RyWzBdID09PSAnaCcgJiYgc3RyWzFdID09PSAncycgJiYgc3RyWzJdID09PSAnbCcpIHtcclxuICAgICAgICAgICAgdHlwZSA9IChzdHJbM10gPT0gJ2EnKSA/IFwiaHNsYVwiIDogXCJoc2xcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHR5cGUpIHtcclxuICAgICAgICAgICAgdmFyIG1hdGNoX3NldCA9IE1BVENIX1NFVF9MSVNUW3R5cGVdO1xyXG4gICAgICAgICAgICB2YXIgbSA9IHN0ci5tYXRjaCggbWF0Y2hfc2V0LnJlZyApO1xyXG4gICAgICAgICAgICB2YWx1ZSA9IG1hdGNoX3NldC5leGVjKG0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChDb2xvci5DT0xPUl9MSVNUW3N0cl0pe1xyXG4gICAgICAgICAgICB2YWx1ZSA9IENvbG9yLkNPTE9SX0xJU1Rbc3RyXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEBtZXRob2RcclxuICAgICAqIGhzbCDjgpIgcmdiIOOBq+WkieaPm1xyXG4gICAgICovXHJcbiAgICB0bS5ncmFwaGljcy5Db2xvci5IU0x0b1JHQiA9IGZ1bmN0aW9uKGgsIHMsIGwpIHtcclxuICAgICAgICB2YXIgciwgZywgYjtcclxuICAgICAgICBcclxuICAgICAgICBoJT0zNjA7XHJcbiAgICAgICAgaCs9MzYwO1xyXG4gICAgICAgIGglPTM2MDtcclxuICAgICAgICBzICo9IDAuMDE7XHJcbiAgICAgICAgbCAqPSAwLjAxO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChzID09IDApIHtcclxuICAgICAgICAgICAgdmFyIGwgPSBNYXRoLnJvdW5kKGwgKiAyNTUpO1xyXG4gICAgICAgICAgICByZXR1cm4gW2wsIGwsIGxdO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbTIgPSAobCA8IDAuNSkgPyBsICogKDErcykgOiBsICsgcyAtIGwqcztcclxuICAgICAgICB2YXIgbTEgPSBsKjIgLSBtMjtcclxuICAgICAgICBcclxuICAgICAgICAvLyByZWRcclxuICAgICAgICB2YXIgdGVtcCA9IChoICsgMTIwKSUzNjA7XHJcbiAgICAgICAgaWYgICAgICAodGVtcCA8IDYwKSB7IHIgPSBtMSArIChtMi1tMSkgKiB0ZW1wLzYwOyB9XHJcbiAgICAgICAgZWxzZSBpZiAodGVtcCA8IDE4MCl7IHIgPSBtMjsgfVxyXG4gICAgICAgIGVsc2UgICAgICAgICAgICAgICAgeyByID0gbTE7IH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBncmVlblxyXG4gICAgICAgIHRlbXAgPSBoO1xyXG4gICAgICAgIGlmICAgICAgKHRlbXAgPCA2MCkgeyBnID0gbTEgKyAobTItbTEpICogdGVtcC82MDsgfVxyXG4gICAgICAgIGVsc2UgaWYgKHRlbXAgPCAxODApeyBnID0gbTI7IH1cclxuICAgICAgICBlbHNlIGlmICh0ZW1wIDwgMjQwKXsgZyA9IG0xICsgKG0yLW0xKSAqICgyNDAtdGVtcCkvNjA7IH1cclxuICAgICAgICBlbHNlICAgICAgICAgICAgICAgIHsgZyA9IG0xOyB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gYmx1ZVxyXG4gICAgICAgIHRlbXAgPSAoKGgtMTIwKSszNjApJTM2MDtcclxuICAgICAgICBpZiAgICAgICh0ZW1wIDwgNjApIHsgYiA9IG0xICsgKG0yLW0xKSAqIHRlbXAvNjA7IH1cclxuICAgICAgICBlbHNlIGlmICh0ZW1wIDwgMTgwKXsgYiA9IG0yOyB9XHJcbiAgICAgICAgZWxzZSBpZiAodGVtcCA8IDI0MCl7IGIgPSBtMSArIChtMi1tMSkgKiAoMjQwLXRlbXApLzYwOyB9XHJcbiAgICAgICAgZWxzZSAgICAgICAgICAgICAgICB7IGIgPSBtMTsgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIHBhcnNlSW50KHIqMjU1KSxcclxuICAgICAgICAgICAgcGFyc2VJbnQoZyoyNTUpLFxyXG4gICAgICAgICAgICBwYXJzZUludChiKjI1NSlcclxuICAgICAgICAgICAgXTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiBoc2xhIOOCkiByZ2JhIOOBq+WkieaPm1xyXG4gICAgICovXHJcbiAgICB0bS5ncmFwaGljcy5Db2xvci5IU0xBdG9SR0JBID0gZnVuY3Rpb24oaCwgcywgbCwgYSkge1xyXG4gICAgICAgIHZhciB0ZW1wID0gQ29sb3IuSFNMdG9SR0IoaCwgcywgbCk7IHRlbXBbM10gPSBhO1xyXG4gICAgICAgIHJldHVybiByZ2I7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQG1ldGhvZFxyXG4gICAgICogcmdiIOWApOOCkuS9nOaIkFxyXG4gICAgICovXHJcbiAgICB0bS5ncmFwaGljcy5Db2xvci5jcmVhdGVTdHlsZVJHQiA9IGZ1bmN0aW9uKHIsIGcsIGIpIHtcclxuICAgICAgICByZXR1cm4gXCJyZ2JhKFwiICsgciArIFwiLFwiICsgZyArIFwiLFwiICsgYiArIFwiKVwiO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiByZ2JhIOWApOOCkuS9nOaIkFxyXG4gICAgICovXHJcbiAgICB0bS5ncmFwaGljcy5Db2xvci5jcmVhdGVTdHlsZVJHQkEgPSBmdW5jdGlvbihyLCBnLCBiLCBhKSB7XHJcbiAgICAgICAgcmV0dXJuIFwicmdiYShcIiArIHIgKyBcIixcIiArIGcgKyBcIixcIiArIGIgKyBcIixcIiArIGEgKyBcIilcIjtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiBoc2wg5YCk44KS5L2c5oiQXHJcbiAgICAgKi9cclxuICAgIHRtLmdyYXBoaWNzLkNvbG9yLmNyZWF0ZVN0eWxlSFNMID0gZnVuY3Rpb24oaCwgcywgbCkge1xyXG4gICAgICAgIHJldHVybiBcImhzbChcIiArIGggKyBcIixcIiArIHMgKyBcIiUsXCIgKyBsICsgXCIlKVwiO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAbWV0aG9kXHJcbiAgICAgKiBoc2xhIOWApOOCkuS9nOaIkFxyXG4gICAgICovXHJcbiAgICB0bS5ncmFwaGljcy5Db2xvci5jcmVhdGVTdHlsZUhTTEEgPSBmdW5jdGlvbihoLCBzLCBsLCBhKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiaHNsYShcIiArIGggKyBcIixcIiArIHMgKyBcIiUsXCIgKyBsICsgXCIlLFwiICsgYSArIFwiKVwiO1xyXG4gICAgfTtcclxufSkoKTtcclxuXHJcbi8qXHJcbiAqIGNhbnZhcy5qc1xyXG4gKi9cclxuXHJcbnRtLmdyYXBoaWNzID0gdG0uZ3JhcGhpY3MgfHwge307XHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLmdyYXBoaWNzLkNhbnZhc1xyXG4gICAgICog44Kt44Oj44Oz44OQ44K5XHJcbiAgICAgKi9cclxuICAgIHRtLmdyYXBoaWNzLkNhbnZhcyA9IHRtLmNyZWF0ZUNsYXNzKHtcclxuICAgICAgICBcclxuICAgICAgICAvKiog6KaB57SgICovXHJcbiAgICAgICAgZWxlbWVudDogbnVsbCxcclxuICAgICAgICBcclxuICAgICAgICAvKiog44Kt44Oj44Oz44OQ44K5ICovXHJcbiAgICAgICAgY2FudmFzOiBudWxsLFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKiDjgrPjg7Pjg4bjgq3jgrnjg4ggKi9cclxuICAgICAgICBjb250ZXh0OiBudWxsLFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKGNhbnZhcykge1xyXG4gICAgICAgICAgICB0aGlzLmNhbnZhcyA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgY2FudmFzID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihjYW52YXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYW52YXMgPSBjYW52YXMgfHwgZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQgICAgICAgICAgICA9IHRoaXMuY2FudmFzO1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQgICAgICAgICAgICA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuICAgICAgICAgICAgdGhpcy5jb250ZXh0LmxpbmVDYXAgICAgPSBcInJvdW5kXCI7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5saW5lSm9pbiAgID0gXCJyb3VuZFwiO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Oq44K144Kk44K644GZ44KLXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcmVzaXplOiBmdW5jdGlvbih3aWR0aCwgaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLndpZHRoICAgPSB3aWR0aDtcclxuICAgICAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ICA9IGhlaWdodDtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg6rjgrXjgqTjgrrjgqbjgqPjg7Pjg4njgqZcclxuICAgICAgICAgKi9cclxuICAgICAgICByZXNpemVXaW5kb3c6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS5wb3NpdGlvbiAgPSBcImZpeGVkXCI7XHJcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLnN0eWxlLm1hcmdpbiAgICA9IFwiMHB4XCI7XHJcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLnN0eWxlLnBhZGRpbmcgICA9IFwiMHB4XCI7XHJcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLnN0eWxlLmxlZnQgICAgICA9IFwiMHB4XCI7XHJcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLnN0eWxlLnRvcCAgICAgICA9IFwiMHB4XCI7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlc2l6ZSh3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODleOCo+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJlc2l6ZVRvRml0U2NyZWVuOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5jYW52YXMuc3R5bGUucG9zaXRpb24gID0gXCJmaXhlZFwiO1xyXG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS5tYXJnaW4gICAgPSBcIjBweFwiO1xyXG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS5wYWRkaW5nICAgPSBcIjBweFwiO1xyXG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS5sZWZ0ICAgICAgPSBcIjBweFwiO1xyXG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS50b3AgICAgICAgPSBcIjBweFwiO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZXNpemUod2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmi6HnuK7jgafnlLvpnaLjgavjg5XjgqPjg4Pjg4jjgZXjgZvjgotcclxuICAgICAgICAgKiDlkI3liY3jga/ku64uIOaknOiojuOBmeOCi1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZpdFdpbmRvdzogZnVuY3Rpb24oZXZlckZsYWcpIHtcclxuICAgICAgICAgICAgdmFyIF9maXRGdW5jID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBldmVyRmxhZyA9IGV2ZXJGbGFnID09PSB1bmRlZmluZWQgPyB0cnVlIDogZXZlckZsYWc7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMuZWxlbWVudDtcclxuICAgICAgICAgICAgICAgIHZhciBzID0gZS5zdHlsZTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgcy5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjtcclxuICAgICAgICAgICAgICAgIHMubWFyZ2luID0gXCJhdXRvXCI7XHJcbiAgICAgICAgICAgICAgICBzLmxlZnQgPSBcIjBweFwiO1xyXG4gICAgICAgICAgICAgICAgcy50b3AgID0gXCIwcHhcIjtcclxuICAgICAgICAgICAgICAgIHMuYm90dG9tID0gXCIwcHhcIjtcclxuICAgICAgICAgICAgICAgIHMucmlnaHQgPSBcIjBweFwiO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciByYXRlV2lkdGggPSBlLndpZHRoL3dpbmRvdy5pbm5lcldpZHRoO1xyXG4gICAgICAgICAgICAgICAgdmFyIHJhdGVIZWlnaHQ9IGUuaGVpZ2h0L3dpbmRvdy5pbm5lckhlaWdodDtcclxuICAgICAgICAgICAgICAgIHZhciByYXRlID0gZS5oZWlnaHQvZS53aWR0aDtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKHJhdGVXaWR0aCA+IHJhdGVIZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBzLndpZHRoICA9IChpbm5lcldpZHRoKS5mbG9vcigpK1wicHhcIjtcclxuICAgICAgICAgICAgICAgICAgICBzLmhlaWdodCA9IChpbm5lcldpZHRoKnJhdGUpLmZsb29yKCkrXCJweFwiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcy53aWR0aCAgPSAoaW5uZXJIZWlnaHQvcmF0ZSkuZmxvb3IoKStcInB4XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgcy5oZWlnaHQgPSAoaW5uZXJIZWlnaHQpLmZsb29yKCkrXCJweFwiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDkuIDluqblrp/ooYzjgZfjgabjgYrjgY9cclxuICAgICAgICAgICAgX2ZpdEZ1bmMoKTtcclxuICAgICAgICAgICAgLy8g44Oq44K144Kk44K65pmC44Gu44Oq44K544OK44Go44GX44Gm55m76Yyy44GX44Gm44GK44GPXHJcbiAgICAgICAgICAgIGlmIChldmVyRmxhZykge1xyXG4gICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgX2ZpdEZ1bmMsIGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Kv44Oq44KiXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY2xlYXI6IGZ1bmN0aW9uKHgsIHksIHdpZHRoLCBoZWlnaHQpIHtcclxuICAgICAgICAgICAgeCA9IHggfHwgMDtcclxuICAgICAgICAgICAgeSA9IHkgfHwgMDtcclxuICAgICAgICAgICAgd2lkdGggPSB3aWR0aCB8fCB0aGlzLndpZHRoO1xyXG4gICAgICAgICAgICBoZWlnaHQ9IGhlaWdodHx8IHRoaXMuaGVpZ2h0O1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuY2xlYXJSZWN0KHgsIHksIHdpZHRoLCBoZWlnaHQpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiJsuaMh+WumuOCr+ODquOColxyXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSAgZmlsbFN0eWxlXHJcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9ICBbeD0wXVxyXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSAgW3k9MF1cclxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gIFt3aWR0aD10aGlzLndpZHRoXVxyXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSAgW2hlaWdodD10aGlzLmhlaWdodF1cclxuICAgICAgICAgKi9cclxuICAgICAgICBjbGVhckNvbG9yOiBmdW5jdGlvbihmaWxsU3R5bGUsIHgsIHksIHdpZHRoLCBoZWlnaHQpIHtcclxuICAgICAgICAgICAgeCA9IHggfHwgMDtcclxuICAgICAgICAgICAgeSA9IHkgfHwgMDtcclxuICAgICAgICAgICAgd2lkdGggPSB3aWR0aCB8fCB0aGlzLndpZHRoO1xyXG4gICAgICAgICAgICBoZWlnaHQ9IGhlaWdodHx8IHRoaXMuaGVpZ2h0O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5zYXZlKCk7XHJcbiAgICAgICAgICAgIHRoaXMucmVzZXRUcmFuc2Zvcm0oKTsgICAgICAgICAgLy8g6KGM5YiX5Yid5pyf5YyWXHJcbiAgICAgICAgICAgIHRoaXMuZmlsbFN0eWxlID0gZmlsbFN0eWxlOyAgICAgLy8g5aGX44KK44Gk44G244GX44K544K/44Kk44Or44K744OD44OIXHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5maWxsUmVjdCh4LCB5LCB3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICAgICAgdGhpcy5yZXN0b3JlKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44OR44K544KS6ZaL5aeLKOODquOCu+ODg+ODiClcclxuICAgICAgICAgKi9cclxuICAgICAgICBiZWdpblBhdGg6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiAg44OR44K544KS6ZaJ44GY44KLXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY2xvc2VQYXRoOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5jb250ZXh0LmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiAg5paw6KaP44OR44K555Sf5oiQXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbW92ZVRvOiBmdW5jdGlvbih4LCB5KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5tb3ZlVG8oeCwgeSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44OR44K544Gr6L+95YqgXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbGluZVRvOiBmdW5jdGlvbih4LCB5KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5saW5lVG8oeCwgeSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44OR44K55YaF44KS5aGX44KK44Gk44G244GZXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZmlsbDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5maWxsKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44OR44K55LiK44Gr44Op44Kk44Oz44KS5byV44GPXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc3Ryb2tlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5jb250ZXh0LnN0cm9rZSgpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCr+ODquODg+ODl1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGNsaXA6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuY2xpcCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOeCueaPj+eUu1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGRyYXdQb2ludDogZnVuY3Rpb24oeCwgeSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHJva2VSZWN0KHgsIHksIDEsIDEpO1xyXG4gICAgICAgICAgICAvLyByZXR1cm4gdGhpcy5iZWdpblBhdGgoKS5tb3ZlVG8oeC0wLjUsIHktMC41KS5saW5lVG8oeCswLjUsIHkrMC41KS5zdHJva2UoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg6njgqTjg7Pjg5HjgrnjgpLkvZzmiJBcclxuICAgICAgICAgKi9cclxuICAgICAgICBsaW5lOiBmdW5jdGlvbih4MCwgeTAsIHgxLCB5MSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tb3ZlVG8oeDAsIHkwKS5saW5lVG8oeDEsIHkxKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODqeOCpOODs+OCkuaPj+eUu1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGRyYXdMaW5lOiBmdW5jdGlvbih4MCwgeTAsIHgxLCB5MSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5iZWdpblBhdGgoKS5saW5lKHgwLCB5MCwgeDEsIHkxKS5zdHJva2UoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODgOODg+OCt+ODpeODqeOCpOODs+OCkuaPj+eUu1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGRyYXdEYXNoTGluZTogZnVuY3Rpb24oeDAsIHkwLCB4MSwgeTEsIHBhdHRlcm4pIHtcclxuICAgICAgICAgICAgdmFyIHBhdHRlcm5UYWJsZSA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YocGF0dGVybikgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgcGF0dGVyblRhYmxlID0gcGF0dGVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHBhdHRlcm4gPSBwYXR0ZXJuIHx8IDB4ZjBmMDtcclxuICAgICAgICAgICAgICAgIHBhdHRlcm5UYWJsZSA9IHBhdHRlcm4udG9TdHJpbmcoMik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcGF0dGVyblRhYmxlID0gcGF0dGVyblRhYmxlLnBhZGRpbmcoMTYsICcxJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgdnggPSB4MS14MDtcclxuICAgICAgICAgICAgdmFyIHZ5ID0geTEteTA7XHJcbiAgICAgICAgICAgIHZhciBsZW4gPSBNYXRoLnNxcnQodngqdnggKyB2eSp2eSk7XHJcbiAgICAgICAgICAgIHZ4Lz1sZW47IHZ5Lz1sZW47XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgeCA9IHgwO1xyXG4gICAgICAgICAgICB2YXIgeSA9IHkwO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpPTA7IGk8bGVuOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIGlmIChwYXR0ZXJuVGFibGVbaSUxNl0gPT0gJzEnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kcmF3UG9pbnQoeCwgeSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5maWxsUmVjdCh4LCB5LCB0aGlzLmNvbnRleHQubGluZVdpZHRoLCB0aGlzLmNvbnRleHQubGluZVdpZHRoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHggKz0gdng7XHJcbiAgICAgICAgICAgICAgICB5ICs9IHZ5O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIHYwKHgwLCB5MCksIHYxKHgxLCB5MSkg44GL44KJ6KeS5bqm44KS5rGC44KB44Gm55+i5Y2w44KS5o+P55S7XHJcbiAgICAgICAgICogaHR0cDovL2hha3VoaW4uanAvYXMvcm90YXRpb24uaHRtbFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGRyYXdBcnJvdzogZnVuY3Rpb24oeDAsIHkwLCB4MSwgeTEsIGFycm93UmFkaXVzKSB7XHJcbiAgICAgICAgICAgIHZhciB2eCA9IHgxLXgwO1xyXG4gICAgICAgICAgICB2YXIgdnkgPSB5MS15MDtcclxuICAgICAgICAgICAgdmFyIGFuZ2xlID0gTWF0aC5hdGFuMih2eSwgdngpKjE4MC9NYXRoLlBJO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5kcmF3TGluZSh4MCwgeTAsIHgxLCB5MSk7XHJcbiAgICAgICAgICAgIHRoaXMuZmlsbFBvbHlnb24oeDEsIHkxLCBhcnJvd1JhZGl1cyB8fCA1LCAzLCBhbmdsZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIGxpbmVzXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbGluZXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLm1vdmVUbyhhcmd1bWVudHNbMF0sIGFyZ3VtZW50c1sxXSk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGk9MSxsZW49YXJndW1lbnRzLmxlbmd0aC8yOyBpPGxlbjsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpbmVUbyhhcmd1bWVudHNbaSoyXSwgYXJndW1lbnRzW2kqMisxXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Op44Kk44Oz44K544OI44Ot44O844Kv5o+P55S7XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc3Ryb2tlTGluZXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmJlZ2luUGF0aCgpO1xyXG4gICAgICAgICAgICB0aGlzLmxpbmVzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIHRoaXMuc3Ryb2tlKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODqeOCpOODs+Whl+OCiuOBpOOBtuOBl+aPj+eUu1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZpbGxMaW5lczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgIHRoaXMubGluZXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgdGhpcy5maWxsKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5Zub6KeS5b2i44OR44K544KS5L2c5oiQ44GZ44KLXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcmVjdDogZnVuY3Rpb24oeCwgeSwgd2lkdGgsIGhlaWdodCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQucmVjdC5hcHBseSh0aGlzLmNvbnRleHQsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5Zub6KeS5b2i5aGX44KK44Gk44G244GX5o+P55S7XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZmlsbFJlY3Q6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuZmlsbFJlY3QuYXBwbHkodGhpcy5jb250ZXh0LCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWbm+inkuW9ouODqeOCpOODs+aPj+eUu1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHN0cm9rZVJlY3Q6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuc3Ryb2tlUmVjdC5hcHBseSh0aGlzLmNvbnRleHQsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6KeS5Li45Zub6KeS5b2i44OR44K5XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcm91bmRSZWN0OiBmdW5jdGlvbih4LCB5LCB3aWR0aCwgaGVpZ2h0LCByYWRpdXMpIHtcclxuICAgICAgICAgICAgdmFyIGwgPSB4ICsgcmFkaXVzO1xyXG4gICAgICAgICAgICB2YXIgciA9IHggKyB3aWR0aCAtIHJhZGl1cztcclxuICAgICAgICAgICAgdmFyIHQgPSB5ICsgcmFkaXVzO1xyXG4gICAgICAgICAgICB2YXIgYiA9IHkgKyBoZWlnaHQgLSByYWRpdXM7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvKlxyXG4gICAgICAgICAgICB2YXIgY3R4ID0gdGhpcy5jb250ZXh0O1xyXG4gICAgICAgICAgICBjdHgubW92ZVRvKGwsIHkpO1xyXG4gICAgICAgICAgICBjdHgubGluZVRvKHIsIHkpO1xyXG4gICAgICAgICAgICBjdHgucXVhZHJhdGljQ3VydmVUbyh4K3dpZHRoLCB5LCB4K3dpZHRoLCB0KTtcclxuICAgICAgICAgICAgY3R4LmxpbmVUbyh4K3dpZHRoLCBiKTtcclxuICAgICAgICAgICAgY3R4LnF1YWRyYXRpY0N1cnZlVG8oeCt3aWR0aCwgeStoZWlnaHQsIHIsIHkraGVpZ2h0KTtcclxuICAgICAgICAgICAgY3R4LmxpbmVUbyhsLCB5K2hlaWdodCk7XHJcbiAgICAgICAgICAgIGN0eC5xdWFkcmF0aWNDdXJ2ZVRvKHgsIHkraGVpZ2h0LCB4LCBiKTtcclxuICAgICAgICAgICAgY3R4LmxpbmVUbyh4LCB0KTtcclxuICAgICAgICAgICAgY3R4LnF1YWRyYXRpY0N1cnZlVG8oeCwgeSwgbCwgeSk7XHJcbiAgICAgICAgICAgIC8qKi9cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5hcmMobCwgdCwgcmFkaXVzLCAgICAgLU1hdGguUEksIC1NYXRoLlBJKjAuNSwgZmFsc2UpOyAgLy8g5bem5LiKXHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5hcmMociwgdCwgcmFkaXVzLCAtTWF0aC5QSSowLjUsICAgICAgICAgICAgMCwgZmFsc2UpOyAgLy8g5Y+z5LiKXHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5hcmMociwgYiwgcmFkaXVzLCAgICAgICAgICAgIDAsICBNYXRoLlBJKjAuNSwgZmFsc2UpOyAgLy8g5Y+z5LiLXHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5hcmMobCwgYiwgcmFkaXVzLCAgTWF0aC5QSSowLjUsICAgICAgTWF0aC5QSSwgZmFsc2UpOyAgLy8g5bem5LiLXHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOinkuS4uOWbm+inkuW9ouWhl+OCiuOBpOOBtuOBl1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZpbGxSb3VuZFJlY3Q6IGZ1bmN0aW9uKHgsIHksIHdpZHRoLCBoZWlnaHQsIHJhZGl1cykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5iZWdpblBhdGgoKS5yb3VuZFJlY3QoeCwgeSwgd2lkdGgsIGhlaWdodCwgcmFkaXVzKS5maWxsKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDop5LkuLjlm5vop5LlvaLjgrnjg4jjg63jg7zjgq/mj4/nlLtcclxuICAgICAgICAgKi9cclxuICAgICAgICBzdHJva2VSb3VuZFJlY3Q6IGZ1bmN0aW9uKHgsIHksIHdpZHRoLCBoZWlnaHQsIHJhZGl1cykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5iZWdpblBhdGgoKS5yb3VuZFJlY3QoeCwgeSwgd2lkdGgsIGhlaWdodCwgcmFkaXVzKS5zdHJva2UoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODneODquOCtOODs+ODkeOCuVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHBvbHlnb246IGZ1bmN0aW9uKHgsIHksIHNpemUsIHNpZGVzLCBvZmZzZXRBbmdsZSkge1xyXG4gICAgICAgICAgICB2YXIgcmFkRGl2ID0gKE1hdGguUEkqMikvc2lkZXM7XHJcbiAgICAgICAgICAgIHZhciByYWRPZmZzZXQgPSAob2Zmc2V0QW5nbGUhPXVuZGVmaW5lZCkgPyBvZmZzZXRBbmdsZSpNYXRoLlBJLzE4MCA6IC1NYXRoLlBJLzI7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLm1vdmVUbyh4ICsgTWF0aC5jb3MocmFkT2Zmc2V0KSpzaXplLCB5ICsgTWF0aC5zaW4ocmFkT2Zmc2V0KSpzaXplKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaT0xOyBpPHNpZGVzOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHZhciByYWQgPSByYWREaXYqaStyYWRPZmZzZXQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpbmVUbyhcclxuICAgICAgICAgICAgICAgICAgICB4ICsgTWF0aC5jb3MocmFkKSpzaXplLFxyXG4gICAgICAgICAgICAgICAgICAgIHkgKyBNYXRoLnNpbihyYWQpKnNpemVcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg53jg6rjgrTjg7PloZfjgorjgaTjgbbjgZdcclxuICAgICAgICAgKi9cclxuICAgICAgICBmaWxsUG9seWdvbjogZnVuY3Rpb24oeCwgeSwgcmFkaXVzLCBzaWRlcywgb2Zmc2V0QW5nbGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYmVnaW5QYXRoKCkucG9seWdvbih4LCB5LCByYWRpdXMsIHNpZGVzLCBvZmZzZXRBbmdsZSkuZmlsbCgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Od44Oq44K044Oz44K544OI44Ot44O844Kv5o+P55S7XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc3Ryb2tlUG9seWdvbjogZnVuY3Rpb24oeCwgeSwgcmFkaXVzLCBzaWRlcywgb2Zmc2V0QW5nbGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYmVnaW5QYXRoKCkucG9seWdvbih4LCB5LCByYWRpdXMsIHNpZGVzLCBvZmZzZXRBbmdsZSkuc3Ryb2tlKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBzdGFyXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc3RhcjogZnVuY3Rpb24oeCwgeSwgcmFkaXVzLCBzaWRlcywgc2lkZUluZGVudCwgb2Zmc2V0QW5nbGUpIHtcclxuICAgICAgICAgICAgdmFyIHNpZGVJbmRlbnRSYWRpdXMgPSByYWRpdXMgKiAoc2lkZUluZGVudCB8fCAwLjM4KTtcclxuICAgICAgICAgICAgdmFyIHJhZE9mZnNldCA9IChvZmZzZXRBbmdsZSkgPyBvZmZzZXRBbmdsZSpNYXRoLlBJLzE4MCA6IC1NYXRoLlBJLzI7XHJcbiAgICAgICAgICAgIHZhciByYWREaXYgPSAoTWF0aC5QSSoyKS9zaWRlcy8yO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5tb3ZlVG8oXHJcbiAgICAgICAgICAgICAgICB4ICsgTWF0aC5jb3MocmFkT2Zmc2V0KSpyYWRpdXMsXHJcbiAgICAgICAgICAgICAgICB5ICsgTWF0aC5zaW4ocmFkT2Zmc2V0KSpyYWRpdXNcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaT0xOyBpPHNpZGVzKjI7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJhZCA9IHJhZERpdippICsgcmFkT2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgdmFyIGxlbiA9IChpJTIpID8gc2lkZUluZGVudFJhZGl1cyA6IHJhZGl1cztcclxuICAgICAgICAgICAgICAgIHRoaXMubGluZVRvKFxyXG4gICAgICAgICAgICAgICAgICAgIHggKyBNYXRoLmNvcyhyYWQpKmxlbixcclxuICAgICAgICAgICAgICAgICAgICB5ICsgTWF0aC5zaW4ocmFkKSpsZW5cclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5pif44KS5aGX44KK44Gk44G244GX5o+P55S7XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZmlsbFN0YXI6IGZ1bmN0aW9uKHgsIHksIHJhZGl1cywgc2lkZXMsIHNpZGVJbmRlbnQsIG9mZnNldEFuZ2xlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJlZ2luUGF0aCgpLnN0YXIoeCwgeSwgcmFkaXVzLCBzaWRlcywgc2lkZUluZGVudCwgb2Zmc2V0QW5nbGUpLmZpbGwoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmmJ/jgpLjgrnjg4jjg63jg7zjgq/mj4/nlLtcclxuICAgICAgICAgKi9cclxuICAgICAgICBzdHJva2VTdGFyOiBmdW5jdGlvbih4LCB5LCByYWRpdXMsIHNpZGVzLCBzaWRlSW5kZW50LCBvZmZzZXRBbmdsZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5iZWdpblBhdGgoKS5zdGFyKHgsIHksIHJhZGl1cywgc2lkZXMsIHNpZGVJbmRlbnQsIG9mZnNldEFuZ2xlKS5zdHJva2UoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKlxyXG4gICAgICAgICAqIGhlYXJ0XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaGVhcnQ6IGZ1bmN0aW9uKHgsIHksIHJhZGl1cywgYW5nbGUpIHtcclxuICAgICAgICAgICAgdmFyIGhhbGZfcmFkaXVzID0gcmFkaXVzKjAuNTtcclxuICAgICAgICAgICAgdmFyIHJhZCA9IChhbmdsZSA9PT0gdW5kZWZpbmVkKSA/IE1hdGguUEkvNCA6IE1hdGguZGVnVG9SYWQoYW5nbGUpO1xyXG5cclxuICAgICAgICAgICAgLy8g5Y2K5b6EIGhhbGZfcmFkaXVzIOOBruinkuW6piBhbmdsZSDkuIrjga7ngrnjgajjga7mjqXnt5rjgpLmsYLjgoHjgotcclxuICAgICAgICAgICAgdmFyIHAgPSBNYXRoLmNvcyhyYWQpKmhhbGZfcmFkaXVzO1xyXG4gICAgICAgICAgICB2YXIgcSA9IE1hdGguc2luKHJhZCkqaGFsZl9yYWRpdXM7XHJcblxyXG4gICAgICAgICAgICAvLyDlhobjga7mjqXnt5rjga7mlrnnqIvlvI8gcHggKyBxeSA9IHJeMiDjgojjgoogeSA9IChyXjItcHgpL3FcclxuICAgICAgICAgICAgdmFyIHgyID0gLWhhbGZfcmFkaXVzO1xyXG4gICAgICAgICAgICB2YXIgeTIgPSAoaGFsZl9yYWRpdXMqaGFsZl9yYWRpdXMtcCp4MikvcTtcclxuXHJcbiAgICAgICAgICAgIC8vIOS4reW/g+S9jee9ruiqv+aVtFxyXG4gICAgICAgICAgICB2YXIgaGVpZ2h0ID0geTIgKyBoYWxmX3JhZGl1cztcclxuICAgICAgICAgICAgdmFyIG9mZnNldFkgPSBoYWxmX3JhZGl1cy1oZWlnaHQvMjtcclxuXHJcbiAgICAgICAgICAgIC8vIOODkeOCueOCkuOCu+ODg+ODiFxyXG4gICAgICAgICAgICB0aGlzLm1vdmVUbygwK3gsIHkyK3krb2Zmc2V0WSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmFyYygtaGFsZl9yYWRpdXMreCwgMCt5K29mZnNldFksIGhhbGZfcmFkaXVzLCBNYXRoLlBJLXJhZCwgTWF0aC5QSSoyKTtcclxuICAgICAgICAgICAgdGhpcy5hcmMoaGFsZl9yYWRpdXMreCwgMCt5K29mZnNldFksIGhhbGZfcmFkaXVzLCBNYXRoLlBJLCByYWQpO1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlUGF0aCgpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLypcclxuICAgICAgICAgKiBmaWxsIGhlYXJ0XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZmlsbEhlYXJ0OiBmdW5jdGlvbih4LCB5LCByYWRpdXMsIGFuZ2xlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJlZ2luUGF0aCgpLmhlYXJ0KHgsIHksIHJhZGl1cywgYW5nbGUpLmZpbGwoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKlxyXG4gICAgICAgICAqIHN0cm9rZSBoZWFydFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHN0cm9rZUhlYXJ0OiBmdW5jdGlvbih4LCB5LCByYWRpdXMsIGFuZ2xlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJlZ2luUGF0aCgpLmhlYXJ0KHgsIHksIHJhZGl1cywgYW5nbGUpLnN0cm9rZSgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5YaG44Gu44OR44K544KS6Kit5a6aXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY2lyY2xlOiBmdW5jdGlvbih4LCB5LCByYWRpdXMpIHtcclxuICAgICAgICAgICAgdGhpcy5jb250ZXh0LmFyYyh4LCB5LCByYWRpdXMsIDAsIE1hdGguUEkqMiwgZmFsc2UpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWhl+OCiuOBpOOBtuOBl+WGhuOCkuaPj+eUu1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZpbGxDaXJjbGU6IGZ1bmN0aW9uKHgsIHksIHJhZGl1cykge1xyXG4gICAgICAgICAgICB2YXIgYyA9IHRoaXMuY29udGV4dDtcclxuICAgICAgICAgICAgYy5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgYy5hcmMoeCwgeSwgcmFkaXVzLCAwLCBNYXRoLlBJKjIsIGZhbHNlKTtcclxuICAgICAgICAgICAgYy5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgYy5maWxsKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgICAgICAvLyByZXR1cm4gdGhpcy5iZWdpblBhdGgoKS5jaXJjbGUoeCwgeSwgcmFkaXVzKS5maWxsKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgrnjg4jjg63jg7zjgq/lhobjgpLmj4/nlLtcclxuICAgICAgICAgKi9cclxuICAgICAgICBzdHJva2VDaXJjbGU6IGZ1bmN0aW9uKHgsIHksIHJhZGl1cykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5iZWdpblBhdGgoKS5jaXJjbGUoeCwgeSwgcmFkaXVzKS5zdHJva2UoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWGhuW8p+OBruODkeOCueOCkuioreWumlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGFyYzogZnVuY3Rpb24oeCwgeSwgcmFkaXVzLCBzdGFydEFuZ2xlLCBlbmRBbmdsZSwgYW50aWNsb2Nrd2lzZSkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuYXJjKHgsIHksIHJhZGl1cywgc3RhcnRBbmdsZSwgZW5kQW5nbGUsIGFudGljbG9ja3dpc2UpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWhl+OCiuOBpOOBtuOBl+WGhuW8p+OCkuaPj+eUu1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZpbGxBcmM6IGZ1bmN0aW9uKHgsIHksIHJhZGl1cywgc3RhcnRBbmdsZSwgZW5kQW5nbGUsIGFudGljbG9ja3dpc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYmVnaW5QYXRoKCkuYXJjKHgsIHksIHJhZGl1cywgc3RhcnRBbmdsZSwgZW5kQW5nbGUsIGFudGljbG9ja3dpc2UpLmZpbGwoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCueODiOODreODvOOCr+WGhuW8p+OCkuaPj+eUu1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHN0cm9rZUFyYzogZnVuY3Rpb24oeCwgeSwgcmFkaXVzLCBzdGFydEFuZ2xlLCBlbmRBbmdsZSwgYW50aWNsb2Nrd2lzZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5iZWdpblBhdGgoKS5hcmMoeCwgeSwgcmFkaXVzLCBzdGFydEFuZ2xlLCBlbmRBbmdsZSwgYW50aWNsb2Nrd2lzZSkuc3Ryb2tlKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDkuInop5LlvaLjg5HjgrnjgpLoqK3lrppcclxuICAgICAgICAgKi9cclxuICAgICAgICB0cmlhbmdsZTogZnVuY3Rpb24oeDAsIHkwLCB4MSwgeTEsIHgyLCB5Mikge1xyXG4gICAgICAgICAgICB0aGlzLm1vdmVUbyh4MCwgeTApLmxpbmVUbyh4MSwgeTEpLmxpbmVUbyh4MiwgeTIpO1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWhl+OCiuOBpOOBtuOBl+S4ieinkuW9ouOCkuaPj+eUu1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZpbGxUcmlhbmdsZTogZnVuY3Rpb24oeDAsIHkwLCB4MSwgeTEsIHgyLCB5Mikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5iZWdpblBhdGgoKS50cmlhbmdsZSh4MCwgeTAsIHgxLCB5MSwgeDIsIHkyKS5maWxsKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgrnjg4jjg63jg7zjgq/kuInop5LlvaLjgpLmj4/nlLtcclxuICAgICAgICAgKi9cclxuICAgICAgICBzdHJva2VUcmlhbmdsZTogZnVuY3Rpb24oeDAsIHkwLCB4MSwgeTEsIHgyLCB5Mikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5iZWdpblBhdGgoKS50cmlhbmdsZSh4MCwgeTAsIHgxLCB5MSwgeDIsIHkyKS5zdHJva2UoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDloZfjgorjgaTjgbbjgZfjg4bjgq3jgrnjg4jjgpLmj4/nlLtcclxuICAgICAgICAgKi9cclxuICAgICAgICBmaWxsVGV4dDogZnVuY3Rpb24odGV4dCwgeCwgeSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmZpbGxUZXh0LmFwcGx5KHRoaXMuY29udGV4dCwgYXJndW1lbnRzKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCueODiOODreODvOOCr+ODhuOCreOCueODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHN0cm9rZVRleHQ6IGZ1bmN0aW9uKHRleHQsIHgsIHkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5zdHJva2VUZXh0LmFwcGx5KHRoaXMuY29udGV4dCwgYXJndW1lbnRzKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIGZpbGxWZXJ0aWNhbFRleHQ6IGZ1bmN0aW9uKHRleHQsIHgsIHkpIHtcclxuICAgICAgICAgICAgdGhpcy5fZHJhd1ZlcnRpY2FsVGV4dChcImZpbGxUZXh0XCIsIHRleHQsIHgsIHkpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc3Ryb2tlVmVydGljYWxUZXh0OiBmdW5jdGlvbih0ZXh0LCB4LCB5KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2RyYXdWZXJ0aWNhbFRleHQoXCJzdHJva2VUZXh0XCIsIHRleHQsIHgsIHkpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgX2RyYXdWZXJ0aWNhbFRleHQ6IGZ1bmN0aW9uKGZ1bmMsIHRleHQsIHgsIHkpIHtcclxuICAgICAgICAgICAgdmFyIGN0eCA9IHRoaXMuY29udGV4dDtcclxuICAgICAgICAgICAgdmFyIGxpbmVzID0gdGV4dC5zcGxpdCgnXFxuJyk7XHJcbiAgICAgICAgICAgIHZhciBjaGFyU2l6ZSA9IHRoaXMuY29udGV4dC5tZWFzdXJlVGV4dCgn44GCJykud2lkdGg7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjdHguc2F2ZSgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY3R4LnRleHRBbGlnbiA9IFwicmlnaHRcIjtcclxuICAgICAgICAgICAgY3R4LnRleHRCYXNlbGluZSA9IFwidG9wXCI7XHJcblxyXG4gICAgICAgICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKHRleHQsIGZ1bmN0aW9uKGNoLCBqKSB7XHJcbiAgICAgICAgICAgICAgICBjdHhbZnVuY10oY2gsIHgsIHkrY2hhclNpemUqaik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIGRyYXdMYWJlbEJveCwgZHJhd0xhYmVsQXJlYSwgZHJhd1RleHRCb3gsIFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9kcmF3TGFiZWxBcmVhOiBmdW5jdGlvbihmdW5jLCBwYXJhbSkge1xyXG4gICAgICAgICAgICB2YXIgY3R4ID0gdGhpcy5jb250ZXh0O1xyXG4gICAgICAgICAgICB2YXIgdGV4dCA9IHBhcmFtLnRleHQ7XHJcbiAgICAgICAgICAgIHZhciBjaGFyU2l6ZSA9IHRoaXMuY29udGV4dC5tZWFzdXJlVGV4dCgn44GCJykud2lkdGg7XHJcbiAgICAgICAgICAgIHZhciBsaW5lcyA9IHRleHQuc3BsaXQoJ1xcbicpO1xyXG4gICAgICAgICAgICB2YXIgbGluZVNwYWNlID0gKHBhcmFtLmxpbmVTcGFjZSB8fCAxKSpjaGFyU2l6ZTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGN0eC5zYXZlKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDmqKrmm7jjgY1cclxuICAgICAgICAgICAgaWYgKCFwYXJhbS5tb2RlIHx8IHBhcmFtLm1vZGUgPT0gXCJob3Jpem9uXCIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBtYXhDaGFyTnVtID0gTWF0aC5tYXgoIChwYXJhbS53aWR0aC9jaGFyU2l6ZSl8MCwgMSApO1xyXG4gICAgICAgICAgICAgICAgdmFyIG5vcm1hbExpbmVzID0gW107XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGN0eC50ZXh0QWxpZ24gPSBcImxlZnRcIjtcclxuICAgICAgICAgICAgICAgIGN0eC50ZXh0QmFzZWxpbmUgPSBcInRvcFwiO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGxpbmVzLmVhY2goZnVuY3Rpb24obGluZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGk9MCxsZW49bGluZS5sZW5ndGg7IGk8bGVuOyBpKz1tYXhDaGFyTnVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdHIgPSBsaW5lLnN1YnN0cihpLCBtYXhDaGFyTnVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbm9ybWFsTGluZXMucHVzaChzdHIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB2YXIgZnVuY05hbWUgPSBmdW5jICsgXCJUZXh0XCI7XHJcbiAgICAgICAgICAgICAgICBub3JtYWxMaW5lcy5lYWNoKGZ1bmN0aW9uKGxpbmUsIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjdHhbZnVuY05hbWVdKGxpbmUsIHBhcmFtLngsIHBhcmFtLnkgKyBpKmxpbmVTcGFjZSArIDQpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g57im5pu444GNXHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIG1heENoYXJOdW0gPSBNYXRoLm1heCggKHBhcmFtLmhlaWdodC9jaGFyU2l6ZSl8MCwgMSApO1xyXG4gICAgICAgICAgICAgICAgdmFyIHN0YXJ0WCA9IHBhcmFtLnggKyBwYXJhbS53aWR0aDtcclxuICAgICAgICAgICAgICAgIHZhciBub3JtYWxMaW5lcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBsaW5lcy5lYWNoKGZ1bmN0aW9uKGxpbmUpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpPTAsbGVuPWxpbmUubGVuZ3RoOyBpPGxlbjsgaSs9bWF4Q2hhck51bSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RyID0gbGluZS5zdWJzdHIoaSwgbWF4Q2hhck51bSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vcm1hbExpbmVzLnB1c2goc3RyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgdmFyIGZ1bmNOYW1lID0gZnVuYyArIFwiVmVydGljYWxUZXh0XCI7XHJcbiAgICAgICAgICAgICAgICBub3JtYWxMaW5lcy5lYWNoKGZ1bmN0aW9uKGxpbmUsIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBib2xk44Gr44Gq44KL44Go44OV44Kp44Oz44OI44K144Kk44K644GM5aSJ44KP44KL44Gf44KB44CB44Oe44O844K444Oz44Go44GX44GmMTVweOOBmuOCieOBmVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXNbZnVuY05hbWVdKGxpbmUsIHN0YXJ0WC1pKmxpbmVTcGFjZSwgcGFyYW0ueSsxNSk7XHJcbiAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjdHgucmVzdG9yZSgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgZmlsbExhYmVsQXJlYTogZnVuY3Rpb24ocGFyYW0pIHtcclxuICAgICAgICAgICAgdGhpcy5fZHJhd0xhYmVsQXJlYShcImZpbGxcIiwgcGFyYW0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgc3Ryb2tlTGFiZWxBcmVhOiBmdW5jdGlvbihwYXJhbSkge1xyXG4gICAgICAgICAgICB0aGlzLl9kcmF3TGFiZWxBcmVhKFwic3Ryb2tlXCIsIHBhcmFtKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOeUu+WDj+aPj+eUu1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGRyYXdJbWFnZTogZnVuY3Rpb24oaW1hZ2UsIHgsIHkpIHtcclxuICAgICAgICAgICAgdGhpcy5jb250ZXh0LmRyYXdJbWFnZS5hcHBseSh0aGlzLmNvbnRleHQsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIHJldHVybiA7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB4ID0geCB8fCAwO1xyXG4gICAgICAgICAgICB5ID0geSB8fCAwO1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuZHJhd0ltYWdlKGltYWdlLCB4LCB5KTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIC8vIGN0eC5kcmF3SW1hZ2UodGhpcy5pbWFnZS5jYW52YXMsXHJcbiAgICAgICAgICAgICAgICAvLyAwLCAwLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCxcclxuICAgICAgICAgICAgICAgIC8vIC10aGlzLndpZHRoLzIsIC10aGlzLmhlaWdodC8yLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg4bjgq/jgrnjg4Hjg6Pmj4/nlLtcclxuICAgICAgICAgKi9cclxuICAgICAgICBkcmF3VGV4dHVyZTogZnVuY3Rpb24odGV4dHVyZSwgeCwgeSkge1xyXG4gICAgICAgICAgICBhcmd1bWVudHNbMF0gPSB0ZXh0dXJlLmVsZW1lbnQ7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5kcmF3SW1hZ2UuYXBwbHkodGhpcy5jb250ZXh0LCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg5Pjg4Pjg4jjg57jg4Pjg5fmj4/nlLtcclxuICAgICAgICAgKi9cclxuICAgICAgICBkcmF3Qml0bWFwOiBmdW5jdGlvbihiaXRtYXAsIHgsIHkpIHtcclxuICAgICAgICAgICAgYXJndW1lbnRzWzBdID0gYml0bWFwLmltYWdlRGF0YTtcclxuICAgICAgICAgICAgdGhpcy5jb250ZXh0LnB1dEltYWdlRGF0YS5hcHBseSh0aGlzLmNvbnRleHQsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIGR1bW15XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZHJhd1NjYWxlOUltYWdlOiBmdW5jdGlvbihpbWFnZSwgcmVjdDAsIHJlY3QxKSB7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgbGVmdFdpZHRoICAgPSByZWN0MS54O1xyXG4gICAgICAgICAgICB2YXIgbWlkZGxlV2lkdGggPSByZWN0MS53aWR0aDtcclxuICAgICAgICAgICAgdmFyIHJpZ2h0V2lkdGggID0gaW1hZ2Uud2lkdGggLSAobGVmdFdpZHRoK21pZGRsZVdpZHRoKTtcclxuICAgICAgICAgICAgdmFyIGZpbmFsV2lkdGggID0gcmVjdDAud2lkdGggLSAobGVmdFdpZHRoK3JpZ2h0V2lkdGgpO1xyXG4gICAgICAgICAgICB2YXIgdG9wSGVpZ2h0ICAgPSByZWN0MS55O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gbGVmdCB0b3BcclxuICAgICAgICAgICAgdGhpcy5kcmF3SW1hZ2UoaW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAwLCAwLCBsZWZ0V2lkdGgsIHRvcEhlaWdodCxcclxuICAgICAgICAgICAgICAgIHJlY3QwLngsIHJlY3QwLnksIGxlZnRXaWR0aCwgdG9wSGVpZ2h0KTtcclxuICAgICAgICAgICAgLy8gbWlkZGxlIHRvcFxyXG4gICAgICAgICAgICB0aGlzLmRyYXdJbWFnZShpbWFnZSxcclxuICAgICAgICAgICAgICAgIGxlZnRXaWR0aCwgMCwgbWlkZGxlV2lkdGgsIHRvcEhlaWdodCxcclxuICAgICAgICAgICAgICAgIHJlY3QwLnggKyBsZWZ0V2lkdGgsIHJlY3QwLnksIGZpbmFsV2lkdGgsIHRvcEhlaWdodClcclxuICAgICAgICAgICAgLy8gcmlnaHQgdG9wXHJcbiAgICAgICAgICAgIHRoaXMuZHJhd0ltYWdlKGltYWdlLFxyXG4gICAgICAgICAgICAgICAgbGVmdFdpZHRoK21pZGRsZVdpZHRoLCAwLCByaWdodFdpZHRoLCB0b3BIZWlnaHQsXHJcbiAgICAgICAgICAgICAgICByZWN0MC54ICsgbGVmdFdpZHRoICsgZmluYWxXaWR0aCwgcmVjdDAueSwgcmlnaHRXaWR0aCwgdG9wSGVpZ2h0KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6KGM5YiX44KS44K744OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0VHJhbnNmb3JtOiBmdW5jdGlvbihtMTEsIG0xMiwgbTIxLCBtMjIsIGR4LCBkeSkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuc2V0VHJhbnNmb3JtKG0xMSwgbTEyLCBtMjEsIG0yMiwgZHgsIGR5KTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDooYzliJfjgpLjg6rjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICByZXNldFRyYW5zZm9ybTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0VHJhbnNmb3JtKDEuMCwgMC4wLCAwLjAsIDEuMCwgMC4wLCAwLjApO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOS4reW/g+OBq+enu+WLlVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFRyYW5zZm9ybUNlbnRlcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgdGhpcy53aWR0aC8yLCB0aGlzLmhlaWdodC8yKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDooYzliJfjgpLmjpvjgZHjgotcclxuICAgICAgICAgKi9cclxuICAgICAgICB0cmFuc2Zvcm06IGZ1bmN0aW9uKG0xMSwgbTEyLCBtMjEsIG0yMiwgZHgsIGR5KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC50cmFuc2Zvcm0obTExLCBtMTIsIG0yMSwgbTIyLCBkeCwgZHkpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOS/neWtmFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNhdmU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuc2F2ZSgpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOW+qeWFg1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJlc3RvcmU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQucmVzdG9yZSgpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOenu+WLlVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRyYW5zbGF0ZTogZnVuY3Rpb24oeCwgeSkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQudHJhbnNsYXRlKHgsIHkpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWbnui7olxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJvdGF0ZTogZnVuY3Rpb24ocm90YXRpb24pIHtcclxuICAgICAgICAgICAgdGhpcy5jb250ZXh0LnJvdGF0ZShyb3RhdGlvbik7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44K544Kx44O844OrXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2NhbGU6IGZ1bmN0aW9uKHNjYWxlWCwgc2NhbGVZKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5zY2FsZShzY2FsZVgsIHNjYWxlWSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog55S75YOP44Go44GX44Gm5L+d5a2YXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2F2ZUFzSW1hZ2U6IGZ1bmN0aW9uKG1pbWVfdHlwZSkge1xyXG4gICAgICAgICAgICBtaW1lX3R5cGUgPSBtaW1lX3R5cGUgfHwgdG0uZ3JhcGhpY3MuQ2FudmFzLk1JTUVfVFlQRV9QTkc7XHJcbiAgICAgICAgICAgIHZhciBkYXRhX3VybCA9IHRoaXMuY2FudmFzLnRvRGF0YVVSTChtaW1lX3R5cGUpO1xyXG4gICAgICAgICAgICAvLyBkYXRhX3VybCA9IGRhdGFfdXJsLnJlcGxhY2UobWltZV90eXBlLCBcImltYWdlL29jdGV0LXN0cmVhbVwiKTtcclxuICAgICAgICAgICAgd2luZG93Lm9wZW4oZGF0YV91cmwsIFwic2F2ZVwiKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIHRvRGF0YVVSTCDjgpLkvb/jgYjjgbDkuIvoqJjjga7jgojjgYbjgarjg4Tjg7zjg6vjgYzkvZzjgozjgovjgYvjgoIhIVxyXG4gICAgICAgICAgICAvLyBUT0RPOiDjg5fjg63jgrDjg6njg6DjgafntbXjgpLjgYvjgYTjgabkv53lrZjjgafjgY3jgovjg4Tjg7zjg6tcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgqLjg6vjg5XjgqHjgajjg5bjg6zjg7Pjg4njg6Ljg7zjg4njgpLlkIzmmYLjgrvjg4Pjg4hcclxuICAgICAgICAgKiBUT0RPOiDmnKrlrp/oo4VcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRDb21wb3NpdGluZzogZnVuY3Rpb24oYWxwaGEsIGNvbXBvc2l0ZU9wZXJhdGlvbikge1xyXG4gICAgICAgICAgICAvLyBUT0RPXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5aGX44KK44Gk44G244GX44K544K/44Kk44Or44KS44K744OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0RmlsbFN0eWxlOiBmdW5jdGlvbihzdHlsZSkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gc3R5bGU7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCueODiOODreODvOOCr+OCueOCv+OCpOODq+OCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFN0cm9rZVN0eWxlOiBmdW5jdGlvbihzdHlsZSkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuc3Ryb2tlU3R5bGUgPSBzdHlsZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiA8YSBocmVmPVwiaHR0cDovL3d3dy53My5vcmcvVFIvMjAxMC9XRC0yZGNvbnRleHQtMjAxMDA2MjQvI2NvbG9ycy1hbmQtc3R5bGVzXCI+aHR0cDovL3d3dy53My5vcmcvVFIvMjAxMC9XRC0yZGNvbnRleHQtMjAxMDA2MjQvI2NvbG9ycy1hbmQtc3R5bGVzPC9hPlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldENvbG9yU3R5bGU6IGZ1bmN0aW9uKHN0cm9rZSwgZmlsbCkge1xyXG4gICAgICAgICAgICBmaWxsID0gZmlsbCB8fCBzdHJva2U7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuc3Ryb2tlU3R5bGUgICAgPSBzdHJva2U7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5maWxsU3R5bGUgICAgICA9IGZpbGw7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44OG44Kt44K544OI44KS44K744OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0VGV4dDogZnVuY3Rpb24oZm9udCwgYWxpZ24sIGJhc2VsaW5lKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gdGhpcy5jb250ZXh0O1xyXG4gICAgICAgICAgICBjLmZvbnQgICAgICAgICAgPSBmb250O1xyXG4gICAgICAgICAgICBjLnRleHRBbGlnbiAgICAgPSBhbGlnbjtcclxuICAgICAgICAgICAgYy50ZXh0QmFzZWxpbmUgID0gYmFzZWxpbmU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg6njgqTjg7Pjgrnjgr/jgqTjg6vjgpLkuIDmi6zjgrvjg4Pjg4hcclxuICAgICAgICAgKiA8YSBocmVmPVwiaHR0cDovL3d3dy53My5vcmcvVFIvMjAxMC9XRC0yZGNvbnRleHQtMjAxMDA2MjQvI2xpbmUtc3R5bGVzXCI+aHR0cDovL3d3dy53My5vcmcvVFIvMjAxMC9XRC0yZGNvbnRleHQtMjAxMDA2MjQvI2xpbmUtc3R5bGVzPC9hPlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldExpbmVTdHlsZTogZnVuY3Rpb24od2lkdGgsIGNhcCwgam9pbiwgbWl0ZXIpIHtcclxuICAgICAgICAgICAgd2l0aCh0aGlzLmNvbnRleHQpIHtcclxuICAgICAgICAgICAgICAgIGxpbmVXaWR0aCAgID0gd2lkdGggfHwgMTtcclxuICAgICAgICAgICAgICAgIGxpbmVDYXAgICAgID0gY2FwICAgfHwgXCJyb3VuZFwiO1xyXG4gICAgICAgICAgICAgICAgbGluZUpvaW4gICAgPSBqb2luICB8fCBcInJvdW5kXCI7XHJcbiAgICAgICAgICAgICAgICBtaXRlckxpbWl0ICA9IG1pdGVyIHx8IDEwLjA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlvbHjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKiAtIDxodHRwOi8vd3d3Lmh0bWw1LmpwL2NhbnZhcy9yZWYvcHJvcGVydHkvc2hhZG93Q29sb3IuaHRtbD5cclxuICAgICAgICAgKiAtIDxodHRwOi8vd3d3LnczLm9yZy9UUi8yMDEwL1dELTJkY29udGV4dC0yMDEwMDYyNC8jc2hhZG93cz5cclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRTaGFkb3c6IGZ1bmN0aW9uKGNvbG9yLCBvZmZzZXRYLCBvZmZzZXRZLCBibHVyKSB7XHJcbiAgICAgICAgICAgIHZhciBjdHggPSB0aGlzLmNvbnRleHQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjdHguc2hhZG93Q29sb3IgICAgID0gY29sb3IgICAgIHx8IFwiYmxhY2tcIjtcclxuICAgICAgICAgICAgY3R4LnNoYWRvd09mZnNldFggICA9IG9mZnNldFggICB8fCAwO1xyXG4gICAgICAgICAgICBjdHguc2hhZG93T2Zmc2V0WSAgID0gb2Zmc2V0WSAgIHx8IDA7XHJcbiAgICAgICAgICAgIGN0eC5zaGFkb3dCbHVyICAgICAgPSBibHVyICAgICAgfHwgMDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Ko44Os44Oh44Oz44OI5Y+W5b6XXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0RWxlbWVudDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQ7XHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKiogQHN0YXRpYyBAcHJvcGVydHkgKi9cclxuICAgIHRtLmdyYXBoaWNzLkNhbnZhcy5NSU1FX1RZUEVfUE5HID0gXCJpbWFnZS9wbmdcIjtcclxuICAgIC8qKiBAc3RhdGljIEBwcm9wZXJ0eSAqL1xyXG4gICAgdG0uZ3JhcGhpY3MuQ2FudmFzLk1JTUVfVFlQRV9KUEcgPSBcImltYWdlL2pwZWdcIjtcclxuICAgIC8qKiBAc3RhdGljIEBwcm9wZXJ0eSAqL1xyXG4gICAgdG0uZ3JhcGhpY3MuQ2FudmFzLk1JTUVfVFlQRV9TVkcgPSBcImltYWdlL3N2Zyt4bWxcIjtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgd2lkdGhcclxuICAgICAqIOW5hVxyXG4gICAgICovXHJcbiAgICB0bS5ncmFwaGljcy5DYW52YXMucHJvdG90eXBlLmFjY2Vzc29yKFwid2lkdGhcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLmNhbnZhcy53aWR0aDsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLmNhbnZhcy53aWR0aCA9IHY7IH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBoZWlnaHRcclxuICAgICAqIOmrmOOBlVxyXG4gICAgICovXHJcbiAgICB0bS5ncmFwaGljcy5DYW52YXMucHJvdG90eXBlLmFjY2Vzc29yKFwiaGVpZ2h0XCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5jYW52YXMuaGVpZ2h0OyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMuY2FudmFzLmhlaWdodCA9IHY7ICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGZpbGxTdHlsZVxyXG4gICAgICog5aGX44KK44Gk44G244GX44K544K/44Kk44OrXHJcbiAgICAgKi9cclxuICAgIHRtLmdyYXBoaWNzLkNhbnZhcy5wcm90b3R5cGUuYWNjZXNzb3IoXCJmaWxsU3R5bGVcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLmNvbnRleHQuZmlsbFN0eWxlOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSB2OyAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIHN0cm9rZVN0eWxlXHJcbiAgICAgKiDjgrnjg4jjg63jg7zjgq/jgrnjgr/jgqTjg6tcclxuICAgICAqL1xyXG4gICAgdG0uZ3JhcGhpY3MuQ2FudmFzLnByb3RvdHlwZS5hY2Nlc3NvcihcInN0cm9rZVN0eWxlXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5jb250ZXh0LnN0cm9rZVN0eWxlOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMuY29udGV4dC5zdHJva2VTdHlsZSA9IHY7ICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgZ2xvYmFsQWxwaGFcclxuICAgICAqIOOCouODq+ODleOCoeaMh+WumlxyXG4gICAgICovXHJcbiAgICB0bS5ncmFwaGljcy5DYW52YXMucHJvdG90eXBlLmFjY2Vzc29yKFwiZ2xvYmFsQWxwaGFcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLmNvbnRleHQuZ2xvYmFsQWxwaGE7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5jb250ZXh0Lmdsb2JhbEFscGhhID0gdjsgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBnbG9iYWxDb21wb3NpdGVPcGVyYXRpb25cclxuICAgICAqIOODluODrOODs+ODieaMh+WumlxyXG4gICAgICovXHJcbiAgICB0bS5ncmFwaGljcy5DYW52YXMucHJvdG90eXBlLmFjY2Vzc29yKFwiZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5jb250ZXh0Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbjsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLmNvbnRleHQuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gdjsgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBzaGFkb3dCbHVyXHJcbiAgICAgKiDjgrfjg6Pjg4njgqbjg5bjg6njg7xcclxuICAgICAqL1xyXG4gICAgdG0uZ3JhcGhpY3MuQ2FudmFzLnByb3RvdHlwZS5hY2Nlc3NvcihcInNoYWRvd0JsdXJcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLmNvbnRleHQuc2hhZG93Qmx1cjsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLmNvbnRleHQuc2hhZG93Qmx1ciA9IHY7ICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBzaGFkb3dDb2xvclxyXG4gICAgICog44K344Oj44OJ44Km44OW44Op44O844Kr44Op44O8XHJcbiAgICAgKi9cclxuICAgIHRtLmdyYXBoaWNzLkNhbnZhcy5wcm90b3R5cGUuYWNjZXNzb3IoXCJzaGFkb3dDb2xvclwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMuY29udGV4dC5zaGFkb3dDb2xvcjsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLmNvbnRleHQuc2hhZG93Q29sb3IgPSB2OyAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgc2hhZG93T2Zmc2V0WFxyXG4gICAgICog44K344Oj44OJ44Km44Kq44OV44K744OD44OIIFggXHJcbiAgICAgKi9cclxuICAgIHRtLmdyYXBoaWNzLkNhbnZhcy5wcm90b3R5cGUuYWNjZXNzb3IoXCJzaGFkb3dPZmZzZXRYXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5jb250ZXh0LnNoYWRvd09mZnNldFg7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5jb250ZXh0LnNoYWRvd09mZnNldFggPSB2OyAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgc2hhZG93T2Zmc2V0WVxyXG4gICAgICog44K344Oj44OJ44Km44Kq44OV44K744OD44OIIFlcclxuICAgICAqL1xyXG4gICAgdG0uZ3JhcGhpY3MuQ2FudmFzLnByb3RvdHlwZS5hY2Nlc3NvcihcInNoYWRvd09mZnNldFlcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLmNvbnRleHQuc2hhZG93T2Zmc2V0WTsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLmNvbnRleHQuc2hhZG93T2Zmc2V0WSA9IHY7ICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGxpbmVDYXBcclxuICAgICAqIOODqeOCpOODs+e1guerr+OBruaPj+eUu+aWueazlVxyXG4gICAgICovXHJcbiAgICB0bS5ncmFwaGljcy5DYW52YXMucHJvdG90eXBlLmFjY2Vzc29yKFwibGluZUNhcFwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMuY29udGV4dC5saW5lQ2FwOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMuY29udGV4dC5saW5lQ2FwID0gdjsgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgbGluZUpvaW5cclxuICAgICAqIOODqeOCpOODs+OBpOOBquOBjuebruOBruaPj+eUu+aWueazlVxyXG4gICAgICovXHJcbiAgICB0bS5ncmFwaGljcy5DYW52YXMucHJvdG90eXBlLmFjY2Vzc29yKFwibGluZUpvaW5cIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLmNvbnRleHQubGluZUpvaW47IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5jb250ZXh0LmxpbmVKb2luID0gdjsgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgbWl0ZXJMaW1pdFxyXG4gICAgICog44Oe44Kk44K/44O844Oq44Of44OD44OIXHJcbiAgICAgKi9cclxuICAgIHRtLmdyYXBoaWNzLkNhbnZhcy5wcm90b3R5cGUuYWNjZXNzb3IoXCJtaXRlckxpbWl0XCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5jb250ZXh0Lm1pdGVyTGltaXQ7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5jb250ZXh0Lm1pdGVyTGltaXQgPSB2OyAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBsaW5lV2lkdGhcclxuICAgICAqIOODqeOCpOODs+W5heioreWumlxyXG4gICAgICovXHJcbiAgICB0bS5ncmFwaGljcy5DYW52YXMucHJvdG90eXBlLmFjY2Vzc29yKFwibGluZVdpZHRoXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5jb250ZXh0LmxpbmVXaWR0aDsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLmNvbnRleHQubGluZVdpZHRoID0gdjsgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgZm9udFxyXG4gICAgICog44OV44Kp44Oz44OIXHJcbiAgICAgKi9cclxuICAgIHRtLmdyYXBoaWNzLkNhbnZhcy5wcm90b3R5cGUuYWNjZXNzb3IoXCJmb250XCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5jb250ZXh0LmZvbnQ7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5jb250ZXh0LmZvbnQgPSB2OyAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICB0ZXh0QWxpZ25cclxuICAgICAqIOODhuOCreOCueODiOOBruOCouODqeOCpOODs+ODoeODs+ODiFxyXG4gICAgICovXHJcbiAgICB0bS5ncmFwaGljcy5DYW52YXMucHJvdG90eXBlLmFjY2Vzc29yKFwidGV4dEFsaWduXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5jb250ZXh0LnRleHRBbGlnbjsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLmNvbnRleHQudGV4dEFsaWduID0gdjsgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgdGV4dEJhc2VsaW5lXHJcbiAgICAgKiDjg4bjgq3jgrnjg4jjga7jg5njg7zjgrnjg6njgqTjg7NcclxuICAgICAqL1xyXG4gICAgdG0uZ3JhcGhpY3MuQ2FudmFzLnByb3RvdHlwZS5hY2Nlc3NvcihcInRleHRCYXNlbGluZVwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMuY29udGV4dC50ZXh0QmFzZWxpbmU7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5jb250ZXh0LnRleHRCYXNlbGluZSA9IHY7ICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGNlbnRlclhcclxuICAgICAqIOOCu+ODs+OCv+ODvFhcclxuICAgICAqL1xyXG4gICAgdG0uZ3JhcGhpY3MuQ2FudmFzLnByb3RvdHlwZS5nZXR0ZXIoXCJjZW50ZXJYXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNhbnZhcy53aWR0aC8yO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGNlbnRlcllcclxuICAgICAqIOOCu+ODs+OCv+ODvFlcclxuICAgICAqL1xyXG4gICAgdG0uZ3JhcGhpY3MuQ2FudmFzLnByb3RvdHlwZS5nZXR0ZXIoXCJjZW50ZXJZXCIsIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2FudmFzLmhlaWdodC8yO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgaW1hZ2VTbW9vdGhpbmdFbmFibGVkXHJcbiAgICAgKiDnlLvlg4/jgrnjg6Djg7zjgrjjg7PjgrDoqK3lrppcclxuICAgICAqL1xyXG4gICAgdG0uZ3JhcGhpY3MuQ2FudmFzLnByb3RvdHlwZS5hY2Nlc3NvcihcImltYWdlU21vb3RoaW5nRW5hYmxlZFwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuaW1hZ2VTbW9vdGhpbmdFbmFibGVkO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuaW1hZ2VTbW9vdGhpbmdFbmFibGVkID0gdjtcclxuICAgICAgICAgICAgdGhpcy5jb250ZXh0LndlYmtpdEltYWdlU21vb3RoaW5nRW5hYmxlZCA9IHY7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5tb3pJbWFnZVNtb290aGluZ0VuYWJsZWQgPSB2O1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuXHJcblxyXG4vKlxyXG4gKiBiaXRtYXAuanNcclxuICovXHJcblxyXG50bS5ncmFwaGljcyA9IHRtLmdyYXBoaWNzIHx8IHt9O1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5ncmFwaGljcy5CaXRtYXBcclxuICAgICAqIOODk+ODg+ODiOODnuODg+ODl+OCr+ODqeOCuVxyXG4gICAgICovXHJcbiAgICB0bS5ncmFwaGljcy5CaXRtYXAgPSB0bS5jcmVhdGVDbGFzcyh7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqIOOCpOODoeODvOOCuOODh+ODvOOCvyAqL1xyXG4gICAgICAgIGltYWdlRGF0YTogbnVsbCxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihpbWFnZURhdGEpIHtcclxuICAgICAgICAgICAgaWYgKCFkdW1teUNhbnZhcykge1xyXG4gICAgICAgICAgICAgICAgZHVtbXlDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xyXG4gICAgICAgICAgICAgICAgZHVtbXlDb250ZXh0PSBkdW1teUNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5faW5pdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICB0aGlzLmluaXQgPSB0aGlzLl9pbml0O1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX2luaXQ6IGZ1bmN0aW9uKGltYWdlRGF0YSkge1xyXG4gICAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmltYWdlRGF0YSA9IGltYWdlRGF0YTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YSA9IGltYWdlRGF0YS5kYXRhO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMikge1xyXG4gICAgICAgICAgICAgICAgdmFyIHcgPSBhcmd1bWVudHNbMF07XHJcbiAgICAgICAgICAgICAgICB2YXIgaCA9IGFyZ3VtZW50c1sxXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW1hZ2VEYXRhID0gZHVtbXlDb250ZXh0LmNyZWF0ZUltYWdlRGF0YSh3LCBoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YSA9IHRoaXMuaW1hZ2VEYXRhLmRhdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIGluZGV4IOaMh+WumuOBp+ODlOOCr+OCu+ODq+WApOOCkuWPluW+l1xyXG4gICAgICAgICAqIOacgOOCgumrmOmAn1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldFBpeGVsSW5kZXg6IGZ1bmN0aW9uKGluZGV4KSB7XHJcbiAgICAgICAgICAgIHZhciBpID0gaW5kZXgqNDtcclxuICAgICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YVtpKzBdLFxyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhW2krMV0sXHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFbaSsyXSxcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YVtpKzNdXHJcbiAgICAgICAgICAgIF07XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiB4LCB5IOaMh+WumuOBp+ODlOOCr+OCu+ODq+WApOOCkuWPluW+l1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldFBpeGVsWFk6IGZ1bmN0aW9uKHgsIHkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UGl4ZWxJbmRleCggdGhpcy5wb3NUb0luZGV4KHgsIHkpICk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg5Tjgq/jgrvjg6vlgKTjgpLlj5blvpdcclxuICAgICAgICAgKiAjIyMgTWVtb1xyXG4gICAgICAgICAqIC0gaW5kZXgg5oyH5a6a44GLIHgsIHkg5oyH5a6a44Gr44GZ44KL44GL5qSc6KiO5LitXHJcbiAgICAgICAgICogLSDphY3liJfjgafov5TjgZnjgYvmlbDlgKTjgafov5TjgZnjgYvmpJzoqI7kuK0uIOmAn+W6puOBruaXqeOBhOOChOOBpOOCkuaOoeeUqOOBmeOCi1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldFBpeGVsOiBmdW5jdGlvbih4LCB5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFBpeGVsSW5kZXgoIHRoaXMucG9zVG9JbmRleCh4LCB5KSApO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODlOOCr+OCu+ODq+OCkuaVsOWApOOBqOOBl+OBpuOCsuODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldFBpeGVsQXNOdW1iZXI6IGZ1bmN0aW9uKGluZGV4KSB7XHJcbiAgICAgICAgICAgIHZhciBpID0gaW5kZXgqNDtcclxuICAgICAgICAgICAgcmV0dXJuICh0aGlzLmRhdGFbaSszXSA8PCAyNCkgfCAodGhpcy5kYXRhW2krMF0gPDwgMTYpIHwgKHRoaXMuZGF0YVtpKzFdIDw8IDgpIHwgdGhpcy5kYXRhW2krMl07XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44OU44Kv44K744Or44KS44Kq44OW44K444Kn44Kv44OI44Go44GX44Gm44Ky44OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0UGl4ZWxBc09iamVjdDogZnVuY3Rpb24oaW5kZXgpIHtcclxuICAgICAgICAgICAgdmFyIGkgPSBpbmRleCo0O1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcjogdGhpcy5kYXRhW2krMF0sXHJcbiAgICAgICAgICAgICAgICBnOiB0aGlzLmRhdGFbaSsxXSxcclxuICAgICAgICAgICAgICAgIGI6IHRoaXMuZGF0YVtpKzJdLFxyXG4gICAgICAgICAgICAgICAgYTogdGhpcy5kYXRhW2krM11cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg5Tjgq/jgrvjg6vjgpLphY3liJfjgajjgZfjgabjgrLjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRQaXhlbEFzQXJyYXk6IGZ1bmN0aW9uKGluZGV4KSB7XHJcbiAgICAgICAgICAgIHZhciBpID0gaW5kZXgqNDtcclxuICAgICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YVtpKzBdLFxyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhW2krMV0sXHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFbaSsyXSxcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YVtpKzNdXHJcbiAgICAgICAgICAgIF07XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmjIflrprjgZfjgZ/nr4Tlm7LlhoXjga7jg5Tjgq/jgrvjg6vlubPlnYflgKTjgpLlj5blvpdcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRQaXhlbEF2ZXJhZ2U6IGZ1bmN0aW9uKHgsIHksIHdpZHRoLCBoZWlnaHQpIHtcclxuICAgICAgICAgICAgdmFyIHJnYmEgPSBbMCwgMCwgMCwgMF07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDnr4Tlm7JcclxuICAgICAgICAgICAgdmFyIGwgPSB4O1xyXG4gICAgICAgICAgICB2YXIgciA9IHgrd2lkdGg7XHJcbiAgICAgICAgICAgIHZhciB0ID0geTtcclxuICAgICAgICAgICAgdmFyIGIgPSB5K2hlaWdodDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIOODj+ODn+WHuuOBl+iqv+aVtFxyXG4gICAgICAgICAgICBpZiAobCA8IDApIHsgbCA9IDA7IH1cclxuICAgICAgICAgICAgaWYgKHIgPiB0aGlzLndpZHRoKSB7IHIgPSB0aGlzLndpZHRoOyB9XHJcbiAgICAgICAgICAgIGlmICh0IDwgMCkgeyB0ID0gMDsgfVxyXG4gICAgICAgICAgICBpZiAoYiA+IHRoaXMuaGVpZ2h0KSB7IGIgPSB0aGlzLmhlaWdodDsgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8g56+E5Zuy5YaF44Gu44OU44Kv44K744Or5YWo44Gm44KS5Y+W5b6XXHJcbiAgICAgICAgICAgIHZhciB0ZW1wID0gW107XHJcbiAgICAgICAgICAgIHZhciBiaXRtYXBXaWR0aCA9IHRoaXMud2lkdGg7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGk9dDsgaTxiOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGo9bDsgajxyOyArK2opIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBiaXRtYXBXaWR0aCppICsgajtcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wLnB1c2goIHRoaXMuZ2V0UGl4ZWxJbmRleChpbmRleCkgKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyB0ZW1wLnB1c2goIHRoaXMuZ2V0UGl4ZWxYWShqLCBpKSApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDlubPlnYfjgpLmsYLjgoHjgotcclxuICAgICAgICAgICAgdmFyIGxlbiA9IGxlbj10ZW1wLmxlbmd0aDtcclxuICAgICAgICAgICAgZm9yICh2YXIgaT0wOyBpPGxlbjsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICByZ2JhWzBdICs9IHRlbXBbaV1bMF07XHJcbiAgICAgICAgICAgICAgICByZ2JhWzFdICs9IHRlbXBbaV1bMV07XHJcbiAgICAgICAgICAgICAgICByZ2JhWzJdICs9IHRlbXBbaV1bMl07XHJcbiAgICAgICAgICAgICAgICByZ2JhWzNdICs9IHRlbXBbaV1bM107XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJnYmFbMF0vPWxlbjtcclxuICAgICAgICAgICAgcmdiYVsxXS89bGVuO1xyXG4gICAgICAgICAgICByZ2JhWzJdLz1sZW47XHJcbiAgICAgICAgICAgIHJnYmFbM10vPWxlbjtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiByZ2JhO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogaW5kZXgg5oyH5a6a44Gn44OU44Kv44K744Or5YCk44KS44K744OD44OIXHJcbiAgICAgICAgICog5pyA44KC6auY6YCfXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0UGl4ZWxJbmRleDogZnVuY3Rpb24oaW5kZXgsIHIsIGcsIGIpIHtcclxuICAgICAgICAgICAgdmFyIGkgPSBpbmRleCo0O1xyXG4gICAgICAgICAgICB0aGlzLmRhdGFbaSswXSA9IHI7XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YVtpKzFdID0gZztcclxuICAgICAgICAgICAgdGhpcy5kYXRhW2krMl0gPSBiO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIHgsIHnmjIflrprjgafjg5Tjgq/jgrvjg6vlgKTjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRQaXhlbFhZOiBmdW5jdGlvbih4LCB5LCByLCBnLCBiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldFBpeGVsSW5kZXgoeSp0aGlzLmltYWdlRGF0YS53aWR0aCt4LCByLCBnLCBiKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODlOOCr+OCu+ODq+WApOOCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFBpeGVsOiBmdW5jdGlvbihpbmRleCwgciwgZywgYikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRQaXhlbEluZGV4KHkqdGhpcy5pbWFnZURhdGEud2lkdGgreCwgciwgZywgYik7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogMzJiaXQg44K744OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0UGl4ZWwzMkluZGV4OiBmdW5jdGlvbihpbmRleCwgciwgZywgYiwgYSkge1xyXG4gICAgICAgICAgICB2YXIgaSA9IGluZGV4KjQ7XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YVtpKzBdID0gcjtcclxuICAgICAgICAgICAgdGhpcy5kYXRhW2krMV0gPSBnO1xyXG4gICAgICAgICAgICB0aGlzLmRhdGFbaSsyXSA9IGI7XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YVtpKzNdID0gYTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogMzJiaXQg44K744OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0UGl4ZWwzMjogZnVuY3Rpb24oeCwgeSwgciwgZywgYiwgYSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRQaXhlbDMySW5kZXgoeSp0aGlzLndpZHRoK3gsIHIsIGcsIGIsIGEpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIDMyYml0IOOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFBpeGVsMzJYWTogZnVuY3Rpb24oeCwgeSwgciwgZywgYiwgYSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRQaXhlbDMySW5kZXgoeSp0aGlzLndpZHRoK3gsIHIsIGcsIGIsIGEpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOmFjeWIl+OBi+OCieODlOOCr+OCu+ODq+OCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFBpeGVsRnJvbUFycmF5OiBmdW5jdGlvbihpbmRleCwgcGl4ZWwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0UGl4ZWwoaW5kZXgsIHBpeGVsWzBdLCBwaXhlbFsxXSwgcGl4ZWxbMl0pO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOmFjeWIl+OBi+OCieODlOOCr+OCu+ODq+OCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFBpeGVsMzJGcm9tQXJyYXk6IGZ1bmN0aW9uKGluZGV4LCBwaXhlbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRQaXhlbDMyKGluZGV4LCBwaXhlbFswXSwgcGl4ZWxbMV0sIHBpeGVsWzJdLCBwaXhlbFszXSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogYXJnYlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFBpeGVsRnJvbU51bWJlcjogZnVuY3Rpb24oaW5kZXgsIHBpeGVsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldFBpeGVsKGluZGV4LCAocGl4ZWwgJiAweDAwZmYwMDAwKT4+PjE2LCAocGl4ZWwgJiAweDAwMDBmZjAwKT4+PjgsIChwaXhlbCAmIDB4MDAwMDAwZmYpPj4+MCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogYXJnYlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFBpeGVsMzJGcm9tTnVtYmVyOiBmdW5jdGlvbihpbmRleCwgcGl4ZWwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0UGl4ZWwzMihpbmRleCwgKHBpeGVsICYgMHgwMGZmMDAwMCk+Pj4xNiwgKHBpeGVsICYgMHgwMDAwZmYwMCk+Pj44LCAocGl4ZWwgJiAweDAwMDAwMGZmKT4+PjAsIChwaXhlbCAmIDB4ZmYwMDAwMDApPj4+MjQpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogb2JqZWN0XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0UGl4ZWxGcm9tT2JqZWN0OiBmdW5jdGlvbihpbmRleCwgcGl4ZWwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0UGl4ZWwocGl4ZWwuciwgcGl4ZWwuZywgcGl4ZWwuYik7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgqrjg5bjgrjjgqfjgq/jg4jjgYvjgonjg5Tjgq/jgrvjg6vjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRQaXhlbDMyRnJvbU9iamVjdDogZnVuY3Rpb24oaW5kZXgsIHBpeGVsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldFBpeGVsMzIocGl4ZWwuciwgcGl4ZWwuZywgcGl4ZWwuYiwgcGl4ZWwuYSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBzdHJpbmdcclxuICAgICAgICAgKiByZ2IsIGhzbCwgIy4uLiAjLi4uLi4uIOOBquOBqeOBq+WvvuW/nOS6iOWumlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFBpeGVsRnJvbVN0cmluZzogZnVuY3Rpb24oaW5kZXgsIHBpeGVsKSB7XHJcbiAgICAgICAgICAgIC8vIFRPRE9cclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOS9jee9ruOCkuOCpOODs+ODh+ODg+OCr+OCueOBq+WkieaPm1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHBvc1RvSW5kZXg6IGZ1bmN0aW9uKHgsIHkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHkqdGhpcy5pbWFnZURhdGEud2lkdGggKyB4O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44OV44Kj44Or44K/44O8XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZmlsdGVyOiBmdW5jdGlvbihmaWx0ZXIpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaT0wOyBpPHRoaXMuaGVpZ2h0OyArK2kpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGo9MDsgajx0aGlzLndpZHRoOyArK2opIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSB0aGlzLnBvc1RvSW5kZXgoaiwgaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSB0aGlzLmdldFBpeGVsKGosIGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGZpbHRlci5jYWxjKHAsIGluZGV4LCBqLCBpLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg47jgqTjgrpcclxuICAgICAgICAgKi9cclxuICAgICAgICBub2lzZTogZnVuY3Rpb24obG93LCBoaWdoKSB7XHJcbiAgICAgICAgICAgIGxvdyA9IGxvdyAgfHwgMDtcclxuICAgICAgICAgICAgaGlnaD0gaGlnaCB8fCAyNTU7XHJcbiAgICAgICAgICAgIHJhbmdlPSBoaWdoLWxvdztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGZvciAodmFyIGk9MCxsZW49dGhpcy5sZW5ndGg7IGk8bGVuOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwID0gdGhpcy5nZXRQaXhlbEluZGV4KGkpO1xyXG4gICAgICAgICAgICAgICAgcFswXSA9IE1hdGgucmFuZG9tKCkqcmFuZ2UgKyBsb3c7XHJcbiAgICAgICAgICAgICAgICBwWzFdID0gTWF0aC5yYW5kb20oKSpyYW5nZSArIGxvdztcclxuICAgICAgICAgICAgICAgIHBbMl0gPSBNYXRoLnJhbmRvbSgpKnJhbmdlICsgbG93O1xyXG4gICAgICAgICAgICAgICAgcFszXSA9IDI1NTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0UGl4ZWwzMkluZGV4KGksIHBbMF0sIHBbMV0sIHBbMl0sIHBbM10pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44OV44Kj44Or44K/44KS6YGp5b+c44GZ44KLXHJcbiAgICAgICAgICogVE9ETzog5pyq5a6f6KOFXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgYXBwbHlGaWx0ZXI6IGZ1bmN0aW9uKGZpbHRlcikge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKiBAcHJvcGVydHkgd2lkdGggIOW5hSAqL1xyXG4gICAgdG0uZ3JhcGhpY3MuQml0bWFwLnByb3RvdHlwZS5hY2Nlc3NvcihcIndpZHRoXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5pbWFnZURhdGEud2lkdGg7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5pbWFnZURhdGEud2lkdGggPSB2OyAgICB9XHJcbiAgICB9KTtcclxuICAgIC8qKiBAcHJvcGVydHkgaGVpZ2h0ICDpq5jjgZUgKi9cclxuICAgIHRtLmdyYXBoaWNzLkJpdG1hcC5wcm90b3R5cGUuYWNjZXNzb3IoXCJoZWlnaHRcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLmltYWdlRGF0YS5oZWlnaHQ7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5pbWFnZURhdGEuaGVpZ2h0ID0gdjsgICAgfVxyXG4gICAgfSk7XHJcbiAgICAvKiogQHByb3BlcnR5IGxlbmd0aCAqL1xyXG4gICAgdG0uZ3JhcGhpY3MuQml0bWFwLnByb3RvdHlwZS5nZXR0ZXIoXCJsZW5ndGhcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW1hZ2VEYXRhLndpZHRoKnRoaXMuaW1hZ2VEYXRhLmhlaWdodDtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1lbWJlciB0bS5ncmFwaGljcy5DYW52YXNcclxuICAgICAqIOODk+ODg+ODiOODnuODg+ODl+WPluW+l1xyXG4gICAgICovXHJcbiAgICB0bS5ncmFwaGljcy5DYW52YXMucHJvdG90eXBlLmdldEJpdG1hcCA9IGZ1bmN0aW9uKHgsIHksIHdpZHRoLCBoZWlnaHQpIHtcclxuICAgICAgICByZXR1cm4gdG0uZ3JhcGhpY3MuQml0bWFwKHRoaXMuY29udGV4dC5nZXRJbWFnZURhdGEoeHx8MCwgeXx8MCwgd2lkdGh8fHRoaXMud2lkdGgsIGhlaWdodHx8dGhpcy5oZWlnaHQpKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1lbWJlciB0bS5ncmFwaGljcy5DYW52YXNcclxuICAgICAqIOODk+ODg+ODiOODnuODg+ODl+eUn+aIkFxyXG4gICAgICovXHJcbiAgICB0bS5ncmFwaGljcy5DYW52YXMucHJvdG90eXBlLmNyZWF0ZUJpdG1hcCA9IGZ1bmN0aW9uKHdpZHRoLCBoZWlnaHQpIHtcclxuICAgICAgICByZXR1cm4gdG0uZ3JhcGhpY3MuQml0bWFwKHRoaXMuY29udGV4dC5jcmVhdGVJbWFnZURhdGEod2lkdGh8fHRoaXMud2lkdGgsIGhlaWdodHx8dGhpcy5oZWlnaHQpKTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWVtYmVyIHRtLmFzc2V0LlRleHR1cmVcclxuICAgICAqIOODk+ODg+ODiOODnuODg+ODl+eUn+aIkFxyXG4gICAgICovXHJcbiAgICB0bS5hc3NldC5UZXh0dXJlLnByb3RvdHlwZS5nZXRCaXRtYXAgPSBmdW5jdGlvbih4LCB5LCB3aWR0aCwgaGVpZ2h0KSB7XHJcbiAgICAgICAgdmFyIGNhbnZhcyA9IHRtLmdyYXBoaWNzLkNhbnZhcygpO1xyXG4gICAgICAgIGNhbnZhcy5yZXNpemUodGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xyXG4gICAgICAgIGNhbnZhcy5kcmF3VGV4dHVyZSh0aGlzLCAwLCAwLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XHJcbiAgICAgICAgcmV0dXJuIGNhbnZhcy5nZXRCaXRtYXAoeCwgeSwgd2lkdGgsIGhlaWdodCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBkdW1teUNhbnZhcyA9IG51bGw7XHJcbiAgICB2YXIgZHVtbXlDb250ZXh0ID0gbnVsbDtcclxufSkoKTtcclxuXHJcblxyXG4vKlxyXG4gKiBmaWx0ZXIuanNcclxuICovXHJcblxyXG50bS5ncmFwaGljcyA9IHRtLmdyYXBoaWNzIHx8IHt9O1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5ncmFwaGljcy5Nb25vY2hyb21lRmlsdGVyXHJcbiAgICAgKiDjg6Ljg47jgq/jg63jg5XjgqPjg6vjgr9cclxuICAgICAqL1xyXG4gICAgdG0uZ3JhcGhpY3MuTW9ub2Nocm9tZUZpbHRlciA9IHRtLmNyZWF0ZUNsYXNzKHtcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbigpIHt9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIGFwcGx5XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgYXBwbHk6IGZ1bmN0aW9uKHNyYywgZHN0KSB7XHJcbiAgICAgICAgICAgIHZhciBsZW4gPSBzcmMubGVuZ3RoO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpPTA7IGk8bGVuOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwID0gc3JjLmdldFBpeGVsSW5kZXgoaSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZ3JheXNjYWxlID0gcFswXSowLjMgKyBwWzFdKjAuNTkgKyBwWzJdKjAuMTE7XHJcbiAgICAgICAgICAgICAgICBkc3Quc2V0UGl4ZWwzMkluZGV4KGksIGdyYXlzY2FsZSwgZ3JheXNjYWxlLCBncmF5c2NhbGUsIHBbM10pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gZHN0O1xyXG4gICAgICAgIH0sXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLmdyYXBoaWNzLlJldmVyc2VGaWx0ZXJcclxuICAgICAqIOODquODkOODvOOCueODleOCo+ODq+OCv1xyXG4gICAgICovXHJcbiAgICB0bS5ncmFwaGljcy5SZXZlcnNlRmlsdGVyID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKCkge30sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogYXBwbHlcclxuICAgICAgICAgKi9cclxuICAgICAgICBhcHBseTogZnVuY3Rpb24oc3JjLCBkc3QpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaT0wLGxlbj1zcmMud2lkdGgqc3JjLmhlaWdodDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHAgPSBzcmMuZ2V0UGl4ZWxJbmRleChpKTtcclxuICAgICAgICAgICAgICAgIHBbMF0gPSAyNTUtcFswXTtcclxuICAgICAgICAgICAgICAgIHBbMV0gPSAyNTUtcFsxXTtcclxuICAgICAgICAgICAgICAgIHBbMl0gPSAyNTUtcFsyXTtcclxuICAgICAgICAgICAgICAgIGRzdC5zZXRQaXhlbDMySW5kZXgoaSwgcFswXSwgcFsxXSwgcFsyXSwgMjU1KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIGRzdDtcclxuICAgICAgICB9LFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIFxyXG59KSgpO1xyXG5cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZ3JhcGhpY3MuQmx1ckZpbHRlclxyXG4gICAgICog44OW44Op44O844OV44Kj44Or44K/XHJcbiAgICAgKiBcclxuICAgICAqICMjIyBSZWZlcmVuY2VcclxuICAgICAqIC0gPGh0dHA6Ly93d3c0MC5hdHdpa2kuanAvc3BlbGxib3VuZC9wYWdlcy8xNTMuaHRtbD5cclxuICAgICAqIC0gPGh0dHA6Ly93d3cuZmxvdGhlci5jb20vYmxvZy8yMDEwL2ltYWdlLWJsdXItaHRtbDUtY2FudmFzLz5cclxuICAgICAqL1xyXG4gICAgdG0uZ3JhcGhpY3MuQmx1ckZpbHRlciA9IHRtLmNyZWF0ZUNsYXNzKHtcclxuXHJcbiAgICAgICAgLyoqIEBwcm9wZXJ0eSBibHVyWCAqL1xyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgYmx1clkgKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5IHF1YWxpdHkgKi9cclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihibHVyWCwgYmx1clksIHF1YWxpdHkpIHtcclxuICAgICAgICAgICAgdGhpcy5ibHVyWCAgICAgID0gYmx1clggfHwgNDtcclxuICAgICAgICAgICAgdGhpcy5ibHVyWSAgICAgID0gYmx1clkgfHwgNDtcclxuICAgICAgICAgICAgdGhpcy5xdWFsaXR5ICAgID0gcXVhbGl0eSB8fCAxO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogYXBwbHlcclxuICAgICAgICAgKi9cclxuICAgICAgICBhcHBseTogZnVuY3Rpb24oc3JjLCBkc3QpIHtcclxuICAgICAgICAgICAgdmFyIGhhbGZYICAgICAgID0gTWF0aC5mbG9vcih0aGlzLmJsdXJYLzIpO1xyXG4gICAgICAgICAgICB2YXIgaGFsZlkgICAgICAgPSBNYXRoLmZsb29yKHRoaXMuYmx1clkvMik7XHJcbiAgICAgICAgICAgIHZhciByYW5nZVggICAgICA9IHRoaXMuYmx1clg7XHJcbiAgICAgICAgICAgIHZhciByYW5nZVkgICAgICA9IHRoaXMuYmx1clk7XHJcbiAgICAgICAgICAgIHZhciBzcmNXaWR0aCAgICA9IHNyYy53aWR0aDtcclxuICAgICAgICAgICAgdmFyIHNyY0hlaWdodCAgID0gc3JjLmhlaWdodDtcclxuICAgICAgICAgICAgdmFyIGxlbiAgICAgICAgID0gc3JjLmxlbmd0aDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIOODluODqeODvOWHpueQhlxyXG4gICAgICAgICAgICB2YXIgX2FwcGx5ID0gZnVuY3Rpb24oc3JjLCBkc3QpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGk9MDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB4ID0gaSVzcmNXaWR0aDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IoaS9zcmNXaWR0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSBzcmMuZ2V0UGl4ZWxBdmVyYWdlKHgtaGFsZlgsIHktaGFsZlksIHJhbmdlWCwgcmFuZ2VZKTtcclxuICAgICAgICAgICAgICAgICAgICBkc3Quc2V0UGl4ZWwzMkluZGV4KGksIHBbMF0sIHBbMV0sIHBbMl0sIDI1NSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBxdWFsaXR5IOOBruWbnuaVsOOBoOOBkeODluODqeODvOOCkuOBi+OBkeOCi1xyXG4gICAgICAgICAgICB2YXIgdGVtcERzdCAgICAgPSBzcmM7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGk9MDsgaTx0aGlzLnF1YWxpdHk7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgc3JjID0gdGVtcERzdDtcclxuICAgICAgICAgICAgICAgIHRlbXBEc3QgPSB0bS5ncmFwaGljcy5CaXRtYXAoc3JjV2lkdGgsIHNyY0hlaWdodCk7XHJcbiAgICAgICAgICAgICAgICBfYXBwbHkoc3JjLCB0ZW1wRHN0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8g57WQ5p6c44Gr5Luj5YWlXHJcbiAgICAgICAgICAgIC8vPyDjg6Hjg6Ljg6rjg6rjg7zjgq/jgajjgYvlpKfkuIjlpKvjgarjga7jgYvjgapcclxuICAgICAgICAgICAgZHN0LmltYWdlRGF0YSA9IHRlbXBEc3QuaW1hZ2VEYXRhO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIGRzdDtcclxuICAgICAgICB9LFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIFxyXG59KSgpO1xyXG5cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLy8g44OI44Kl44O844Oz44OG44O844OW44OrXHJcbiAgICB2YXIgZGVmYXVsdFRvb25UYWJsZSA9IFtdO1xyXG4gICAgZm9yKHZhciBpPTA7IGk8MjU1OyArK2kpIHtcclxuICAgICAgICB2YXIgbj0wO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICAgICAgKGk8MTAwKSB7IG4gPSAgNjA7IH1cclxuICAgICAgICBlbHNlIGlmIChpPDE1MCkgeyBuID0gMTUwOyB9XHJcbiAgICAgICAgZWxzZSBpZiAoaTwxODApIHsgbiA9IDE4MDsgfVxyXG4gICAgICAgIGVsc2UgICAgICAgICAgICB7IG4gPSAyMjA7IH1cclxuICAgICAgICBcclxuICAgICAgICBkZWZhdWx0VG9vblRhYmxlW2ldID0gbjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZ3JhcGhpY3MuVG9vbkZpbHRlclxyXG4gICAgICog44OI44Kl44O844Oz44OV44Kj44Or44K/XHJcbiAgICAgKi9cclxuICAgIHRtLmdyYXBoaWNzLlRvb25GaWx0ZXIgPSB0bS5jcmVhdGVDbGFzcyh7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqIOODiOOCpeODvOODs+ODhuODvOODluODqyAqL1xyXG4gICAgICAgIHRvb25UYWJsZTogbnVsbCxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbih0b29uVGFibGUpIHtcclxuICAgICAgICAgICAgdGhpcy50b29uVGFibGUgPSB0b29uVGFibGUgfHwgZGVmYXVsdFRvb25UYWJsZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIGFwcGx5XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgYXBwbHk6IGZ1bmN0aW9uKHNyYywgZHN0KSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGk9MCxsZW49c3JjLndpZHRoKnNyYy5oZWlnaHQ7IGk8bGVuOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwaXhlbCA9IHNyYy5nZXRQaXhlbEluZGV4KGkpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHIgPSB0aGlzLnRvb25UYWJsZVsgcGl4ZWxbMF0gXTtcclxuICAgICAgICAgICAgICAgIHZhciBnID0gdGhpcy50b29uVGFibGVbIHBpeGVsWzFdIF07XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMudG9vblRhYmxlWyBwaXhlbFsyXSBdO1xyXG4gICAgICAgICAgICAgICAgZHN0LnNldFBpeGVsMzJJbmRleChpLCByLCBnLCBiLCAyNTUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gZHN0O1xyXG4gICAgICAgIH0sXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZ3JhcGhpY3MuQ29sb3JNYXRyaXhGaWx0ZXJcclxuICAgICAqIOOCq+ODqeODvOODnuODiOODquODg+OCr+OCueODleOCo+ODq+OCv1xyXG4gICAgICogXHJcbiAgICAgKiAjIyMgUmVmZXJlbmNlXHJcbiAgICAgKiAtIDxodHRwOi8vYmxvZy5ib3JlYWwta2lzcy5jb20vMjAwOC8wNC8wODExMzExMy5odG1sLz5cclxuICAgICAqIC0gPGh0dHA6Ly92b2dsaWEuanAvMjAxMC8wMS8yNi8yNjA+XHJcbiAgICAgKiAtIDxodHRwOi8vaGFrdWhpbi5qcC9hcy9jb2xvci5odG1sI0NPTE9SXzAyPlxyXG4gICAgICogLSA8aHR0cDovL2QuaGF0ZW5hLm5lLmpwL3VtZXpvLzIwMDkwMTIyLzEyMzI2Mjc2OTQ+XHJcbiAgICAgKiAtIDxodHRwOi8vd3d3NDAuYXR3aWtpLmpwL3NwZWxsYm91bmQvcGFnZXMvMTg4Lmh0bWw+XHJcbiAgICAgKi9cclxuICAgIHRtLmdyYXBoaWNzLkNvbG9yTWF0cml4RmlsdGVyID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgY29sb3JNYXRyaXggKi9cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oY29sb3JNYXRyaXgpIHtcclxuICAgICAgICAgICAgdGhpcy5jb2xvck1hdHJpeCA9IGNvbG9yTWF0cml4O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByb3BlcnR5XHJcbiAgICAgICAgICogYXBwbHlcclxuICAgICAgICAgKi9cclxuICAgICAgICBhcHBseTogZnVuY3Rpb24oc3JjLCBkc3QpIHtcclxuICAgICAgICAgICAgdmFyIGNtID0gdGhpcy5jb2xvck1hdHJpeDtcclxuICAgICAgICAgICAgZm9yICh2YXIgaT0wLGxlbj1zcmMubGVuZ3RoOyBpPGxlbjsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGl4ZWwgPSBzcmMuZ2V0UGl4ZWxJbmRleChpKTtcclxuICAgICAgICAgICAgICAgIHZhciByID0gKHBpeGVsWzBdICogY21bMF0pICsgKHBpeGVsWzFdICogY21bMV0pICsgKHBpeGVsWzJdICogY21bMl0pICsgKHBpeGVsWzNdICogY21bM10pICsgY21bNF07XHJcbiAgICAgICAgICAgICAgICB2YXIgZyA9IChwaXhlbFswXSAqIGNtWzVdKSArIChwaXhlbFsxXSAqIGNtWzZdKSArIChwaXhlbFsyXSAqIGNtWzddKSArIChwaXhlbFszXSAqIGNtWzhdKSArIGNtWzldO1xyXG4gICAgICAgICAgICAgICAgdmFyIGIgPSAocGl4ZWxbMF0gKiBjbVsxMF0pICsgKHBpeGVsWzFdICogY21bMTFdKSArIChwaXhlbFsyXSAqIGNtWzEyXSkgKyAocGl4ZWxbM10gKiBjbVsxM10pICsgY21bMTRdO1xyXG4gICAgICAgICAgICAgICAgdmFyIGEgPSAocGl4ZWxbMF0gKiBjbVsxNV0pICsgKHBpeGVsWzFdICogY21bMTZdKSArIChwaXhlbFsyXSAqIGNtWzE3XSkgKyAocGl4ZWxbM10gKiBjbVsxOF0pICsgY21bMTldO1xyXG4gICAgICAgICAgICAgICAgZHN0LnNldFBpeGVsMzJJbmRleChpLCByLCBnLCBiLCBhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIGRzdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICB9KTtcclxuICAgIFxyXG59KSgpO1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4vKlxyXG4gKiBncmFkaWVudC5qc1xyXG4gKi9cclxuXHJcbnRtLmdyYXBoaWNzID0gdG0uZ3JhcGhpY3MgfHwge307XHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIHRtLmdyYXBoaWNzLkNhbnZhcy5wcm90b3R5cGUuc2V0R3JhZGllbnQgPSBmdW5jdGlvbihncmFkaWVudCkge1xyXG4gICAgICAgIHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSBncmFkaWVudC5ncmFkaWVudDtcclxuICAgIH07XHJcbiAgICBcclxufSkoKTtcclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZ3JhcGhpY3MuTGluZWFyR3JhZGllbnRcclxuICAgICAqIOe3muW9ouOCsOODqeODh+ODvOOCt+ODp+ODs1xyXG4gICAgICovXHJcbiAgICB0bS5ncmFwaGljcy5MaW5lYXJHcmFkaWVudCA9IHRtLmNyZWF0ZUNsYXNzKHtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oeCwgeSwgd2lkdGgsIGhlaWdodCkge1xyXG4gICAgICAgICAgICBpZiAoIWR1bW15Q2FudmFzKSB7XHJcbiAgICAgICAgICAgICAgICBkdW1teUNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XHJcbiAgICAgICAgICAgICAgICBkdW1teUNvbnRleHQ9IGR1bW15Q2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLl9pbml0KHgsIHksIHdpZHRoLCBoZWlnaHQpO1xyXG4gICAgICAgICAgICB0aGlzLmluaXQgPSB0aGlzLl9pbml0O1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX2luaXQ6IGZ1bmN0aW9uKHgsIHksIHdpZHRoLCBoZWlnaHQpIHtcclxuICAgICAgICAgICAgdGhpcy5ncmFkaWVudCA9IGR1bW15Q29udGV4dC5jcmVhdGVMaW5lYXJHcmFkaWVudCh4LCB5LCB3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgqvjg6njg7zngrnjgpLov73liqBcclxuICAgICAgICAgKi9cclxuICAgICAgICBhZGRDb2xvclN0b3A6IGZ1bmN0aW9uKG9mZnNldCwgY29sb3IpIHtcclxuICAgICAgICAgICAgdGhpcy5ncmFkaWVudC5hZGRDb2xvclN0b3Aob2Zmc2V0LCBjb2xvcik7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCq+ODqeODvOeCueOCkuODquOCueODiOOBp+i/veWKoFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGFkZENvbG9yU3RvcExpc3Q6IGZ1bmN0aW9uKHByb3ApIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaT0wLGxlbj1wcm9wLmxlbmd0aDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCAgPSBwcm9wW2ldLm9mZnNldDtcclxuICAgICAgICAgICAgICAgIHZhciBjb2xvciAgID0gcHJvcFtpXS5jb2xvcjtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRkQ29sb3JTdG9wKG9mZnNldCwgY29sb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCueOCv+OCpOODq+WMllxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRvU3R5bGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ncmFkaWVudDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgfSk7XHJcblxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5ncmFwaGljcy5SYWRpYWxHcmFkaWVudFxyXG4gICAgICog5YaG5b2i44Kw44Op44OH44O844K344On44OzXHJcbiAgICAgKi9cclxuICAgIHRtLmdyYXBoaWNzLlJhZGlhbEdyYWRpZW50ID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi8gICAgICAgIFxyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKHgwLCB5MCwgcjAsIHgxLCB5MSwgcjEpIHtcclxuICAgICAgICAgICAgaWYgKCFkdW1teUNhbnZhcykge1xyXG4gICAgICAgICAgICAgICAgZHVtbXlDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xyXG4gICAgICAgICAgICAgICAgZHVtbXlDb250ZXh0PSBkdW1teUNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5faW5pdCh4MCwgeTAsIHIwLCB4MSwgeTEsIHIxKTtcclxuICAgICAgICAgICAgdGhpcy5pbml0ID0gdGhpcy5faW5pdDtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9pbml0OiBmdW5jdGlvbih4MCwgeTAsIHIwLCB4MSwgeTEsIHIxKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ3JhZGllbnQgPSBkdW1teUNvbnRleHQuY3JlYXRlUmFkaWFsR3JhZGllbnQoeDAsIHkwLCByMCwgeDEsIHkxLCByMSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgqvjg6njg7zngrnjgpLov73liqBcclxuICAgICAgICAgKi9cclxuICAgICAgICBhZGRDb2xvclN0b3A6IGZ1bmN0aW9uKG9mZnNldCwgY29sb3IpIHtcclxuICAgICAgICAgICAgdGhpcy5ncmFkaWVudC5hZGRDb2xvclN0b3Aob2Zmc2V0LCBjb2xvcik7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCq+ODqeODvOeCueOCkuODquOCueODiOOBp+i/veWKoFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGFkZENvbG9yU3RvcExpc3Q6IGZ1bmN0aW9uKHByb3ApIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaT0wLGxlbj1wcm9wLmxlbmd0aDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCAgPSBwcm9wW2ldLm9mZnNldDtcclxuICAgICAgICAgICAgICAgIHZhciBjb2xvciAgID0gcHJvcFtpXS5jb2xvcjtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRkQ29sb3JTdG9wKG9mZnNldCwgY29sb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCueOCv+OCpOODq+WMllxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRvU3R5bGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ncmFkaWVudDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIGR1bW15Q2FudmFzID0gbnVsbDtcclxuICAgIHZhciBkdW1teUNvbnRleHQgPSBudWxsO1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4vKlxyXG4gKiB0d2Vlbi5qc1xyXG4gKi9cclxuXHJcbnRtLmFuaW0gPSB0bS5hbmltIHx8IHt9O1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLmFuaW0uVHdlZW5cclxuICAgICAqIFR3ZWVuIOOCr+ODqeOCuVxyXG4gICAgICogQGV4dGVuZHMgdG0uZXZlbnQuRXZlbnREaXNwYXRjaGVyXHJcbiAgICAgKi9cclxuICAgIHRtLmFuaW0uVHdlZW4gPSB0bS5jcmVhdGVDbGFzcyh7XHJcbiAgICAgICAgXHJcbiAgICAgICAgc3VwZXJDbGFzczogdG0uZXZlbnQuRXZlbnREaXNwYXRjaGVyLFxyXG5cclxuICAgICAgICAvKiog44Ki44OL44Oh44O844K344On44Oz44GV44Gb44KL5a++6LGhICAqL1xyXG4gICAgICAgIHRhcmdldCAgICAgIDogbnVsbCxcclxuICAgICAgICAvKiog44Ki44OL44Oh44O844K344On44Oz44Gu5pmC6ZaTICAqL1xyXG4gICAgICAgIHRpbWUgICAgICAgIDogbnVsbCxcclxuICAgICAgICAvKiog44OX44Ot44OR44OG44KjIOacquS9v+eUqO+8nyAgKi9cclxuICAgICAgICBwcm9wICAgICAgICA6IG51bGwsXHJcbiAgICAgICAgLyoqIOePvuWcqOOBruODl+ODreODkeODhuOCoyAgKi9cclxuICAgICAgICBub3dQcm9wcyAgICA6IG51bGwsXHJcbiAgICAgICAgLyoqIOacquS9v+eUqCAgKi9cclxuICAgICAgICBub3cgICAgICAgICA6IG51bGwsXHJcbiAgICAgICAgLyoqIOacquS9v+eUqCAgKi9cclxuICAgICAgICBiZWdpbiAgICAgICA6IG51bGwsXHJcbiAgICAgICAgLyoqIOacquS9v+eUqCAgKi9cclxuICAgICAgICBmaW5pc2ggICAgICA6IG51bGwsXHJcbiAgICAgICAgLyoqIOOCouODi+ODoeODvOOCt+ODp+ODs+OBq+OBi+OBkeOCi+aZgumWkyAgKi9cclxuICAgICAgICBkdXJhdGlvbiAgICA6IG51bGwsXHJcbiAgICAgICAgLyoqIOODq+ODvOODl+OBmeOCi+OBi+OBqeOBhuOBiyAgKi9cclxuICAgICAgICBpc0xvb3BpbmcgICA6IG51bGwsXHJcbiAgICAgICAgLyoqIOOCouODi+ODoeODvOOCt+ODp+ODs+S4reOBi+OBqeOBhuOBiyAgKi9cclxuICAgICAgICBpc1BsYXlpbmcgICA6IG51bGwsXHJcbiAgICAgICAgLyoqIOOCouODi+ODoeODvOOCt+ODp+ODs+Wun+ihjOmWouaVsCAgKi9cclxuICAgICAgICBmdW5jICAgICAgICA6IE1hdGgubGluZWFyLFxyXG4gICAgICAgIC8qKiDjg5Xjg6zjg7zjg6Djg6zjg7zjg4ggICovXHJcbiAgICAgICAgZnBzICAgICAgICAgOiAzMCxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gdGFyZ2V0XHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGZpbmlzaFByb3BzXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGR1cmF0aW9uXHJcbiAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuY1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKHRhcmdldCwgZmluaXNoUHJvcHMsIGR1cmF0aW9uLCBmdW5jKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3VwZXJJbml0KCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLnRpbWUgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLm5vd1Byb3BzID0ge307XHJcbiAgICAgICAgICAgIHRoaXMuaXNQbGF5aW5nID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudG8uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaMh+WumuOBl+OBn+WApOOBvuOBp+OCouODi+ODoeODvOOCt+ODp+ODs1xyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gZmluaXNoUHJvcHNcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gZHVyYXRpb25cclxuICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdG86IGZ1bmN0aW9uKHRhcmdldCwgZmluaXNoUHJvcHMsIGR1cmF0aW9uLCBmdW5jKSB7XHJcbiAgICAgICAgICAgIHZhciBiZWdpblByb3BzID0ge307XHJcblxyXG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gZmluaXNoUHJvcHMpIHtcclxuICAgICAgICAgICAgICAgIGJlZ2luUHJvcHNba2V5XSA9IHRhcmdldFtrZXldO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLmZyb21Ubyh0YXJnZXQsIGJlZ2luUHJvcHMsIGZpbmlzaFByb3BzLCBkdXJhdGlvbiwgZnVuYyk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmjIflrprjgZfjgZ/lgKTjgpLotrPjgZfjgZ/lgKTjgb7jgafjgqLjg4vjg6Hjg7zjgrfjg6fjg7NcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gdGFyZ2V0XHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHByb3BzXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGR1cmF0aW9uXHJcbiAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuY1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGJ5OiBmdW5jdGlvbih0YXJnZXQsIHByb3BzLCBkdXJhdGlvbiwgZnVuYykge1xyXG4gICAgICAgICAgICB2YXIgYmVnaW5Qcm9wcyA9IHt9O1xyXG4gICAgICAgICAgICB2YXIgZmluaXNoUHJvcHMgPSB7fTtcclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBwcm9wcykge1xyXG4gICAgICAgICAgICAgICAgYmVnaW5Qcm9wc1trZXldID0gdGFyZ2V0W2tleV07XHJcbiAgICAgICAgICAgICAgICBmaW5pc2hQcm9wc1trZXldID0gdGFyZ2V0W2tleV0gKyBwcm9wc1trZXldO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLmZyb21Ubyh0YXJnZXQsIGJlZ2luUHJvcHMsIGZpbmlzaFByb3BzLCBkdXJhdGlvbiwgZnVuYyk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDplovlp4vjga7lgKTjgYvjgonntYLkuobjga7lgKTjgb7jgafjgqLjg4vjg6Hjg7zjgrfjg6fjg7NcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gdGFyZ2V0XHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGJlZ2luUHJvcHNcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gZmluaXNoUHJvcHNcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gZHVyYXRpb25cclxuICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnJvbVRvOiBmdW5jdGlvbih0YXJnZXQsIGJlZ2luUHJvcHMsIGZpbmlzaFByb3BzLCBkdXJhdGlvbiwgZnVuYykge1xyXG4gICAgICAgICAgICB0aGlzLnRhcmdldCA9IHRhcmdldDtcclxuICAgICAgICAgICAgdGhpcy5iZWdpblByb3BzICA9IGJlZ2luUHJvcHM7XHJcbiAgICAgICAgICAgIHRoaXMuZmluaXNoUHJvcHMgPSBmaW5pc2hQcm9wcztcclxuICAgICAgICAgICAgdGhpcy5kdXJhdGlvbiA9IGR1cmF0aW9uO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gc2V0dXBcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VQcm9wcyA9IHt9O1xyXG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gYmVnaW5Qcm9wcykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VQcm9wc1trZXldID0gZmluaXNoUHJvcHNba2V5XSAtIGJlZ2luUHJvcHNba2V5XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnNldFRyYW5zaXRpb24oZnVuYyk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBmcm9tXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHRhcmdldFxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBiZWdpblByb3BzXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGR1cmF0aW9uXHJcbiAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuY1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZyb206IGZ1bmN0aW9uKHRhcmdldCwgYmVnaW5Qcm9wcywgZHVyYXRpb24sIGZ1bmMpIHtcclxuICAgICAgICAgICAgdmFyIGZpbmlzaFByb3BzID0ge307XHJcblxyXG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gYmVnaW5Qcm9wcykge1xyXG4gICAgICAgICAgICAgICAgZmluaXNoUHJvcHNba2V5XSA9IHRhcmdldFtrZXldO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLmZyb21Ubyh0YXJnZXQsIGJlZ2luUHJvcHMsIGZpbmlzaFByb3BzLCBkdXJhdGlvbiwgZnVuYyk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIGVhc2luZ+OBruaMh+WumuOBi+OAgeOCs+ODvOODq+ODkOODg+OCr+OBruaMh+WumuOBi+iqv+OBueOCi1xyXG4gICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmNcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRUcmFuc2l0aW9uOiBmdW5jdGlvbihmdW5jKSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZnVuYyA9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZ1bmMgPSBmdW5jO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBmdW5jID09ICdzdHJpbmcnKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuZnVuYyA9IHRtLmFuaW0uZWFzaW5nW2Z1bmNdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mdW5jID0gdG0uYW5pbS5lYXNpbmdbXCJkZWZhdWx0XCJdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Ki44OL44Oh44O844K344On44Oz44Gu5YaN6ZaLXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcmVzdW1lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl9yZXN1bWVUaW1lKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVRpbWUoKTtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KHRtLmV2ZW50LlR3ZWVuRXZlbnQoXCJyZXN1bWVcIiwgdGhpcy50aW1lLCB0aGlzLm5vd1Byb3BzKSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgqLjg4vjg6Hjg7zjgrfjg6fjg7Pjga7plovlp4tcclxuICAgICAgICAgKi9cclxuICAgICAgICBzdGFydDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNQbGF5aW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5fc3RhcnRUaW1lKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVRpbWUoKTtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KHRtLmV2ZW50LlR3ZWVuRXZlbnQoXCJzdGFydFwiLCB0aGlzLnRpbWUsIHRoaXMubm93UHJvcHMpKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCouODi+ODoeODvOOCt+ODp+ODs+OBruOCueODiOODg+ODl1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHN0b3A6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmlzUGxheWluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQodG0uZXZlbnQuVHdlZW5FdmVudChcInN0b3BcIiwgdGhpcy50aW1lLCB0aGlzLm5vd1Byb3BzKSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDplovlp4vkvY3nva7jgb7jgafmiLvjgotcclxuICAgICAgICAgKi9cclxuICAgICAgICByZXdpbmQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLnRpbWUgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZSgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5pyA5b6M5L2N572u44G+44Gn5pep6YCB44KKXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZmZvcndhcmQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLnRpbWUgPSB0aGlzLmR1cmF0aW9uO1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZSgpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKiAgICAgICAgXHJcbiAgICAgICAgICog44Oo44O844Oo44O844Gu44Ki44OL44Oh44O844K344On44OzXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgeW95bzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciB0ZW1wID0gdGhpcy5maW5pc2hQcm9wcztcclxuICAgICAgICAgICAgdGhpcy5maW5pc2hQcm9wcyA9IHRoaXMuYmVnaW5Qcm9wcztcclxuICAgICAgICAgICAgdGhpcy5iZWdpblByb3BzICA9IHRlbXA7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLmJlZ2luUHJvcHMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlUHJvcHNba2V5XSA9IHRoaXMuZmluaXNoUHJvcHNba2V5XSAtIHRoaXMuYmVnaW5Qcm9wc1trZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuc3RhcnQoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOabtOaWsFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHVwZGF0ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLmNoYW5nZVByb3BzKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vd1Byb3BzW2tleV0gPSB0aGlzLmZ1bmModGhpcy50aW1lLCB0aGlzLmJlZ2luUHJvcHNba2V5XSwgdGhpcy5jaGFuZ2VQcm9wc1trZXldLCB0aGlzLmR1cmF0aW9uKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudGFyZ2V0W2tleV0gPSB0aGlzLm5vd1Byb3BzW2tleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KHRtLmV2ZW50LlR3ZWVuRXZlbnQoXCJjaGFuZ2VcIiwgdGhpcy50aW1lLCB0aGlzLm5vd1Byb3BzKSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmmYLplpPjgpLlt7vjgY3miLvjgZlcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9yZXN1bWVUaW1lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5zdGFydFRpbWUgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpIC0gdGhpcy50aW1lO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44K544K/44O844OI5pmC6ZaT44KS6Kit5a6aXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfc3RhcnRUaW1lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5zdGFydFRpbWUgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5pmC6ZaT44KS6YCy44KB44KLXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfdXBkYXRlVGltZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzUGxheWluZykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2V0VGltZSgobmV3IERhdGUoKSkuZ2V0VGltZSgpIC0gdGhpcy5zdGFydFRpbWUpO1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChhcmd1bWVudHMuY2FsbGVlLmJpbmQodGhpcyksIDEwMDAvdGhpcy5mcHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmmYLplpPjgpLoqK3lrprjgZnjgotcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gdFxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3NldFRpbWU6IGZ1bmN0aW9uKHQpIHtcclxuICAgICAgICAgICAgdmFyIHRpbWUgPSB0O1xyXG4gICAgICAgICAgICAvLyDjg6Ljg7zjgrfjg6fjg7PntYLkuoZcclxuICAgICAgICAgICAgaWYgKHRpbWUgPiB0aGlzLmR1cmF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDjg6vjg7zjg5dcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzTG9vcGluZykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmV3aW5kKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5bqn5qiZ44KS5pu05pawXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDjgqTjg5njg7Pjg4jplovlp4tcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQodG0uZXZlbnQuVHdlZW5FdmVudChcImxvb3BcIiwgdGhpcy50aW1lLCB0aGlzLm5vd1Byb3BzKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyDntYLkuoZcclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGltZSA9IHRoaXMuZHVyYXRpb247XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5bqn5qiZ44KS5pu05pawXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDlgZzmraJcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3AoKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDjgqTjg5njg7Pjg4hcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQodG0uZXZlbnQuVHdlZW5FdmVudChcImZpbmlzaFwiLCB0aGlzLnRpbWUsIHRoaXMubm93UHJvcHMpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDmm7TmlrBcclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpbWUgPSB0aW1lO1xyXG4gICAgICAgICAgICAgICAgLy8g5bqn5qiZ44KS5pu05pawXHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn0pKCk7XHJcblxyXG5cclxuLypcclxuICogZWFzaW5nXHJcbiAqL1xyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLmFuaW0uZWFzaW5nXHJcbiAgICAgKiDjgqTjg7zjgrjjg7PjgrBcclxuICAgICAqICMjIyBSZWZlcmVuY2VcclxuICAgICAqIC0gPGh0dHA6Ly9jb2RlcmVwb3Mub3JnL3NoYXJlL3dpa2kvSlNUd2VlbmVyPlxyXG4gICAgICogLSA8aHR0cDovL2NvZGVyZXBvcy5vcmcvc2hhcmUvYnJvd3Nlci9sYW5nL2phdmFzY3JpcHQvanN0d2VlbmVyL3RydW5rL3NyYy9KU1R3ZWVuZXIuanM+XHJcbiAgICAgKiAtIDxodHRwOi8vZ3NnZC5jby51ay9zYW5kYm94L2pxdWVyeS9lYXNpbmcvanF1ZXJ5LmVhc2luZy4xLjMuanM+XHJcbiAgICAgKiAtIDxodHRwOi8vaG9zdGVkLnplaC5jb20uYnIvdHdlZW5lci9kb2NzL2VuLXVzL21pc2MvdHJhbnNpdGlvbnMuaHRtbD5cclxuICAgICAqL1xyXG4gICAgdG0uYW5pbS5lYXNpbmcgPSB7XHJcbiAgICAgICAgLyoqIGRlZmF1bHQgKi9cclxuICAgICAgICBcImRlZmF1bHRcIjogZnVuY3Rpb24odCwgYiwgYywgZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYyp0L2QgKyBiO1xyXG4gICAgICAgIH0sICAgICAgICBcclxuICAgICAgICAvKiogbGluZWFyICovXHJcbiAgICAgICAgbGluZWFyOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjKnQvZCArIGI7XHJcbiAgICAgICAgfSwgICAgICAgIFxyXG4gICAgICAgIC8qKiBzd2luZyAqL1xyXG4gICAgICAgIHN3aW5nOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAtYyAqKHQvPWQpKih0LTIpICsgYjtcclxuICAgICAgICB9LCAgICAgICAgXHJcbiAgICAgICAgLyoqIGVhc2VJblF1YWQgKi9cclxuICAgICAgICBlYXNlSW5RdWFkOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjKih0Lz1kKSp0ICsgYjtcclxuICAgICAgICB9LCAgICAgICAgXHJcbiAgICAgICAgLyoqIGVhc2VPdXRRdWFkICovXHJcbiAgICAgICAgZWFzZU91dFF1YWQ6IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIC1jICoodC89ZCkqKHQtMikgKyBiO1xyXG4gICAgICAgIH0sICAgICAgICBcclxuICAgICAgICAvKiogZWFzZUluT3V0UXVhZCAqL1xyXG4gICAgICAgIGVhc2VJbk91dFF1YWQ6IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcclxuICAgICAgICAgICAgaWYoKHQvPWQvMikgPCAxKSByZXR1cm4gYy8yKnQqdCArIGI7XHJcbiAgICAgICAgICAgIHJldHVybiAtYy8yICooKC0tdCkqKHQtMikgLSAxKSArIGI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKiogZGVmZUluQ3ViaWMgKi9cclxuICAgICAgICBlYXNlSW5DdWJpYzogZnVuY3Rpb24odCwgYiwgYywgZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYyoodC89ZCkqdCp0ICsgYjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKiBlYXNlT3V0Q3ViaWMgKi9cclxuICAgICAgICBlYXNlT3V0Q3ViaWM6IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGMqKCh0PXQvZC0xKSp0KnQgKyAxKSArIGI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKiogZWFzZUluT3V0Q3ViaWMgKi9cclxuICAgICAgICBlYXNlSW5PdXRDdWJpYzogZnVuY3Rpb24odCwgYiwgYywgZCkge1xyXG4gICAgICAgICAgICBpZigodC89ZC8yKSA8IDEpIHJldHVybiBjLzIqdCp0KnQgKyBiO1xyXG4gICAgICAgICAgICByZXR1cm4gYy8yKigodC09MikqdCp0ICsgMikgKyBiO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqIGVhc2VPdXRJbkN1YmljICovXHJcbiAgICAgICAgZWFzZU91dEluQ3ViaWM6IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcclxuICAgICAgICAgICAgaWYodCA8IGQvMikgcmV0dXJuIHRtLmFuaW0uZWFzaW5nLmVhc2VPdXRDdWJpYyh0KjIsIGIsIGMvMiwgZCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0bS5hbmltLmVhc2luZy5lYXNlSW5DdWJpYygodCoyKS1kLCBiK2MvMiwgYy8yLCBkKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKiBlYXNlSW5RdWFydCAqL1xyXG4gICAgICAgIGVhc2VJblF1YXJ0OiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjKih0Lz1kKSp0KnQqdCArIGI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKiogZWFzZU91dFF1YXJ0ICovXHJcbiAgICAgICAgZWFzZU91dFF1YXJ0OiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAtYyAqKCh0PXQvZC0xKSp0KnQqdCAtIDEpICsgYjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKiBlYXNlSW5PdXRRdWFydCAqL1xyXG4gICAgICAgIGVhc2VJbk91dFF1YXJ0OiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XHJcbiAgICAgICAgICAgIGlmKCh0Lz1kLzIpIDwgMSkgcmV0dXJuIGMvMip0KnQqdCp0ICsgYjtcclxuICAgICAgICAgICAgcmV0dXJuIC1jLzIgKigodC09MikqdCp0KnQgLSAyKSArIGI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKiogZWFzZU91dEluUXVhcnQgKi9cclxuICAgICAgICBlYXNlT3V0SW5RdWFydDogZnVuY3Rpb24odCwgYiwgYywgZCkge1xyXG4gICAgICAgICAgICBpZih0IDwgZC8yKSByZXR1cm4gdG0uYW5pbS5lYXNpbmcuZWFzZU91dFF1YXJ0KHQqMiwgYiwgYy8yLCBkKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRtLmFuaW0uZWFzaW5nLmVhc2VJblF1YXJ0KCh0KjIpLWQsIGIrYy8yLCBjLzIsIGQpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqIGVhc2VJblF1aW50ICovXHJcbiAgICAgICAgZWFzZUluUXVpbnQ6IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGMqKHQvPWQpKnQqdCp0KnQgKyBiO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqIGVhc2VPdXRRdWludCAqL1xyXG4gICAgICAgIGVhc2VPdXRRdWludDogZnVuY3Rpb24odCwgYiwgYywgZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYyooKHQ9dC9kLTEpKnQqdCp0KnQgKyAxKSArIGI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKiogZWFzZUluT3V0UXVpbnQgKi9cclxuICAgICAgICBlYXNlSW5PdXRRdWludDogZnVuY3Rpb24odCwgYiwgYywgZCkge1xyXG4gICAgICAgICAgICBpZigodC89ZC8yKSA8IDEpIHJldHVybiBjLzIqdCp0KnQqdCp0ICsgYjtcclxuICAgICAgICAgICAgcmV0dXJuIGMvMiooKHQtPTIpKnQqdCp0KnQgKyAyKSArIGI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKiogZWFzZU91dEluUXVpbnQgKi9cclxuICAgICAgICBlYXNlT3V0SW5RdWludDogZnVuY3Rpb24odCwgYiwgYywgZCkge1xyXG4gICAgICAgICAgICBpZih0IDwgZC8yKSByZXR1cm4gdG0uYW5pbS5lYXNpbmcuZWFzZU91dFF1aW50KHQqMiwgYiwgYy8yLCBkKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRtLmFuaW0uZWFzaW5nLmVhc2VJblF1aW50KCh0KjIpLWQsIGIrYy8yLCBjLzIsIGQpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqIGVhc2VJblNpbmUgKi9cclxuICAgICAgICBlYXNlSW5TaW5lOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAtYyAqIE1hdGguY29zKHQvZCAqKE1hdGguUEkvMikpICsgYyArIGI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKiogZWFzZU91dFNpbmUgKi9cclxuICAgICAgICBlYXNlT3V0U2luZTogZnVuY3Rpb24odCwgYiwgYywgZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYyAqIE1hdGguc2luKHQvZCAqKE1hdGguUEkvMikpICsgYjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKiBlYXNlSW5PdXRTaW5lICovXHJcbiAgICAgICAgZWFzZUluT3V0U2luZTogZnVuY3Rpb24odCwgYiwgYywgZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gLWMvMiAqKE1hdGguY29zKE1hdGguUEkqdC9kKSAtIDEpICsgYjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKiBlYXNlT3V0SW5TaW5lICovXHJcbiAgICAgICAgZWFzZU91dEluU2luZTogZnVuY3Rpb24odCwgYiwgYywgZCkge1xyXG4gICAgICAgICAgICBpZih0IDwgZC8yKSByZXR1cm4gdG0uYW5pbS5lYXNpbmcuZWFzZU91dFNpbmUodCoyLCBiLCBjLzIsIGQpO1xyXG4gICAgICAgICAgICByZXR1cm4gdG0uYW5pbS5lYXNpbmcuZWFzZUluU2luZSgodCoyKS1kLCBiK2MvMiwgYy8yLCBkKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKiBlYXNlSW5FeHBvICovXHJcbiAgICAgICAgZWFzZUluRXhwbzogZnVuY3Rpb24odCwgYiwgYywgZCkge1xyXG4gICAgICAgICAgICByZXR1cm4odD09MCkgPyBiIDogYyAqIE1hdGgucG93KDIsIDEwICoodC9kIC0gMSkpICsgYiAtIGMgKiAwLjAwMTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKiBlYXNlT3V0RXhwbyAqL1xyXG4gICAgICAgIGVhc2VPdXRFeHBvOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XHJcbiAgICAgICAgICAgIHJldHVybih0PT1kKSA/IGIrYyA6IGMgKiAxLjAwMSAqKC1NYXRoLnBvdygyLCAtMTAgKiB0L2QpICsgMSkgKyBiO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqIGVhc2VJbk91dEV4cG8gKi9cclxuICAgICAgICBlYXNlSW5PdXRFeHBvOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XHJcbiAgICAgICAgICAgIGlmKHQ9PTApIHJldHVybiBiO1xyXG4gICAgICAgICAgICBpZih0PT1kKSByZXR1cm4gYitjO1xyXG4gICAgICAgICAgICBpZigodC89ZC8yKSA8IDEpIHJldHVybiBjLzIgKiBNYXRoLnBvdygyLCAxMCAqKHQgLSAxKSkgKyBiIC0gYyAqIDAuMDAwNTtcclxuICAgICAgICAgICAgcmV0dXJuIGMvMiAqIDEuMDAwNSAqKC1NYXRoLnBvdygyLCAtMTAgKiAtLXQpICsgMikgKyBiO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqIGVhc2VPdXRJbkV4cG8gKi9cclxuICAgICAgICBlYXNlT3V0SW5FeHBvOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XHJcbiAgICAgICAgICAgIGlmKHQgPCBkLzIpIHJldHVybiB0bS5hbmltLmVhc2luZy5lYXNlT3V0RXhwbyh0KjIsIGIsIGMvMiwgZCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0bS5hbmltLmVhc2luZy5lYXNlSW5FeHBvKCh0KjIpLWQsIGIrYy8yLCBjLzIsIGQpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqIGVhc2VJbkNpcmMgKi9cclxuICAgICAgICBlYXNlSW5DaXJjOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAtYyAqKE1hdGguc3FydCgxIC0odC89ZCkqdCkgLSAxKSArIGI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKiogZWFzZU91dENpcmMgKi9cclxuICAgICAgICBlYXNlT3V0Q2lyYzogZnVuY3Rpb24odCwgYiwgYywgZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYyAqIE1hdGguc3FydCgxIC0odD10L2QtMSkqdCkgKyBiO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqIGVhc2VJbk91dENpcmMgKi9cclxuICAgICAgICBlYXNlSW5PdXRDaXJjOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XHJcbiAgICAgICAgICAgIGlmKCh0Lz1kLzIpIDwgMSkgcmV0dXJuIC1jLzIgKihNYXRoLnNxcnQoMSAtIHQqdCkgLSAxKSArIGI7XHJcbiAgICAgICAgICAgIHJldHVybiBjLzIgKihNYXRoLnNxcnQoMSAtKHQtPTIpKnQpICsgMSkgKyBiO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqIGVhc2VPdXRJbkNpcmMgKi9cclxuICAgICAgICBlYXNlT3V0SW5DaXJjOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XHJcbiAgICAgICAgICAgIGlmKHQgPCBkLzIpIHJldHVybiB0bS5hbmltLmVhc2luZy5lYXNlT3V0Q2lyYyh0KjIsIGIsIGMvMiwgZCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0bS5hbmltLmVhc2luZy5lYXNlSW5DaXJjKCh0KjIpLWQsIGIrYy8yLCBjLzIsIGQpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqIGVhc2VJbkVsYXN0aWMgKi9cclxuICAgICAgICBlYXNlSW5FbGFzdGljOiBmdW5jdGlvbih0LCBiLCBjLCBkLCBhLCBwKSB7XHJcbiAgICAgICAgICAgIHZhciBzO1xyXG4gICAgICAgICAgICBpZih0PT0wKSByZXR1cm4gYjsgIGlmKCh0Lz1kKT09MSkgcmV0dXJuIGIrYzsgIGlmKCFwKSBwPWQqLjM7XHJcbiAgICAgICAgICAgIGlmKCFhIHx8IGEgPCBNYXRoLmFicyhjKSkgeyBhPWM7IHM9cC80OyB9IGVsc2UgcyA9IHAvKDIqTWF0aC5QSSkgKiBNYXRoLmFzaW4oYy9hKTtcclxuICAgICAgICAgICAgcmV0dXJuIC0oYSpNYXRoLnBvdygyLDEwKih0LT0xKSkgKiBNYXRoLnNpbigodCpkLXMpKigyKk1hdGguUEkpL3AgKSkgKyBiO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqIGVhc2VPdXRFbGFzdGljICovXHJcbiAgICAgICAgZWFzZU91dEVsYXN0aWM6IGZ1bmN0aW9uKHQsIGIsIGMsIGQsIGEsIHApIHtcclxuICAgICAgICAgICAgdmFyIHM7XHJcbiAgICAgICAgICAgIGlmKHQ9PTApIHJldHVybiBiOyAgaWYoKHQvPWQpPT0xKSByZXR1cm4gYitjOyAgaWYoIXApIHA9ZCouMztcclxuICAgICAgICAgICAgaWYoIWEgfHwgYSA8IE1hdGguYWJzKGMpKSB7IGE9Yzsgcz1wLzQ7IH0gZWxzZSBzID0gcC8oMipNYXRoLlBJKSAqIE1hdGguYXNpbihjL2EpO1xyXG4gICAgICAgICAgICByZXR1cm4oYSpNYXRoLnBvdygyLC0xMCp0KSAqIE1hdGguc2luKCh0KmQtcykqKDIqTWF0aC5QSSkvcCApICsgYyArIGIpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqIGVhc2VJbk91dEVsYXN0aWMgKi9cclxuICAgICAgICBlYXNlSW5PdXRFbGFzdGljOiBmdW5jdGlvbih0LCBiLCBjLCBkLCBhLCBwKSB7XHJcbiAgICAgICAgICAgIHZhciBzO1xyXG4gICAgICAgICAgICBpZih0PT0wKSByZXR1cm4gYjsgIGlmKCh0Lz1kLzIpPT0yKSByZXR1cm4gYitjOyAgaWYoIXApIHA9ZCooLjMqMS41KTtcclxuICAgICAgICAgICAgaWYoIWEgfHwgYSA8IE1hdGguYWJzKGMpKSB7IGE9Yzsgcz1wLzQ7IH0gICAgICAgZWxzZSBzID0gcC8oMipNYXRoLlBJKSAqIE1hdGguYXNpbihjL2EpO1xyXG4gICAgICAgICAgICBpZih0IDwgMSkgcmV0dXJuIC0uNSooYSpNYXRoLnBvdygyLDEwKih0LT0xKSkgKiBNYXRoLnNpbigodCpkLXMpKigyKk1hdGguUEkpL3AgKSkgKyBiO1xyXG4gICAgICAgICAgICByZXR1cm4gYSpNYXRoLnBvdygyLC0xMCoodC09MSkpICogTWF0aC5zaW4oKHQqZC1zKSooMipNYXRoLlBJKS9wICkqLjUgKyBjICsgYjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKiBlYXNlT3V0SW5FbGFzdGljICovXHJcbiAgICAgICAgZWFzZU91dEluRWxhc3RpYzogZnVuY3Rpb24odCwgYiwgYywgZCwgYSwgcCkge1xyXG4gICAgICAgICAgICBpZih0IDwgZC8yKSByZXR1cm4gdG0uYW5pbS5lYXNpbmcuZWFzZU91dEVsYXN0aWModCoyLCBiLCBjLzIsIGQsIGEsIHApO1xyXG4gICAgICAgICAgICByZXR1cm4gdG0uYW5pbS5lYXNpbmcuZWFzZUluRWxhc3RpYygodCoyKS1kLCBiK2MvMiwgYy8yLCBkLCBhLCBwKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKiBlYXNlSW5CYWNrICovXHJcbiAgICAgICAgZWFzZUluQmFjazogZnVuY3Rpb24odCwgYiwgYywgZCwgcykge1xyXG4gICAgICAgICAgICBpZihzID09IHVuZGVmaW5lZCkgcyA9IDEuNzAxNTg7XHJcbiAgICAgICAgICAgIHJldHVybiBjKih0Lz1kKSp0KigocysxKSp0IC0gcykgKyBiO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqIGVhc2VPdXRCYWNrICovXHJcbiAgICAgICAgZWFzZU91dEJhY2s6IGZ1bmN0aW9uKHQsIGIsIGMsIGQsIHMpIHtcclxuICAgICAgICAgICAgaWYocyA9PSB1bmRlZmluZWQpIHMgPSAxLjcwMTU4O1xyXG4gICAgICAgICAgICByZXR1cm4gYyooKHQ9dC9kLTEpKnQqKChzKzEpKnQgKyBzKSArIDEpICsgYjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKiBlYXNlSW5PdXRCYWNrICovXHJcbiAgICAgICAgZWFzZUluT3V0QmFjazogZnVuY3Rpb24odCwgYiwgYywgZCwgcykge1xyXG4gICAgICAgICAgICBpZihzID09IHVuZGVmaW5lZCkgcyA9IDEuNzAxNTg7XHJcbiAgICAgICAgICAgIGlmKCh0Lz1kLzIpIDwgMSkgcmV0dXJuIGMvMioodCp0KigoKHMqPSgxLjUyNSkpKzEpKnQgLSBzKSkgKyBiO1xyXG4gICAgICAgICAgICByZXR1cm4gYy8yKigodC09MikqdCooKChzKj0oMS41MjUpKSsxKSp0ICsgcykgKyAyKSArIGI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKiogZWFzZU91dEluQmFjayAqL1xyXG4gICAgICAgIGVhc2VPdXRJbkJhY2s6IGZ1bmN0aW9uKHQsIGIsIGMsIGQsIHMpIHtcclxuICAgICAgICAgICAgaWYodCA8IGQvMikgcmV0dXJuIHRtLmFuaW0uZWFzaW5nLmVhc2VPdXRCYWNrKHQqMiwgYiwgYy8yLCBkLCBzKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRtLmFuaW0uZWFzaW5nLmVhc2VJbkJhY2soKHQqMiktZCwgYitjLzIsIGMvMiwgZCwgcyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKiogZWFzZUluQm91bmNlICovXHJcbiAgICAgICAgZWFzZUluQm91bmNlOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjIC0gdG0uYW5pbS5lYXNpbmcuZWFzZU91dEJvdW5jZShkLXQsIDAsIGMsIGQpICsgYjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKiBlYXNlT3V0Qm91bmNlICovXHJcbiAgICAgICAgZWFzZU91dEJvdW5jZTogZnVuY3Rpb24odCwgYiwgYywgZCkge1xyXG4gICAgICAgICAgICBpZigodC89ZCkgPCgxLzIuNzUpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYyooNy41NjI1KnQqdCkgKyBiO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYodCA8KDIvMi43NSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjKig3LjU2MjUqKHQtPSgxLjUvMi43NSkpKnQgKyAuNzUpICsgYjtcclxuICAgICAgICAgICAgfSBlbHNlIGlmKHQgPCgyLjUvMi43NSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjKig3LjU2MjUqKHQtPSgyLjI1LzIuNzUpKSp0ICsgLjkzNzUpICsgYjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjKig3LjU2MjUqKHQtPSgyLjYyNS8yLjc1KSkqdCArIC45ODQzNzUpICsgYjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqIGVhc2VJbk91dEJvdW5jZSAqL1xyXG4gICAgICAgIGVhc2VJbk91dEJvdW5jZTogZnVuY3Rpb24odCwgYiwgYywgZCkge1xyXG4gICAgICAgICAgICBpZih0IDwgZC8yKSByZXR1cm4gdG0uYW5pbS5lYXNpbmcuZWFzZUluQm91bmNlKHQqMiwgMCwgYywgZCkgKiAuNSArIGI7XHJcbiAgICAgICAgICAgIGVsc2UgcmV0dXJuIHRtLmFuaW0uZWFzaW5nLmVhc2VPdXRCb3VuY2UodCoyLWQsIDAsIGMsIGQpICogLjUgKyBjKi41ICsgYjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKiBlYXNlT3V0SW5Cb3VuY2UgKi9cclxuICAgICAgICBlYXNlT3V0SW5Cb3VuY2U6IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcclxuICAgICAgICAgICAgaWYodCA8IGQvMikgcmV0dXJuIHRtLmFuaW0uZWFzaW5nLmVhc2VPdXRCb3VuY2UodCoyLCBiLCBjLzIsIGQpO1xyXG4gICAgICAgICAgICByZXR1cm4gdG0uYW5pbS5lYXNpbmcuZWFzZUluQm91bmNlKCh0KjIpLWQsIGIrYy8yLCBjLzIsIGQpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4vKlxyXG4gKiBUaW1lclxyXG4gKi9cclxuXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgdG0uZGVmaW5lKFwidG0uYXBwLlRpbWVyXCIsIHtcclxuICAgICAgICAvKiog44OV44Os44O844OgICovXHJcbiAgICAgICAgZnJhbWU6IDAsXHJcbiAgICAgICAgZnBzOiAzMCxcclxuICAgICAgICBmcmFtZVRpbWU6IDEwMDAvMzAsXHJcblxyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmZyYW1lID0gMDtcclxuICAgICAgICAgICAgdGhpcy5mcHMgPSB0bS5hcHAuVGltZXJbXCJkZWZhdWx0XCJdLmZwcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICByZXNldDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZnJhbWUgPSAwO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICB1cGRhdGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmZyYW1lID0gdGhpcy5mcmFtZSArIDE7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGdldEZyYW1lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZnJhbWU7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZ2V0U2Vjb25kczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZWNvbmRzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGdldE1pbGxpc2Vjb25kczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9taWxsaXNlY29uZHM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgY2hlY2tJbnRlcnZhbEVuZDogZnVuY3Rpb24odGltZSkge1xyXG4gICAgICAgICAgICB2YXIgdCA9ICh0aW1lL3RoaXMuZnBzKXwwO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5mcmFtZSAlIHQgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8vIHN0YXJ0IH4gZW5kIOOBrumWk+OBi+OCkuWIpOWumuOBmeOCi1xyXG4gICAgICAgIGNoZWNrQmV0d2VlbjogZnVuY3Rpb24oc3RhcnQsIGVuZCkge1xyXG4gICAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICBlbmQgPSBNYXRoLm1heChzdGFydCwgMCk7XHJcbiAgICAgICAgICAgICAgICBzdGFydCA9IGVuZC10aGlzLmZyYW1lVGltZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgdGltZSA9ICh0aGlzLmZyYW1lL3RoaXMuZnBzKSoxMDAwO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHN0YXJ0IDw9IHRpbWUgPCBlbmQ7XHJcbiAgICAgICAgICAgIHJldHVybiBNYXRoLmluc2lkZSh0aW1lLCBzdGFydCwgZW5kKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfdXBkYXRlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHRpbWUgPSAodGhpcy5mcmFtZS90aGlzLmZwcyk7XHJcbiAgICAgICAgICAgIHRoaXMuX3NlY29uZHMgPSB0aW1lfDA7XHJcbiAgICAgICAgICAgIHRoaXMuX21pbGxpc2Vjb25kcyA9ICh0aW1lKjEwMDApfDA7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgdG0uYXBwLlRpbWVyLnByb3RvdHlwZS5hY2Nlc3NvcihcImZyYW1lXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2ZyYW1lO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24oZnJhbWUpe1xyXG4gICAgICAgICAgICB0aGlzLl9mcmFtZSA9IGZyYW1lO1xyXG4gICAgICAgICAgICB0aGlzLl91cGRhdGUoKTtcclxuICAgICAgICB9LFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5IGZwc1xyXG4gICAgICogZnBzXHJcbiAgICAgKi9cclxuICAgIHRtLmFwcC5UaW1lci5wcm90b3R5cGUuYWNjZXNzb3IoXCJmcHNcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZnBzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24oZnBzKXtcclxuICAgICAgICAgICAgaWYgKGZwcyAhPT0gdGhpcy5fZnBzKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZyYW1lVGltZSA9ICgxMDAwL2Zwcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5fZnBzID0gZnBzO1xyXG4gICAgICAgICAgICB0aGlzLl91cGRhdGUoKTtcclxuICAgICAgICB9LFxyXG4gICAgfSk7ICAgIFxyXG5cclxuICAgIHRtLmFwcC5UaW1lcltcImRlZmF1bHRcIl0gPSB7XHJcbiAgICAgICAgZnBzOiAzMCxcclxuICAgIH07XHJcblxyXG59KSgpO1xyXG5cclxuXHJcblxyXG5cclxuLypcclxuICogdXBkYXRlci5qc1xyXG4gKi9cclxuXHJcbiBcclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5hcHAuVXBkYXRlclxyXG4gICAgICog5pu05paw566h55CG44Kv44Op44K5XHJcbiAgICAgKi9cclxuICAgIHRtLmRlZmluZShcInRtLmFwcC5VcGRhdGVyXCIsIHtcclxuICAgICAgICBhcHA6IG51bGwsXHJcblxyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKGFwcCkge1xyXG4gICAgICAgICAgICB0aGlzLmFwcCA9IGFwcDtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICB1cGRhdGU6IGZ1bmN0aW9uKHJvb3QpIHtcclxuICAgICAgICAgICAgdGhpcy5fdXBkYXRlRWxlbWVudChyb290KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfdXBkYXRlRWxlbWVudDogZnVuY3Rpb24oZWxtKSB7XHJcbiAgICAgICAgICAgIHZhciBhcHAgPSB0aGlzLmFwcDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIOabtOaWsOOBmeOCi+OBi+OCkuWIpOWumlxyXG4gICAgICAgICAgICBpZiAoZWxtLmF3YWtlID09IGZhbHNlKSByZXR1cm4gO1xyXG5cclxuICAgICAgICAgICAgLy8g5pu05pawXHJcbiAgICAgICAgICAgIGlmIChlbG0udXBkYXRlKSBlbG0udXBkYXRlKGFwcCk7XHJcblxyXG4gICAgICAgICAgICAvLyDjgqjjg7Pjgr/jg7zjg5Xjg6zjg7zjg6DjgqTjg5njg7Pjg4hcclxuICAgICAgICAgICAgaWYgKGVsbS5oYXNFdmVudExpc3RlbmVyKFwiZW50ZXJmcmFtZVwiKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGUgPSB0bS5ldmVudC5FdmVudChcImVudGVyZnJhbWVcIik7XHJcbiAgICAgICAgICAgICAgICBlLmFwcCA9IGFwcDtcclxuICAgICAgICAgICAgICAgIGVsbS5maXJlKGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDjgr/jg4Pjg4HliKTlrppcclxuICAgICAgICAgICAgaWYgKGVsbS5pbnRlcmFjdGl2ZSkge1xyXG4gICAgICAgICAgICAgICAgZWxtLl9jaGVja1BvaW50aW5nKGFwcCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIOWtkOS+m+OCkuabtOaWsFxyXG4gICAgICAgICAgICB2YXIgbGVuID0gZWxtLmNoaWxkcmVuLmxlbmd0aDtcclxuICAgICAgICAgICAgaWYgKGxlbiA+IDApIHtcclxuICAgICAgICAgICAgICAgIHZhciB0ZW1wQ2hpbGRyZW4gPSBlbG0uY2hpbGRyZW4uc2xpY2UoKTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGk9MDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZUVsZW1lbnQodGVtcENoaWxkcmVuW2ldKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICB9KTtcclxuXHJcbn0pKCk7XHJcblxyXG5cclxuXHJcbi8qXHJcbiAqIGJhc2VhcHAuanNcclxuICovXHJcblxyXG50bS5hcHAgPSB0bS5hcHAgfHwge307XHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5hcHAuQmFzZUFwcFxyXG4gICAgICog44OZ44O844K544Ki44OX44Oq44Kx44O844K344On44OzXHJcbiAgICAgKi9cclxuICAgIHRtLmFwcC5CYXNlQXBwID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG5cclxuICAgICAgICBzdXBlckNsYXNzOiB0bS5ldmVudC5FdmVudERpc3BhdGNoZXIsXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqIOOCqOODrOODoeODs+ODiCAqL1xyXG4gICAgICAgIGVsZW1lbnQgICAgICAgOiBudWxsLFxyXG4gICAgICAgIC8qKiDjg57jgqbjgrnjgq/jg6njgrkgKi9cclxuICAgICAgICBtb3VzZSAgICAgICAgIDogbnVsbCxcclxuICAgICAgICAvKiog44K/44OD44OB44Kv44Op44K5ICovXHJcbiAgICAgICAgdG91Y2ggICAgICAgICA6IG51bGwsXHJcbiAgICAgICAgLyoqIOODnuOCpuOCueOCr+ODqeOCuSArIOOCv+ODg+ODgeOCr+ODqeOCuSAqL1xyXG4gICAgICAgIHBvaW50aW5nICAgICAgOiBudWxsLFxyXG4gICAgICAgIC8qKiDjgq3jg7zjg5zjg7zjg4njgq/jg6njgrkgKi9cclxuICAgICAgICBrZXlib2FyZCAgICAgIDogbnVsbCxcclxuICAgICAgICAvKiog5Yqg6YCf5bqm44K744Oz44K144O8ICovXHJcbiAgICAgICAgYWNjZWxlcm9tZXRlciA6IG51bGwsXHJcbiAgICAgICAgLyoqIOabtOaWsOOCr+ODqeOCuSAqL1xyXG4gICAgICAgIHVwZGF0ZXIgICAgICAgOiBudWxsLFxyXG4gICAgICAgIC8qKiBzdGF0c+ODqeOCpOODluODqeODqiAqL1xyXG4gICAgICAgIHN0YXRzICAgICAgICAgOiBudWxsLFxyXG4gICAgICAgIC8qKiDjgr/jgqTjg57jg7wgKi9cclxuICAgICAgICB0aW1lciAgICAgICAgIDogbnVsbCxcclxuICAgICAgICAvKiog54++5Zyo5pu05paw5Lit44GLICovXHJcbiAgICAgICAgYXdha2UgICAgICAgICA6IG51bGwsXHJcbiAgICAgICAgLyoqIEBwcml2YXRlICDjgrfjg7zjg7Pmg4XloLHjga7nrqHnkIYgKi9cclxuICAgICAgICBfc2NlbmVzICAgICAgIDogbnVsbCxcclxuICAgICAgICAvKiogQHByaXZhdGUgIOOCt+ODvOODs+OBruOCpOODs+ODh+ODg+OCr+OCuSAqL1xyXG4gICAgICAgIF9zY2VuZUluZGV4ICAgOiAwLFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gZWxtXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oZWxtKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3VwZXJJbml0KCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbG07XHJcblxyXG4gICAgICAgICAgICAvLyDjgr/jgqTjg57jg7xcclxuICAgICAgICAgICAgdGhpcy50aW1lciA9IHRtLmFwcC5UaW1lcigpO1xyXG5cclxuICAgICAgICAgICAgLy8g44Oe44Km44K544KS55Sf5oiQXHJcbiAgICAgICAgICAgIHRoaXMubW91c2UgICAgICA9IHRtLmlucHV0Lk1vdXNlKHRoaXMuZWxlbWVudCk7XHJcbiAgICAgICAgICAgIC8vIOOCv+ODg+ODgeOCkueUn+aIkFxyXG4gICAgICAgICAgICB0aGlzLnRvdWNoICAgICAgPSB0bS5pbnB1dC5Ub3VjaCh0aGlzLmVsZW1lbnQsIDApO1xyXG4gICAgICAgICAgICAvLyDjgq3jg7zjg5zjg7zjg4njgpLnlJ/miJBcclxuICAgICAgICAgICAgdGhpcy5rZXlib2FyZCAgID0gdG0uaW5wdXQuS2V5Ym9hcmQoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIOODneOCpOODs+ODhuOCo+ODs+OCsOOCkuOCu+ODg+ODiChQQyDjgafjga8gTW91c2UsIE1vYmlsZSDjgafjga8gVG91Y2gpXHJcbiAgICAgICAgICAgIHRoaXMucG9pbnRpbmcgICA9ICh0bS5pc01vYmlsZSkgPyB0aGlzLnRvdWNoIDogdGhpcy5tb3VzZTtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucG9pbnRpbmcgPSB0aGlzLnRvdWNoO1xyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBvaW50aW5nID0gdGhpcy5tb3VzZTtcclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIOWKoOmAn+W6puOCu+ODs+OCteODvOOCkueUn+aIkFxyXG4gICAgICAgICAgICB0aGlzLmFjY2VsZXJvbWV0ZXIgPSB0bS5pbnB1dC5BY2NlbGVyb21ldGVyKCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZXIgPSB0bS5hcHAuVXBkYXRlcih0aGlzKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIOWGjeeUn+ODleODqeOCsFxyXG4gICAgICAgICAgICB0aGlzLmF3YWtlID0gdHJ1ZTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIOOCt+ODvOODs+WRqOOCilxyXG4gICAgICAgICAgICB0aGlzLl9zY2VuZXMgPSBbIHRtLmFwcC5TY2VuZSgpIF07XHJcbiAgICAgICAgICAgIHRoaXMuX3NjZW5lSW5kZXggPSAwO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8g5rG65a6a5pmC44Gu5Yem55CG44KS44Kq44OV44Gr44GZ44KLKGlQaG9uZSDmmYLjga7jgaHjgonjgaTjgY3lr77nrZYpXHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCBmdW5jdGlvbihlKSB7IGUuc3RvcCgpOyB9KTtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaG1vdmVcIiwgZnVuY3Rpb24oZSkgeyBlLnN0b3AoKTsgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDjgqbjgqPjg7Pjg4njgqbjg5Xjgqnjg7zjgqvjgrnmmYLjgqTjg5njg7Pjg4jjg6rjgrnjg4rjgpLnmbvpjLJcclxuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJmb2N1c1wiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmlyZSh0bS5ldmVudC5FdmVudChcImZvY3VzXCIpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFNjZW5lLmRpc3BhdGNoRXZlbnQodG0uZXZlbnQuRXZlbnQoXCJmb2N1c1wiKSk7XHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgICAgIC8vIOOCpuOCo+ODs+ODieOCpuODluODqeODvOaZguOCpOODmeODs+ODiOODquOCueODiuOCkueZu+mMslxyXG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpcmUodG0uZXZlbnQuRXZlbnQoXCJibHVyXCIpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFNjZW5lLmRpc3BhdGNoRXZlbnQodG0uZXZlbnQuRXZlbnQoXCJibHVyXCIpKTtcclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgICAgICAgICAgLy8g44Kv44Oq44OD44KvXHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCh0bS5pc01vYmlsZSkgPyBcInRvdWNoZW5kXCIgOiBcIm1vdXNldXBcIiwgdGhpcy5fb25jbGljay5iaW5kKHRoaXMpKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWun+ihjFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJ1bjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc3RhcnRlZFRpbWUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgICAgICB0aGlzLnByZXZUaW1lID0gbmV3IERhdGUoKTtcclxuICAgICAgICAgICAgdGhpcy5kZWx0YVRpbWUgPSAwO1xyXG5cclxuICAgICAgICAgICAgdmFyIF9ydW4gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIC8vIHN0YXJ0XHJcbiAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIHJ1blxyXG4gICAgICAgICAgICAgICAgc2VsZi5fbG9vcCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGNhbGN1bGF0ZSBwcm9ncmVzcyB0aW1lXHJcbiAgICAgICAgICAgICAgICB2YXIgcHJvZ3Jlc3MgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpIC0gc3RhcnQ7XHJcbiAgICAgICAgICAgICAgICAvLyBjYWxjdWxhdGUgbmV4dCB3YWl0aW5nIHRpbWVcclxuICAgICAgICAgICAgICAgIHZhciBuZXdEZWxheSA9IHNlbGYudGltZXIuZnJhbWVUaW1lLXByb2dyZXNzO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIHNldCBuZXh0IHJ1bm5pbmcgZnVuY3Rpb25cclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoX3J1biwgbmV3RGVsYXkpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgX3J1bigpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKlxyXG4gICAgICAgICAqIOODq+ODvOODl+WHpueQhlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX2xvb3A6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyB1cGRhdGVcclxuICAgICAgICAgICAgaWYgKHRoaXMudXBkYXRlKSB0aGlzLnVwZGF0ZSgpO1xyXG4gICAgICAgICAgICB0aGlzLl91cGRhdGUoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIGRyYXdcclxuICAgICAgICAgICAgaWYgKHRoaXMuZHJhdykgdGhpcy5kcmF3KCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2RyYXcoKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgICAgICB0aGlzLmRlbHRhVGltZSA9IG5vdyAtIHRoaXMucHJldlRpbWU7XHJcbiAgICAgICAgICAgIHRoaXMucHJldlRpbWUgPSBub3c7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBzdGF0cyB1cGRhdGVcclxuICAgICAgICAgICAgaWYgKHRoaXMuc3RhdHMpIHRoaXMuc3RhdHMudXBkYXRlKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgrfjg7zjg7PjgpLliIfjgormm7/jgYjjgotcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gc2NlbmVcclxuICAgICAgICAgKiAjIyBSZWZlcmVuY2VcclxuICAgICAgICAgKiAtIDxodHRwOi8vYW1lYmxvLmpwL2hhc2gtci0xMjM0L2VudHJ5LTEwOTY3OTQyNTUwLmh0bWw+XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcmVwbGFjZVNjZW5lOiBmdW5jdGlvbihzY2VuZSkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRTY2VuZSkge1xyXG4gICAgICAgICAgICAgICAgZSA9IHRtLmV2ZW50LkV2ZW50KFwiZXhpdFwiKTtcclxuICAgICAgICAgICAgICAgIGUuYXBwID0gdGhpcztcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFNjZW5lLmRpc3BhdGNoRXZlbnQoZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRTY2VuZS5hcHAgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGUgPSB0bS5ldmVudC5FdmVudChcImVudGVyXCIpO1xyXG4gICAgICAgICAgICBlLmFwcCA9IHRoaXM7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFNjZW5lID0gc2NlbmU7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFNjZW5lLmFwcCA9IHRoaXM7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFNjZW5lLmRpc3BhdGNoRXZlbnQoZSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCt+ODvOODs+OCkuODl+ODg+OCt+ODpeOBmeOCiyjjg53jg7zjgrrjgoTjgqrjg5bjgrfjg6fjg7PnlLvpnaLjgarjganjgafkvb/nlKgpXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHNjZW5lXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcHVzaFNjZW5lOiBmdW5jdGlvbihzY2VuZSkge1xyXG4gICAgICAgICAgICB0aGlzLmZpcmUodG0uZXZlbnQuRXZlbnQoXCJwdXNoXCIpKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBlID0gdG0uZXZlbnQuRXZlbnQoXCJwYXVzZVwiKTtcclxuICAgICAgICAgICAgZS5hcHAgPSB0aGlzO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTY2VuZS5kaXNwYXRjaEV2ZW50KGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5fc2NlbmVzLnB1c2goc2NlbmUpO1xyXG4gICAgICAgICAgICArK3RoaXMuX3NjZW5lSW5kZXg7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLmZpcmUodG0uZXZlbnQuRXZlbnQoXCJwdXNoZWRcIikpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGUgPSB0bS5ldmVudC5FdmVudChcImVudGVyXCIpO1xyXG4gICAgICAgICAgICBlLmFwcCA9IHRoaXM7XHJcbiAgICAgICAgICAgIHNjZW5lLmFwcCA9IHRoaXM7XHJcbiAgICAgICAgICAgIHNjZW5lLmRpc3BhdGNoRXZlbnQoZSk7XHJcblxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgrfjg7zjg7PjgpLjg53jg4Pjg5fjgZnjgoso44Od44O844K644KE44Kq44OW44K344On44Oz55S76Z2i44Gq44Gp44Gn5L2/55SoKVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHBvcFNjZW5lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5maXJlKHRtLmV2ZW50LkV2ZW50KFwicG9wXCIpKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciBzY2VuZSA9IHRoaXMuX3NjZW5lcy5wb3AoKTtcclxuICAgICAgICAgICAgLS10aGlzLl9zY2VuZUluZGV4O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdmFyIGUgPSB0bS5ldmVudC5FdmVudChcImV4aXRcIik7XHJcbiAgICAgICAgICAgIGUuYXBwID0gdGhpcztcclxuICAgICAgICAgICAgc2NlbmUuZGlzcGF0Y2hFdmVudChlKTtcclxuICAgICAgICAgICAgc2NlbmUuYXBwID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZmlyZSh0bS5ldmVudC5FdmVudChcInBvcGVkXCIpKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFxyXG4gICAgICAgICAgICB2YXIgZSA9IHRtLmV2ZW50LkV2ZW50KFwicmVzdW1lXCIpO1xyXG4gICAgICAgICAgICBlLmFwcCA9IHRoaXM7XHJcbiAgICAgICAgICAgIGUucHJldlNjZW5lID0gc2NlbmU7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFNjZW5lLmRpc3BhdGNoRXZlbnQoZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gc2NlbmU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlpJbpg6jjga5GUFPooajnpLrjg6njgqTjg5bjg6njg6ogU3RhdHMg44KS55Sf5oiQ44CB6YWN572u44GZ44KLXHJcbiAgICAgICAgICogIyMgUmVmZXJlbmNlXHJcbiAgICAgICAgICogLSA8aHR0cHM6Ly9naXRodWIuY29tL21yZG9vYi9zdGF0cy5qcz5cclxuICAgICAgICAgKi9cclxuICAgICAgICBlbmFibGVTdGF0czogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICh3aW5kb3dbXCJTdGF0c1wiXSkge1xyXG4gICAgICAgICAgICAgICAgLy8gU3RhdHNcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdHMgPSBuZXcgU3RhdHMoKTtcclxuICAgICAgICAgICAgICAgIC8vIOWPs+S4iuOBq+ioreWumlxyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0cy5kb21FbGVtZW50LnN0eWxlLnBvc2l0aW9uID0gXCJmaXhlZFwiO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0cy5kb21FbGVtZW50LnN0eWxlLmxlZnQgICAgID0gXCI1cHhcIjtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdHMuZG9tRWxlbWVudC5zdHlsZS50b3AgICAgICA9IFwiMjBweFwiO1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLnN0YXRzLmRvbUVsZW1lbnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwibm90IGRlZmluZWQgc3RhdHMuXCIpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIGRhdCBndWkg44KS5pyJ5Yq55YyWXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZW5hYmxlRGF0R1VJOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKHdpbmRvdy5kYXQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBndWkgPSBuZXcgZGF0LkdVSSgpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZ3VpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgrfjg7zjg7Pjga51cGRhdGXjgpLlrp/ooYzjgZnjgovjgojjgYbjgavjgZnjgotcclxuICAgICAgICAgKi9cclxuICAgICAgICBzdGFydDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXdha2UgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgrfjg7zjg7Pjga51cGRhdGXjgpLlrp/ooYzjgZfjgarjgYTjgojjgYbjgavjgZnjgotcclxuICAgICAgICAgKi9cclxuICAgICAgICBzdG9wOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5hd2FrZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg4fjg5DjgqTjgrnjgoTjgrfjg7zjg7Pjga7jgqLjg4Pjg5fjg4fjg7zjg4jlkbzjgbPlh7rjgZflh6bnkIZcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF91cGRhdGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyDjg4fjg5DjgqTjgrnns7sgVXBkYXRlXHJcbiAgICAgICAgICAgIHRoaXMubW91c2UudXBkYXRlKCk7XHJcbiAgICAgICAgICAgIHRoaXMua2V5Ym9hcmQuX3VwZGF0ZSgpO1xyXG4gICAgICAgICAgICB0aGlzLnRvdWNoLnVwZGF0ZSgpO1xyXG4gICAgICAgICAgICAvLyB0aGlzLnRvdWNoZXMudXBkYXRlKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAodGhpcy5hd2FrZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVyLnVwZGF0ZSh0aGlzLmN1cnJlbnRTY2VuZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpbWVyLnVwZGF0ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmj4/nlLvnlKjku67mg7PplqLmlbBcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9kcmF3OiBmdW5jdGlvbigpIHt9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIGVsZW1lbnTjga7lj5blvpdcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRFbGVtZW50OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudDtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgq/jg6rjg4Pjgq/jgqTjg5njg7Pjg4jnmbvpjLJcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX29uY2xpY2s6IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgdmFyIF9mbiA9IGZ1bmN0aW9uKGVsbSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVsbS5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxtLmNoaWxkcmVuLmVhY2goZnVuY3Rpb24oZWxtKSB7IF9mbihlbG0pOyB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChlbG0uX2NsaWNrRmxhZyAmJiBlbG0uaGFzRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxtLmRpc3BhdGNoRXZlbnQodG0uZXZlbnQuRXZlbnQoXCJjbGlja1wiKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbG0uX2NsaWNrRmxhZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBfZm4odGhpcy5jdXJyZW50U2NlbmUpO1xyXG4gICAgICAgIH0sXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgY3VycmVudFNjZW5lXHJcbiAgICAgKiDjgqvjg6zjg7Pjg4jjgrfjg7zjg7NcclxuICAgICAqL1xyXG4gICAgdG0uYXBwLkJhc2VBcHAucHJvdG90eXBlLmFjY2Vzc29yKFwiY3VycmVudFNjZW5lXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXMuX3NjZW5lc1t0aGlzLl9zY2VuZUluZGV4XTsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KXsgdGhpcy5fc2NlbmVzW3RoaXMuX3NjZW5lSW5kZXhdID0gdjsgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5IGZyYW1lXHJcbiAgICAgKiDjg5Xjg6zjg7zjg6BcclxuICAgICAqL1xyXG4gICAgdG0uYXBwLkJhc2VBcHAucHJvdG90eXBlLmFjY2Vzc29yKFwiZnJhbWVcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy50aW1lci5mcmFtZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpe1xyXG4gICAgICAgICAgICB0aGlzLnRpbWVyLmZyYW1lID0gdjtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgZnBzXHJcbiAgICAgKiBmcHNcclxuICAgICAqL1xyXG4gICAgdG0uYXBwLkJhc2VBcHAucHJvdG90eXBlLmFjY2Vzc29yKFwiZnBzXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudGltZXIuZnBzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odil7XHJcbiAgICAgICAgICAgIHRoaXMudGltZXIuZnBzID0gdjtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG59KSgpO1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbi8qXHJcbiAqIGVsZW1lbnQuanNcclxuICovXHJcblxyXG50bS5hcHAgPSB0bS5hcHAgfHwge307XHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5hcHAuRWxlbWVudFxyXG4gICAgICog44Ki44OX44Oq44Kx44O844K344On44Oz55So44Kq44OW44K444Kn44Kv44OI44Gu5Z+65bqV44Go44Gq44KL44Kv44Op44K5XHJcbiAgICAgKiDopqrlrZDplqLkv4Ljga7mg4XloLHjgpLnrqHnkIbjgZnjgotcclxuICAgICAqIEBleHRlbmRzIHRtLmV2ZW50LkV2ZW50RGlzcGF0Y2hlclxyXG4gICAgICovXHJcbiAgICB0bS5hcHAuRWxlbWVudCA9IHRtLmNyZWF0ZUNsYXNzKHtcclxuICAgICAgICBzdXBlckNsYXNzOiB0bS5ldmVudC5FdmVudERpc3BhdGNoZXIsXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqIOimqiAqL1xyXG4gICAgICAgIHBhcmVudDogbnVsbCxcclxuICAgICAgICAvKiog5a2QICovXHJcbiAgICAgICAgY2hpbGRyZW46IG51bGwsXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3VwZXJJbml0KCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4gPSBbXTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOimquOBi+OCiembouOBmVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJlbW92ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuYXNzZXJ0KHRoaXMucGFyZW50KTtcclxuICAgICAgICAgICAgdGhpcy5wYXJlbnQucmVtb3ZlQ2hpbGQodGhpcyk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnBhcmVudCA9IG51bGw7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWtkOS+m+OCkui/veWKoFxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjaGlsZFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGFkZENoaWxkOiBmdW5jdGlvbihjaGlsZCkge1xyXG4gICAgICAgICAgICBpZiAoY2hpbGQucGFyZW50KSBjaGlsZC5yZW1vdmUoKTtcclxuICAgICAgICAgICAgY2hpbGQucGFyZW50ID0gdGhpcztcclxuICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5wdXNoKGNoaWxkKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBlID0gdG0uZXZlbnQuRXZlbnQoXCJhZGRlZFwiKTtcclxuICAgICAgICAgICAgY2hpbGQuZGlzcGF0Y2hFdmVudChlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiBjaGlsZDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIHBhcmVudCDjgavoh6rliIbjgpLlrZDkvpvjgajjgZfjgabov73liqBcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gcGFyZW50XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgYWRkQ2hpbGRUbzogZnVuY3Rpb24ocGFyZW50KSB7XHJcbiAgICAgICAgICAgIHBhcmVudC5hZGRDaGlsZCh0aGlzKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIGlmICh0aGlzLnBhcmVudCkgdGhpcy5yZW1vdmUoKTtcclxuICAgICAgICAgICAgLy8gdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XHJcbiAgICAgICAgICAgIC8vIHBhcmVudC5jaGlsZHJlbi5wdXNoKGNoaWxkKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44G+44Go44KB44Gm6L+95YqgXHJcbiAgICAgICAgICogc2NlbmUg6YG356e75pmC44Gr5a2Q5L6b44KS44GU44Gj44Gd44KK56e76K2y44GZ44KL44Go44GN44Gq44Gp44Gr5L2/55SoXHJcbiAgICAgICAgICog44G+44Gg5YuV5L2c56K66KqN44GX44Gm44GE44Gq44GEXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGNoaWxkcmVuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgYWRkQ2hpbGRyZW46IGZ1bmN0aW9uKGNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgIHZhciB0ZW1wQ2hpbGRyZW4gPSBjaGlsZHJlbi5zbGljZSgpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpPWJlZ2luSW5kZXgsbGVuPXRlbXBDaGlsZHJlbi5sZW5ndGg7IGk8bGVuOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQodGVtcENoaWxkcmVuW2ldKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogaW5kZXgg5oyH5a6a44Gn6KaB57Sg44KS5Y+W5b6XXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgYWRkQ2hpbGRBdDogZnVuY3Rpb24oY2hpbGQsIGluZGV4KSB7XHJcbiAgICAgICAgICAgIGlmIChjaGlsZC5wYXJlbnQpIGNoaWxkLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICBjaGlsZC5wYXJlbnQgPSB0aGlzO1xyXG4gICAgICAgICAgICB0aGlzLmNoaWxkcmVuLnNwbGljZShpbmRleCwgMCwgY2hpbGQpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGUgPSB0bS5ldmVudC5FdmVudChcImFkZGVkXCIpO1xyXG4gICAgICAgICAgICBjaGlsZC5kaXNwYXRjaEV2ZW50KGUpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNoaWxkO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5oyH5a6a44Gn6KaB57Sg44KS5Y+W5b6XXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0Q2hpbGRBdDogZnVuY3Rpb24oY2hpbGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2hpbGRyZW4uYXQoY2hpbGQpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5oyH5a6a44Gn6KaB57Sg44KS5Y+W5b6XXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0Q2hpbGRJbmRleDogZnVuY3Rpb24oY2hpbGQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2hpbGRyZW4uaW5kZXhPZihjaGlsZCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBjaGlsZCDjgavkuIDoh7TjgZnjgovjgqjjg6zjg6Hjg7Pjg4jjgpLpm6LjgZlcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gY2hpbGRcclxuICAgICAgICAgKi9cclxuICAgICAgICByZW1vdmVDaGlsZDogZnVuY3Rpb24oY2hpbGQpIHtcclxuICAgICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5jaGlsZHJlbi5pbmRleE9mKGNoaWxkKTtcclxuICAgICAgICAgICAgaWYgKGluZGV4ICE9IC0xKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcmVuLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IHRtLmV2ZW50LkV2ZW50KFwicmVtb3ZlZFwiKTtcclxuICAgICAgICAgICAgICAgIGNoaWxkLmRpc3BhdGNoRXZlbnQoZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOBmeOBueOBpuOBriBjaGlsZCDjgpLpm6LjgZlcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gYmVnaW5JbmRleFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJlbW92ZUNoaWxkcmVuOiBmdW5jdGlvbihiZWdpbkluZGV4KSB7XHJcbiAgICAgICAgICAgIGJlZ2luSW5kZXggPSBiZWdpbkluZGV4IHx8IDA7XHJcbiAgICAgICAgICAgIHZhciB0ZW1wQ2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuLnNsaWNlKCk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGk9YmVnaW5JbmRleCxsZW49dGVtcENoaWxkcmVuLmxlbmd0aDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICAgICAgdGVtcENoaWxkcmVuW2ldLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4gPSBbXTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWQjeWJjeOBruS4gOiHtOOBmeOCiyBjaGlsZCDjgpLlj5blvpdcclxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldENoaWxkQnlOYW1lOiBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGk9MCxsZW49dGhpcy5jaGlsZHJlbi5sZW5ndGg7IGk8bGVuOyArK2kpXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jaGlsZHJlbltpXS5uYW1lID09IG5hbWUpIHJldHVybiB0aGlzLmNoaWxkcmVuW2ldO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDplqLmlbDlrp/ooYxcclxuICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGFyZ3NcclxuICAgICAgICAgKi9cclxuICAgICAgICBleGVjQ2hpbGRyZW46IGZ1bmN0aW9uKGZ1bmMsIGFyZ3MpIHtcclxuICAgICAgICAgICAgYXJncyA9IChhcmdzICYmIGFyZ3MubGVuZ3RoKSA/IGFyZ3MgOiBbYXJnc107XHJcbiAgICAgICAgICAgIC8vIOmWouaVsOWGheOBpyByZW1vdmUg44GV44KM44KL5Y+v6IO95oCn44GM44GC44KL44Gu44Gn6YWN5YiX44KS44Kz44OU44O844GZ44KLXHJcbiAgICAgICAgICAgIHZhciB0ZW1wQ2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuLnNsaWNlKCk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGk9MCxsZW49dGVtcENoaWxkcmVuLmxlbmd0aDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICAgICAgZnVuYy5hcHBseSh0ZW1wQ2hpbGRyZW5baV0sIGFyZ3MpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDopqrjgpLlj5blvpdcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRQYXJlbnQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpcy5wYXJlbnQ7IH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Or44O844OI44KS5Y+W5b6XXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0Um9vdDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5wYXJlbnQpIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAvLyBUT0RPOiDopqrjgpLjgZ/jganjgaPjgaYgTlVMTCDjgaDjgaPjgZ/jgonjgZ3jga7jgqjjg6zjg6Hjg7Pjg4jjgpLov5TjgZlcclxuICAgICAgICAgICAgdmFyIGVsbSA9IG51bGw7XHJcbiAgICAgICAgICAgIGZvciAoZWxtPXRoaXMucGFyZW50OyBlbG0ucGFyZW50ICE9IG51bGw7IGVsbSA9IGVsbS5wYXJlbnQpIHt9XHJcbiAgICAgICAgICAgIHJldHVybiBlbG07XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBqc29u44KS44OR44O844K544GX44GmdGhpc+OBq+WxlemWi1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZyb21KU09OOiBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBfZnJvbUpTT04gPSBmdW5jdGlvbihuYW1lLCBkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5pdCA9IGRhdGFbXCJpbml0XCJdO1xyXG4gICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSAoaW5pdCBpbnN0YW5jZW9mIEFycmF5KSA/IGluaXQgOiBbaW5pdF07XHJcbiAgICAgICAgICAgICAgICB2YXIgdHlwZSA9IChESVJUWV9DTEFTU19NQVBbZGF0YS50eXBlXSkgPyBESVJUWV9DTEFTU19NQVBbZGF0YS50eXBlXSA6IGRhdGEudHlwZTtcclxuICAgICAgICAgICAgICAgIHZhciBfY2xhc3MgPSB0bS51c2luZyh0eXBlKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5hc3NlcnQoT2JqZWN0LmtleXMoX2NsYXNzKS5sZW5ndGggIT09IDAsIF9jbGFzcyArIFwiIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgdmFyIGVsbSA9IF9jbGFzcy5hcHBseShudWxsLCBhcmdzKS5hZGRDaGlsZFRvKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgZWxtLmZyb21KU09OKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB0aGlzW25hbWVdID0gZWxtO1xyXG4gICAgICAgICAgICB9LmJpbmQodGhpcyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZGF0YVtrZXldO1xyXG4gICAgICAgICAgICAgICAgaWYgKGtleSA9PSBcImNoaWxkcmVuXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpPTAsbGVuPXZhbHVlLmxlbmd0aDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkRGF0YSA9IHZhbHVlW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Zyb21KU09OKGNoaWxkRGF0YS5uYW1lLCBjaGlsZERhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZERhdGEgPSB2YWx1ZVtrZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Zyb21KU09OKGtleSwgY2hpbGREYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChrZXkgPT0gXCJ0eXBlXCIpIGtleSA9IFwiX19rZXlcIjtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDopoHntKDjgpIgSlNPTiDljJbjgZnjgotcclxuICAgICAgICAgKiBUT0RPOiDlrp/oo4XjgZnjgovkuojlrppcclxuICAgICAgICAgKi9cclxuICAgICAgICB0b0pTT046IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyBUT0RPOlxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICB9KTtcclxuXHJcbiAgICAvKlxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqIG5hbWVzcGFjZeOBruW+jOaWueS6kuaPm1xyXG4gICAgICovXHJcbiAgICB2YXIgRElSVFlfQ0xBU1NfTUFQID0ge1xyXG4gICAgICAgIFwiU3ByaXRlXCIgICAgICAgICAgICAgICAgOiBcInRtLmRpc3BsYXkuU3ByaXRlXCIsXHJcbiAgICAgICAgXCJMYWJlbFwiICAgICAgICAgICAgICAgICA6IFwidG0uZGlzcGxheS5MYWJlbFwiLFxyXG4gICAgICAgIFwiU2hhcGVcIiAgICAgICAgICAgICAgICAgOiBcInRtLmRpc3BsYXkuU2hhcGVcIixcclxuICAgICAgICBcIkNpcmNsZVNoYXBlXCIgICAgICAgICAgIDogXCJ0bS5kaXNwbGF5LkNpcmNsZVNoYXBlXCIsXHJcbiAgICAgICAgXCJUcmlhbmdsZVNoYXBlXCIgICAgICAgICA6IFwidG0uZGlzcGxheS5UcmlhbmdsZVNoYXBlXCIsXHJcbiAgICAgICAgXCJSZWN0YW5nbGVTaGFwZVwiICAgICAgICA6IFwidG0uZGlzcGxheS5SZWN0YW5nbGVTaGFwZVwiLFxyXG4gICAgICAgIFwiUm91bmRSZWN0YW5nbGVTaGFwZVwiICAgOiBcInRtLmRpc3BsYXkuUm91bmRSZWN0YW5nbGVTaGFwZVwiLFxyXG4gICAgICAgIFwiVGV4dFNoYXBlXCIgICAgICAgICAgICAgOiBcInRtLmRpc3BsYXkuVGV4dFNoYXBlXCIsXHJcbiAgICAgICAgXCJTdGFyU2hhcGVcIiAgICAgICAgICAgICA6IFwidG0uZGlzcGxheS5TdGFyU2hhcGVcIixcclxuICAgICAgICBcIlBvbHlnb25TaGFwZVwiICAgICAgICAgIDogXCJ0bS5kaXNwbGF5LlBvbHlnb25TaGFwZVwiLFxyXG4gICAgICAgIFwiSGVhcnRTaGFwZVwiICAgICAgICAgICAgOiBcInRtLmRpc3BsYXkuSGVhcnRTaGFwZVwiLFxyXG4gICAgICAgIFwiQW5pbWF0aW9uU3ByaXRlXCIgICAgICAgOiBcInRtLmRpc3BsYXkuQW5pbWF0aW9uU3ByaXRlXCIsXHJcbiAgICAgICAgXHJcbiAgICAgICAgXCJMYWJlbEJ1dHRvblwiICAgICAgICAgICA6IFwidG0udWkuTGFiZWxCdXR0b25cIixcclxuICAgICAgICBcIkljb25CdXR0b25cIiAgICAgICAgICAgIDogXCJ0bS51aS5JY29uQnV0dG9uXCIsXHJcbiAgICAgICAgXCJHbG9zc3lCdXR0b25cIiAgICAgICAgICA6IFwidG0udWkuR2xvc3N5QnV0dG9uXCIsXHJcbiAgICAgICAgXCJGbGF0QnV0dG9uXCIgICAgICAgICAgICA6IFwidG0udWkuRmxhdEJ1dHRvblwiLFxyXG4gICAgfTtcclxuICAgIFxyXG59KSgpO1xyXG5cclxuLypcclxuICogb2JqZWN0MmQuanNcclxuICovXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLmFwcC5PYmplY3QyRFxyXG4gICAgICogT2JqZWN0MkRcclxuICAgICAqIEBleHRlbmRzIHRtLmFwcC5FbGVtZW50XHJcbiAgICAgKi9cclxuICAgIHRtLmRlZmluZShcInRtLmFwcC5PYmplY3QyRFwiLCB7XHJcbiAgICAgICAgc3VwZXJDbGFzczogXCJ0bS5hcHAuRWxlbWVudFwiLFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKiDkvY3nva4gKi9cclxuICAgICAgICBwb3NpdGlvbjogbnVsbCxcclxuICAgICAgICAvKiog44K544Kx44O844OrICovXHJcbiAgICAgICAgc2NhbGU6IG51bGwsXHJcbiAgICAgICAgLyoqIOWbnui7oiAqL1xyXG4gICAgICAgIHJvdGF0aW9uOiAwLFxyXG4gICAgICAgIC8qKiDotbfjgY3jgabjgYTjgovjg5Xjg6njgrAgKi9cclxuICAgICAgICBhd2FrZTogdHJ1ZSxcclxuICAgICAgICAvKiogQHByaXZhdGUgIOW5hSAqL1xyXG4gICAgICAgIF93aWR0aDogIDY0LFxyXG4gICAgICAgIC8qKiBAcHJpdmF0ZSAg6auY44GVICovXHJcbiAgICAgICAgX2hlaWdodDogNjQsXHJcbiAgICAgICAgLyoqIEBwcm9wZXJ0eSBwb2ludGluZyAgICAgIOODneOCpOODs+ODhuOCo+ODs+OCsCAqL1xyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgb3JpZ2luICAgICAgICDkuK3lv4PkvY3nva4gKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5IF9tYXRyaXggICAgICAg44Oe44OI44Oq44OD44Kv44K5ICovXHJcbiAgICAgICAgLyoqIEBwcm9wZXJ0eSBoaXRGbGFncyAgICAgIOODkuODg+ODiOWIpOWumuODleODqeOCsCAqL1xyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgZG93bkZsYWdzICAgICDjg4Djgqbjg7Pjg5Xjg6njgrAgKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5IF93b3JsZE1hdHJpeCAg44Kw44Ot44O844OQ44Or6KGM5YiXICovXHJcbiAgICAgICAgLyoqIEBwcm9wZXJ0eSBfd29ybGRBbHBoYSAgIOOCsOODreODvOODkOODq+OBrs6x5YCkICovXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGVsbVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdCgpO1xyXG4gICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gdG0uZ2VvbS5WZWN0b3IyKDAsIDApO1xyXG4gICAgICAgICAgICB0aGlzLnNjYWxlICAgID0gdG0uZ2VvbS5WZWN0b3IyKDEsIDEpO1xyXG4gICAgICAgICAgICB0aGlzLnBvaW50aW5nID0gdG0uZ2VvbS5WZWN0b3IyKDAsIDApO1xyXG4gICAgICAgICAgICB0aGlzLm9yaWdpbiAgID0gdG0uZ2VvbS5WZWN0b3IyKDAuNSwgMC41KTtcclxuICAgICAgICAgICAgdGhpcy5fbWF0cml4ICA9IHRtLmdlb20uTWF0cml4MzMoKTtcclxuICAgICAgICAgICAgdGhpcy5fbWF0cml4LmlkZW50aXR5KCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLmJvdW5kaW5nVHlwZSA9IFwiY2lyY2xlXCI7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tIaWVyYXJjaHkgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLmludGVyYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuaGl0RmxhZ3MgPSBbXTtcclxuICAgICAgICAgICAgdGhpcy5kb3duRmxhZ3M9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLl9jbGlja0ZsYWcgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3dvcmxkTWF0cml4ID0gdG0uZ2VvbS5NYXRyaXgzMygpLmlkZW50aXR5KCk7XHJcbiAgICAgICAgICAgIHRoaXMuX3dvcmxkQWxwaGEgPSAxLjA7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmnIDntYLnmoTjgarooYzliJfjgpLjgrLjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRGaW5hbE1hdHJpeDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBtYXRyaXggPSB0bS5nZW9tLk1hdHJpeDMzKCk7XHJcbiBcclxuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICBtYXRyaXgubXVsdGlwbHkodGhpcy5wYXJlbnQuZ2V0RmluYWxNYXRyaXgoKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbWF0cml4LnRyYW5zbGF0ZSh0aGlzLngsIHRoaXMueSk7XHJcbiAgICAgICAgICAgIG1hdHJpeC5yb3RhdGVaKHRoaXMucm90YXRpb24qTWF0aC5ERUdfVE9fUkFEKTtcclxuICAgICAgICAgICAgbWF0cml4LnNjYWxlKHRoaXMuc2NhbGVYLCB0aGlzLnNjYWxlWSk7XHJcbiBcclxuICAgICAgICAgICAgcmV0dXJuIG1hdHJpeDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOeCueOBqOihneeqgeOBl+OBpuOBhOOCi+OBi+OCkuWIpOWumlxyXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSB4XHJcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHlcclxuICAgICAgICAgKi9cclxuICAgICAgICBpc0hpdFBvaW50OiBmdW5jdGlvbih4LCB5KSB7XHJcbiAgICAgICAgICAgIC8vIOWGhuWIpOWumlxyXG4gICAgICAgICAgICB2YXIgcCA9IHRoaXMuZ2xvYmFsVG9Mb2NhbCh0bS5nZW9tLlZlY3RvcjIoeCwgeSkpO1xyXG4gICAgICAgICAgICB0aGlzLnBvaW50aW5nLnggPSBwLng7XHJcbiAgICAgICAgICAgIHRoaXMucG9pbnRpbmcueSA9IHAueTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmICgoKHAueCkqKHAueCkrKHAueSkqKHAueSkpIDwgKHRoaXMucmFkaXVzKnRoaXMucmFkaXVzKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH0sXHJcbiBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlhobjgajjgZfjgabngrnjgajooZ3nqoHliKTlrppcclxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0geFxyXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSB5XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaXNIaXRQb2ludENpcmNsZTogZnVuY3Rpb24oeCwgeSkge1xyXG4gICAgICAgICAgICB2YXIgbGVuWCA9IHRoaXMueCAtIHg7XHJcbiAgICAgICAgICAgIHZhciBsZW5ZID0gdGhpcy55IC0geTtcclxuICAgICAgICAgICAgaWYgKCgobGVuWCkqKGxlblgpKyhsZW5ZKSoobGVuWSkpIDwgKHRoaXMucmFkaXVzKnRoaXMucmFkaXVzKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH0sXHJcbiBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDnn6nlvaLjgajjgZfjgabngrnjgajooZ3nqoHliKTlrppcclxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0geFxyXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSB5XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaXNIaXRQb2ludFJlY3Q6IGZ1bmN0aW9uKHgsIHkpIHtcclxuICAgICAgICAgICAgLy8g44GT44GT44GL44KJ5LiL44Gu44OQ44O844K444On44Oz44Gv5Zub6KeS5b2iXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgbGVmdCAgID0gdGhpcy54IC0gdGhpcy53aWR0aCp0aGlzLm9yaWdpblg7XHJcbiAgICAgICAgICAgIHZhciByaWdodCAgPSB0aGlzLnggKyB0aGlzLndpZHRoKigxLXRoaXMub3JpZ2luWCk7XHJcbiAgICAgICAgICAgIHZhciB0b3AgICAgPSB0aGlzLnkgLSB0aGlzLmhlaWdodCp0aGlzLm9yaWdpblk7XHJcbiAgICAgICAgICAgIHZhciBib3R0b20gPSB0aGlzLnkgKyB0aGlzLmhlaWdodCooMS10aGlzLm9yaWdpblkpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKCBsZWZ0IDwgeCAmJiB4IDwgcmlnaHQgJiYgdG9wICA8IHkgJiYgeSA8IGJvdHRvbSApIHsgcmV0dXJuIHRydWU7IH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOmajuWxpOOCkuiAg+aFruOBl+OBn+WGhuihneeqgeWIpOWumlxyXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSB4XHJcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHlcclxuICAgICAgICAgKi9cclxuICAgICAgICBpc0hpdFBvaW50Q2lyY2xlSGllcmFyY2h5OiBmdW5jdGlvbih4LCB5KSB7XHJcbiAgICAgICAgICAgIC8vIOWGhuWIpOWumlxyXG4gICAgICAgICAgICB2YXIgcCA9IHRoaXMuZ2xvYmFsVG9Mb2NhbCh0bS5nZW9tLlZlY3RvcjIoeCwgeSkpO1xyXG4gICAgICAgICAgICB0aGlzLnBvaW50aW5nLnggPSBwLng7XHJcbiAgICAgICAgICAgIHRoaXMucG9pbnRpbmcueSA9IHAueTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmICgoKHAueCkqKHAueCkrKHAueSkqKHAueSkpIDwgKHRoaXMucmFkaXVzKnRoaXMucmFkaXVzKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6ZqO5bGk44KS6ICD5oWu44GX44Gf55+p5b2i6KGd56qB5Yik5a6aXHJcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHhcclxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0geVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGlzSGl0UG9pbnRSZWN0SGllcmFyY2h5OiBmdW5jdGlvbih4LCB5KSB7XHJcbiAgICAgICAgICAgIHZhciBwID0gdGhpcy5nbG9iYWxUb0xvY2FsKHRtLmdlb20uVmVjdG9yMih4LCB5KSk7XHJcbiAgICAgICAgICAgIHRoaXMucG9pbnRpbmcueCA9IHAueDtcclxuICAgICAgICAgICAgdGhpcy5wb2ludGluZy55ID0gcC55O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdmFyIGxlZnQgICA9IC10aGlzLndpZHRoKnRoaXMub3JpZ2luWDtcclxuICAgICAgICAgICAgdmFyIHJpZ2h0ICA9ICt0aGlzLndpZHRoKigxLXRoaXMub3JpZ2luWCk7XHJcbiAgICAgICAgICAgIHZhciB0b3AgICAgPSAtdGhpcy5oZWlnaHQqdGhpcy5vcmlnaW5ZO1xyXG4gICAgICAgICAgICB2YXIgYm90dG9tID0gK3RoaXMuaGVpZ2h0KigxLXRoaXMub3JpZ2luWSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoIGxlZnQgPCBwLnggJiYgcC54IDwgcmlnaHQgJiYgdG9wICA8IHAueSAmJiBwLnkgPCBib3R0b20gKSB7IHJldHVybiB0cnVlOyB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDopoHntKDjgajooZ3nqoHjgZfjgabjgYTjgovjgYvjgpLliKTlrppcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gZWxtXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaXNIaXRFbGVtZW50OiBmdW5jdGlvbihlbG0pIHtcclxuICAgICAgICAgICAgdmFyIHNlbGZHbG9iYWxQb3MgID0gdGhpcy5wYXJlbnQubG9jYWxUb0dsb2JhbCh0aGlzKTtcclxuICAgICAgICAgICAgaWYgKCgodGhpcy54LWVsbS54KSoodGhpcy54LWVsbS54KSsodGhpcy55LWVsbS55KSoodGhpcy55LWVsbS55KSkgPCAodGhpcy5yYWRpdXMrZWxtLnJhZGl1cykqKHRoaXMucmFkaXVzK2VsbS5yYWRpdXMpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSxcclxuIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWGhuWQjOWjq+OBruihneeqgeWIpOWumlxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBlbG1cclxuICAgICAgICAgKi9cclxuICAgICAgICBpc0hpdEVsZW1lbnRDaXJjbGU6IGZ1bmN0aW9uKGVsbSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdG0uY29sbGlzaW9uLnRlc3RDaXJjbGVDaXJjbGUodGhpcy5nZXRCb3VuZGluZ0NpcmNsZSgpLCBlbG0uZ2V0Qm91bmRpbmdDaXJjbGUoKSk7XHJcbiAgICAgICAgfSxcclxuIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWGhuWQjOWjq+OBruihneeqgeWIpOWumlxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBlbG1cclxuICAgICAgICAgKi9cclxuICAgICAgICBpc0hpdEVsZW1lbnRSZWN0OiBmdW5jdGlvbihlbG0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRtLmNvbGxpc2lvbi50ZXN0UmVjdFJlY3QodGhpcy5nZXRCb3VuZGluZ1JlY3QoKSwgZWxtLmdldEJvdW5kaW5nUmVjdCgpKTsgICAgXHJcbiAgICAgICAgfSxcclxuIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODkOOCpuODs+ODh+OCo+ODs+OCsOOCteODvOOCr+ODq1xyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBlbG1cclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRCb3VuZGluZ0NpcmNsZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0bS5nZW9tLkNpcmNsZSh0aGlzLmNlbnRlclgsIHRoaXMuY2VudGVyWSwgdGhpcy5yYWRpdXMpO1xyXG4gICAgICAgIH0sXHJcbiBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg5Djgqbjg7Pjg4fjgqPjg7PjgrDjg6zjgq/jg4hcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gZWxtXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0Qm91bmRpbmdSZWN0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRtLmdlb20uUmVjdCh0aGlzLmxlZnQsIHRoaXMudG9wLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XHJcbiAgICAgICAgfSxcclxuIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODreODvOOCq+ODq+W6p+aomeOCkuOCsOODreODvOODkOODq+W6p+aomeOBq+WkieaPm1xyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBlbG1cclxuICAgICAgICAgKi9cclxuICAgICAgICBsb2NhbFRvR2xvYmFsOiBmdW5jdGlvbihwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEZpbmFsTWF0cml4KCkubXVsdGlwbHlWZWN0b3IyKHApO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Kw44Ot44O844OQ44Or5bqn5qiZ44KS44Ot44O844Kr44Or5bqn5qiZ44Gr5aSJ5o+bXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGVsbVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdsb2JhbFRvTG9jYWw6IGZ1bmN0aW9uKHApIHtcclxuICAgICAgICAgICAgdmFyIG1hdHJpeCA9IHRoaXMuX3dvcmxkTWF0cml4LmNsb25lKCk7XHJcbiAgICAgICAgICAgIG1hdHJpeC5pbnZlcnQoKTtcclxuICAgICAgICAgICAgbWF0cml4LnRyYW5zcG9zZSgpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIG1hdHJpeC5tdWx0aXBseVZlY3RvcjIocCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBYIOW6p+aomeWApOOCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSB4XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0WDogZnVuY3Rpb24oeCkge1xyXG4gICAgICAgICAgICB0aGlzLnBvc2l0aW9uLnggPSB4O1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFkg5bqn5qiZ5YCk44KS44K744OD44OIXHJcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHlcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRZOiBmdW5jdGlvbih5KSB7XHJcbiAgICAgICAgICAgIHRoaXMucG9zaXRpb24ueSA9IHk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogWFkg5bqn5qiZ44KS44K744OD44OIXHJcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHhcclxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0geVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFBvc2l0aW9uOiBmdW5jdGlvbih4LCB5KSB7XHJcbiAgICAgICAgICAgIHRoaXMucG9zaXRpb24ueCA9IHg7XHJcbiAgICAgICAgICAgIHRoaXMucG9zaXRpb24ueSA9IHk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWbnui7ouOCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSByb3RhdGlvblxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFJvdGF0aW9uOiBmdW5jdGlvbihyb3RhdGlvbikge1xyXG4gICAgICAgICAgICB0aGlzLnJvdGF0aW9uID0gcm90YXRpb247XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCueOCseODvOODq+OCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSB4XHJcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHlcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRTY2FsZTogZnVuY3Rpb24oeCwgeSkge1xyXG4gICAgICAgICAgICB0aGlzLnNjYWxlLnggPSB4O1xyXG4gICAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8PSAxKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjYWxlLnkgPSB4O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zY2FsZS55ID0geTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWfuua6lueCueOCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSB4XHJcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHlcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRPcmlnaW46IGZ1bmN0aW9uKHgsIHkpIHtcclxuICAgICAgICAgICAgdGhpcy5vcmlnaW4ueCA9IHg7XHJcbiAgICAgICAgICAgIHRoaXMub3JpZ2luLnkgPSB5O1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOW5heOCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSB3aWR0aFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFdpZHRoOiBmdW5jdGlvbih3aWR0aCkge1xyXG4gICAgICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6auY44GV44KS44K744OD44OIXHJcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IGhlaWdodFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldEhlaWdodDogZnVuY3Rpb24oaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCteOCpOOCuijluYUsIOmrmOOBlSnjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gd2lkdGhcclxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gaGVpZ2h0XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0U2l6ZTogZnVuY3Rpb24od2lkdGgsIGhlaWdodCkge1xyXG4gICAgICAgICAgICB0aGlzLndpZHRoICA9IHdpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDotbfli5VcclxuICAgICAgICAgKi9cclxuICAgICAgICB3YWtlVXA6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmF3YWtlID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlgZzmraJcclxuICAgICAgICAgKi9cclxuICAgICAgICBzbGVlcDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXdha2UgPSBmYWxzZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgr/jg4Pjg4HliKTlrprjga7mnInlirkv54Sh5Yq544KS44K744OD44OIXHJcbiAgICAgICAgICogQHBhcmFtIHtCb29sZWFufSBmbGFnXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0SW50ZXJhY3RpdmU6IGZ1bmN0aW9uKGZsYWcsIHR5cGUpIHtcclxuICAgICAgICAgICAgdGhpcy5pbnRlcmFjdGl2ZSA9IGZsYWc7XHJcblxyXG4gICAgICAgICAgICBpZiAodHlwZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ib3VuZGluZ1R5cGUgPSB0eXBlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODkOOCpuODs+ODh+OCo+ODs+OCsOOCv+OCpOODl+OCkuOCu+ODg+ODiChcImNpcmNsZVwiIG9yIFwicmVjdFwiKVxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSB0eXBlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0Qm91bmRpbmdUeXBlOiBmdW5jdGlvbih0eXBlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYm91bmRpbmdUeXBlID0gdHlwZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg53jgqTjg7Pjg4bjgqPjg7PjgrDjgpLjg4Hjgqfjg4Pjgq9cclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBhcHBcclxuICAgICAgICAgKi9cclxuICAgICAgICBfY2hlY2tQb2ludGluZzogZnVuY3Rpb24oYXBwKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuYXNzZXJ0KGZhbHNlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODnuOCpuOCueODgeOCp+ODg+OCr1xyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGFwcFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9jaGVja01vdXNlOiBmdW5jdGlvbihhcHApIHtcclxuICAgICAgICAgICAgdGhpcy5fX2NoZWNrUG9pbnRpbmcoYXBwLCBhcHAucG9pbnRpbmcsIDApO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCv+ODg+ODgeODgeOCp+ODg+OCr1xyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGFwcFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9jaGVja1RvdWNoOiBmdW5jdGlvbihhcHApIHtcclxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICB0aGlzLl9fY2hlY2tQb2ludGluZyhhcHAsIGFwcC5wb2ludGluZywgMCk7XHJcbiAgICAgICAgICAgIC8vIGFwcC50b3VjaGVzLmVhY2goZnVuY3Rpb24odG91Y2gsIGkpIHtcclxuICAgICAgICAgICAgLy8gICAgIHNlbGYuX19jaGVja1BvaW50aW5nKGFwcCwgdG91Y2gsIGkpO1xyXG4gICAgICAgICAgICAvLyB9KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODgeOCp+ODg+OCr+ODneOCpOODs+ODs+ODhuOCo+ODs+OCsFxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGFwcFxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwXHJcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IGluZGV4XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX19jaGVja1BvaW50aW5nOiBmdW5jdGlvbihhcHAsIHAsIGluZGV4KSB7XHJcbiAgICAgICAgICAgIHZhciBlbG0gPSB0aGlzLmVsZW1lbnQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgcHJldkhpdEZsYWcgPSB0aGlzLmhpdEZsYWdzW2luZGV4XTtcclxuICAgICAgICAgICAgdGhpcy5oaXRGbGFnc1tpbmRleF0gICAgPSB0aGlzLmlzSGl0UG9pbnQocC54LCBwLnkpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFwcmV2SGl0RmxhZyAmJiB0aGlzLmhpdEZsYWdzW2luZGV4XSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZGlzcGF0Y2hQb2ludGluZ0V2ZW50KFwibW91c2VvdmVyXCIsIFwidG91Y2hvdmVyXCIsIFwicG9pbnRpbmdvdmVyXCIsIGFwcCwgcCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmIChwcmV2SGl0RmxhZyAmJiAhdGhpcy5oaXRGbGFnc1tpbmRleF0pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Rpc3BhdGNoUG9pbnRpbmdFdmVudChcIm1vdXNlb3V0XCIsIFwidG91Y2hvdXRcIiwgXCJwb2ludGluZ291dFwiLCBhcHAsIHApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAodGhpcy5oaXRGbGFnc1tpbmRleF0pIHtcclxuICAgICAgICAgICAgICAgIGlmIChwLmdldFBvaW50aW5nU3RhcnQoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2Rpc3BhdGNoUG9pbnRpbmdFdmVudChcIm1vdXNlZG93blwiLCBcInRvdWNoc3RhcnRcIiwgXCJwb2ludGluZ3N0YXJ0XCIsIGFwcCwgcCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kb3duRmxhZ3NbaW5kZXhdID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jbGlja0ZsYWcgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAodGhpcy5kb3duRmxhZ3NbaW5kZXhdKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kaXNwYXRjaFBvaW50aW5nRXZlbnQoXCJtb3VzZW1vdmVcIiwgXCJ0b3VjaG1vdmVcIiwgXCJwb2ludGluZ21vdmVcIiwgYXBwLCBwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKHRoaXMuZG93bkZsYWdzW2luZGV4XT09dHJ1ZSAmJiBwLmdldFBvaW50aW5nRW5kKCkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Rpc3BhdGNoUG9pbnRpbmdFdmVudChcIm1vdXNldXBcIiwgXCJ0b3VjaGVuZFwiLCBcInBvaW50aW5nZW5kXCIsIGFwcCwgcCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvd25GbGFnc1tpbmRleF0gPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Od44Kk44Oz44OI44Kk44OZ44Oz44OI44KS55m654Gr44GZ44KLXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gbW91c2VcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gdG91Y2hcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gcG9pbnRpbmdcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gYXBwXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHBcclxuICAgICAgICAgKi9cclxuICAgICAgICBfZGlzcGF0Y2hQb2ludGluZ0V2ZW50OiBmdW5jdGlvbihtb3VzZSwgdG91Y2gsIHBvaW50aW5nLCBhcHAsIHApIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KCB0bS5ldmVudC5Nb3VzZUV2ZW50KG1vdXNlLCBhcHAsIHApICk7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCggdG0uZXZlbnQuVG91Y2hFdmVudCh0b3VjaCwgYXBwLCBwKSApO1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoIHRtLmV2ZW50LlBvaW50aW5nRXZlbnQocG9pbnRpbmcsIGFwcCwgcCkgKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODr+ODvOODq+ODieODnuODiOODquODg+OCr+OCueOCkuioiOeul1xyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX2NhbGNXb3JsZE1hdHJpeDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5wYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiA7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIOihjOWIl1xyXG4gICAgICAgICAgICBpZih0aGlzLnJvdGF0aW9uICE9IHRoaXMucm90YXRpb25DYWNoZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yb3RhdGlvbkNhY2hlID0gdGhpcy5yb3RhdGlvbjtcclxuICAgICAgICAgICAgICAgIHZhciByID0gdGhpcy5yb3RhdGlvbipNYXRoLkRFR19UT19SQUQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zciA9ICBNYXRoLnNpbihyKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NyID0gIE1hdGguY29zKHIpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgbG9jYWxUcmFuc2Zvcm0gPSB0aGlzLl9tYXRyaXgubTtcclxuICAgICAgICAgICAgdmFyIHBhcmVudFRyYW5zZm9ybSA9IHRoaXMucGFyZW50Ll93b3JsZE1hdHJpeC5tO1xyXG4gICAgICAgICAgICB2YXIgd29ybGRUcmFuc2Zvcm0gPSB0aGlzLl93b3JsZE1hdHJpeC5tO1xyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGxvY2FsVHJhbnNmb3JtKVxyXG4gICAgICAgICAgICBsb2NhbFRyYW5zZm9ybVswXSA9IHRoaXMuX2NyICogdGhpcy5zY2FsZS54O1xyXG4gICAgICAgICAgICBsb2NhbFRyYW5zZm9ybVsxXSA9LXRoaXMuX3NyICogdGhpcy5zY2FsZS55XHJcbiAgICAgICAgICAgIGxvY2FsVHJhbnNmb3JtWzNdID0gdGhpcy5fc3IgKiB0aGlzLnNjYWxlLng7XHJcbiAgICAgICAgICAgIGxvY2FsVHJhbnNmb3JtWzRdID0gdGhpcy5fY3IgKiB0aGlzLnNjYWxlLnk7XHJcblxyXG4gICAgICAgICAgICAvLyBcclxuICAgICAgICAgICAgbG9jYWxUcmFuc2Zvcm1bMl0gPSB0aGlzLnBvc2l0aW9uLng7XHJcbiAgICAgICAgICAgIGxvY2FsVHJhbnNmb3JtWzVdID0gdGhpcy5wb3NpdGlvbi55O1xyXG5cclxuICAgICAgICAgICAgLy8gY2FjaGVcclxuICAgICAgICAgICAgdmFyIGEwMCA9IGxvY2FsVHJhbnNmb3JtWzBdLCBhMDEgPSBsb2NhbFRyYW5zZm9ybVsxXSwgYTAyID0gbG9jYWxUcmFuc2Zvcm1bMl0sXHJcbiAgICAgICAgICAgICAgICBhMTAgPSBsb2NhbFRyYW5zZm9ybVszXSwgYTExID0gbG9jYWxUcmFuc2Zvcm1bNF0sIGExMiA9IGxvY2FsVHJhbnNmb3JtWzVdLFxyXG5cclxuICAgICAgICAgICAgICAgIGIwMCA9IHBhcmVudFRyYW5zZm9ybVswXSwgYjAxID0gcGFyZW50VHJhbnNmb3JtWzFdLCBiMDIgPSBwYXJlbnRUcmFuc2Zvcm1bMl0sXHJcbiAgICAgICAgICAgICAgICBiMTAgPSBwYXJlbnRUcmFuc2Zvcm1bM10sIGIxMSA9IHBhcmVudFRyYW5zZm9ybVs0XSwgYjEyID0gcGFyZW50VHJhbnNmb3JtWzVdO1xyXG5cclxuICAgICAgICAgICAgd29ybGRUcmFuc2Zvcm1bMF0gPSBiMDAgKiBhMDAgKyBiMDEgKiBhMTA7XHJcbiAgICAgICAgICAgIHdvcmxkVHJhbnNmb3JtWzFdID0gYjAwICogYTAxICsgYjAxICogYTExO1xyXG4gICAgICAgICAgICB3b3JsZFRyYW5zZm9ybVsyXSA9IGIwMCAqIGEwMiArIGIwMSAqIGExMiArIGIwMjtcclxuXHJcbiAgICAgICAgICAgIHdvcmxkVHJhbnNmb3JtWzNdID0gYjEwICogYTAwICsgYjExICogYTEwO1xyXG4gICAgICAgICAgICB3b3JsZFRyYW5zZm9ybVs0XSA9IGIxMCAqIGEwMSArIGIxMSAqIGExMTtcclxuICAgICAgICAgICAgd29ybGRUcmFuc2Zvcm1bNV0gPSBiMTAgKiBhMDIgKyBiMTEgKiBhMTIgKyBiMTI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBkaXJ0eSBtZXRob2RcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9kaXJ0eUNhbGM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLl9jYWxjV29ybGRNYXRyaXgoKTtcclxuICAgICAgICB9LFxyXG4gICAgfSk7XHJcbiBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIHhcclxuICAgICAqIHjluqfmqJnlgKRcclxuICAgICAqL1xyXG4gICAgdG0uYXBwLk9iamVjdDJELnByb3RvdHlwZS5hY2Nlc3NvcihcInhcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLnBvc2l0aW9uLng7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5wb3NpdGlvbi54ID0gdjsgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIHlcclxuICAgICAqIHnluqfmqJnlgKRcclxuICAgICAqL1xyXG4gICAgdG0uYXBwLk9iamVjdDJELnByb3RvdHlwZS5hY2Nlc3NvcihcInlcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLnBvc2l0aW9uLnk7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5wb3NpdGlvbi55ID0gdjsgfVxyXG4gICAgfSk7XHJcbiBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIG9yaWdpblhcclxuICAgICAqIHjluqfmqJnlgKRcclxuICAgICAqL1xyXG4gICAgdG0uYXBwLk9iamVjdDJELnByb3RvdHlwZS5hY2Nlc3NvcihcIm9yaWdpblhcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLm9yaWdpbi54OyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMub3JpZ2luLnggPSB2OyB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgb3JpZ2luWVxyXG4gICAgICogeeW6p+aomeWApFxyXG4gICAgICovXHJcbiAgICB0bS5hcHAuT2JqZWN0MkQucHJvdG90eXBlLmFjY2Vzc29yKFwib3JpZ2luWVwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMub3JpZ2luLnk7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5vcmlnaW4ueSA9IHY7IH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBzY2FsZVhcclxuICAgICAqIOOCueOCseODvOODq1jlgKRcclxuICAgICAqL1xyXG4gICAgdG0uYXBwLk9iamVjdDJELnByb3RvdHlwZS5hY2Nlc3NvcihcInNjYWxlWFwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMuc2NhbGUueDsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLnNjYWxlLnggPSB2OyB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgc2NhbGVZXHJcbiAgICAgKiDjgrnjgrHjg7zjg6tZ5YCkXHJcbiAgICAgKi9cclxuICAgIHRtLmFwcC5PYmplY3QyRC5wcm90b3R5cGUuYWNjZXNzb3IoXCJzY2FsZVlcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLnNjYWxlLnk7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5zY2FsZS55ID0gdjsgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIFxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICB3aWR0aFxyXG4gICAgICogd2lkdGhcclxuICAgICAqL1xyXG4gICAgdG0uYXBwLk9iamVjdDJELnByb3RvdHlwZS5hY2Nlc3NvcihcIndpZHRoXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5fd2lkdGg7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5fd2lkdGggPSB2OyB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBoZWlnaHRcclxuICAgICAqIGhlaWdodFxyXG4gICAgICovXHJcbiAgICB0bS5hcHAuT2JqZWN0MkQucHJvdG90eXBlLmFjY2Vzc29yKFwiaGVpZ2h0XCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5faGVpZ2h0OyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMuX2hlaWdodCA9IHY7IH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICByYWRpdXNcclxuICAgICAqIOWNiuW+hFxyXG4gICAgICovXHJcbiAgICB0bS5hcHAuT2JqZWN0MkQucHJvdG90eXBlLmFjY2Vzc29yKFwicmFkaXVzXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAge1xyXG4gICAgICAgICAgICByZXR1cm4gKHRoaXMuX3JhZGl1cyAhPT0gdW5kZWZpbmVkKSA/IHRoaXMuX3JhZGl1cyA6ICh0aGlzLndpZHRoK3RoaXMuaGVpZ2h0KS80O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5fcmFkaXVzID0gdjsgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIHRvcFxyXG4gICAgICog5bemXHJcbiAgICAgKi9cclxuICAgIHRtLmFwcC5PYmplY3QyRC5wcm90b3R5cGUuYWNjZXNzb3IoXCJ0b3BcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLnkgLSB0aGlzLmhlaWdodCp0aGlzLm9yaWdpblk7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy55ID0gdiArIHRoaXMuaGVpZ2h0KnRoaXMub3JpZ2luWTsgfSxcclxuICAgIH0pO1xyXG4gXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICByaWdodFxyXG4gICAgICog5bemXHJcbiAgICAgKi9cclxuICAgIHRtLmFwcC5PYmplY3QyRC5wcm90b3R5cGUuYWNjZXNzb3IoXCJyaWdodFwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMueCArIHRoaXMud2lkdGgqKDEtdGhpcy5vcmlnaW5YKTsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAgeyB0aGlzLnggPSB2IC0gdGhpcy53aWR0aCooMS10aGlzLm9yaWdpblgpOyB9LFxyXG4gICAgfSk7XHJcbiBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGJvdHRvbVxyXG4gICAgICog5bemXHJcbiAgICAgKi9cclxuICAgIHRtLmFwcC5PYmplY3QyRC5wcm90b3R5cGUuYWNjZXNzb3IoXCJib3R0b21cIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLnkgKyB0aGlzLmhlaWdodCooMS10aGlzLm9yaWdpblkpOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMueSA9IHYgLSB0aGlzLmhlaWdodCooMS10aGlzLm9yaWdpblkpOyB9LFxyXG4gICAgfSk7XHJcbiBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGxlZnRcclxuICAgICAqIOW3plxyXG4gICAgICovXHJcbiAgICB0bS5hcHAuT2JqZWN0MkQucHJvdG90eXBlLmFjY2Vzc29yKFwibGVmdFwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMueCAtIHRoaXMud2lkdGgqdGhpcy5vcmlnaW5YOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMueCA9IHYgKyB0aGlzLndpZHRoKnRoaXMub3JpZ2luWDsgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGNlbnRlclhcclxuICAgICAqIGNlbnRlclhcclxuICAgICAqL1xyXG4gICAgdG0uYXBwLk9iamVjdDJELnByb3RvdHlwZS5hY2Nlc3NvcihcImNlbnRlclhcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLnggKyB0aGlzLndpZHRoLzIgLSB0aGlzLndpZHRoKnRoaXMub3JpZ2luWDsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAge1xyXG4gICAgICAgICAgICAvLyBUT0RPOiDjganjgYbjgZfjgojjgYbjgYvjgao/P1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBjZW50ZXJZXHJcbiAgICAgKiBjZW50ZXJZXHJcbiAgICAgKi9cclxuICAgIHRtLmFwcC5PYmplY3QyRC5wcm90b3R5cGUuYWNjZXNzb3IoXCJjZW50ZXJZXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy55ICsgdGhpcy5oZWlnaHQvMiAtIHRoaXMuaGVpZ2h0KnRoaXMub3JpZ2luWTsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAge1xyXG4gICAgICAgICAgICAvLyBUT0RPOiDjganjgYbjgZfjgojjgYbjgYvjgao/P1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBib3VuZGluZ1R5cGVcclxuICAgICAqIGJvdW5kaW5nVHlwZVxyXG4gICAgICovXHJcbiAgICB0bS5hcHAuT2JqZWN0MkQucHJvdG90eXBlLmFjY2Vzc29yKFwiYm91bmRpbmdUeXBlXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JvdW5kaW5nVHlwZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgdGhpcy5fYm91bmRpbmdUeXBlID0gdjtcclxuICAgICAgICAgICAgdGhpcy5fc2V0SXNIaXRGdW5jKCk7XHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG4gXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBjaGVja0hpZXJhcmNoeVxyXG4gICAgICogY2hlY2tIaWVyYXJjaHlcclxuICAgICAqL1xyXG4gICAgdG0uYXBwLk9iamVjdDJELnByb3RvdHlwZS5hY2Nlc3NvcihcImNoZWNrSGllcmFyY2h5XCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5fY2hlY2tIaWVyYXJjaHk7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHtcclxuICAgICAgICAgICAgdGhpcy5fY2hlY2tIaWVyYXJjaHkgPSB2O1xyXG4gICAgICAgICAgICB0aGlzLl9zZXRJc0hpdEZ1bmMoKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuIFxyXG4gXHJcbiAgICB2YXIgX2lzSGl0RnVuY01hcCA9IHtcclxuICAgICAgICBcInJlY3RcIjogdG0uYXBwLk9iamVjdDJELnByb3RvdHlwZS5pc0hpdFBvaW50UmVjdCxcclxuICAgICAgICBcImNpcmNsZVwiOiB0bS5hcHAuT2JqZWN0MkQucHJvdG90eXBlLmlzSGl0UG9pbnRDaXJjbGUsXHJcbiAgICAgICAgXCJ0cnVlXCI6IGZ1bmN0aW9uKCkgeyByZXR1cm4gdHJ1ZTsgfSxcclxuICAgICAgICBcImZhbHNlXCI6IGZ1bmN0aW9uKCkgeyByZXR1cm4gZmFsc2U7IH0sXHJcbiAgICB9O1xyXG4gXHJcbiAgICB2YXIgX2lzSGl0RnVuY01hcEhpZXJhcmNoeSA9IHtcclxuICAgICAgICBcInJlY3RcIjogdG0uYXBwLk9iamVjdDJELnByb3RvdHlwZS5pc0hpdFBvaW50UmVjdEhpZXJhcmNoeSxcclxuICAgICAgICBcImNpcmNsZVwiOiB0bS5hcHAuT2JqZWN0MkQucHJvdG90eXBlLmlzSGl0UG9pbnRDaXJjbGVIaWVyYXJjaHksXHJcbiAgICAgICAgXCJ0cnVlXCI6IGZ1bmN0aW9uKCkgeyByZXR1cm4gdHJ1ZTsgfSxcclxuICAgICAgICBcImZhbHNlXCI6IGZ1bmN0aW9uKCkgeyByZXR1cm4gZmFsc2U7IH0sXHJcbiAgICB9O1xyXG4gXHJcbiAgICB2YXIgX2lzSGl0RWxlbWVudE1hcCA9IHtcclxuICAgICAgICBcInJlY3RcIjogdG0uYXBwLk9iamVjdDJELnByb3RvdHlwZS5pc0hpdEVsZW1lbnRSZWN0LFxyXG4gICAgICAgIFwiY2lyY2xlXCI6IHRtLmFwcC5PYmplY3QyRC5wcm90b3R5cGUuaXNIaXRFbGVtZW50Q2lyY2xlLFxyXG4gICAgICAgIFwidHJ1ZVwiOiBmdW5jdGlvbigpIHsgcmV0dXJuIHRydWU7IH0sXHJcbiAgICAgICAgXCJmYWxzZVwiOiBmdW5jdGlvbigpIHsgcmV0dXJuIGZhbHNlOyB9LFxyXG4gICAgfTtcclxuIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWVtYmVyICAgICAgdG0uYXBwLk9iamVjdDJEXHJcbiAgICAgKiBAcHJvcGVydHkgICAgX3NldElzSGl0RnVuY1xyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgdG0uYXBwLk9iamVjdDJELnByb3RvdHlwZS5fc2V0SXNIaXRGdW5jID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGlzSGl0RnVuY01hcCA9ICh0aGlzLmNoZWNrSGllcmFyY2h5KSA/IF9pc0hpdEZ1bmNNYXBIaWVyYXJjaHkgOiBfaXNIaXRGdW5jTWFwO1xyXG4gICAgICAgIHZhciBib3VuZGluZ1R5cGUgPSB0aGlzLmJvdW5kaW5nVHlwZTtcclxuICAgICAgICB2YXIgaXNIaXRGdW5jID0gKGlzSGl0RnVuY01hcFtib3VuZGluZ1R5cGVdKSA/IChpc0hpdEZ1bmNNYXBbYm91bmRpbmdUeXBlXSkgOiAoaXNIaXRGdW5jTWFwW1widHJ1ZVwiXSk7XHJcbiBcclxuICAgICAgICB0aGlzLmlzSGl0UG9pbnQgICA9IChpc0hpdEZ1bmNNYXBbYm91bmRpbmdUeXBlXSkgPyAoaXNIaXRGdW5jTWFwW2JvdW5kaW5nVHlwZV0pIDogKGlzSGl0RnVuY01hcFtcInRydWVcIl0pO1xyXG4gICAgICAgIHRoaXMuaXNIaXRFbGVtZW50ID0gKF9pc0hpdEVsZW1lbnRNYXBbYm91bmRpbmdUeXBlXSkgPyAoX2lzSGl0RWxlbWVudE1hcFtib3VuZGluZ1R5cGVdKSA6IChfaXNIaXRFbGVtZW50TWFwW1widHJ1ZVwiXSk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZW1iZXIgICAgICB0bS5hcHAuT2JqZWN0MkRcclxuICAgICAqIEBwcm9wZXJ0eSAgICBfY2hlY2tQb2ludGluZ1xyXG4gICAgICog44Od44Kk44Oz44OI44KS44OB44Kn44OD44KvXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gaXNNb2JpbGVcclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIHRtLmFwcC5PYmplY3QyRC5wcm90b3R5cGUuX2NoZWNrUG9pbnRpbmcgPSAodG0uaXNNb2JpbGUpID9cclxuICAgICAgICB0bS5hcHAuT2JqZWN0MkQucHJvdG90eXBlLl9jaGVja1RvdWNoIDogdG0uYXBwLk9iamVjdDJELnByb3RvdHlwZS5fY2hlY2tNb3VzZTtcclxuXHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG5cclxuXHJcbjsoZnVuY3Rpb24oKSB7XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLmFwcC5HcmlkXHJcbiAgICAgKiBAZXh0ZW5kcyB0bS5hcHAuT2JqZWN0MmRcclxuICAgICAqIOOCsOODquODg+ODiVxyXG4gICAgICovXHJcbiAgICB0bS5kZWZpbmUoXCJ0bS5hcHAuR3JpZFwiLCB7XHJcbiAgICAgICAgc3VwZXJDbGFzczogXCJ0bS5hcHAuT2JqZWN0MkRcIixcclxuXHJcbiAgICAgICAgY2VsbFdpZHRoOiA2NCxcclxuICAgICAgICBjZWxsSGVpZ2h0OiA2NCxcclxuICAgICAgICBtYXhQZXJMaW5lOiA4LFxyXG4gICAgICAgIGFycmFuZ2VtZW50OiBcImhvcml6b250YWxcIiwgLy8gdmVydGljYWxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihwYXJhbSkge1xyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdCgpO1xyXG5cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICByZXBvc2l0aW9uOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGNoaWxkcyA9IHRoaXMuY2hpbGRyZW47XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5hcnJhbmdlbWVudCA9PSBcImhvcml6b250YWxcIikge1xyXG4gICAgICAgICAgICAgICAgY2hpbGRzLmVhY2goZnVuY3Rpb24oY2hpbGQsIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgeEluZGV4ID0gKGkldGhpcy5tYXhQZXJMaW5lKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgeUluZGV4ID0gKGkvdGhpcy5tYXhQZXJMaW5lKXwwO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB4ID0gdGhpcy5jZWxsV2lkdGgqeEluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB5ID0gdGhpcy5jZWxsSGVpZ2h0KnlJbmRleDtcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZC5zZXRQb3NpdGlvbih4LCB5KTtcclxuICAgICAgICAgICAgICAgIH0sIHRoaXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY2hpbGRzLmVhY2goZnVuY3Rpb24oY2hpbGQsIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgeEluZGV4ID0gKGkvdGhpcy5tYXhQZXJMaW5lKXwwO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB5SW5kZXggPSAoaSV0aGlzLm1heFBlckxpbmUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB4ID0gdGhpcy5jZWxsV2lkdGgqeEluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB5ID0gdGhpcy5jZWxsSGVpZ2h0KnlJbmRleDtcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZC5zZXRQb3NpdGlvbih4LCB5KTtcclxuICAgICAgICAgICAgICAgIH0sIHRoaXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxufSkoKTtcclxuXHJcblxyXG4vKlxyXG4gKiBzY2VuZS5qc1xyXG4gKi9cclxuXHJcbnRtLmFwcCA9IHRtLmFwcCB8fCB7fTtcclxuXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLmFwcC5TY2VuZVxyXG4gICAgICog44K344O844Oz44Go44GX44Gm5L2/55So44GZ44KL44Ky44O844Og44Ko44Os44Oh44Oz44OI44Kv44Op44K5XHJcbiAgICAgKiBAZXh0ZW5kcyB0bS5hcHAuT2JqZWN0MkRcclxuICAgICAqL1xyXG4gICAgdG0uYXBwLlNjZW5lID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IHRtLmFwcC5PYmplY3QyRCxcclxuXHJcbiAgICAgICAgYXBwOiBudWxsLFxyXG5cclxuICAgICAgICAvKiogTWFuYWdlclNjZW5lIOe1jOeUseOBp+eUn+aIkOOBleOCjOOBn+mam+OBq+asoeOBq+OBqeOBruOCt+ODvOODs+OBq+mBt+enu+OBmeOCi+OBi+OBruODqeODmeODqyAqL1xyXG4gICAgICAgIG5leHRMYWJlbDogXCJcIixcclxuXHJcbiAgICAgICAgLyoqIE1hbmFnZXJTY2VuZSDntYznlLHjgafnlJ/miJDjgZXjgozjgZ/pmpvjgavmrKHjga7jgrfjg7zjg7PjgavmuKHjgZnlvJXmlbAgKi9cclxuICAgICAgICBuZXh0QXJndW1lbnRzOiBudWxsLFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5zdXBlckluaXQoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuYm91bmRpbmdUeXBlID0gXCJub25lXCI7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDjgr/jg4Pjg4Hjgavlj43lv5zjgZXjgZvjgotcclxuICAgICAgICAgICAgdGhpcy5zZXRJbnRlcmFjdGl2ZSh0cnVlKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBleGl0OiBmdW5jdGlvbihwYXJhbSkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuYXBwKSByZXR1cm4gO1xyXG5cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBwYXJhbSAhPT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0ZW1wID0ge307XHJcbiAgICAgICAgICAgICAgICB0ZW1wLm5leHRMYWJlbCA9IGFyZ3VtZW50c1swXTtcclxuICAgICAgICAgICAgICAgIHRlbXAubmV4dEFyZ3VtZW50cyA9IGFyZ3VtZW50c1sxXTtcclxuICAgICAgICAgICAgICAgIHBhcmFtID0gdGVtcDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHBhcmFtLm5leHRMYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5uZXh0TGFiZWwgPSBwYXJhbS5uZXh0TGFiZWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHBhcmFtLm5leHRBcmd1bWVudHMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubmV4dEFyZ3VtZW50cyA9IHBhcmFtLm5leHRBcmd1bWVudHM7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuYXBwLnBvcFNjZW5lKCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgIH0pO1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuXHJcbi8qXHJcbiAqIGNvbGxpc2lvbi5qc1xyXG4gKi9cclxuXHJcbnRtLmFwcCA9IHRtLmFwcCB8fCB7fTtcclxuXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLmFwcC5Db2xsaXNpb25cclxuICAgICAqIOihneeqgeeuoeeQhuOCr+ODqeOCuVxyXG4gICAgICovXHJcbiAgICB0bS5hcHAuQ29sbGlzaW9uID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBlbGVtZW50OiBudWxsLFxyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgKi9cclxuICAgICAgICBjb2xsaWRlTGlzdDogbnVsbCxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGVsbVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKGVsbSkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbG07XHJcbiAgICAgICAgICAgIHRoaXMuY29sbGlkZUxpc3QgPSBbXTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOabtOaWsFxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBhcHBcclxuICAgICAgICAgKi9cclxuICAgICAgICB1cGRhdGU6IGZ1bmN0aW9uKGFwcCkge1xyXG4gICAgICAgICAgICB2YXIgY2wgID0gdGhpcy5jb2xsaWRlTGlzdC5jbG9uZSgpO1xyXG4gICAgICAgICAgICB2YXIgZWxtID0gdGhpcy5lbGVtZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZm9yICh2YXIgaT0wLGxlbj1jbC5sZW5ndGg7IGk8bGVuOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjID0gY2xbaV07XHJcbiAgICAgICAgICAgICAgICBpZiAoZWxtLmlzSGl0RWxlbWVudChjLmVsZW1lbnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5pyA5Yid44Gu6KGd56qB44Gg44Gj44Gf5aC05ZCI44GvIGNvbGxpc2lvbmVudGVyIOOCkuWRvOOBtlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjLmNvbGxpZGUgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlID0gdG0uZXZlbnQuRXZlbnQoXCJjb2xsaXNpb25lbnRlclwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5vdGhlciA9IGMuZWxlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxtLmRpc3BhdGNoRXZlbnQoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIOmAmuW4uOOBruihneeqgeOCpOODmeODs+ODiFxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlID0gdG0uZXZlbnQuRXZlbnQoXCJjb2xsaXNpb25zdGF5XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGUub3RoZXIgPSBjLmVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxtLmRpc3BhdGNoRXZlbnQoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgYy5jb2xsaWRlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjLmNvbGxpZGUgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IHRtLmV2ZW50LkV2ZW50KFwiY29sbGlzaW9uZXhpdFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5vdGhlciA9IGMuZWxlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxtLmRpc3BhdGNoRXZlbnQoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGMuY29sbGlkZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDov73liqBcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gZWxtXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgYWRkOiBmdW5jdGlvbihlbG0pIHtcclxuICAgICAgICAgICAgdGhpcy5jb2xsaWRlTGlzdC5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGVsbSxcclxuICAgICAgICAgICAgICAgIGNvbGxpZGU6IGZhbHNlLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWJiumZpFxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBlbG1cclxuICAgICAgICAgKi9cclxuICAgICAgICByZW1vdmU6IGZ1bmN0aW9uKGVsbSkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbGxpZGVMaXN0LmVyYXNlSWYoZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHYuZWxlbWVudCA9PSBlbG07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZW1iZXIgICAgICB0bS5hcHAuRWxlbWVudFxyXG4gICAgICogQHByb3BlcnR5ICAgIGNvbGxpc2lvblxyXG4gICAgICog44Kz44Oq44K444On44OzXHJcbiAgICAgKi9cclxuICAgIHRtLmFwcC5FbGVtZW50LnByb3RvdHlwZS5nZXR0ZXIoXCJjb2xsaXNpb25cIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9jb2xsaXNpb24pIHtcclxuICAgICAgICAgICAgdGhpcy5fY29sbGlzaW9uID0gdG0uYXBwLkNvbGxpc2lvbih0aGlzKTtcclxuICAgICAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKFwiZW50ZXJmcmFtZVwiLCBmdW5jdGlvbihlKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NvbGxpc2lvbi51cGRhdGUoZS5hcHApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbGxpc2lvbjtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBcclxufSkoKTtcclxuLypcclxuICogdHdlZW5lci5qc1xyXG4gKi9cclxuXHJcbihmdW5jdGlvbigpIHtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5hcHAuVHdlZW5lclxyXG4gICAgICog44OI44Kl44Kk44O844OK44O844Kv44Op44K5XHJcbiAgICAgKiBAZXh0ZW5kcyB0bS5ldmVudC5FdmVudERpc3BhdGNoZXJcclxuICAgICAqL1xyXG4gICAgdG0uZGVmaW5lKFwidG0uYXBwLlR3ZWVuZXJcIiwge1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IFwidG0uYXBwLkVsZW1lbnRcIixcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGVsbVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKGVsbSkge1xyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdCgpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zZXRUYXJnZXQoZWxtIHx8IHt9KTtcclxuICAgICAgICAgICAgdGhpcy5sb29wID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9pbml0KCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5Yid5pyf5YyWXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX2luaXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLl9pbmRleCA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuX3Rhc2tzID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuX2Z1bmMgPSB0aGlzLl91cGRhdGVUYXNrO1xyXG4gICAgICAgICAgICB0aGlzLmlzUGxheWluZyA9IHRydWU7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44K/44O844Ky44OD44OI44Gu44K744OD44OIXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHRhcmdldFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFRhcmdldDogZnVuY3Rpb24odGFyZ2V0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IHRhcmdldDtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOabtOaWsFxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBhcHBcclxuICAgICAgICAgKi9cclxuICAgICAgICB1cGRhdGU6IGZ1bmN0aW9uKGFwcCkge1xyXG4gICAgICAgICAgICB0aGlzLl9mdW5jKGFwcCk7XHJcbiAgICAgICAgICAgIHJldHVybiA7XHJcbiAgICAgICAgICAgIHZhciB0d2VlbnMgPSB0aGlzLnR3ZWVucy5jbG9uZSgpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpPTAsbGVuPXR3ZWVucy5sZW5ndGg7IGk8bGVuOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0d2VlbiA9IHR3ZWVuc1tpXTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8g5b6F44Gh44OB44Kn44OD44KvXHJcbiAgICAgICAgICAgICAgICBpZiAodHdlZW4uZGVsYXkgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHdlZW4uZGVsYXkgLT0gMTAwMC9hcHAuZnBzO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB2YXIgdGltZSA9IHR3ZWVuLnRpbWUgKyAxMDAwL2FwcC5mcHM7XHJcbiAgICAgICAgICAgICAgICB0d2Vlbi5fc2V0VGltZSh0aW1lKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKHR3ZWVuLnRpbWUgPj0gdHdlZW4uZHVyYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDliYrpmaRcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnR3ZWVucy5lcmFzZSh0d2Vlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5YWo44Gm44Gu44Ki44OL44Oh44O844K344On44Oz57WC5LqG44OB44Kn44OD44KvXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudHdlZW5zLmxlbmd0aCA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaXNBbmltYXRpb24gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSB0bS5ldmVudC5FdmVudChcImZpbmlzaFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmZpcmUoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0d2Vlbi51cGRhdGUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCv+OCueOCr+OBruabtOaWsFxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGFwcFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF91cGRhdGVUYXNrOiBmdW5jdGlvbihhcHApIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmlzUGxheWluZykgcmV0dXJuIDtcclxuXHJcbiAgICAgICAgICAgIHZhciB0YXNrID0gdGhpcy5fdGFza3NbdGhpcy5faW5kZXhdO1xyXG4gICAgICAgICAgICBpZiAoIXRhc2spIHtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5sb29wID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faW5kZXggPSAwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuX2luZGV4Kys7XHJcblxyXG4gICAgICAgICAgICBpZiAodGFzay50eXBlID09IFwidHdlZW5cIikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSB0YXNrLmRhdGE7XHJcbiAgICAgICAgICAgICAgICB2YXIgZm5TdHI9IHRhc2suZGF0YS50eXBlO1xyXG4gICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSB0YXNrLmRhdGEuYXJncztcclxuICAgICAgICAgICAgICAgIHRoaXMuX3R3ZWVuID0gdG0uYW5pbS5Ud2VlbigpO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuX3R3ZWVuW2ZuU3RyXS5hcHBseSh0aGlzLl90d2VlbiwgYXJncyk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5fZnVuYyA9IHRoaXMuX3VwZGF0ZVR3ZWVuO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZnVuYyhhcHApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHRhc2sudHlwZSA9PSBcIndhaXRcIikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fd2FpdCA9IHRhc2suZGF0YTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3dhaXQudGltZSA9IDA7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5fZnVuYyA9IHRoaXMuX3VwZGF0ZVdhaXQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9mdW5jKGFwcCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAodGFzay50eXBlID09IFwiY2FsbFwiKSB7XHJcbiAgICAgICAgICAgICAgICB0YXNrLmRhdGEuZnVuYy5hcHBseSh0YXNrLmRhdGEuc2VsZiwgdGFzay5kYXRhLmFyZ3MpO1xyXG4gICAgICAgICAgICAgICAgLy8gMeODleODrOODvOODoOa2iOiyu+OBl+OBquOBhOOCiOOBhuWGjeW4sFxyXG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlVGFzayhhcHApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHRhc2sudHlwZSA9PSBcInNldFwiKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuJGV4dGVuZCh0YXNrLmRhdGEudmFsdWVzKTtcclxuICAgICAgICAgICAgICAgIC8vIDHjg5Xjg6zjg7zjg6DmtojosrvjgZfjgarjgYTjgojjgYblho3luLBcclxuICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVRhc2soYXBwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFR3ZWVuIOOBruabtOaWsFxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGVsbVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF91cGRhdGVUd2VlbjogZnVuY3Rpb24oYXBwKSB7XHJcbiAgICAgICAgICAgIHZhciB0d2VlbiA9IHRoaXMuX3R3ZWVuO1xyXG4gICAgICAgICAgICB2YXIgdGltZSA9IHR3ZWVuLnRpbWUgKyAxMDAwL2FwcC5mcHM7XHJcbiAgICAgICAgICAgIHR3ZWVuLl9zZXRUaW1lKHRpbWUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKHR3ZWVuLnRpbWUgPj0gdHdlZW4uZHVyYXRpb24pIHtcclxuICAgICAgICAgICAgICAgIC8vIOWJiumZpFxyXG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuX3R3ZWVuO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdHdlZW4gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZnVuYyA9IHRoaXMuX3VwZGF0ZVRhc2s7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0d2Vlbi51cGRhdGUoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmmYLplpPjga7mm7TmlrBcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBlbG1cclxuICAgICAgICAgKi9cclxuICAgICAgICBfdXBkYXRlV2FpdDogZnVuY3Rpb24oYXBwKSB7XHJcbiAgICAgICAgICAgIHZhciB3YWl0ID0gdGhpcy5fd2FpdDtcclxuICAgICAgICAgICAgd2FpdC50aW1lICs9IDEwMDAvYXBwLmZwcztcclxuXHJcbiAgICAgICAgICAgIGlmICh3YWl0LnRpbWUgPj0gd2FpdC5saW1pdCkge1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuX3dhaXQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl93YWl0ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Z1bmMgPSB0aGlzLl91cGRhdGVUYXNrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6L+95YqgXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgYWRkOiBmdW5jdGlvbihwYXJhbSkge1xyXG4gICAgICAgICAgICBpZiAoIXBhcmFtLnRhcmdldCkgcGFyYW0udGFyZ2V0ID0gdGhpcy5lbGVtZW50O1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fdGFza3MucHVzaCh7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiBcInR3ZWVuXCIsXHJcbiAgICAgICAgICAgICAgICBkYXRhOiBwYXJhbVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzQW5pbWF0aW9uID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzQW5pbWF0aW9uID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHZhciBlID0gdG0uZXZlbnQuRXZlbnQoXCJhbmltYXRpb25zdGFydFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5kaXNwYXRjaEV2ZW50KGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmjIflrprjgZfjgZ/lgKTjgpLotrPjgZfjgZ/lgKTjgb7jgafjgqLjg4vjg6Hjg7zjgrfjg6fjg7NcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gcHJvcHNcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gZHVyYXRpb25cclxuICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGJ5OiBmdW5jdGlvbihwcm9wcywgZHVyYXRpb24sIGZuKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2FkZFR3ZWVuVGFzayh7XHJcbiAgICAgICAgICAgICAgICBwcm9wczogcHJvcHMsXHJcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogZHVyYXRpb24sXHJcbiAgICAgICAgICAgICAgICBmbjogZm4sXHJcbiAgICAgICAgICAgICAgICB0eXBlOiBcImJ5XCJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaMh+WumuOBl+OBn+WApOOBvuOBp+OCouODi+ODoeODvOOCt+ODp+ODs1xyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wc1xyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkdXJhdGlvblxyXG4gICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdG86IGZ1bmN0aW9uKHByb3BzLCBkdXJhdGlvbiwgZm4pIHtcclxuICAgICAgICAgICAgdGhpcy5fYWRkVHdlZW5UYXNrKHtcclxuICAgICAgICAgICAgICAgIHByb3BzOiBwcm9wcyxcclxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBkdXJhdGlvbixcclxuICAgICAgICAgICAgICAgIGZuOiBmbixcclxuICAgICAgICAgICAgICAgIHR5cGU6IFwidG9cIlxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZnJvbTogZnVuY3Rpb24ocHJvcHMsIGR1cmF0aW9uLCBmbikge1xyXG4gICAgICAgICAgICB0aGlzLl9hZGRUd2VlblRhc2soe1xyXG4gICAgICAgICAgICAgICAgcHJvcHM6IHByb3BzLFxyXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IGR1cmF0aW9uLFxyXG4gICAgICAgICAgICAgICAgZm46IGZuLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogXCJmcm9tXCJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOenu+WLleOCouODi+ODoeODvOOCt+ODp+ODs1xyXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSB4XHJcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHlcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gZHVyYXRpb25cclxuICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIG1vdmU6IGZ1bmN0aW9uKHgsIHksIGR1cmF0aW9uLCBmbikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy50byh7eDp4LCB5Onl9LCBkdXJhdGlvbiwgZm4pO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaMh+WumuOBl+OBn+WApOOCkui2s+OBl+OBn+W6p+aomeOBvuOBp+OCouODi+ODoeODvOOCt+ODp+ODs1xyXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSB4XHJcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHlcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gZHVyYXRpb25cclxuICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIG1vdmVCeTogZnVuY3Rpb24oeCwgeSwgZHVyYXRpb24sIGZuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJ5KHt4OngsIHk6eX0sIGR1cmF0aW9uLCBmbik7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5Zue6Lui44Ki44OL44Oh44O844K344On44OzXHJcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHJvdGF0aW9uXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGR1cmF0aW9uXHJcbiAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm5cclxuICAgICAgICAgKi9cclxuICAgICAgICByb3RhdGU6IGZ1bmN0aW9uKHJvdGF0aW9uLCBkdXJhdGlvbiwgZm4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudG8oe3JvdGF0aW9uOnJvdGF0aW9ufSwgZHVyYXRpb24sIGZuKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmi6HnuK7jgqLjg4vjg6Hjg7zjgrfjg6fjg7NcclxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gc2NhbGVcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gZHVyYXRpb25cclxuICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNjYWxlOiBmdW5jdGlvbihzY2FsZSwgZHVyYXRpb24sIGZuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRvKHtzY2FsZVg6c2NhbGUsIHNjYWxlWTpzY2FsZX0sIGR1cmF0aW9uLCBmbik7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44OV44Kn44O844OJ44Ki44OL44Oh44O844K344On44OzXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHZhbHVlXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGR1cmF0aW9uXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZmFkZTogZnVuY3Rpb24odmFsdWUsIGR1cmF0aW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMudG8oe1wiYWxwaGFcIjp2YWx1ZX0sIGR1cmF0aW9uKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44OV44Kn44O844OJ44Kk44OzXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGR1cmF0aW9uXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZmFkZUluOiBmdW5jdGlvbihkdXJhdGlvbikge1xyXG4gICAgICAgICAgICB0aGlzLmZhZGUoMS4wLCBkdXJhdGlvbik7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODleOCp+ODvOODieOCouOCpuODiFxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkdXJhdGlvblxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZhZGVPdXQ6IGZ1bmN0aW9uKGR1cmF0aW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmFkZSgwLjAsIGR1cmF0aW9uKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVHdlZW4g44Gu44K/44K544Kv44KS6L+95YqgXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gcGFyYW1cclxuICAgICAgICAgKi9cclxuICAgICAgICBfYWRkVHdlZW5UYXNrOiBmdW5jdGlvbihwYXJhbSkge1xyXG4gICAgICAgICAgICBwYXJhbS50YXJnZXQgICA9IChwYXJhbS50YXJnZXQgIT09IHVuZGVmaW5lZCkgPyBwYXJhbS50YXJnZXQgOiB0aGlzLmVsZW1lbnQ7XHJcbiAgICAgICAgICAgIHBhcmFtLmR1cmF0aW9uID0gKHBhcmFtLmR1cmF0aW9uICE9PSB1bmRlZmluZWQpID8gcGFyYW0uZHVyYXRpb24gOiAxMDAwO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fdGFza3MucHVzaCh7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiBcInR3ZWVuXCIsXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXJnczogW3BhcmFtLnRhcmdldCwgcGFyYW0ucHJvcHMsIHBhcmFtLmR1cmF0aW9uLCBwYXJhbS5mbl0sXHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogcGFyYW0udHlwZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzQW5pbWF0aW9uID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzQW5pbWF0aW9uID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHZhciBlID0gdG0uZXZlbnQuRXZlbnQoXCJhbmltYXRpb25zdGFydFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5kaXNwYXRjaEV2ZW50KGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlvoXjgaHmmYLplpNcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gdGltZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHdhaXQ6IGZ1bmN0aW9uKHRpbWUpIHtcclxuICAgICAgICAgICAgdGhpcy5fdGFza3MucHVzaCh7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiBcIndhaXRcIixcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICBsaW1pdDogdGltZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Kz44O844Or44OQ44OD44Kv44KS55m76YyyXHJcbiAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm5cclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gYXJnc1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGNhbGw6IGZ1bmN0aW9uKGZuLCBzZWxmLCBhcmdzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Rhc2tzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgdHlwZTogXCJjYWxsXCIsXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZnVuYzogZm4sXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZjogc2VsZiB8fCB0aGlzLFxyXG4gICAgICAgICAgICAgICAgICAgIGFyZ3M6IGFyZ3MsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODl+ODreODkeODhuOCo+OCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBrZXlcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gdmFsdWVcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgdmFyIHZhbHVlcyA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09IDIpIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlcyA9IHt9O1xyXG4gICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlcyA9IGtleTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLl90YXNrcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IFwic2V0XCIsXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiB2YWx1ZXNcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgqLjg4vjg6Hjg7zjgrfjg6fjg7Pplovlp4tcclxuICAgICAgICAgKi9cclxuICAgICAgICBwbGF5OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgqLjg4vjg6Hjg7zjgrfjg6fjg7PjgpLkuIDmmYLlgZzmraJcclxuICAgICAgICAgKi9cclxuICAgICAgICBwYXVzZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNQbGF5aW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCouODi+ODoeODvOOCt+ODp+ODs+OCkuW3u+OBjeaIu+OBmVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJld2luZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2Z1bmMgPSB0aGlzLl91cGRhdGVUYXNrO1xyXG4gICAgICAgICAgICB0aGlzLl9pbmRleCA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMucGxheSgpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgqLjg4vjg6Hjg7zjgrfjg6fjg7Pjg6vjg7zjg5foqK3lrppcclxuICAgICAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGZsYWdcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRMb29wOiBmdW5jdGlvbihmbGFnKSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9vcCA9IGZsYWc7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCouODi+ODoeODvOOCt+ODp+ODs+OCkuOCr+ODquOColxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGNsZWFyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5faW5pdCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBtZW1iZXIgICAgICB0bS5hcHAuRWxlbWVudFxyXG4gICAgICogQHByb3BlcnR5ICAgIHR3ZWVuZXJcclxuICAgICAqIOODiOOCpeOCpOODvOODs+OCouODi+ODoeODvOOCt+ODp+ODs1xyXG4gICAgICovXHJcbiAgICB0bS5hcHAuRWxlbWVudC5wcm90b3R5cGUuZ2V0dGVyKFwidHdlZW5lclwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoIXRoaXMuX3R3ZWVuZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5fdHdlZW5lciA9IHRtLmFwcC5Ud2VlbmVyKHRoaXMpO1xyXG4gICAgICAgICAgICB0aGlzLm9uKFwiZW50ZXJmcmFtZVwiLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90d2VlbmVyLnVwZGF0ZShlLmFwcCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gdGhpcy5fdHdlZW5lcjtcclxuICAgIH0pO1xyXG59KSgpO1xyXG5cclxuLypcclxuICogdGltZWxpbmUuanNcclxuICovXHJcblxyXG50bS5uYW1lc3BhY2UoXCJ0bS5hcHBcIiwgZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uYXBwLlRpbWVsaW5lXHJcbiAgICAgKiDjgr/jgqTjg6Djg6njgqTjg7Pjgq/jg6njgrlcclxuICAgICAqIEBleHRlbmRzIHRtLmV2ZW50LkV2ZW50RGlzcGF0Y2hlclxyXG4gICAgICovXHJcbiAgICB0bS5kZWZpbmUoXCJ0bS5hcHAuVGltZWxpbmVcIiwge1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IFwidG0uYXBwLkVsZW1lbnRcIixcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gZWxtXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oZWxtKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3VwZXJJbml0KCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLnNldFRhcmdldChlbG0gfHwge30pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50RnJhbWUgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRUaW1lID0gMDtcclxuICAgICAgICAgICAgdGhpcy5wcmV2VGltZSA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuZHVyYXRpb24gPSAwO1xyXG4gICAgICAgICAgICB0aGlzLmlzUGxheSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX3R3ZWVucyAgPSBbXTtcclxuICAgICAgICAgICAgdGhpcy5fYWN0aW9ucyA9IFtdO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5pu05pawXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGFwcFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHVwZGF0ZTogZnVuY3Rpb24oYXBwKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5pc1BsYXkpIHJldHVybiA7XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2VGltZSA8PSB0aGlzLmR1cmF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVUd2VlbigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlQWN0aW9uKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEZyYW1lKys7XHJcbiAgICAgICAgICAgIHRoaXMucHJldlRpbWUgPSB0aGlzLmN1cnJlbnRUaW1lO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRUaW1lID0gKCh0aGlzLmN1cnJlbnRGcmFtZS9hcHAuZnBzKSoxMDAwKXwwO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44OI44Kl44Kk44O844Oz44KS5pu05pawXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfdXBkYXRlVHdlZW46IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgdHdlZW5zID0gdGhpcy5fdHdlZW5zO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpPTAsbGVuPXR3ZWVucy5sZW5ndGg7IGk8bGVuOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0d2VlbiA9IHR3ZWVuc1tpXTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKHR3ZWVuLmRlbGF5ID4gdGhpcy5jdXJyZW50VGltZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlIDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgdmFyIHRpbWUgPSB0aGlzLmN1cnJlbnRUaW1lIC0gdHdlZW4uZGVsYXk7XHJcbiAgICAgICAgICAgICAgICB0d2Vlbi5fc2V0VGltZSh0aW1lKTtcclxuICAgICAgICAgICAgICAgIGlmICh0d2Vlbi50aW1lID49IHR3ZWVuLmR1cmF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0d2Vlbi51cGRhdGUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Ki44Kv44K344On44Oz44KS5pu05pawXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfdXBkYXRlQWN0aW9uOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGFjdGlvbnMgPSB0aGlzLl9hY3Rpb25zO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZm9yICh2YXIgaT0wLGxlbj1hY3Rpb25zLmxlbmd0aDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IGFjdGlvbnNbaV07XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnByZXZUaW1lIDw9IGFjdGlvbi5kZWxheSAmJiBhY3Rpb24uZGVsYXkgPCB0aGlzLmN1cnJlbnRUaW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGlvbi50eXBlID09IFwiY2FsbFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5mdW5jLmNhbGwoYWN0aW9uLnNlbGYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhY3Rpb24uZnVuYygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChhY3Rpb24udHlwZSA9PSBcInNldFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9wcyA9IGFjdGlvbi5wcm9wcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHByb3BzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnRba2V5XSA9IHByb3BzW2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaMh+WumuOBl+OBn+WApOOBvuOBp+OCouODi+ODoeODvOOCt+ODp+ODs1xyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkZWxheVxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wc1xyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkdXJhdGlvblxyXG4gICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmNcclxuICAgICAgICAgKi9cclxuICAgICAgICB0bzogZnVuY3Rpb24oZGVsYXksIHByb3BzLCBkdXJhdGlvbiwgZm4pIHtcclxuICAgICAgICAgICAgY29uc29sZS5hc3NlcnQodHlwZW9mIGRlbGF5ID09IFwibnVtYmVyXCIsIFwidG8g44Gu56ys5LiA5byV5pWw44GvZGVsYXnjgavlpInjgo/jgorjgb7jgZfjgZ9cIik7XHJcbiAgICAgICAgICAgIHRoaXMuX2FkZFR3ZWVuKHtcclxuICAgICAgICAgICAgICAgIHByb3BzOiBwcm9wcyxcclxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBkdXJhdGlvbixcclxuICAgICAgICAgICAgICAgIGZuOiBmbixcclxuICAgICAgICAgICAgICAgIGRlbGF5OiBkZWxheVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaMh+WumuOBl+OBn+WApOOCkui2s+OBl+OBn+WApOOBvuOBp+OCouODi+ODoeODvOOCt+ODp+ODs1xyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkZWxheVxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wc1xyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkdXJhdGlvblxyXG4gICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmNcclxuICAgICAgICAgKi9cclxuICAgICAgICBieTogZnVuY3Rpb24oZGVsYXksIHByb3BzLCBkdXJhdGlvbiwgZm4pIHtcclxuICAgICAgICAgICAgY29uc29sZS5hc3NlcnQodHlwZW9mIGRlbGF5ID09IFwibnVtYmVyXCIsIFwiYnkg44Gu56ys5LiA5byV5pWw44GvZGVsYXnjgavlpInjgo/jgorjgb7jgZfjgZ9cIik7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBwcm9wcykge1xyXG4gICAgICAgICAgICAgICAgcHJvcHNba2V5XSArPSB0aGlzLmVsZW1lbnRba2V5XSB8fCAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuX2FkZFR3ZWVuKHtcclxuICAgICAgICAgICAgICAgIHByb3BzOiBwcm9wcyxcclxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBkdXJhdGlvbixcclxuICAgICAgICAgICAgICAgIGZuOiBmbixcclxuICAgICAgICAgICAgICAgIGRlbGF5OiBkZWxheVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6Zai5pWw44KS5a6f6KGMXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGRlbGF5XHJcbiAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuY1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGNhbGw6IGZ1bmN0aW9uKGRlbGF5LCBmdW5jLCBzZWxmKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuYXNzZXJ0KHR5cGVvZiBkZWxheSA9PSBcIm51bWJlclwiLCBcImNhbGwg44Gu56ys5LiA5byV5pWw44GvZGVsYXnjgavlpInjgo/jgorjgb7jgZfjgZ9cIik7XHJcbiAgICAgICAgICAgIHRoaXMuX2FkZEFjdGlvbih7XHJcbiAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJjYWxsXCIsXHJcbiAgICAgICAgICAgICAgICBmdW5jOiBmdW5jLFxyXG4gICAgICAgICAgICAgICAgc2VsZjogc2VsZiB8fCB0aGlzLFxyXG4gICAgICAgICAgICAgICAgZGVsYXk6IGRlbGF5LFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg5fjg63jg5Hjg4bjgqPjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gZGVsYXlcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gcHJvcHNcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uKGRlbGF5LCBwcm9wcykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmFzc2VydCh0eXBlb2YgZGVsYXkgPT0gXCJudW1iZXJcIiwgXCJzZXQg44Gu56ys5LiA5byV5pWw44GvZGVsYXnjgavlpInjgo/jgorjgb7jgZfjgZ9cIik7XHJcbiAgICAgICAgICAgIHRoaXMuX2FkZEFjdGlvbih7XHJcbiAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJzZXRcIixcclxuICAgICAgICAgICAgICAgIHByb3BzOiBwcm9wcyxcclxuICAgICAgICAgICAgICAgIGRlbGF5OiBkZWxheSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgr/jg7zjgrLjg4Pjg4jjga7jgrvjg4Pjg4hcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gdGFyZ2V0XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0VGFyZ2V0OiBmdW5jdGlvbih0YXJnZXQpIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gdGFyZ2V0O1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44K/44O844Ky44OD44OI44KS44Ky44OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0VGFyZ2V0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCouODi+ODoeODvOOCt+ODp+ODs+mWi+Wni1xyXG4gICAgICAgICAqIOOCouODi+ODoeODvOOCt+ODp+ODs+OBjOe1guS6huOBl+OBn+OCieWGjeW6puOCouODi+ODoeODvOOCt+ODp+ODs+OCkuihjOOBhlxyXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBmcmFtZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdvdG9BbmRQbGF5OiBmdW5jdGlvbihmcmFtZSkge1xyXG4gICAgICAgICAgICB0aGlzLmlzUGxheSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEZyYW1lID0gZnJhbWU7XHJcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVR3ZWVuKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgqLjg4vjg6Hjg7zjgrfjg6fjg7Pplovlp4tcclxuICAgICAgICAgKiDjgqLjg4vjg6Hjg7zjgrfjg6fjg7PjgYzntYLkuobjgZfjgZ/jgonjgrnjg4jjg4Pjg5fjgZnjgotcclxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gZnJhbWVcclxuICAgICAgICAgKi9cclxuICAgICAgICBnb3RvQW5kU3RvcDogZnVuY3Rpb24oZnJhbWUpIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50RnJhbWUgPSBmcmFtZTtcclxuICAgICAgICAgICAgdGhpcy5pc1BsYXkgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5fdXBkYXRlVHdlZW4oKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiB0d2VlbiDjgpLov73liqBcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSB0d2VlblxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9hZGRUd2VlbjogZnVuY3Rpb24odHdlZW4pIHtcclxuICAgICAgICAgICAgdHdlZW4uZHVyYXRpb24gPSB0d2Vlbi5kdXJhdGlvbiB8fCAxMDAwO1xyXG4gICAgICAgICAgICB0d2Vlbi5kdXJhdGlvbiA9IHRoaXMuX2RpcnR5KHR3ZWVuLmR1cmF0aW9uKTtcclxuICAgICAgICAgICAgdHdlZW4uZGVsYXkgPSB0d2Vlbi5kZWxheSB8fCAwO1xyXG4gICAgICAgICAgICB0d2Vlbi5kZWxheSA9IHRoaXMuX2RpcnR5KHR3ZWVuLmRlbGF5KTtcclxuXHJcbiAgICAgICAgICAgIHZhciB0d2Vlbk9iaiA9IHRtLmFuaW0uVHdlZW4oKTtcclxuICAgICAgICAgICAgdHdlZW5PYmoudG8odGhpcy5lbGVtZW50LCB0d2Vlbi5wcm9wcywgdHdlZW4uZHVyYXRpb24sIHR3ZWVuLmZuKTtcclxuICAgICAgICAgICAgdHdlZW5PYmouZGVsYXkgPSB0d2Vlbi5kZWxheTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3R3ZWVucy5wdXNoKHR3ZWVuT2JqKTtcclxuICAgICAgICAgICAgdGhpcy5fdXBkYXRlRHVyYXRpb24odHdlZW5PYmopO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCouODi+ODoeODvOOCt+ODp+ODs+OCkui/veWKoFxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGFjdGlvblxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9hZGRBY3Rpb246IGZ1bmN0aW9uKGFjdGlvbikge1xyXG4gICAgICAgICAgICBhY3Rpb24uZGVsYXkgPSBhY3Rpb24uZGVsYXkgfHwgMDtcclxuICAgICAgICAgICAgYWN0aW9uLmRlbGF5ID0gdGhpcy5fZGlydHkoYWN0aW9uLmRlbGF5KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX2FjdGlvbnMucHVzaChhY3Rpb24pO1xyXG4gICAgICAgICAgICB0aGlzLl91cGRhdGVEdXJhdGlvbihhY3Rpb24pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5pmC6ZaT44KS5pu05pawXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gdGFza1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF91cGRhdGVEdXJhdGlvbjogZnVuY3Rpb24odGFzaykge1xyXG4gICAgICAgICAgICB2YXIgZHVyYXRpb24gPSB0YXNrLmRlbGF5ICsgKHRhc2suZHVyYXRpb24gPyB0YXNrLmR1cmF0aW9uIDogMCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmR1cmF0aW9uIDwgZHVyYXRpb24pIHRoaXMuZHVyYXRpb24gPSBkdXJhdGlvbjtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogZGlydHkgbWV0aG9kXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gdFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9kaXJ0eTogZnVuY3Rpb24odCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdDtcclxuLy8gICAgICAgICAgICByZXR1cm4gKHQvdGhpcy5mcHMpLnRvSW50KCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg63jg7zjg4lcclxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGxvYWQ6IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBkYXRhLnRpbWVsaW5lKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBkYXRhLnRpbWVsaW5lW2tleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Ki44OL44Oh44O844K344On44Oz44KS44Kv44Oq44KiXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY2xlYXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRGcmFtZSA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMucHJldlRpbWUgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRUaW1lID0gMDtcclxuICAgICAgICAgICAgdGhpcy5kdXJhdGlvbiA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuaXNQbGF5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5fdHdlZW5zICA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLl9hY3Rpb25zID0gW107XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgXHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1lbWJlciAgICAgIHRtLmFwcC5FbGVtZW50XHJcbiAgICAgKiBAcHJvcGVydHkgICAgdGltZWxpbmVcclxuICAgICAqIOOCv+OCpOODoOODqeOCpOODs+OCouODi+ODoeODvOOCt+ODp+ODs1xyXG4gICAgICovXHJcbiAgICB0bS5hcHAuRWxlbWVudC5wcm90b3R5cGUuZ2V0dGVyKFwidGltZWxpbmVcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLl90aW1lbGluZSkge1xyXG4gICAgICAgICAgICB0aGlzLl90aW1lbGluZSA9IHRtLmFwcC5UaW1lbGluZSh0aGlzKTtcclxuICAgICAgICAgICAgdGhpcy5vbihcImVudGVyZnJhbWVcIiwgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdGltZWxpbmUudXBkYXRlKGUuYXBwKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5fdGltZWxpbmU7XHJcbiAgICB9KTtcclxuICAgIFxyXG59KTtcclxuXHJcbi8qXHJcbiAqIGNhbnZhc2FwcC5qc1xyXG4gKi9cclxuXHJcbnRtLmRpc3BsYXkgPSB0bS5kaXNwbGF5IHx8IHt9O1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLmRpc3BsYXkuQ2FudmFzQXBwXHJcbiAgICAgKiDjgq3jg6Pjg7Pjg5DjgrnjgqLjg5fjg6rjgrHjg7zjgrfjg6fjg7NcclxuICAgICAqIEBleHRlbmRzIHRtLmFwcC5CYXNlQXBwXHJcbiAgICAgKi9cclxuICAgIHRtLmRpc3BsYXkuQ2FudmFzQXBwID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IHRtLmFwcC5CYXNlQXBwLFxyXG5cclxuICAgICAgICAvKiogQHByb3BlcnR5IGVsZW1lbnQgKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5IGNhbnZhcyAqL1xyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgcmVuZGVyZXIgKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5IGJhY2tncm91bmQgKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5IF9zY2VuZXMgKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5IG1vdXNlICovXHJcbiAgICAgICAgLyoqIEBwcm9wZXJ0eSB0b3VjaCAqL1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKGNhbnZhcykge1xyXG4gICAgICAgICAgICBpZiAoY2FudmFzIGluc3RhbmNlb2YgSFRNTENhbnZhc0VsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IGNhbnZhcztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgY2FudmFzID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY2FudmFzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIOimquOBruWIneacn+WMllxyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdCh0aGlzLmVsZW1lbnQpO1xyXG5cclxuICAgICAgICAgICAgLy8g44Kw44Op44OV44Kj44OD44Kv44K544KS55Sf5oiQXHJcbiAgICAgICAgICAgIHRoaXMuY2FudmFzID0gdG0uZ3JhcGhpY3MuQ2FudmFzKHRoaXMuZWxlbWVudCk7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIgPSB0bS5kaXNwbGF5LkNhbnZhc1JlbmRlcmVyKHRoaXMuY2FudmFzKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIOOCq+ODqeODvFxyXG4gICAgICAgICAgICB0aGlzLmJhY2tncm91bmQgPSBcImJsYWNrXCI7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDjgrfjg7zjg7PlkajjgopcclxuICAgICAgICAgICAgdGhpcy5fc2NlbmVzID0gWyB0bS5hcHAuU2NlbmUoKSBdO1xyXG5cclxuXHJcbiAgICAgICAgICAgIHRoaXMuX2NhbnZhc0NhY2hlID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuX2NhbnZhc0NhY2hlQ2FjaGUgPSBbXTtcclxuICAgICAgICAgICAgdGhpcy5vbihcInB1c2hcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kcmF3KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGNhbnZhcyA9IHRoaXMuX2NhbnZhc0NhY2hlQ2FjaGUucG9wKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWNhbnZhcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5jYW52YXMuZWxlbWVudC5jbG9uZU5vZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMgPSB0bS5ncmFwaGljcy5DYW52YXMoZWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5kcmF3VGV4dHVyZSh0aGlzLmNhbnZhcywgMCwgMCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jYW52YXNDYWNoZS5wdXNoKGNhbnZhcyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLm9uKFwicG9wZWRcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2FudmFzID0gdGhpcy5fY2FudmFzQ2FjaGUucG9wKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kcmF3KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2FudmFzQ2FjaGVDYWNoZS5wdXNoKGNhbnZhcyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Oq44K144Kk44K6XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcmVzaXplOiBmdW5jdGlvbih3aWR0aCwgaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcclxuICAgICAgICAgICAgdGhpcy5oZWlnaHQ9IGhlaWdodDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCpuOCo+ODs+ODieOCpuOBruOCteOCpOOCuuOBq+ODquOCteOCpOOCulxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJlc2l6ZVdpbmRvdzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSBpbm5lcldpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLmhlaWdodD0gaW5uZXJIZWlnaHQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOeUu+mdouOBq+ODleOCo+ODg+ODiOOBleOBm+OCi1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZpdFdpbmRvdzogZnVuY3Rpb24oZXZlckZsYWcpIHtcclxuICAgICAgICAgICAgLy8g55S76Z2i44Gr44OV44Kj44OD44OIXHJcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLmZpdFdpbmRvdyhldmVyRmxhZyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDjg57jgqbjgrnjgajjgr/jg4Pjg4Hjga7luqfmqJnmm7TmlrDplqLmlbDjgpLjg5Hjg6/jg7zjgqLjg4Pjg5dcclxuICAgICAgICAgICAgdGhpcy5tb3VzZS5fbW91c2Vtb3ZlID0gdGhpcy5tb3VzZS5fbW91c2Vtb3ZlU2NhbGU7XHJcbiAgICAgICAgICAgIHRoaXMudG91Y2guX3RvdWNobW92ZSA9IHRoaXMudG91Y2guX3RvdWNobW92ZVNjYWxlO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfZHJhdzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLmNsZWFyKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5maWxsU3R5bGUgICA9IFwid2hpdGVcIjtcclxuICAgICAgICAgICAgdGhpcy5jYW52YXMuc3Ryb2tlU3R5bGUgPSBcIndoaXRlXCI7XHJcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLmNvbnRleHQubGluZUpvaW4gPSBcInJvdW5kXCI7XHJcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLmNvbnRleHQubGluZUNhcCAgPSBcInJvdW5kXCI7XHJcblxyXG4gICAgICAgICAgICAvLyDjgrnjgr/jg4Pjgq/jgZfjgZ/jgq3jg6Pjg7Pjg5DjgrnjgpLmj4/nlLtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2NhbnZhc0NhY2hlLmxhc3QpXHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhbnZhcy5kcmF3VGV4dHVyZSh0aGlzLl9jYW52YXNDYWNoZS5sYXN0LCAwLCAwKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIHRoaXMuX2NhbnZhc0NhY2hlLmVhY2goZnVuY3Rpb24oYml0bWFwLCBpbmRleCkge1xyXG4gICAgICAgICAgICAvLyAgICAgdGhpcy5jYW52YXMuZHJhd0JpdG1hcChiaXRtYXAsIDAsIDApO1xyXG4gICAgICAgICAgICAvLyB9LCB0aGlzKTtcclxuXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDmj4/nlLvjga/lhajjgabjga7jgrfjg7zjg7PooYzjgYZcclxuICAgICAgICAgICAgdGhpcy5jYW52YXMuc2F2ZSgpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5yZW5kZXIodGhpcy5jdXJyZW50U2NlbmUpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jYW52YXMucmVzdG9yZSgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICB3aWR0aFxyXG4gICAgICog5bmFXHJcbiAgICAgKi9cclxuICAgIHRtLmRpc3BsYXkuQ2FudmFzQXBwLnByb3RvdHlwZS5hY2Nlc3NvcihcIndpZHRoXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5jYW52YXMud2lkdGg7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5jYW52YXMud2lkdGggPSB2OyB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgaGVpZ2h0XHJcbiAgICAgKiDpq5jjgZVcclxuICAgICAqL1xyXG4gICAgdG0uZGlzcGxheS5DYW52YXNBcHAucHJvdG90eXBlLmFjY2Vzc29yKFwiaGVpZ2h0XCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5jYW52YXMuaGVpZ2h0OyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7IHRoaXMuY2FudmFzLmhlaWdodCA9IHY7IH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBoZWlnaHRcclxuICAgICAqIOmrmOOBlVxyXG4gICAgICovXHJcbiAgICB0bS5kaXNwbGF5LkNhbnZhc0FwcC5wcm90b3R5cGUuYWNjZXNzb3IoXCJiYWNrZ3JvdW5kXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5jYW52YXMuX2JhY2tncm91bmQ7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHtcclxuICAgICAgICAgICAgdGhpcy5fYmFja2dyb3VuZCA9IHY7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kID0gdjtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbn0pKCk7XHJcblxyXG5cclxuXHJcbi8qXHJcbiAqIGNhbnZhc2VsZW1lbnQuanNcclxuICovXHJcblxyXG50bS5kaXNwbGF5ID0gdG0uZGlzcGxheSB8fCB7fTtcclxuXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZGlzcGxheS5DYW52YXNFbGVtZW50XHJcbiAgICAgKiDjgq3jg6Pjg7Pjg5Djgrnjgqjjg6zjg6Hjg7Pjg4hcclxuICAgICAqIEBleHRlbmRzIHRtLmFwcC5PYmplY3QyRFxyXG4gICAgICovXHJcbiAgICB0bS5kaXNwbGF5LkNhbnZhc0VsZW1lbnQgPSB0bS5jcmVhdGVDbGFzcyh7XHJcbiAgICAgICAgc3VwZXJDbGFzczogdG0uYXBwLk9iamVjdDJELFxyXG5cclxuICAgICAgICAvKiog6KGo56S644OV44Op44KwICovXHJcbiAgICAgICAgdmlzaWJsZTogdHJ1ZSxcclxuICAgICAgICAvKiog44Kv44Oq44OD44OU44Oz44Kw44OV44Op44KwICovXHJcbiAgICAgICAgY2xpcHBpbmc6IGZhbHNlLFxyXG4gICAgICAgIC8qKiBmaWxsU3R5bGUgKi9cclxuICAgICAgICBmaWxsU3R5bGU6IFwid2hpdGVcIixcclxuICAgICAgICAvKiogc3Ryb2tlU3R5bGUgKi9cclxuICAgICAgICBzdHJva2VTdHlsZTogXCJ3aGl0ZVwiLFxyXG4gICAgICAgIC8qKiDjgqLjg6vjg5XjgqEgKi9cclxuICAgICAgICBhbHBoYTogMS4wLFxyXG4gICAgICAgIC8qKiDjg5bjg6zjg7Pjg4njg6Ljg7zjg4kgKi9cclxuICAgICAgICBibGVuZE1vZGU6IFwic291cmNlLW92ZXJcIixcclxuICAgICAgICAvKiog44K344Oj44OJ44Km44Kr44Op44O8ICovXHJcbiAgICAgICAgc2hhZG93Q29sb3I6IFwiYmxhY2tcIixcclxuICAgICAgICAvKiog44K344Oj44OJ44Km44Kq44OV44K744OD44OIWCAqL1xyXG4gICAgICAgIHNoYWRvd09mZnNldFg6IDAsXHJcbiAgICAgICAgLyoqIOOCt+ODo+ODieOCpuOCquODleOCu+ODg+ODiFkgKi9cclxuICAgICAgICBzaGFkb3dPZmZzZXRZOiAwLFxyXG4gICAgICAgIC8qKiDjgrfjg6Pjg4njgqbjgqrjg5Xjg5bjg6njg7wgKi9cclxuICAgICAgICBzaGFkb3dCbHVyOiAwLFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5zdXBlckluaXQoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgqLjg6vjg5XjgqHjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRBbHBoYTogZnVuY3Rpb24oYWxwaGEpIHtcclxuICAgICAgICAgICAgdGhpcy5hbHBoYSA9IGFscGhhO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgrfjg6Pjg4njgqbjgqvjg6njg7zjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRTaGFkb3dDb2xvcjogZnVuY3Rpb24oY29sb3IpIHtcclxuICAgICAgICAgICAgdGhpcy5zaGFkb3dDb2xvciA9IGNvbG9yO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCt+ODo+ODieOCpuODluODqeODvOOCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFNoYWRvd0JsdXI6IGZ1bmN0aW9uKGJsdXIpIHtcclxuICAgICAgICAgICAgdGhpcy5zaGFkb3dCbHVyID0gYmx1cjtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgrfjg6Pjg4njgqbjgqrjg5Xjgrvjg4Pjg4jjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRTaGFkb3dPZmZzZXQ6IGZ1bmN0aW9uKHgsIHkpIHtcclxuICAgICAgICAgICAgdGhpcy5zaGFkb3dPZmZzZXRYID0geDtcclxuICAgICAgICAgICAgdGhpcy5zaGFkb3dPZmZzZXRZID0geTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44OQ44Km44Oz44OH44Kj44Oz44Kw44K144O844Kv44Or44KS5o+P55S7XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZHJhd0JvdW5kaW5nQ2lyY2xlOiBmdW5jdGlvbihjYW52YXMpIHtcclxuICAgICAgICAgICAgY2FudmFzLnNhdmUoKTtcclxuICAgICAgICAgICAgY2FudmFzLmxpbmVXaWR0aCA9IDI7XHJcbiAgICAgICAgICAgIGNhbnZhcy5zdHJva2VDaXJjbGUoMCwgMCwgdGhpcy5yYWRpdXMpO1xyXG4gICAgICAgICAgICBjYW52YXMucmVzdG9yZSgpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODkOOCpuODs+ODh+OCo+ODs+OCsOODrOOCr+ODiOOCkuaPj+eUu1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGRyYXdCb3VuZGluZ1JlY3Q6IGZ1bmN0aW9uKGNhbnZhcykge1xyXG4gICAgICAgICAgICBjYW52YXMuc2F2ZSgpO1xyXG4gICAgICAgICAgICBjYW52YXMubGluZVdpZHRoID0gMjtcclxuICAgICAgICAgICAgY2FudmFzLnN0cm9rZVJlY3QoLXRoaXMud2lkdGgqdGhpcy5vcmlnaW5YLCAtdGhpcy5oZWlnaHQqdGhpcy5vcmlnaW5ZLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XHJcbiAgICAgICAgICAgIGNhbnZhcy5yZXN0b3JlKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogPz8/P1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGRyYXdGaWxsUmVjdDogZnVuY3Rpb24oY3R4KSB7XHJcbiAgICAgICAgICAgIGN0eC5maWxsUmVjdCgtdGhpcy53aWR0aC8yLCAtdGhpcy5oZWlnaHQvMiwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqID8/Pz9cclxuICAgICAgICAgKi9cclxuICAgICAgICBkcmF3U3Ryb2tlUmVjdDogZnVuY3Rpb24oY3R4KSB7XHJcbiAgICAgICAgICAgIGN0eC5zdHJva2VSZWN0KC10aGlzLndpZHRoLzIsIC10aGlzLmhlaWdodC8yLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqID8/Pz9cclxuICAgICAgICAgKi9cclxuICAgICAgICBkcmF3RmlsbEFyYzogZnVuY3Rpb24oY3R4KSB7XHJcbiAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgY3R4LmFyYygwLCAwLCB0aGlzLnJhZGl1cywgMCwgTWF0aC5QSSoyLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIGN0eC5maWxsKCk7XHJcbiAgICAgICAgICAgIGN0eC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiA/Pz8/XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZHJhd1N0cm9rZUFyYzogZnVuY3Rpb24oY3R4KSB7XHJcbiAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgY3R4LmFyYygwLCAwLCB0aGlzLnJhZGl1cywgMCwgTWF0aC5QSSoyLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIGN0eC5zdHJva2UoKTtcclxuICAgICAgICAgICAgY3R4LmNsb3NlUGF0aCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDooajnpLov6Z2e6KGo56S644KS44K744OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0VmlzaWJsZTogZnVuY3Rpb24oZmxhZykge1xyXG4gICAgICAgICAgICB0aGlzLnZpc2libGUgPSBmbGFnO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDooajnpLpcclxuICAgICAgICAgKi9cclxuICAgICAgICBzaG93OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy52aXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6Z2e6KGo56S6XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaGlkZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMudmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDloZfjgorjgaTjgbbjgZfjgrnjgr/jgqTjg6vjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRGaWxsU3R5bGU6IGZ1bmN0aW9uKHN0eWxlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmlsbFN0eWxlID0gc3R5bGU7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCueODiOODreODvOOCr+OCueOCv+OCpOODq+OCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFN0cm9rZVN0eWxlOiBmdW5jdGlvbihzdHlsZSkge1xyXG4gICAgICAgICAgICB0aGlzLnN0cm9rZVN0eWxlID0gc3R5bGU7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODluODrOODs+ODieODouODvOODieOCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldEJsZW5kTW9kZTogZnVuY3Rpb24oYmxlbmRNb2RlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYmxlbmRNb2RlID0gYmxlbmRNb2RlO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg63jg7zjg4lcclxuICAgICAgICAgKi9cclxuICAgICAgICBsb2FkOiBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgICAgICAgICAgIGRhdGEubGF5ZXJzLmZvckVhY2goZnVuY3Rpb24obGF5ZXIpIHtcclxuICAgICAgICAgICAgICAgIGlmIChsYXllci50eXBlICE9IFwib2JqZWN0Z3JvdXBcIikgcmV0dXJuIDtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgZ3JvdXAgPSB0bS5kaXNwbGF5LkNhbnZhc0VsZW1lbnQoKS5hZGRDaGlsZFRvKHNlbGYpO1xyXG4gICAgICAgICAgICAgICAgZ3JvdXAud2lkdGggPSBsYXllci53aWR0aDtcclxuICAgICAgICAgICAgICAgIGdyb3VwLmhlaWdodCA9IGxheWVyLmhlaWdodDtcclxuXHJcbiAgICAgICAgICAgICAgICBsYXllci5vYmplY3RzLmZvckVhY2goZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9jbGFzcyA9IHRtLnVzaW5nKG9iai50eXBlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoX2NsYXNzKS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2NsYXNzPXRtLmRpc3BsYXlbb2JqLnR5cGVdO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5pdFBhcmFtID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAob2JqLnByb3BlcnRpZXMuaW5pdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbml0UGFyYW0gPSBKU09OLnBhcnNlKG9iai5wcm9wZXJ0aWVzLmluaXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IF9jbGFzcy5hcHBseShudWxsLCBpbml0UGFyYW0pLmFkZENoaWxkVG8oZ3JvdXApO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwcm9wcyAgID0gb2JqLnByb3BlcnRpZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHByb3BzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZXkgPT0gXCJpbml0XCIpIGNvbnRpbnVlIDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gcHJvcHNba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudFtrZXldID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnggPSBvYmoueDtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnkgPSBvYmoueTtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LndpZHRoID0gb2JqLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuaGVpZ2h0ID0gb2JqLmhlaWdodDtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHNlbGZbbGF5ZXIubmFtZV0gPSBncm91cDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfY2FsY0FscGhhOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLnBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fd29ybGRBbHBoYSA9IHRoaXMuYWxwaGE7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gYWxwaGFcclxuICAgICAgICAgICAgICAgIHRoaXMuX3dvcmxkQWxwaGEgPSB0aGlzLnBhcmVudC5fd29ybGRBbHBoYSAqIHRoaXMuYWxwaGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9kaXJ0eUNhbGM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLl9jYWxjQWxwaGEoKTtcclxuICAgICAgICAgICAgdGhpcy5fY2FsY1dvcmxkTWF0cml4KCk7XHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxuXHJcbn0pKCk7XHJcblxyXG5cclxuLypcclxuICogc3ByaXRlLmpzXHJcbiAqL1xyXG5cclxuXHJcbnRtLmRpc3BsYXkgPSB0bS5kaXNwbGF5IHx8IHt9O1xyXG5cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZGlzcGxheS5TcHJpdGVcclxuICAgICAqIOeUu+WDj+OBruaPj+eUu+OCkuihjOOBhuOCr+ODqeOCuVxyXG4gICAgICogQGV4dGVuZHMgdG0uZGlzcGxheS5DYW52YXNFbGVtZW50XHJcbiAgICAgKi9cclxuICAgIHRtLmRpc3BsYXkuU3ByaXRlID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IHRtLmRpc3BsYXkuQ2FudmFzRWxlbWVudCxcclxuICAgICAgICBcclxuICAgICAgICAvKiogQHByb3BlcnR5IHNyY1JlY3QgICAgICAgICAgKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5IHdpZHRoICAgICAgICAgICAgd2lkdGggKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5IGhlaWdodCAgICAgICAgICAgaGVpZ2h0ICovXHJcbiAgICAgICAgLyoqIEBwcm9wZXJ0eSBAcHJpdmF0ZSBfaW1hZ2UgIOihqOekuuOBl+OBpuOBhOOCi+OCouOCu+ODg+ODiCjnlLvlg48pICovXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKGltYWdlLCB3aWR0aCwgaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3VwZXJJbml0KCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zb2xlLmFzc2VydCh0eXBlb2YgaW1hZ2UgIT0gJ251bWJlcicsIFwiU3ByaXRlIOOBruesrOS4gOW8leaVsOOBr+ODhuOCr+OCueODgeODo+OCguOBl+OBj+OBr+ODhuOCr+OCueODgeODo+WQjeOBq+WkieOCj+OCiuOBvuOBl+OBn1wiKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuX2ZyYW1lSW5kZXggPSAwO1xyXG4gICAgICAgICAgICB0aGlzLnNyY1JlY3QgPSB0bS5nZW9tLlJlY3QoMCwgMCwgNjQsIDY0KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIOW8leaVsOOBguOCilxyXG4gICAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+PSAxKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldEltYWdlKGltYWdlKS5maXRJbWFnZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh3aWR0aCAhPT0gdW5kZWZpbmVkKSB0aGlzLndpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgICAgICAgICBpZiAoaGVpZ2h0ICE9PSB1bmRlZmluZWQpIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6KGo56S644GZ44KL44Ki44K744OD44OIKOeUu+WDjynjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRJbWFnZTogZnVuY3Rpb24oaW1hZ2UsIHdpZHRoLCBoZWlnaHQpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBpbWFnZSA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIga2V5ID0gaW1hZ2U7XHJcbiAgICAgICAgICAgICAgICBpbWFnZSA9IHRtLmFzc2V0Lk1hbmFnZXIuZ2V0KGtleSk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmFzc2VydChpbWFnZSAhPSBudWxsLCBcImRvbid0IGZpbmQgJ1wiICsga2V5ICsgXCInIGFzIGltYWdlLlwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5faW1hZ2UgPSBpbWFnZTtcclxuICAgICAgICAgICAgdGhpcy5zcmNSZWN0LnggPSAwO1xyXG4gICAgICAgICAgICB0aGlzLnNyY1JlY3QueSA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuc3JjUmVjdC53aWR0aCAgPSBpbWFnZS5lbGVtZW50LndpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLnNyY1JlY3QuaGVpZ2h0ID0gaW1hZ2UuZWxlbWVudC5oZWlnaHQ7XHJcblxyXG4gICAgICAgICAgICBpZiAod2lkdGggICE9PSB1bmRlZmluZWQpIHRoaXMud2lkdGggID0gd2lkdGg7XHJcbiAgICAgICAgICAgIGlmIChoZWlnaHQgIT09IHVuZGVmaW5lZCkgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICAgICAgICAgIC8vIHRoaXMud2lkdGggID0gKHdpZHRoICE9PSB1bmRlZmluZWQpICA/IHdpZHRoICA6IGltYWdlLmVsZW1lbnQud2lkdGg7XHJcbiAgICAgICAgICAgIC8vIHRoaXMuaGVpZ2h0ID0gKGhlaWdodCAhPT0gdW5kZWZpbmVkKSA/IGhlaWdodCA6IGltYWdlLmVsZW1lbnQuaGVpZ2h0O1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6KGo56S644GX44Gm44GE44KL44Ki44K744OD44OIKOeUu+WDjynjgpLlj5blvpdcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRJbWFnZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pbWFnZTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDoh6rliIboh6rkv6HjgpLnlLvlg4/jgrXjgqTjgrrjgajlkIzjgZjjgrXjgqTjgrrjgavjgZnjgotcclxuICAgICAgICAgKi9cclxuICAgICAgICBmaXRJbWFnZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMud2lkdGggID0gdGhpcy5pbWFnZS53aWR0aDtcclxuICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSB0aGlzLmltYWdlLmhlaWdodDtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44OV44Os44O844Og44Kk44Oz44OH44OD44Kv44K544KS44K744OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0RnJhbWVJbmRleDogZnVuY3Rpb24oaW5kZXgsIHdpZHRoLCBoZWlnaHQpIHtcclxuICAgICAgICAgICAgdmFyIHR3ICA9IHdpZHRoIHx8IHRoaXMud2lkdGg7ICAgICAgLy8gdHdcclxuICAgICAgICAgICAgdmFyIHRoICA9IGhlaWdodCB8fCB0aGlzLmhlaWdodDsgICAgLy8gdGhcclxuICAgICAgICAgICAgdmFyIHJvdyA9IH5+KHRoaXMuaW1hZ2Uud2lkdGggLyB0dyk7XHJcbiAgICAgICAgICAgIHZhciBjb2wgPSB+fih0aGlzLmltYWdlLmhlaWdodCAvIHRoKTtcclxuICAgICAgICAgICAgdmFyIG1heEluZGV4ID0gcm93KmNvbDtcclxuICAgICAgICAgICAgaW5kZXggPSBpbmRleCVtYXhJbmRleDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciB4ICAgPSBpbmRleCVyb3c7XHJcbiAgICAgICAgICAgIHZhciB5ICAgPSB+fihpbmRleC9yb3cpO1xyXG4gICAgICAgICAgICB0aGlzLnNyY1JlY3QueCA9IHgqdHc7XHJcbiAgICAgICAgICAgIHRoaXMuc3JjUmVjdC55ID0geSp0aDtcclxuICAgICAgICAgICAgdGhpcy5zcmNSZWN0LndpZHRoICA9IHR3O1xyXG4gICAgICAgICAgICB0aGlzLnNyY1JlY3QuaGVpZ2h0ID0gdGg7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9mcmFtZUluZGV4ID0gaW5kZXg7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3JlZnJlc2hTaXplOiBmdW5jdGlvbigpIHt9LFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGltYWdlXHJcbiAgICAgKiDnlLvlg49cclxuICAgICAqL1xyXG4gICAgdG0uZGlzcGxheS5TcHJpdGUucHJvdG90eXBlLmFjY2Vzc29yKFwiaW1hZ2VcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pbWFnZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKGltYWdlKSAge1xyXG4gICAgICAgICAgICB0aGlzLnNldEltYWdlKGltYWdlKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBmcmFtZUluZGV4XHJcbiAgICAgKiDjg5Xjg6zjg7zjg6DjgqTjg7Pjg4fjg4Pjgq/jgrlcclxuICAgICAqL1xyXG4gICAgdG0uZGlzcGxheS5TcHJpdGUucHJvdG90eXBlLmFjY2Vzc29yKFwiZnJhbWVJbmRleFwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2ZyYW1lSW5kZXg7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2YWx1ZSkgIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRGcmFtZUluZGV4KHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG59KSgpO1xyXG5cclxuLypcclxuICogc2hhcGUuanNcclxuICovXHJcblxyXG5cclxudG0uZGlzcGxheSA9IHRtLmRpc3BsYXkgfHwge307XHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5kaXNwbGF5LlNoYXBlXHJcbiAgICAgKiBAZXh0ZW5kcyB0bS5kaXNwbGF5LkNhbnZhc0VsZW1lbnRcclxuICAgICAqIOWbs+W9ouOCkuaPj+eUu+OBmeOCi+OCr+ODqeOCuVxyXG4gICAgICovXHJcbiAgICB0bS5kaXNwbGF5LlNoYXBlID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IHRtLmRpc3BsYXkuQ2FudmFzRWxlbWVudCxcclxuICAgICAgICBcclxuICAgICAgICAvKiogQHByb3BlcnR5IGNhbnZzYSAqL1xyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgd2lkdGggKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5IGhlaWdodCAqL1xyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgYXV0b1JlbmRlciAqL1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihwYXJhbSkge1xyXG4gICAgICAgICAgICBwYXJhbSA9IHRoaXMuX2RpcnR5Q2hlY2tQYXJhbS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICB2YXIgcGFyYW0gPSB7fS4kc2FmZShwYXJhbSwge1xyXG4gICAgICAgICAgICAgICAgd2lkdGg6IDY0LFxyXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiA2NCxcclxuICAgICAgICAgICAgICAgIC8vIGJnQ29sb3I6IFwiIzg4OFwiLFxyXG4gICAgICAgICAgICAgICAgYmdDb2xvcjogXCJ0cmFuc3BhcmVudFwiLFxyXG5cclxuICAgICAgICAgICAgICAgIGZpbGxTdHlsZTogXCJyZWRcIixcclxuICAgICAgICAgICAgICAgIHN0cm9rZVN0eWxlOiBcIndoaXRlXCIsXHJcbiAgICAgICAgICAgICAgICBsaW5lV2lkdGg6IFwiMlwiLFxyXG4gICAgICAgICAgICAgICAgc2hhZG93Qmx1cjogMCxcclxuICAgICAgICAgICAgICAgIHNoYWRvd0NvbG9yOiBcInJlZFwiLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuc3VwZXJJbml0KCk7XHJcblxyXG4gICAgICAgICAgICAvLyBcclxuICAgICAgICAgICAgdGhpcy5jYW52YXMgPSB0bS5ncmFwaGljcy5DYW52YXMoKTtcclxuICAgICAgICAgICAgLy8gXHJcbiAgICAgICAgICAgIHRoaXMuJGV4dGVuZChwYXJhbSk7XHJcbiAgICAgICAgICAgIC8vIFxyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xyXG4gICAgICAgICAgICAvLyBcclxuICAgICAgICAgICAgdGhpcy5hdXRvUmVuZGVyID0gdHJ1ZTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfcHJlcmVuZGVyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSB0aGlzLmNhbnZhcztcclxuICAgICAgICAgICAgYy5yZXNpemUodGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xyXG4gICAgICAgICAgICBjLmNsZWFyQ29sb3IodGhpcy5iZ0NvbG9yKTtcclxuXHJcbiAgICAgICAgICAgIGMuc2F2ZSgpO1xyXG5cclxuICAgICAgICAgICAgLy8g44OR44Op44Oh44O844K/44K744OD44OIXHJcbiAgICAgICAgICAgIGMuZmlsbFN0eWxlICAgPSB0aGlzLmZpbGxTdHlsZTtcclxuICAgICAgICAgICAgYy5zdHJva2VTdHlsZSA9IHRoaXMuc3Ryb2tlU3R5bGU7XHJcbiAgICAgICAgICAgIGMubGluZVdpZHRoICAgPSB0aGlzLmxpbmVXaWR0aDtcclxuICAgICAgICAgICAgYy5zaGFkb3dCbHVyICA9IHRoaXMuc2hhZG93Qmx1cjtcclxuICAgICAgICAgICAgYy5zaGFkb3dDb2xvciAgPSB0aGlzLnNoYWRvd0NvbG9yO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX3Bvc3RyZW5kZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgYyA9IHRoaXMuY2FudmFzO1xyXG4gICAgICAgICAgICBjLnJlc3RvcmUoKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3ByZXJlbmRlcigpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyKCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9wb3N0cmVuZGVyKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX3JlbmRlcjogZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODhuOCreOCueODiOaPj+eUu1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJlbmRlclRleHQ6IGZ1bmN0aW9uKHBhcmFtKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gdGhpcy5jYW52YXM7XHJcbiAgICAgICAgICAgIHBhcmFtID0ge30uJGV4dGVuZCh0bS5kaXNwbGF5LlNoYXBlLkRFRkFVTFRfU0hBUEVfUEFSQU1fVEVYVCwgcGFyYW0pO1xyXG5cclxuICAgICAgICAgICAgYy5zYXZlKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDjg5Hjg6njg6Hjg7zjgr/jgrvjg4Pjg4hcclxuICAgICAgICAgICAgYy5maWxsU3R5bGUgICAgID0gcGFyYW0uZmlsbFN0eWxlO1xyXG4gICAgICAgICAgICBjLnN0cm9rZVN0eWxlICAgPSBwYXJhbS5zdHJva2VTdHlsZTtcclxuICAgICAgICAgICAgYy5saW5lV2lkdGggICAgID0gcGFyYW0ubGluZVdpZHRoO1xyXG4gICAgICAgICAgICBjLmZvbnQgICAgICAgICAgPSBwYXJhbS5mb250O1xyXG4gICAgICAgICAgICBjLnRleHRBbGlnbiAgICAgPSBwYXJhbS50ZXh0QWxpZ247XHJcbiAgICAgICAgICAgIGMudGV4dEJhc2VsaW5lICA9IHBhcmFtLnRleHRCYXNlbGluZTtcclxuXHJcbiAgICAgICAgICAgIC8vIOaPj+eUu1xyXG4gICAgICAgICAgICBjLnN0cm9rZVRleHQocGFyYW0udGV4dCwgdGhpcy53aWR0aC8yLCB0aGlzLmhlaWdodC8yKTtcclxuICAgICAgICAgICAgYy5maWxsVGV4dChwYXJhbS50ZXh0LCB0aGlzLndpZHRoLzIsIHRoaXMuaGVpZ2h0LzIpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgYy5yZXN0b3JlKCk7XHJcbiAgICAgICAgfSxcclxuXHJcblxyXG4gICAgICAgIC8vIFRPRE86IG9sZCBzdXBwb3J0KHBsYW4gZGVsZXRlKVxyXG4gICAgICAgIF9kaXJ0eUNoZWNrUGFyYW06IGZ1bmN0aW9uKHBhcmFtKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXJhbSA9IHBhcmFtO1xyXG4gICAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+PSAyKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBhcmd1bWVudHNbMF07XHJcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0PSBhcmd1bWVudHNbMV07XHJcbiAgICAgICAgICAgICAgICB2YXIgcGFyYW0gPSBhcmd1bWVudHNbMl0gfHwge307XHJcbiAgICAgICAgICAgICAgICBwYXJhbS53aWR0aCA9IHdpZHRoO1xyXG4gICAgICAgICAgICAgICAgcGFyYW0uaGVpZ2h0ID0gaGVpZ2h0O1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcInRtbGliLmpzIHdhcm46IGFyZ3VtZW50cyBvZiBzaGFwZSBpbml0IGlzIG9ubHkgcGFyYW0gZnJvbSB2ZXJzaW9uIDAuNFwiKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHBhcmFtO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICB9KTtcclxuXHJcbiAgICBbXCJ3aWR0aFwiLCBcImhlaWdodFwiLCBcImJnQ29sb3JcIiwgXCJzdHJva2VTdHlsZVwiLCBcImZpbGxTdHlsZVwiLCBcImxpbmVXaWR0aFwiLCBcInNoYWRvd0JsdXJcIiwgXCJzaGFkb3dDb2xvclwiXS5lYWNoKGZ1bmN0aW9uKHByb3ApIHtcclxuICAgICAgICB2YXIgcHJvcE5hbWUgPSAnXycgKyBwcm9wO1xyXG5cclxuICAgICAgICB0bS5kaXNwbGF5LlNoYXBlLnByb3RvdHlwZS5hY2Nlc3Nvcihwcm9wLCB7XHJcbiAgICAgICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1twcm9wTmFtZV07XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7XHJcbiAgICAgICAgICAgICAgICB0aGlzW3Byb3BOYW1lXSA9IHY7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hdXRvUmVuZGVyID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG59KSgpO1xyXG5cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZGlzcGxheS5DaXJjbGVTaGFwZVxyXG4gICAgICogQGV4dGVuZHMgdG0uZGlzcGxheS5TaGFwZVxyXG4gICAgICog57Ch5Y2Y44Gr5YaG44KS5o+P55S744Gn44GN44KL44Kv44Op44K5XHJcbiAgICAgKiBcclxuICAgICAqICAgICAgQGV4YW1wbGUgZGlzcGxheVxyXG4gICAgICogICAgICB2YXIgc2hhcGUgPSB0bS5kaXNwbGF5LkNpcmNsZVNoYXBlKCkuYWRkQ2hpbGRUbyh0aGlzKTtcclxuICAgICAqICAgICAgc2hhcGUuc2V0UG9zaXRpb24oNTAsIDUwKTtcclxuICAgICAqL1xyXG4gICAgdG0uZGVmaW5lKFwidG0uZGlzcGxheS5DaXJjbGVTaGFwZVwiLCB7XHJcbiAgICAgICAgc3VwZXJDbGFzczogdG0uZGlzcGxheS5TaGFwZSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihwYXJhbSkge1xyXG4gICAgICAgICAgICBwYXJhbSA9IHRoaXMuX2RpcnR5Q2hlY2tQYXJhbS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdChwYXJhbSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIF9yZW5kZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgYyA9IHRoaXMuY2FudmFzO1xyXG4gICAgICAgICAgICAvLyDmj4/nlLtcclxuICAgICAgICAgICAgdmFyIHJhZGl1cyA9IE1hdGgubWluKHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KS8yO1xyXG4gICAgICAgICAgICBjLmZpbGxDaXJjbGUodGhpcy53aWR0aC8yLCB0aGlzLmhlaWdodC8yLCByYWRpdXMpO1xyXG4gICAgICAgICAgICBjLnN0cm9rZUNpcmNsZSh0aGlzLndpZHRoLzIsIHRoaXMuaGVpZ2h0LzIsIHJhZGl1cy1OdW1iZXIoYy5saW5lV2lkdGgpLzIpO1xyXG4gICAgICAgIH0sXHJcbiAgICB9KTtcclxuICAgIFxyXG59KSgpO1xyXG5cclxuXHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5kaXNwbGF5LlRyaWFuZ2xlU2hhcGVcclxuICAgICAqIOewoeWNmOOBq+S4ieinkuW9ouOCkuaPj+eUu+OBp+OBjeOCi+OCr+ODqeOCuVxyXG4gICAgICogQGV4dGVuZHMgdG0uZGlzcGxheS5TaGFwZVxyXG4gICAgICovXHJcbiAgICB0bS5kZWZpbmUoXCJ0bS5kaXNwbGF5LlRyaWFuZ2xlU2hhcGVcIiwge1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IHRtLmRpc3BsYXkuU2hhcGUsXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24ocGFyYW0pIHtcclxuICAgICAgICAgICAgcGFyYW0gPSB0aGlzLl9kaXJ0eUNoZWNrUGFyYW0uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgcGFyYW0gPSB7fS4kc2FmZShwYXJhbSwge1xyXG4gICAgICAgICAgICAgICAgZmlsbFN0eWxlOiBcImdyZWVuXCIsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdChwYXJhbSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIF9yZW5kZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgYyA9IHRoaXMuY2FudmFzO1xyXG5cclxuICAgICAgICAgICAgLy8g5o+P55S7XHJcbiAgICAgICAgICAgIHZhciB4ID0gdGhpcy53aWR0aC8yO1xyXG4gICAgICAgICAgICB2YXIgeSA9IHRoaXMuaGVpZ2h0LzI7XHJcbiAgICAgICAgICAgIHZhciByYWRpdXMgPSBNYXRoLm1pbih0aGlzLndpZHRoLCB0aGlzLmhlaWdodCkvMjtcclxuICAgICAgICAgICAgdmFyIG9mZnNldExpbmUgPSBOdW1iZXIoYy5saW5lV2lkdGgpKjE7XHJcbiAgICAgICAgICAgIGMuZmlsbFBvbHlnb24oeCwgeSwgcmFkaXVzLCAzKTtcclxuICAgICAgICAgICAgYy5zdHJva2VQb2x5Z29uKHgsIHksIHJhZGl1cy1vZmZzZXRMaW5lLCAzKTtcclxuICAgICAgICB9LFxyXG4gICAgfSk7XHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG5cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZGlzcGxheS5SZWN0YW5nbGVTaGFwZVxyXG4gICAgICog57Ch5Y2Y44Gr55+p5b2i44KS5o+P55S744Gn44GN44KL44Kv44Op44K5XHJcbiAgICAgKiBAZXh0ZW5kcyB0bS5kaXNwbGF5LlNoYXBlXHJcbiAgICAgKi9cclxuICAgIHRtLmRlZmluZShcInRtLmRpc3BsYXkuUmVjdGFuZ2xlU2hhcGVcIiwge1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IHRtLmRpc3BsYXkuU2hhcGUsXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24ocGFyYW0pIHtcclxuICAgICAgICAgICAgcGFyYW0gPSB0aGlzLl9kaXJ0eUNoZWNrUGFyYW0uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgcGFyYW0gPSB7fS4kc2FmZShwYXJhbSwge1xyXG4gICAgICAgICAgICAgICAgZmlsbFN0eWxlOiBcImJsdWVcIixcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuc3VwZXJJbml0KHBhcmFtKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX3JlbmRlcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gdGhpcy5jYW52YXM7XHJcbiAgICAgICAgICAgIC8vIOaPj+eUu1xyXG4gICAgICAgICAgICB2YXIgbHcgPSB0aGlzLmxpbmVXaWR0aDtcclxuICAgICAgICAgICAgdmFyIGx3X2hhbGYgPSBsdy8yO1xyXG4gICAgICAgICAgICBjLmZpbGxSZWN0KDAsIDAsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcclxuICAgICAgICAgICAgYy5zdHJva2VSZWN0KGx3X2hhbGYsIGx3X2hhbGYsIHRoaXMud2lkdGgtbHcsIHRoaXMuaGVpZ2h0LWx3KTtcclxuICAgICAgICB9LFxyXG4gICAgfSk7XHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG5cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZGlzcGxheS5Sb3VuZFJlY3RhbmdsZVNoYXBlXHJcbiAgICAgKiDnsKHljZjjgavnn6nlvaLjgpLmj4/nlLvjgafjgY3jgovjgq/jg6njgrlcclxuICAgICAqIEBleHRlbmRzIHRtLmRpc3BsYXkuU2hhcGVcclxuICAgICAqL1xyXG4gICAgdG0uZGVmaW5lKFwidG0uZGlzcGxheS5Sb3VuZFJlY3RhbmdsZVNoYXBlXCIsIHtcclxuICAgICAgICBzdXBlckNsYXNzOiB0bS5kaXNwbGF5LlNoYXBlLFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKHBhcmFtKSB7XHJcbiAgICAgICAgICAgIHBhcmFtID0gdGhpcy5fZGlydHlDaGVja1BhcmFtLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIHBhcmFtID0ge30uJHNhZmUocGFyYW0sIHtcclxuICAgICAgICAgICAgICAgIGZpbGxTdHlsZTogXCJibHVlXCIsXHJcbiAgICAgICAgICAgICAgICBjb3JuZXJSYWRpdXM6IDgsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdChwYXJhbSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIF9yZW5kZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgYyA9IHRoaXMuY2FudmFzO1xyXG4gICAgICAgICAgICAvLyDmj4/nlLtcclxuICAgICAgICAgICAgdmFyIGx3ID0gdGhpcy5saW5lV2lkdGg7XHJcbiAgICAgICAgICAgIHZhciBsd19oYWxmID0gbHcvMjtcclxuXHJcbiAgICAgICAgICAgIGMuZmlsbFJvdW5kUmVjdChsd19oYWxmLCBsd19oYWxmLCB0aGlzLndpZHRoLWx3LCB0aGlzLmhlaWdodC1sdywgdGhpcy5jb3JuZXJSYWRpdXMpO1xyXG4gICAgICAgICAgICBjLnN0cm9rZVJvdW5kUmVjdChsd19oYWxmLCBsd19oYWxmLCB0aGlzLndpZHRoLWx3LCB0aGlzLmhlaWdodC1sdywgdGhpcy5jb3JuZXJSYWRpdXMpO1xyXG4gICAgICAgIH0sXHJcbiAgICB9KTtcclxuXHJcbiAgICBbXCJjb3JuZXJSYWRpdXNcIl0uZWFjaChmdW5jdGlvbihwcm9wKSB7XHJcbiAgICAgICAgdmFyIHByb3BOYW1lID0gJ18nICsgcHJvcDtcclxuXHJcbiAgICAgICAgdG0uZGlzcGxheS5Sb3VuZFJlY3RhbmdsZVNoYXBlLnByb3RvdHlwZS5hY2Nlc3Nvcihwcm9wLCB7XHJcbiAgICAgICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1twcm9wTmFtZV07XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7XHJcbiAgICAgICAgICAgICAgICB0aGlzW3Byb3BOYW1lXSA9IHY7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hdXRvUmVuZGVyID09PSB0cnVlKSB7IHRoaXMucmVuZGVyKCk7IH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG59KSgpO1xyXG5cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZGlzcGxheS5TdGFyU2hhcGVcclxuICAgICAqIOewoeWNmOOBq+aYn+W9ouOCkuaPj+eUu+OBp+OBjeOCi+OCr+ODqeOCuVxyXG4gICAgICogQGV4dGVuZHMgdG0uZGlzcGxheS5TaGFwZVxyXG4gICAgICovXHJcbiAgICB0bS5kZWZpbmUoXCJ0bS5kaXNwbGF5LlN0YXJTaGFwZVwiLCB7XHJcbiAgICAgICAgc3VwZXJDbGFzczogdG0uZGlzcGxheS5TaGFwZSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihwYXJhbSkge1xyXG4gICAgICAgICAgICBwYXJhbSA9IHRoaXMuX2RpcnR5Q2hlY2tQYXJhbS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICBwYXJhbSA9IHt9LiRzYWZlKHBhcmFtLCB7XHJcbiAgICAgICAgICAgICAgICBmaWxsU3R5bGU6IFwieWVsbG93XCIsXHJcbiAgICAgICAgICAgICAgICBzaWRlczogNSxcclxuICAgICAgICAgICAgICAgIHNpZGVJbmRlbnQ6IDAuMzgsXHJcbiAgICAgICAgICAgICAgICBvZmZzZXRBbmdsZTogLTkwLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5zdXBlckluaXQocGFyYW0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfcmVuZGVyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSB0aGlzLmNhbnZhcztcclxuXHJcbiAgICAgICAgICAgIHZhciBzaWRlcyAgICAgICA9IHRoaXMuc2lkZXM7XHJcbiAgICAgICAgICAgIHZhciBzaWRlSW5kZW50ICA9IHRoaXMuc2lkZUluZGVudDtcclxuICAgICAgICAgICAgdmFyIG9mZnNldEFuZ2xlID0gdGhpcy5vZmZzZXRBbmdsZTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIOaPj+eUu1xyXG4gICAgICAgICAgICB2YXIgeCA9IHRoaXMud2lkdGgvMjtcclxuICAgICAgICAgICAgdmFyIHkgPSB0aGlzLmhlaWdodC8yO1xyXG4gICAgICAgICAgICB2YXIgcmFkaXVzID0gTWF0aC5taW4odGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpLzI7XHJcbiAgICAgICAgICAgIHZhciBvZmZzZXRMaW5lID0gTnVtYmVyKGMubGluZVdpZHRoKSoxLjU7XHJcbiAgICAgICAgICAgIGMuZmlsbFN0YXIoeCwgeSwgcmFkaXVzLCBzaWRlcywgc2lkZUluZGVudCwgb2Zmc2V0QW5nbGUpO1xyXG4gICAgICAgICAgICBjLnN0cm9rZVN0YXIoeCwgeSwgcmFkaXVzLW9mZnNldExpbmUsIHNpZGVzLCBzaWRlSW5kZW50LCBvZmZzZXRBbmdsZSk7XHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIFtcInNpZGVzXCIsIFwic2lkZUluZGVudFwiLCBcIm9mZnNldEFuZ2xlXCJdLmVhY2goZnVuY3Rpb24ocHJvcCkge1xyXG4gICAgICAgIHZhciBwcm9wTmFtZSA9ICdfJyArIHByb3A7XHJcblxyXG4gICAgICAgIHRtLmRpc3BsYXkuU3RhclNoYXBlLnByb3RvdHlwZS5hY2Nlc3Nvcihwcm9wLCB7XHJcbiAgICAgICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1twcm9wTmFtZV07XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7XHJcbiAgICAgICAgICAgICAgICB0aGlzW3Byb3BOYW1lXSA9IHY7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hdXRvUmVuZGVyID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5kaXNwbGF5LlBvbHlnb25TaGFwZVxyXG4gICAgICogQGV4dGVuZHMgdG0uZGlzcGxheS5TaGFwZVxyXG4gICAgICog44Od44Oq44K044Oz5o+P55S744Kv44Op44K5XHJcbiAgICAgKi9cclxuICAgIHRtLmRlZmluZShcInRtLmRpc3BsYXkuUG9seWdvblNoYXBlXCIsIHtcclxuICAgICAgICBzdXBlckNsYXNzOiB0bS5kaXNwbGF5LlNoYXBlLFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKHBhcmFtKSB7XHJcbiAgICAgICAgICAgIHBhcmFtID0gdGhpcy5fZGlydHlDaGVja1BhcmFtLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIHBhcmFtID0ge30uJHNhZmUocGFyYW0sIHtcclxuICAgICAgICAgICAgICAgIGZpbGxTdHlsZTogXCJjeWFuXCIsXHJcbiAgICAgICAgICAgICAgICBzaWRlczogNSxcclxuICAgICAgICAgICAgICAgIHNpZGVJbmRlbnQ6IDAuMzgsXHJcbiAgICAgICAgICAgICAgICBvZmZzZXRBbmdsZTogLTkwLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5zdXBlckluaXQocGFyYW0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfcmVuZGVyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSB0aGlzLmNhbnZhcztcclxuXHJcbiAgICAgICAgICAgIHZhciBzaWRlcyAgICAgICA9IHRoaXMuc2lkZXM7XHJcbiAgICAgICAgICAgIHZhciBvZmZzZXRBbmdsZSA9IHRoaXMub2Zmc2V0QW5nbGU7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDmj4/nlLtcclxuICAgICAgICAgICAgdmFyIHggPSB0aGlzLndpZHRoLzI7XHJcbiAgICAgICAgICAgIHZhciB5ID0gdGhpcy5oZWlnaHQvMjtcclxuICAgICAgICAgICAgdmFyIHJhZGl1cyA9IE1hdGgubWluKHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KS8yO1xyXG4gICAgICAgICAgICB2YXIgb2Zmc2V0TGluZSA9IE51bWJlcihjLmxpbmVXaWR0aCkqMC42O1xyXG4gICAgICAgICAgICBjLmZpbGxQb2x5Z29uKHgsIHksIHJhZGl1cywgc2lkZXMsIG9mZnNldEFuZ2xlKTtcclxuICAgICAgICAgICAgYy5zdHJva2VQb2x5Z29uKHgsIHksIHJhZGl1cy1vZmZzZXRMaW5lLCBzaWRlcywgb2Zmc2V0QW5nbGUpO1xyXG4gICAgICAgIH0sXHJcbiAgICB9KTtcclxuXHJcbiAgICBbXCJzaWRlc1wiLCBcIm9mZnNldEFuZ2xlXCJdLmVhY2goZnVuY3Rpb24ocHJvcCkge1xyXG4gICAgICAgIHZhciBwcm9wTmFtZSA9ICdfJyArIHByb3A7XHJcblxyXG4gICAgICAgIHRtLmRpc3BsYXkuUG9seWdvblNoYXBlLnByb3RvdHlwZS5hY2Nlc3Nvcihwcm9wLCB7XHJcbiAgICAgICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1twcm9wTmFtZV07XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7XHJcbiAgICAgICAgICAgICAgICB0aGlzW3Byb3BOYW1lXSA9IHY7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hdXRvUmVuZGVyID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG5cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZGlzcGxheS5IZWFydFNoYXBlXHJcbiAgICAgKiDnsKHljZjjgavjg4/jg7zjg4jjgpLmj4/nlLvjgafjgY3jgovjgq/jg6njgrlcclxuICAgICAqIEBleHRlbmRzIHRtLmRpc3BsYXkuU2hhcGVcclxuICAgICAqL1xyXG4gICAgdG0uZGVmaW5lKFwidG0uZGlzcGxheS5IZWFydFNoYXBlXCIsIHtcclxuICAgICAgICBzdXBlckNsYXNzOiB0bS5kaXNwbGF5LlNoYXBlLFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKHBhcmFtKSB7XHJcbiAgICAgICAgICAgIHBhcmFtID0gdGhpcy5fZGlydHlDaGVja1BhcmFtLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIHBhcmFtID0ge30uJHNhZmUocGFyYW0sIHtcclxuICAgICAgICAgICAgICAgIGZpbGxTdHlsZTogXCJwaW5rXCIsXHJcbiAgICAgICAgICAgICAgICBjb3JuZXJBbmdsZTogNDUsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdChwYXJhbSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIF9yZW5kZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgYyA9IHRoaXMuY2FudmFzO1xyXG4gICAgICAgICAgICAvLyDmj4/nlLtcclxuICAgICAgICAgICAgdmFyIHggPSB0aGlzLndpZHRoLzI7XHJcbiAgICAgICAgICAgIHZhciB5ID0gdGhpcy5oZWlnaHQvMjtcclxuICAgICAgICAgICAgdmFyIHJhZGl1cyA9IE1hdGgubWluKHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KS8yO1xyXG4gICAgICAgICAgICBjLmZpbGxIZWFydCh4LCB5LCByYWRpdXMsIHRoaXMuY29ybmVyQW5nbGUpO1xyXG4gICAgICAgICAgICBjLnN0cm9rZUhlYXJ0KHgsIHksIHJhZGl1cy1OdW1iZXIoYy5saW5lV2lkdGgpLzIsIHRoaXMuY29ybmVyQW5nbGUpO1xyXG4gICAgICAgIH0sXHJcbiAgICB9KTtcclxuXHJcbiAgICBbXCJjb3JuZXJBbmdsZVwiXS5lYWNoKGZ1bmN0aW9uKHByb3ApIHtcclxuICAgICAgICB2YXIgcHJvcE5hbWUgPSAnXycgKyBwcm9wO1xyXG5cclxuICAgICAgICB0bS5kaXNwbGF5LkhlYXJ0U2hhcGUucHJvdG90eXBlLmFjY2Vzc29yKHByb3AsIHtcclxuICAgICAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW3Byb3BOYW1lXTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHtcclxuICAgICAgICAgICAgICAgIHRoaXNbcHJvcE5hbWVdID0gdjtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmF1dG9SZW5kZXIgPT09IHRydWUpIHsgdGhpcy5yZW5kZXIoKTsgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbn0pKCk7XHJcblxyXG5cclxuXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgdmFyIGR1bW15Q2FudmFzID0gbnVsbDtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZGlzcGxheS5UZXh0U2hhcGVcclxuICAgICAqIEBleHRlbmRzIHRtLmRpc3BsYXkuU2hhcGVcclxuICAgICAqIOODhuOCreOCueODiOaPj+eUu+OCr+ODqeOCuVxyXG4gICAgICovXHJcbiAgICB0bS5kZWZpbmUoXCJ0bS5kaXNwbGF5LlRleHRTaGFwZVwiLCB7XHJcblxyXG4gICAgICAgIHN1cGVyQ2xhc3M6IFwidG0uZGlzcGxheS5TaGFwZVwiLFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKHdpZHRoLCBoZWlnaHQsIHBhcmFtKSB7XHJcbiAgICAgICAgICAgIHBhcmFtID0gdGhpcy5fZGlydHlDaGVja1BhcmFtLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIHBhcmFtID0ge30uJHNhZmUocGFyYW0sIHtcclxuICAgICAgICAgICAgICAgIGZpbGxTdHlsZTogXCJibGFja1wiLFxyXG4gICAgICAgICAgICAgICAgbGluZVdpZHRoOiA0LFxyXG4gICAgICAgICAgICAgICAgdGV4dDogXCJoZWxsbywgd29ybGQhXCIsXHJcbiAgICAgICAgICAgICAgICBmb250U2l6ZTogNjQsXHJcbiAgICAgICAgICAgICAgICBmb250V2VpZ2h0OiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgZm9udEZhbWlseTogXCInSGlyYUtha3VQcm9OLVczJ1wiLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5zdXBlckluaXQocGFyYW0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5maXQoKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZml0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCFkdW1teUNhbnZhcykge1xyXG4gICAgICAgICAgICAgICAgZHVtbXlDYW52YXMgPSB0bS5ncmFwaGljcy5DYW52YXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBkdW1teUNhbnZhcy5mb250ID0gXCJ7Zm9udFdlaWdodH0ge2ZvbnRTaXplfXB4IHtmb250RmFtaWx5fVwiLmZvcm1hdCh0aGlzKTtcclxuICAgICAgICAgICAgdmFyIHRleHRXaWR0aCA9IGR1bW15Q2FudmFzLmNvbnRleHQubWVhc3VyZVRleHQodGhpcy50ZXh0KS53aWR0aCArICgxMCk7XHJcbiAgICAgICAgICAgIHZhciB0ZXh0SGVpZ2h0ID0gZHVtbXlDYW52YXMuY29udGV4dC5tZWFzdXJlVGV4dCgn44GCJykud2lkdGgqMS41O1xyXG4gICAgICAgICAgICB0aGlzLndpZHRoID0gdGV4dFdpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLmhlaWdodCA9IHRleHRIZWlnaHQ7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX3JlbmRlcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gdGhpcy5jYW52YXM7XHJcblxyXG4gICAgICAgICAgICBjLmZpbGxTdHlsZSA9IHRoaXMuZmlsbFN0eWxlO1xyXG4gICAgICAgICAgICBjLnN0cm9rZVN0eWxlID0gdGhpcy5zdHJva2VTdHlsZTtcclxuICAgICAgICAgICAgYy5mb250ID0gXCJ7Zm9udFdlaWdodH0ge2ZvbnRTaXplfXB4IHtmb250RmFtaWx5fVwiLmZvcm1hdCh0aGlzKTtcclxuICAgICAgICAgICAgYy50ZXh0QWxpZ24gPSBcImNlbnRlclwiO1xyXG4gICAgICAgICAgICBjLnRleHRCYXNlbGluZSA9IFwibWlkZGxlXCI7XHJcblxyXG4gICAgICAgICAgICB2YXIgdGV4dFdpZHRoID0gYy5jb250ZXh0Lm1lYXN1cmVUZXh0KHRoaXMudGV4dCkud2lkdGg7XHJcblxyXG4gICAgICAgICAgICB2YXIgaHcgPSB0aGlzLndpZHRoLzI7XHJcbiAgICAgICAgICAgIHZhciBoaCA9IHRoaXMuaGVpZ2h0LzJcclxuICAgICAgICAgICAgYy5zdHJva2VUZXh0KHRoaXMudGV4dCwgaHcsIGhoKTtcclxuICAgICAgICAgICAgYy5maWxsVGV4dCh0aGlzLnRleHQsIGh3LCBoaCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgICBbJ3RleHQnLCBcImZvbnRXZWlnaHRcIiwgXCJmb250U2l6ZVwiLCBcImZvbnRGYW1pbHlcIl0uZWFjaChmdW5jdGlvbihwcm9wKSB7XHJcbiAgICAgICAgdmFyIHByb3BOYW1lID0gJ18nICsgcHJvcDtcclxuXHJcbiAgICAgICAgdG0uZGlzcGxheS5UZXh0U2hhcGUucHJvdG90eXBlLmFjY2Vzc29yKHByb3AsIHtcclxuICAgICAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW3Byb3BOYW1lXTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHtcclxuICAgICAgICAgICAgICAgIHRoaXNbcHJvcE5hbWVdID0gdjtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmF1dG9SZW5kZXIgPT09IHRydWUpIHsgdGhpcy5yZW5kZXIoKTsgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbi8qXHJcbiAqIGxhYmVsLmpzXHJcbiAqL1xyXG5cclxudG0uZGlzcGxheSA9IHRtLmRpc3BsYXkgfHwge307XHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICB2YXIgZHVtbXlDYW52YXMgID0gbnVsbDtcclxuICAgIHZhciBkdW1teUNvbnRleHQgPSBudWxsO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLmRpc3BsYXkuTGFiZWxcclxuICAgICAqIOOCt+OCueODhuODoOODleOCqeODs+ODiOOCkuaPj+eUu+OBmeOCi+OCr+ODqeOCuVxyXG4gICAgICogQGV4dGVuZHMgdG0uZGlzcGxheS5DYW52YXNFbGVtZW50XHJcbiAgICAgKi9cclxuICAgIHRtLmRpc3BsYXkuTGFiZWwgPSB0bS5jcmVhdGVDbGFzcyh7XHJcbiAgICAgICAgXHJcbiAgICAgICAgc3VwZXJDbGFzczogdG0uZGlzcGxheS5DYW52YXNFbGVtZW50LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKiDloZfjgorjgaTjgbbjgZfjg5Xjg6njgrAgKi9cclxuICAgICAgICBmaWxsOiB0cnVlLFxyXG4gICAgICAgIC8qKiDjgrnjg4jjg63jg7zjgq/jg5Xjg6njgrAgKi9cclxuICAgICAgICBzdHJva2U6IGZhbHNlLFxyXG4gICAgICAgIC8qKiDjg4fjg5Djg4PjgrDjg5zjg4Pjgq/jgrkgKi9cclxuICAgICAgICBkZWJ1Z0JveDogZmFsc2UsXHJcblxyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgX2ZvbnRTaXplIEBwcml2YXRlICovXHJcbiAgICAgICAgLyoqIEBwcm9wZXJ0eSBfZm9udEZhbWlseSBAcHJpdmF0ZSAqL1xyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgX2ZvbnRXZWlnaHQgQHByaXZhdGUgKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5IF9saW5lSGVpZ2h0IEBwcml2YXRlICovXHJcbiAgICAgICAgLyoqIEBwcm9wZXJ0eSBhbGlnbiAqL1xyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgYmFzZWxpbmUgKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5IG1heFdpZHRoICovXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKHRleHQsIHNpemUpIHtcclxuICAgICAgICAgICAgdGhpcy5zdXBlckluaXQoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMudGV4dCAgICAgICA9IHRleHQgfHwgXCJcIjtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuX2ZvbnRTaXplICAgPSBzaXplIHx8IDI0O1xyXG4gICAgICAgICAgICB0aGlzLl9mb250RmFtaWx5ID0gdG0uZGlzcGxheS5MYWJlbFtcImRlZmF1bHRcIl0uZm9udEZhbWlseTtcclxuICAgICAgICAgICAgdGhpcy5fZm9udFdlaWdodCA9IFwiXCI7XHJcbiAgICAgICAgICAgIHRoaXMuX2xpbmVIZWlnaHQgPSAxLjI7XHJcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZUZvbnQoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuYWxpZ24gPSB0bS5kaXNwbGF5LkxhYmVsW1wiZGVmYXVsdFwiXS5hbGlnbjtcclxuICAgICAgICAgICAgdGhpcy5iYXNlbGluZSA9IHRtLmRpc3BsYXkuTGFiZWxbXCJkZWZhdWx0XCJdLmJhc2VsaW5lO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5tYXhXaWR0aCAgID0gbnVsbDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCouODqeOCpOODs+OCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldEFsaWduOiBmdW5jdGlvbihhbGlnbikge1xyXG4gICAgICAgICAgICB0aGlzLmFsaWduID0gYWxpZ247XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44OZ44O844K544Op44Kk44Oz44KS44K744OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0QmFzZWxpbmU6IGZ1bmN0aW9uKGJhc2VsaW5lKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYmFzZWxpbmUgPSBiYXNlbGluZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg5Xjgqnjg7Pjg4jjgrXjgqTjgrrjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRGb250U2l6ZTogZnVuY3Rpb24oc2l6ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmZvbnRTaXplID0gc2l6ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg5Xjgqnjg7Pjg4jjg5XjgqHjg5/jg6rjg7zjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRGb250RmFtaWx5OiBmdW5jdGlvbihmYW1pbHkpIHtcclxuICAgICAgICAgICAgdGhpcy5mb250RmFtaWx5PSBmYW1pbHk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODleOCqeODs+ODiOOCpuOCp+OCpOODiOOCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldEZvbnRXZWlnaHQ6IGZ1bmN0aW9uKHdlaWdodCkge1xyXG4gICAgICAgICAgICB0aGlzLmZvbnRXZWlnaHQ9IHdlaWdodDtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfdXBkYXRlRm9udDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZm9udFN0eWxlID0gXCJ7Zm9udFdlaWdodH0ge2ZvbnRTaXplfXB4IHtmb250RmFtaWx5fVwiLmZvcm1hdCh0aGlzKTtcclxuICAgICAgICAgICAgaWYgKCFkdW1teUNhbnZhcykge1xyXG4gICAgICAgICAgICAgICAgZHVtbXlDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xyXG4gICAgICAgICAgICAgICAgZHVtbXlDb250ZXh0ID0gZHVtbXlDYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBkdW1teUNvbnRleHQuZm9udCA9IHRoaXMuZm9udFN0eWxlO1xyXG4gICAgICAgICAgICB0aGlzLnRleHRTaXplID0gZHVtbXlDb250ZXh0Lm1lYXN1cmVUZXh0KCfjgYInKS53aWR0aCAqIHRoaXMubGluZUhlaWdodDtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF91cGRhdGVMaW5lczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xpbmVzID0gKHRoaXMuX3RleHQrJycpLnNwbGl0KCdcXG4nKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIHRleHRcclxuICAgICAqIOaWh+Wtl1xyXG4gICAgICovXHJcbiAgICB0bS5kaXNwbGF5LkxhYmVsLnByb3RvdHlwZS5hY2Nlc3NvcihcInRleHRcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpcy5fdGV4dDsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KXtcclxuICAgICAgICAgICAgaWYgKHYgPT0gbnVsbCB8fCB2ID09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdGV4dCA9IFwiXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90ZXh0ID0gdjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLl91cGRhdGVMaW5lcygpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBmb250U2l6ZVxyXG4gICAgICog44OV44Kp44Oz44OI44K144Kk44K6XHJcbiAgICAgKi9cclxuICAgIHRtLmRpc3BsYXkuTGFiZWwucHJvdG90eXBlLmFjY2Vzc29yKFwiZm9udFNpemVcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpcy5fZm9udFNpemU7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odil7IHRoaXMuX2ZvbnRTaXplID0gdjsgdGhpcy5fdXBkYXRlRm9udCgpOyB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgZm9udEZhbWlseVxyXG4gICAgICog44OV44Kp44Oz44OIXHJcbiAgICAgKi9cclxuICAgIHRtLmRpc3BsYXkuTGFiZWwucHJvdG90eXBlLmFjY2Vzc29yKFwiZm9udEZhbWlseVwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzLl9mb250RmFtaWx5OyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpeyB0aGlzLl9mb250RmFtaWx5ID0gdjsgdGhpcy5fdXBkYXRlRm9udCgpOyB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgZm9udFdlaWdodFxyXG4gICAgICovXHJcbiAgICB0bS5kaXNwbGF5LkxhYmVsLnByb3RvdHlwZS5hY2Nlc3NvcihcImZvbnRXZWlnaHRcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpcy5fZm9udFdlaWdodDsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2ZvbnRXZWlnaHQgPSB2OyB0aGlzLl91cGRhdGVGb250KCk7XHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSBsaW5lSGVpZ2h0XHJcbiAgICAgKi9cclxuICAgIHRtLmRpc3BsYXkuTGFiZWwucHJvdG90eXBlLmFjY2Vzc29yKFwibGluZUhlaWdodFwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzLl9saW5lSGVpZ2h0OyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgdGhpcy5fbGluZUhlaWdodCA9IHY7IHRoaXMuX3VwZGF0ZUZvbnQoKTtcclxuICAgICAgICB9LFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIHRtLmRpc3BsYXkuTGFiZWxbXCJkZWZhdWx0XCJdID0ge1xyXG4gICAgICAgIGFsaWduOiBcImNlbnRlclwiLFxyXG4gICAgICAgIGJhc2VsaW5lOiBcIm1pZGRsZVwiLFxyXG4gICAgICAgIGZvbnRGYW1pbHk6IFwiJ0hpcmFLYWt1UHJvTi1XMydcIiwgLy8gSGlyYWdpbm8gb3IgSGVsdmV0aWNhXHJcbiAgICAgICAgLy8gYWxpZ246IFwic3RhcnRcIixcclxuICAgICAgICAvLyBiYXNlbGluZTogXCJhbHBoYWJldGljXCIsXHJcbiAgICB9O1xyXG5cclxuICAgIFxyXG59KSgpO1xyXG5cclxuXHJcbi8qXHJcbiAqIGFuaW1hdGlvbnNwcml0ZS5qc1xyXG4gKi9cclxuXHJcblxyXG50bS5kaXNwbGF5ID0gdG0uZGlzcGxheSB8fCB7fTtcclxuXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZGlzcGxheS5BbmltYXRpb25TcHJpdGVcclxuICAgICAqIOOCueODl+ODqeOCpOODiOOCouODi+ODoeODvOOCt+ODp+ODs+OCr+ODqeOCuVxyXG4gICAgICogQGV4dGVuZHMgdG0uZGlzcGxheS5DYW52YXNFbGVtZW50XHJcbiAgICAgKi9cclxuICAgIHRtLmRpc3BsYXkuQW5pbWF0aW9uU3ByaXRlID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IHRtLmRpc3BsYXkuQ2FudmFzRWxlbWVudCxcclxuXHJcbiAgICAgICAgLyoqIEBwcm9wZXJ0eSBzcyAgICAgICAgICAgICAgICAgc3ByaXRlIHNoZWV0ICovXHJcbiAgICAgICAgLyoqIEBwcm9wZXJ0eSB3aWR0aCAgICAgICAgICAgICAgd2lkdGggKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5IGhlaWdodCAgICAgICAgICAgICBoZWlnaHQgKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5IGN1cnJlbnRGcmFtZSAgICAgICDnj77lnKjjga7jg5Xjg6zjg7zjg6AgKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5IGN1cnJlbnRGcmFtZUluZGV4ICDnj77lnKjjga7jg5Xjg6zjg7zjg6DjgqTjg7Pjg4fjg4Pjgq/jgrkgKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5IHBhdXNlZCAgICAgICAgICAgICDjg53jg7zjgrogKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5IGN1cnJlbnRBbmltYXRpb24gICDnj77lnKjjga7jgqLjg4vjg6Hjg7zjgrfjg6fjg7MgKi9cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oc3MsIHdpZHRoLCBoZWlnaHQpIHtcclxuICAgICAgICAgICAgdGhpcy5zdXBlckluaXQoKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc3MgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNzID0gdG0uYXNzZXQuTWFuYWdlci5nZXQoc3MpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5hc3NlcnQoc3MsIFwibm90IGZvdW5kIFwiICsgc3MpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zb2xlLmFzc2VydCh0eXBlb2Ygc3MgPT0gXCJvYmplY3RcIiwgXCJBbmltYXRpb25TcHJpdGUg44Gu56ys5LiA5byV5pWw44Gv44K544OX44Op44Kk44OI44K344O844OI44KC44GX44GP44Gv44K544OX44Op44Kk44OI44K344O844OI5ZCN44Gr5aSJ44KP44KK44G+44GX44GfXCIpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zcyA9IHNzO1xyXG5cclxuICAgICAgICAgICAgdGhpcy53aWR0aCAgPSB3aWR0aCB8fCBzcy5mcmFtZS53aWR0aDtcclxuICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHR8fCBzcy5mcmFtZS5oZWlnaHQ7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRGcmFtZSA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEZyYW1lSW5kZXggPSAwO1xyXG4gICAgICAgICAgICB0aGlzLnBhdXNlZCA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRBbmltYXRpb24gPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKFwiZW50ZXJmcmFtZVwiLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMucGF1c2VkICYmIGUuYXBwLmZyYW1lJXRoaXMuY3VycmVudEFuaW1hdGlvbi5mcmVxdWVuY3kgPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVGcmFtZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmj4/nlLtcclxuICAgICAgICAgKi9cclxuICAgICAgICBkcmF3OiBmdW5jdGlvbihjYW52YXMpIHtcclxuICAgICAgICAgICAgdmFyIHNyY1JlY3QgPSB0aGlzLnNzLmdldEZyYW1lKHRoaXMuY3VycmVudEZyYW1lKTtcclxuICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLnNzLmltYWdlLmVsZW1lbnQ7XHJcblxyXG4gICAgICAgICAgICBjYW52YXMuZHJhd0ltYWdlKGVsZW1lbnQsXHJcbiAgICAgICAgICAgICAgICBzcmNSZWN0LngsIHNyY1JlY3QueSwgc3JjUmVjdC53aWR0aCwgc3JjUmVjdC5oZWlnaHQsXHJcbiAgICAgICAgICAgICAgICAtdGhpcy53aWR0aCp0aGlzLm9yaWdpblgsIC10aGlzLmhlaWdodCp0aGlzLm9yaWdpblksIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlho3nlJ9cclxuICAgICAgICAgKi9cclxuICAgICAgICBnb3RvQW5kUGxheTogZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgICAgICBuYW1lID0gKG5hbWUgIT09IHVuZGVmaW5lZCkgPyBuYW1lIDogXCJkZWZhdWx0XCI7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnBhdXNlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRBbmltYXRpb24gPSB0aGlzLnNzLmFuaW1hdGlvbnNbbmFtZV07XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEZyYW1lID0gMDtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50RnJhbWVJbmRleCA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuX25vcm1hbGl6ZUZyYW1lKCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgrnjg4jjg4Pjg5dcclxuICAgICAgICAgKi9cclxuICAgICAgICBnb3RvQW5kU3RvcDogZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgICAgICBuYW1lID0gKG5hbWUgIT09IHVuZGVmaW5lZCkgPyBuYW1lIDogXCJkZWZhdWx0XCI7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnBhdXNlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEFuaW1hdGlvbiA9IHRoaXMuc3MuYW5pbWF0aW9uc1tuYW1lXTtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50RnJhbWUgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRGcmFtZUluZGV4ID0gMDtcclxuICAgICAgICAgICAgdGhpcy5fbm9ybWFsaXplRnJhbWUoKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODleODrOODvOODoOaVsOOBruOCq+OCpuODs+ODiOOCouODg+ODl1xyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3VwZGF0ZUZyYW1lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50RnJhbWVJbmRleCArPSAxO1xyXG4gICAgICAgICAgICB0aGlzLl9ub3JtYWxpemVGcmFtZSgpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX25vcm1hbGl6ZUZyYW1lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGFuaW0gPSB0aGlzLmN1cnJlbnRBbmltYXRpb247XHJcbiAgICAgICAgICAgIGlmIChhbmltKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50RnJhbWVJbmRleCA8IGFuaW0uZnJhbWVzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEZyYW1lID0gYW5pbS5mcmFtZXNbdGhpcy5jdXJyZW50RnJhbWVJbmRleF07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYW5pbS5uZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ290b0FuZFBsYXkoYW5pbS5uZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEZyYW1lSW5kZXggPSBhbmltLmZyYW1lcy5sZW5ndGggLSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRGcmFtZSA9IGFuaW0uZnJhbWVzW3RoaXMuY3VycmVudEZyYW1lSW5kZXhdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhdXNlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGRpc3BhdGNoIGFuaW1hdGlvbmVuZFxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlID0gdG0uZXZlbnQuRXZlbnQoXCJhbmltYXRpb25lbmRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICB9KTtcclxuXHJcbn0pKCk7XHJcblxyXG5cclxuLypcclxuICogbWFwc3ByaXRlLmpzXHJcbiAqL1xyXG5cclxuXHJcbihmdW5jdGlvbigpIHtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5kaXNwbGF5Lk1hcFNwcml0ZVxyXG4gICAgICog44Oe44OD44OX5o+P55S744Kv44Op44K5XHJcbiAgICAgKiBAZXh0ZW5kcyB0bS5kaXNwbGF5LkNhbnZhc0VsZW1lbnRcclxuICAgICAqL1xyXG4gICAgdG0uZGVmaW5lKFwidG0uZGlzcGxheS5NYXBTcHJpdGVcIiwge1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IFwidG0uZGlzcGxheS5DYW52YXNFbGVtZW50XCIsXHJcblxyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgbWFwU2hlZXQgKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5IGNoaXBXaWR0aCAqL1xyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgY2hpcEhlaWdodCAqL1xyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgb3JpZ2luWCAqL1xyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgb3JpZ2luWSAqL1xyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgd2lkdGggKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5IGhlaWdodCAqL1xyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgdGlsZXNldCAqL1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihtYXBTaGVldCwgY2hpcFdpZHRoLCBjaGlwSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3VwZXJJbml0KCk7XHJcblxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIG1hcFNoZWV0ID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubWFwU2hlZXQgPSB0bS5hc3NldC5NYW5hZ2VyLmdldChtYXBTaGVldCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1hcFNoZWV0ID0gbWFwU2hlZXQ7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuY2hpcFdpZHRoICA9IGNoaXBXaWR0aCAgfHwgMzI7XHJcbiAgICAgICAgICAgIHRoaXMuY2hpcEhlaWdodCA9IGNoaXBIZWlnaHQgfHwgMzI7XHJcblxyXG4gICAgICAgICAgICB0aGlzLm9yaWdpblggPSB0aGlzLm9yaWdpblkgPSAwO1xyXG5cclxuICAgICAgICAgICAgdGhpcy53aWR0aCA9IGNoaXBXaWR0aCp0aGlzLm1hcFNoZWV0LndpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLmhlaWdodD0gY2hpcFdpZHRoKnRoaXMubWFwU2hlZXQuaGVpZ2h0O1xyXG5cclxuICAgICAgICAgICAgdGhpcy50aWxlc2V0ID0gW107XHJcbiAgICAgICAgICAgIHRoaXMudGlsZXNldEluZm8gPSB7fTtcclxuICAgICAgICAgICAgdGhpcy5fYnVpbGQoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9idWlsZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgICAgICAgICAgIHRoaXMubWFwU2hlZXQudGlsZXNldHMuZWFjaChmdW5jdGlvbih0aWxlc2V0LCBpbmRleCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5fYnVpbGRUaWxlc2V0KHRpbGVzZXQsIGluZGV4KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLm1hcFNoZWV0LmxheWVycy5lYWNoKGZ1bmN0aW9uKGxheWVyLCBob2dlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobGF5ZXIudHlwZSA9PSBcIm9iamVjdGdyb3VwXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLl9idWlsZE9iamVjdChsYXllcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChsYXllci50eXBlID09IFwiaW1hZ2VsYXllclwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fYnVpbGRJbWFnZUxheWVyKGxheWVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX2J1aWxkTGF5ZXIobGF5ZXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9idWlsZFRpbGVzZXQ6IGZ1bmN0aW9uKHRpbGVzZXQsIGluZGV4KSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxmICAgICAgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgbWFwU2hlZXQgID0gdGhpcy5tYXBTaGVldDtcclxuICAgICAgICAgICAgdmFyIHRleHR1cmUgICA9IHRtLmFzc2V0Lk1hbmFnZXIuZ2V0KHRpbGVzZXQuaW1hZ2UpO1xyXG4gICAgICAgICAgICB2YXIgeEluZGV4TWF4ID0gKHRleHR1cmUud2lkdGggLyBtYXBTaGVldC50aWxld2lkdGgpfDA7XHJcbiAgICAgICAgICAgIHZhciB5SW5kZXhNYXggPSAodGV4dHVyZS5oZWlnaHQgLyBtYXBTaGVldC50aWxlaGVpZ2h0KXwwO1xyXG5cclxuICAgICAgICAgICAgdmFyIGluZm8gPSB7XHJcbiAgICAgICAgICAgICAgICBiZWdpbjogc2VsZi50aWxlc2V0Lmxlbmd0aCxcclxuICAgICAgICAgICAgICAgIGVuZDogc2VsZi50aWxlc2V0Lmxlbmd0aCArIHhJbmRleE1heCAqIHlJbmRleE1heFxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgc2VsZi50aWxlc2V0SW5mb1tpbmRleF0gPSBpbmZvO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRpbGVzZXQubmFtZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnRpbGVzZXRJbmZvW3RpbGVzZXQubmFtZV0gPSBpbmZvO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB5SW5kZXhNYXgudGltZXMoZnVuY3Rpb24obXkpIHtcclxuICAgICAgICAgICAgICAgIHhJbmRleE1heC50aW1lcyhmdW5jdGlvbihteCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZWN0ID0gdG0uZ2VvbS5SZWN0KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBteCAqIG1hcFNoZWV0LnRpbGV3aWR0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbXkgKiBtYXBTaGVldC50aWxlaGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXBTaGVldC50aWxld2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcFNoZWV0LnRpbGVoZWlnaHRcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnRpbGVzZXQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiB0aWxlc2V0LmltYWdlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWN0OiByZWN0XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfYnVpbGRMYXllcjogZnVuY3Rpb24obGF5ZXIpIHtcclxuICAgICAgICAgICAgdmFyIHNlbGYgICAgID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIG1hcFNoZWV0ID0gdGhpcy5tYXBTaGVldDtcclxuICAgICAgICAgICAgdmFyIHNoYXBlICAgID0gdG0uZGlzcGxheS5TaGFwZSh7XHJcbiAgICAgICAgICAgICAgICB3aWR0aDogdGhpcy53aWR0aCxcclxuICAgICAgICAgICAgICAgIGhlaWdodDogdGhpcy5oZWlnaHRcclxuICAgICAgICAgICAgfSkuYWRkQ2hpbGRUbyh0aGlzKTtcclxuICAgICAgICAgICAgdmFyIHZpc2libGUgID0gKGxheWVyLnZpc2libGUgPT09IDEpIHx8IChsYXllci52aXNpYmxlID09PSB1bmRlZmluZWQpO1xyXG4gICAgICAgICAgICB2YXIgb3BhY2l0eSAgPSBsYXllci5vcGFjaXR5ID09PSB1bmRlZmluZWQgPyAxIDogbGF5ZXIub3BhY2l0eTtcclxuICAgICAgICAgICAgdmFyIHRpbGVzZXQgID0gW107XHJcbiAgICAgICAgICAgIHNoYXBlLm9yaWdpbi5zZXQoMCwgMCk7XHJcblxyXG4gICAgICAgICAgICBpZiAobGF5ZXIudGlsZXNldHMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRpbGVzZXRzID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGxheWVyLnRpbGVzZXRzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRpbGVzZXRzID0gbGF5ZXIudGlsZXNldHM7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRpbGVzZXRzID0gW2xheWVyLnRpbGVzZXRzXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRpbGVzZXRzLmVhY2goZnVuY3Rpb24obikge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmZvID0gc2VsZi50aWxlc2V0SW5mb1tuXTtcclxuICAgICAgICAgICAgICAgICAgICB0aWxlc2V0ID0gdGlsZXNldC5jb25jYXQoc2VsZi50aWxlc2V0LnNsaWNlKGluZm8uYmVnaW4sIGluZm8uZW5kKSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRpbGVzZXQgPSBzZWxmLnRpbGVzZXQ7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh2aXNpYmxlKSB7XHJcbiAgICAgICAgICAgICAgICBsYXllci5kYXRhLmVhY2goZnVuY3Rpb24oZCwgaW5kZXgpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdHlwZSA9IGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9IE1hdGguYWJzKHR5cGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aWxlc2V0W3R5cGVdID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciB4SW5kZXggPSBpbmRleCVtYXBTaGVldC53aWR0aDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgeUluZGV4ID0gKGluZGV4L21hcFNoZWV0LndpZHRoKXwwO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkeCA9IHhJbmRleCpzZWxmLmNoaXBXaWR0aDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZHkgPSB5SW5kZXgqc2VsZi5jaGlwSGVpZ2h0O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgdGlsZSA9IHRpbGVzZXRbdHlwZV07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0dXJlID0gdG0uYXNzZXQuTWFuYWdlci5nZXQodGlsZS5pbWFnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlY3QgPSB0aWxlLnJlY3Q7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHNoYXBlLmNhbnZhcy5nbG9iYWxBbHBoYSA9IG9wYWNpdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hhcGUuY2FudmFzLmRyYXdUZXh0dXJlKHRleHR1cmUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY3QueCwgcmVjdC55LCByZWN0LndpZHRoLCByZWN0LmhlaWdodCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZHgsIGR5LCBzZWxmLmNoaXBXaWR0aCwgc2VsZi5jaGlwSGVpZ2h0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX2J1aWxkT2JqZWN0OiBmdW5jdGlvbihsYXllcikge1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgICAgICAgICB2YXIgZ3JvdXAgPSB0bS5kaXNwbGF5LkNhbnZhc0VsZW1lbnQoKS5hZGRDaGlsZFRvKHNlbGYpO1xyXG4gICAgICAgICAgICBncm91cC53aWR0aCA9IHNlbGYud2lkdGg7XHJcbiAgICAgICAgICAgIGdyb3VwLmhlaWdodCA9IHNlbGYuaGVpZ2h0O1xyXG5cclxuICAgICAgICAgICAgbGF5ZXIub2JqZWN0cy5mb3JFYWNoKGZ1bmN0aW9uKG9iaikge1xyXG4gICAgICAgICAgICAgICAgdmFyIF9jbGFzcyA9IHRtLnVzaW5nKG9iai50eXBlKTtcclxuICAgICAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhfY2xhc3MpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIF9jbGFzcz10bS5kaXNwbGF5W29iai50eXBlXTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgaW5pdFBhcmFtID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGlmIChvYmoucHJvcGVydGllcy5pbml0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5pdFBhcmFtID0gSlNPTi5wYXJzZShvYmoucHJvcGVydGllcy5pbml0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gX2NsYXNzLmFwcGx5KG51bGwsIGluaXRQYXJhbSkuYWRkQ2hpbGRUbyhncm91cCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgcHJvcHMgICA9IG9iai5wcm9wZXJ0aWVzO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHByb3BzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtleSA9PSBcImluaXRcIikgY29udGludWUgO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHByb3BzW2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudFtrZXldID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZWxlbWVudC54ID0gb2JqLng7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LnkgPSBvYmoueTtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQud2lkdGggPSBvYmoud2lkdGg7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmhlaWdodCA9IG9iai5oZWlnaHQ7XHJcblxyXG4gICAgICAgICAgICAgICAgZ3JvdXBbb2JqLm5hbWVdID0gZWxlbWVudDtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBzZWxmW2xheWVyLm5hbWVdID0gZ3JvdXA7XHJcblxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX2J1aWxkSW1hZ2VMYXllcjogZnVuY3Rpb24obGF5ZXIpIHtcclxuICAgICAgICAgICAgdmFyIHNwcml0ZSA9IHRtLmRpc3BsYXkuU3ByaXRlKGxheWVyLmltYWdlLnNvdXJjZSkuc2V0T3JpZ2luKDAsIDApLmFkZENoaWxkVG8odGhpcyk7XHJcbiAgICAgICAgICAgIHNwcml0ZS54ID0gbGF5ZXIueDtcclxuICAgICAgICAgICAgc3ByaXRlLnkgPSBsYXllci55O1xyXG4gICAgICAgICAgICBzcHJpdGUuYWxwaGEgPSBsYXllci5hbHBoYTtcclxuICAgICAgICAgICAgc3ByaXRlLnZpc2libGUgPSBsYXllci52aXNpYmxlO1xyXG5cclxuICAgICAgICAgICAgdGhpc1tsYXllci5uYW1lXSA9IHNwcml0ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfSk7XHJcblxyXG59KSgpO1xyXG5cclxuXHJcblxyXG5cclxuLypcclxuICogcmVuZGVyZXIuanNcclxuICovXHJcblxyXG4gXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZGlzcGxheS5DYW52YXNSZW5kZXJlclxyXG4gICAgICog44Kt44Oj44Oz44OQ44K55o+P55S744Kv44Op44K5XHJcbiAgICAgKi9cclxuICAgIHRtLmRlZmluZShcInRtLmRpc3BsYXkuQ2FudmFzUmVuZGVyZXJcIiwge1xyXG4gICAgICAgIC8qKiDjgq3jg6Pjg7Pjg5DjgrkgKi9cclxuICAgICAgICBjYW52YXM6IG51bGwsXHJcblxyXG4gICAgICAgIC8qKiBAcHJvcGVydHkgQHByaXZhdGUgX2NvbnRleHQgICAgIOOCs+ODs+ODhuOCreOCueODiCAqL1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKiDjgrPjg7Pjgrnjg4jjg6njgq/jgr9cclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihjYW52YXMpIHtcclxuICAgICAgICAgICAgdGhpcy5jYW52YXMgPSBjYW52YXM7XHJcbiAgICAgICAgICAgIHRoaXMuX2NvbnRleHQgPSB0aGlzLmNhbnZhcy5jb250ZXh0O1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaPj+eUu1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJlbmRlcjogZnVuY3Rpb24ocm9vdCkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5zYXZlKCk7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyT2JqZWN0KHJvb3QpO1xyXG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5yZXN0b3JlKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Kq44OW44K444Kn44Kv44OI44KS5o+P55S7XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcmVuZGVyT2JqZWN0OiBmdW5jdGlvbihvYmopIHtcclxuICAgICAgICAgICAgaWYgKG9iai52aXNpYmxlID09PSBmYWxzZSkgcmV0dXJuIDtcclxuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzLl9jb250ZXh0O1xyXG5cclxuICAgICAgICAgICAgLy8gVE9ETzog5Yil44Gu5aC05omA44Gn5ZG844G244KI44GG6Kq/5pW044GZ44KLXHJcbiAgICAgICAgICAgIG9iai5fZGlydHlDYWxjICYmIG9iai5fZGlydHlDYWxjKCk7XHJcblxyXG4gICAgICAgICAgICAvLyDmj4/nlLvlj6/og73jgYvjgpLjg4Hjgqfjg4Pjgq9cclxuICAgICAgICAgICAgaWYgKCF0aGlzLl9jaGVja1JlbmRlcmFibGUob2JqKSkge1xyXG4gICAgICAgICAgICAgICAgLy8g5a2Q5L6b6YGU44Gu44G/5o+P55S75a6f6KGMXHJcbiAgICAgICAgICAgICAgICBpZiAob2JqLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcENoaWxkcmVuID0gb2JqLmNoaWxkcmVuLnNsaWNlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaT0wLGxlbj10ZW1wQ2hpbGRyZW4ubGVuZ3RoOyBpPGxlbjsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyT2JqZWN0KHRlbXBDaGlsZHJlbltpXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiA7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFxyXG4gICAgICAgICAgICBpZiAoIW9iai5kcmF3KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zZXRSZW5kZXJGdW5jdGlvbihvYmopO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyDmg4XloLHjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgICAgaWYgKG9iai5maWxsU3R5bGUpICAgY29udGV4dC5maWxsU3R5bGUgICA9IG9iai5maWxsU3R5bGU7XHJcbiAgICAgICAgICAgIGlmIChvYmouc3Ryb2tlU3R5bGUpIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSBvYmouc3Ryb2tlU3R5bGU7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZ2xvYmFsQWxwaGEgICAgPSBvYmouX3dvcmxkQWxwaGE7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gb2JqLmJsZW5kTW9kZTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmIChvYmouc2hhZG93Qmx1cikge1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5zaGFkb3dDb2xvciAgID0gb2JqLnNoYWRvd0NvbG9yO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5zaGFkb3dPZmZzZXRYID0gb2JqLnNoYWRvd09mZnNldFg7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LnNoYWRvd09mZnNldFkgPSBvYmouc2hhZG93T2Zmc2V0WTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuc2hhZG93Qmx1ciAgICA9IG9iai5zaGFkb3dCbHVyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5zaGFkb3dPZmZzZXRYID0gMDtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuc2hhZG93T2Zmc2V0WSA9IDA7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LnNoYWRvd0NvbG9yICAgPSBcInJnYmEoMCwgMCwgMCwgMClcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8g6KGM5YiX44KS44K744OD44OIXHJcbiAgICAgICAgICAgIHZhciBtID0gb2JqLl93b3JsZE1hdHJpeC5tO1xyXG4gICAgICAgICAgICBjb250ZXh0LnNldFRyYW5zZm9ybSggbVswXSwgbVszXSwgbVsxXSwgbVs0XSwgbVsyXSwgbVs1XSApO1xyXG4gICAgICAgICAgICBcclxuXHJcbiAgICAgICAgICAgIGlmIChvYmouY2xpcHBpbmcpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIOOCr+ODquODg+ODl+WHpueQhuOCkuWun+ihjFxyXG4gICAgICAgICAgICAgICAgaWYgKG9iai5jbGlwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JqLmNsaXAoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG9uY2xpcC5jYWxsKG9iaiwgdGhpcy5jYW52YXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29udGV4dC5jbGlwKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgb2JqLmRyYXcodGhpcy5jYW52YXMpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyDlrZDkvpvpgZTjgoLlrp/ooYxcclxuICAgICAgICAgICAgICAgIGlmIChvYmouY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wQ2hpbGRyZW4gPSBvYmouY2hpbGRyZW4uc2xpY2UoKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpPTAsbGVuPXRlbXBDaGlsZHJlbi5sZW5ndGg7IGk8bGVuOyArK2kpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJPYmplY3QodGVtcENoaWxkcmVuW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBvYmouZHJhdyh0aGlzLmNhbnZhcyk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIOWtkOS+m+mBlOOCguWun+ihjFxyXG4gICAgICAgICAgICAgICAgaWYgKG9iai5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBDaGlsZHJlbiA9IG9iai5jaGlsZHJlbi5zbGljZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGk9MCxsZW49dGVtcENoaWxkcmVuLmxlbmd0aDsgaTxsZW47ICsraSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlck9iamVjdCh0ZW1wQ2hpbGRyZW5baV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX2NoZWNrUmVuZGVyYWJsZTogZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgIGlmIChvYmouX3JlbmRlcmFibGUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgb2JqLl9yZW5kZXJhYmxlID0gKG9iaiBpbnN0YW5jZW9mIHRtLmRpc3BsYXkuQ2FudmFzRWxlbWVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG9iai5fcmVuZGVyYWJsZTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9zZXRSZW5kZXJGdW5jdGlvbjogZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgIGlmIChvYmogaW5zdGFuY2VvZiB0bS5kaXNwbGF5LlNwcml0ZSkge1xyXG4gICAgICAgICAgICAgICAgb2JqLmRyYXcgPSByZW5kZXJGdW5jTGlzdFtcInNwcml0ZVwiXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChvYmogaW5zdGFuY2VvZiB0bS5kaXNwbGF5Lk1hcFNwcml0ZSkge1xyXG4gICAgICAgICAgICAgICAgb2JqLmRyYXcgPSBmdW5jdGlvbigpIHt9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKG9iaiBpbnN0YW5jZW9mIHRtLmRpc3BsYXkuTGFiZWwpIHtcclxuICAgICAgICAgICAgICAgIG9iai5kcmF3ID0gcmVuZGVyRnVuY0xpc3RbXCJsYWJlbFwiXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChvYmogaW5zdGFuY2VvZiB0bS5kaXNwbGF5LlNoYXBlKSB7XHJcbiAgICAgICAgICAgICAgICBvYmouZHJhdyA9IHJlbmRlckZ1bmNMaXN0W1wic2hhcGVcIl07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBvYmouZHJhdyA9IGZ1bmN0aW9uKCkge307XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIHZhciByZW5kZXJGdW5jTGlzdCA9IHtcclxuICAgICAgICBcInNwcml0ZVwiOiBmdW5jdGlvbihjYW52YXMpIHtcclxuICAgICAgICAgICAgdmFyIHNyY1JlY3QgPSB0aGlzLnNyY1JlY3Q7XHJcbiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5faW1hZ2UuZWxlbWVudDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNhbnZhcy5jb250ZXh0LmRyYXdJbWFnZShlbGVtZW50LFxyXG4gICAgICAgICAgICAgICAgc3JjUmVjdC54LCBzcmNSZWN0LnksIHNyY1JlY3Qud2lkdGgsIHNyY1JlY3QuaGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgLXRoaXMud2lkdGgqdGhpcy5vcmlnaW4ueCwgLXRoaXMuaGVpZ2h0KnRoaXMub3JpZ2luLnksIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFwic2hhcGVcIjogZnVuY3Rpb24oY2FudmFzKSB7XHJcbiAgICAgICAgICAgIHZhciBzcmNSZWN0ID0gdGhpcy5zcmNSZWN0O1xyXG4gICAgICAgICAgICBjYW52YXMuZHJhd0ltYWdlKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5jYW52YXMuY2FudmFzLFxyXG4gICAgICAgICAgICAgICAgMCwgMCwgdGhpcy5jYW52YXMud2lkdGgsIHRoaXMuY2FudmFzLmhlaWdodCxcclxuICAgICAgICAgICAgICAgIC10aGlzLndpZHRoKnRoaXMub3JpZ2luLngsIC10aGlzLmhlaWdodCp0aGlzLm9yaWdpbi55LCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcImxhYmVsXCI6IGZ1bmN0aW9uKGNhbnZhcykge1xyXG4gICAgICAgICAgICBjYW52YXMuc2V0VGV4dCh0aGlzLmZvbnRTdHlsZSwgdGhpcy5hbGlnbiwgdGhpcy5iYXNlbGluZSk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmxpbmVXaWR0aCkgY2FudmFzLmxpbmVXaWR0aCA9IHRoaXMubGluZVdpZHRoO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKHRoaXMuc3Ryb2tlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5tYXhXaWR0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2xpbmVzLmVhY2goZnVuY3Rpb24oZWxtLCBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcy5zdHJva2VUZXh0KGVsbSwgMCwgdGhpcy50ZXh0U2l6ZSppLCB0aGlzLm1heFdpZHRoKTtcclxuICAgICAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbGluZXMuZWFjaChmdW5jdGlvbihlbG0sIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLnN0cm9rZVRleHQoZWxtLCAwLCB0aGlzLnRleHRTaXplKmkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuZmlsbCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubWF4V2lkdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9saW5lcy5lYWNoKGZ1bmN0aW9uKGVsbSwgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMuZmlsbFRleHQoZWxtLCAwLCB0aGlzLnRleHRTaXplKmksIHRoaXMubWF4V2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9saW5lcy5lYWNoKGZ1bmN0aW9uKGVsbSwgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMuZmlsbFRleHQoZWxtLCAwLCB0aGlzLnRleHRTaXplKmkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRlYnVnQm94KSB7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuc3Ryb2tlUmVjdCgwLCAwLCB0aGlzLndpZHRoLCAtdGhpcy5zaXplKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdmFyIG9uY2xpcCA9IGZ1bmN0aW9uKGMpIHtcclxuICAgICAgICBjLmJlZ2luUGF0aCgpO1xyXG4gICAgICAgIGMucmVjdChcclxuICAgICAgICAgICAgLXRoaXMud2lkdGgqdGhpcy5vcmlnaW4ueCxcclxuICAgICAgICAgICAgLXRoaXMuaGVpZ2h0KnRoaXMub3JpZ2luLnksXHJcbiAgICAgICAgICAgIHRoaXMud2lkdGgsXHJcbiAgICAgICAgICAgIHRoaXMuaGVpZ2h0XHJcbiAgICAgICAgICAgICk7XHJcbiAgICB9O1xyXG5cclxufSkoKTtcclxuIFxyXG5cclxuXHJcbiBcclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5kaXNwbGF5LkJvdW5kaW5nUmVjdFJlbmRlcmVyXHJcbiAgICAgKiDjg5Djgqbjg7Pjg4fjgqPjg7PjgrDooajnpLrjg6zjg7Pjg4Djg7xcclxuICAgICAqIEBleHRlbmRzIHRtLmRpc3BsYXkuQ2FudmFzUmVuZGVyZXJcclxuICAgICAqL1xyXG4gICAgdG0uZGVmaW5lKFwidG0uZGlzcGxheS5Cb3VuZGluZ1JlY3RSZW5kZXJlclwiLCB7XHJcbiAgICAgICAgc3VwZXJDbGFzczogXCJ0bS5kaXNwbGF5LkNhbnZhc1JlbmRlcmVyXCIsXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqIOOCs+ODs+OCueODiOODqeOCr+OCv1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKGNhbnZhcykge1xyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdChjYW52YXMpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3NldFJlbmRlckZ1bmN0aW9uOiBmdW5jdGlvbihvYmopIHtcclxuICAgICAgICAgICAgb2JqLmRyYXcgPSByZW5kZXI7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIHJlbmRlciA9IGZ1bmN0aW9uKGNhbnZhcykge1xyXG4gICAgICAgIGNhbnZhcy5zYXZlKCk7XHJcbiAgICAgICAgY2FudmFzLmxpbmVXaWR0aCA9IDI7XHJcbiAgICAgICAgY2FudmFzLnN0cm9rZVJlY3QoLXRoaXMud2lkdGgqdGhpcy5vcmlnaW5YLCAtdGhpcy5oZWlnaHQqdGhpcy5vcmlnaW5ZLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XHJcbiAgICAgICAgY2FudmFzLnJlc3RvcmUoKTtcclxuICAgIH07XHJcblxyXG59KSgpO1xyXG4gXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbi8qXHJcbiAqIHVzZXJpbnRlcmZhY2UuanNcclxuICovXHJcblxyXG50bS51aSA9IHRtLnVpIHx8IHt9O1xyXG5cclxuXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLnVpLlBhZFxyXG4gICAgICogcGFk44Kv44Op44K5XHJcbiAgICAgKiBAZXh0ZW5kcyB0bS5kaXNwbGF5LlNoYXBlXHJcbiAgICAgKi9cclxuICAgIHRtLnVpLlBhZCA9IHRtLmNyZWF0ZUNsYXNzKHtcclxuICAgICAgICBzdXBlckNsYXNzOiB0bS5kaXNwbGF5LlNoYXBlLFxyXG4gICAgICAgIFxyXG4gICAgICAgIGlzVG91Y2hpbmc6IGZhbHNlLFxyXG4gICAgICAgIGNpcmNsZTogbnVsbCxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3VwZXJJbml0KDEyMCwgMTIwKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciBjID0gdGhpcy5jYW52YXM7XHJcbiAgICAgICAgICAgIGMuZmlsbFN0eWxlID0gXCIjZmZmXCI7XHJcbiAgICAgICAgICAgIGMuZmlsbENpcmNsZSg2MCwgNjAsIDYwKTtcclxuICAgICAgICAgICAgYy5maWxsU3R5bGUgPSBcIiNlZWVcIjtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuX2NyZWF0ZUNpcmNsZSgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5zZXRJbnRlcmFjdGl2ZSh0cnVlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuYWxwaGEgPSAwLjc1O1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX2NyZWF0ZUNpcmNsZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBjaXJjbGUgPSB0aGlzLmNpcmNsZSA9IHRtLmRpc3BsYXkuU2hhcGUoODAsIDgwKTtcclxuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChjaXJjbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdmFyIGMgPSBjaXJjbGUuY2FudmFzO1xyXG4gICAgICAgICAgICBjLmZpbGxTdHlsZSA9IFwiIzIyMlwiO1xyXG4gICAgICAgICAgICBjLnNldFNoYWRvdyhcImJsYWNrXCIsIDIsIDIsIDIpO1xyXG4gICAgICAgICAgICBjLmZpbGxDaXJjbGUoNDAsIDQwLCAzNSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgb25wb2ludGluZ3N0YXJ0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5pc1RvdWNoaW5nID0gdHJ1ZTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBvbnBvaW50aW5nZW5kOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5pc1RvdWNoaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuY2lyY2xlLnBvc2l0aW9uLnNldCgwLCAwKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBvbnBvaW50aW5nbW92ZTogZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pc1RvdWNoaW5nPT1mYWxzZSkgcmV0dXJuIDtcclxuICAgICAgICAgICAgdmFyIHAgPSBlLnBvaW50aW5nO1xyXG4gICAgICAgICAgICB2YXIgdiA9IHRtLmdlb20uVmVjdG9yMihwLnggLSB0aGlzLngsIHAueSAtIHRoaXMueSk7XHJcbiAgICAgICAgICAgIHZhciBsZW4gPSB2Lmxlbmd0aCgpO1xyXG4gICAgICAgICAgICB2LmRpdihsZW4pO1xyXG4gICAgICAgICAgICBpZiAobGVuID4gNDApIGxlbiA9IDQwO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5hbmdsZSA9IE1hdGgucmFkVG9EZWcodi50b0FuZ2xlKCkpO1xyXG4gICAgICAgICAgICB0aGlzLmNpcmNsZS5wb3NpdGlvbi5zZXQodi54Kmxlbiwgdi55Kmxlbik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDlpKfjgY3jgZVcclxuICAgICAgICAgICAgdGhpcy5kaXN0YW5jZSAgPSBsZW4vNDAuMDtcclxuICAgICAgICAgICAgLy8g5ZCR44GN44OZ44Kv44OI44OrXHJcbiAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uID0gdi5tdWwodGhpcy5kaXN0YW5jZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIFxyXG4gICAgfSk7XHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG5cclxuXHJcbi8qXHJcbiAqIGJ1dHRvbi5qc1xyXG4gKi9cclxuXHJcbnRtLnVpID0gdG0udWkgfHwge307XHJcblxyXG5cclxuOyhmdW5jdGlvbigpIHtcclxuXHJcbiAgICB0bS5kZWZpbmUoXCJ0bS51aS5CYXNlQnV0dG9uXCIsIHtcclxuICAgICAgICBzdXBlckNsYXNzOiBcInRtLmRpc3BsYXkuQ2FudmFzRWxlbWVudFwiLFxyXG5cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihwYXJhbSkge1xyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdCgpO1xyXG5cclxuICAgICAgICAgICAgcGFyYW0gPSBwYXJhbSB8fCB7fTtcclxuICAgICAgICAgICAgdGhpcy53aWR0aCA9IHBhcmFtLndpZHRoIHx8IDY0O1xyXG4gICAgICAgICAgICB0aGlzLmhlaWdodCA9IHBhcmFtLmhlaWdodCB8fCA2NDtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2V0SW50ZXJhY3RpdmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIHRoaXMuYm91bmRpbmdUeXBlID0gXCJyZWN0XCI7XHJcblxyXG4gICAgICAgICAgICB0aGlzLm9uKFwicG9pbnRpbmdlbmRcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZsYXJlKCdwdXNoJyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICB9KTtcclxuXHJcbn0pKCk7XHJcblxyXG5cclxuOyhmdW5jdGlvbigpIHtcclxuXHJcbiAgICB0bS5kZWZpbmUoXCJ0bS51aS5TcHJpdGVCdXR0b25cIiwge1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IFwidG0udWkuQmFzZUJ1dHRvblwiLFxyXG5cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihpbWFnZSkge1xyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdCgpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zcHJpdGUgPSB0bS5kaXNwbGF5LlNwcml0ZShpbWFnZSkuYWRkQ2hpbGRUbyh0aGlzKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSB0aGlzLnNwcml0ZS53aWR0aDtcclxuICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSB0aGlzLnNwcml0ZS5oZWlnaHQ7XHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxufSkoKTtcclxuXHJcblxyXG47KGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS51aS5MYWJlbEJ1dHRvblxyXG4gICAgICogTGFiZWxCdXR0b25cclxuICAgICAqIEBleHRlbmRzIHRtLmRpc3BsYXkuTGFiZWxcclxuICAgICAqL1xyXG4gICAgdG0udWkuTGFiZWxCdXR0b24gPSB0bS5jcmVhdGVDbGFzcyh7XHJcbiAgICAgICAgc3VwZXJDbGFzczogdG0uZGlzcGxheS5MYWJlbCxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24odGV4dCkge1xyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdCh0ZXh0KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuYWxwaGEgPSB0bS51aS5MYWJlbEJ1dHRvbi5ERUZBVUxUX0FMUEhBO1xyXG4gICAgICAgICAgICB0aGlzLnNldEFsaWduKFwiY2VudGVyXCIpLnNldEJhc2VsaW5lKFwibWlkZGxlXCIpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5zZXRJbnRlcmFjdGl2ZSh0cnVlKTtcclxuICAgICAgICAgICAgdGhpcy5ib3VuZGluZ1R5cGUgPSBcInJlY3RcIjtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50aW5nb3ZlclwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudHdlZW5lci5jbGVhcigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50d2VlbmVyLmZhZGVJbigyNTApO1xyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGluZ291dFwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudHdlZW5lci5jbGVhcigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50d2VlbmVyLmZhZGUodG0udWkuTGFiZWxCdXR0b24uREVGQVVMVF9BTFBIQSwgMjUwKTtcclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8qXHJcbiAgICAgICAgICAgIHZhciBkID0gdGhpcy5kcmF3O1xyXG4gICAgICAgICAgICB0aGlzLmRyYXcgPSBmdW5jdGlvbihjYW52YXMpIHtcclxuICAgICAgICAgICAgICAgIGQuY2FsbCh0aGlzLCBjYW52YXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kcmF3Qm91bmRpbmdSZWN0KGNhbnZhcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLypcclxuICAgICAgICAgICAgKi9cclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAcHJvcGVydHlcclxuICAgICAqIOODh+ODleOCqeODq+ODiOOBqOOBquOCi+OCouODq+ODleOCoeWApFxyXG4gICAgICovXHJcbiAgICB0bS51aS5MYWJlbEJ1dHRvbi5ERUZBVUxUX0FMUEhBID0gMC41O1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS51aS5JY29uQnV0dG9uXHJcbiAgICAgKiBJY29uQnV0dG9uXHJcbiAgICAgKiBAZXh0ZW5kcyB0bS5kaXNwbGF5LlNwcml0ZVxyXG4gICAgICovXHJcbiAgICB0bS51aS5JY29uQnV0dG9uID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IHRtLmRpc3BsYXkuU3ByaXRlLFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdC5jYWxsKHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLnNldEludGVyYWN0aXZlKHRydWUpO1xyXG4gICAgICAgICAgICB0aGlzLmJvdW5kaW5nVHlwZSA9IFwicmVjdFwiO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5vbihcInBvaW50aW5nZW5kXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mbGFyZSgncHVzaCcpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQHByb3BlcnR5XHJcbiAgICAgKiDjg4fjg5Xjgqnjg6vjg4jjgajjgarjgovjgqLjg6vjg5XjgqHlgKRcclxuICAgICAqL1xyXG4gICAgdG0udWkuSWNvbkJ1dHRvbi5ERUZBVUxUX0FMUEhBID0gMC41O1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS51aS5HbG9zc3lCdXR0b25cclxuICAgICAqIGdsb3NzeSBidXR0b25cclxuICAgICAqIEBleHRlbmRzIHRtLmRpc3BsYXkuU2hhcGVcclxuICAgICAqL1xyXG4gICAgdG0udWkuR2xvc3N5QnV0dG9uID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IHRtLmRpc3BsYXkuU2hhcGUsXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKHdpZHRoLCBoZWlnaHQsIGJhY2tncm91bmRDb2xvciwgdGV4dCkge1xyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdCh3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRleHQgID0gdGV4dCAgfHwgXCJCdXR0b25cIjtcclxuICAgICAgICAgICAgdGhpcy5iYWNrZ3JvdW5kQ29sb3IgPSBiYWNrZ3JvdW5kQ29sb3IgfHwgXCJibGFja1wiO1xyXG4gICAgICAgICAgICB0aGlzLmFscGhhID0gdG0udWkuR2xvc3N5QnV0dG9uLkRFRkFVTFRfQUxQSEE7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLnNldEludGVyYWN0aXZlKHRydWUpO1xyXG4gICAgICAgICAgICB0aGlzLmJvdW5kaW5nVHlwZSA9IFwicmVjdFwiO1xyXG4gICAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGluZ292ZXJcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnR3ZWVuZXIuY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudHdlZW5lci5mYWRlKDEuMCwgMjUwKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50aW5nb3V0XCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50d2VlbmVyLmNsZWFyKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnR3ZWVuZXIuZmFkZSh0bS51aS5HbG9zc3lCdXR0b24uREVGQVVMVF9BTFBIQSwgMjUwKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDjg6njg5njg6tcclxuICAgICAgICAgICAgdGhpcy5sYWJlbCA9IHRtLmRpc3BsYXkuTGFiZWwodGV4dCB8fCBcIlwiKS5hZGRDaGlsZFRvKHRoaXMpO1xyXG4gICAgICAgICAgICB0aGlzLmxhYmVsLnNldEFsaWduKFwiY2VudGVyXCIpLnNldEJhc2VsaW5lKFwibWlkZGxlXCIpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5fcmVmcmVzaCgpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiDjOaZr+iJsuOCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldEJhY2tncm91bmRDb2xvcjogZnVuY3Rpb24oYmFja2dyb3VuZENvbG9yKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYmFja2dyb3VuZENvbG9yID0gYmFja2dyb3VuZENvbG9yO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5fcmVmcmVzaCgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Oq44OV44Os44OD44K344OlXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfcmVmcmVzaDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8vIOODnOOCv+ODs+aPj+eUu1xyXG4gICAgICAgICAgICB2YXIgYyA9IHRoaXMuY2FudmFzO1xyXG4gICAgICAgICAgICBjLnJlc2l6ZSh0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XHJcbiAgICAgICAgICAgIGMuZmlsbFN0eWxlID0gdGhpcy5iYWNrZ3JvdW5kQ29sb3I7XHJcbiAgICAgICAgICAgIGMuZmlsbFJvdW5kUmVjdCgyLCAyLCB0aGlzLndpZHRoLTQsIHRoaXMuaGVpZ2h0LTQsIDEwKTtcclxuICAgICAgICAgICAgYy5zdHJva2VTdHlsZSAgID0gXCJyZ2JhKDEwMCwxMDAsMTAwLDAuNzUpXCI7XHJcbiAgICAgICAgICAgIGMubGluZVdpZHRoICAgICA9IDI7XHJcbiAgICAgICAgICAgIGMuc3Ryb2tlUm91bmRSZWN0KDIsIDIsIHRoaXMud2lkdGgtNCwgdGhpcy5oZWlnaHQtNCwgMTApO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8g44OG44Kr44OqXHJcbiAgICAgICAgICAgIGMucm91bmRSZWN0KDIsIDIsIHRoaXMud2lkdGgtNCwgdGhpcy5oZWlnaHQtNCwgMTApO1xyXG4gICAgICAgICAgICBjLmNsaXAoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciBncmFkID0gdG0uZ3JhcGhpY3MuTGluZWFyR3JhZGllbnQoMCwgMCwgMCwgdGhpcy5oZWlnaHQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gZ3JhZC5hZGRDb2xvclN0b3AoMC4wLCBcImhzbCggIDAsIDc1JSwgNTAlKVwiKTtcclxuICAgICAgICAgICAgLy8gZ3JhZC5hZGRDb2xvclN0b3AoMC41LCBcImhzbCgxMjAsIDc1JSwgNTAlKVwiKTtcclxuICAgICAgICAgICAgLy8gZ3JhZC5hZGRDb2xvclN0b3AoMS4wLCBcImhzbCgyNDAsIDc1JSwgNTAlKVwiKTtcclxuICAgICAgICAgICAgZ3JhZC5hZGRDb2xvclN0b3AoMC4wLCBcInJnYmEoMjU1LDI1NSwyNTUsMC45KVwiKTtcclxuICAgICAgICAgICAgZ3JhZC5hZGRDb2xvclN0b3AoMC41LCBcInJnYmEoMjU1LDI1NSwyNTUsMC41KVwiKTtcclxuICAgICAgICAgICAgZ3JhZC5hZGRDb2xvclN0b3AoMC41MSwgXCJyZ2JhKDI1NSwyNTUsMjU1LDAuMilcIik7XHJcbiAgICAgICAgICAgIGdyYWQuYWRkQ29sb3JTdG9wKDEuMCwgXCJyZ2JhKDI1NSwyNTUsMjU1LDAuMClcIik7XHJcbiAgICAgICAgICAgIGMuc2V0R3JhZGllbnQoZ3JhZCk7XHJcbiAgICAgICAgICAgIGMuZmlsbFJlY3QoMiwgMiwgdGhpcy53aWR0aC00LCB0aGlzLmhlaWdodC00LCAxMCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDjg6njg5njg6vjga7jgrXjgqTjgrrjgpLjg6rjgrvjg4Pjg4hcclxuICAgICAgICAgICAgdGhpcy5sYWJlbC5zZXRTaXplKHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcclxuICAgICAgICB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAcHJvcGVydHlcclxuICAgICAqIOODh+ODleOCqeODq+ODiOOBqOOBquOCi+OCouODq+ODleOCoeWApFxyXG4gICAgICovXHJcbiAgICB0bS51aS5HbG9zc3lCdXR0b24uREVGQVVMVF9BTFBIQSA9IDAuNTtcclxuICAgIFxyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLnVpLkZsYXRCdXR0b25cclxuICAgICAqIOODleODqeODg+ODiOODh+OCtuOCpOODs+OBruODnOOCv+ODs1xyXG4gICAgICogQGV4dGVuZHMgdG0uZGlzcGxheS5TaGFwZVxyXG4gICAgICovXHJcbiAgICB0bS5kZWZpbmUoXCJ0bS51aS5GbGF0QnV0dG9uXCIsIHtcclxuICAgICAgICBzdXBlckNsYXNzOiBcInRtLnVpLkJhc2VCdXR0b25cIixcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24ocGFyYW0pIHtcclxuICAgICAgICAgICAgcGFyYW0gPSAocGFyYW0gfHwge30pLiRzYWZlKHRtLnVpLkZsYXRCdXR0b24uZGVmYXVsdHMpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zdXBlckluaXQocGFyYW0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zaGFwZSA9IHRtLmRpc3BsYXkuUm91bmRSZWN0YW5nbGVTaGFwZShwYXJhbSkuYWRkQ2hpbGRUbyh0aGlzKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMubGFiZWwgPSB0bS5kaXNwbGF5LkxhYmVsKHBhcmFtLnRleHQpLmFkZENoaWxkVG8odGhpcyk7XHJcbiAgICAgICAgICAgIHRoaXMubGFiZWwuc2V0Rm9udFNpemUocGFyYW0uZm9udFNpemUpLnNldEZvbnRGYW1pbHkocGFyYW0uZm9udEZhbWlseSkuc2V0QWxpZ24oXCJjZW50ZXJcIikuc2V0QmFzZWxpbmUoXCJtaWRkbGVcIik7XHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIHRtLnVpLkZsYXRCdXR0b24uZGVmYXVsdHMgPSB7XHJcbiAgICAgICAgd2lkdGg6IDMwMCxcclxuICAgICAgICBoZWlnaHQ6IDEwMCxcclxuICAgICAgICBmaWxsU3R5bGU6IFwiaHNsKDE4MCwgNjAlLCA1MCUpXCIsXHJcbiAgICAgICAgc3Ryb2tlU3R5bGU6IFwidHJhbnNwYXJlbnRcIixcclxuICAgICAgICB0ZXh0OiBcIlNUQVJUXCIsXHJcbiAgICAgICAgZm9udFNpemU6IDUwLFxyXG4gICAgICAgIGNvcm5lclJhZGl1czogOCxcclxuICAgICAgICBmb250RmFtaWx5OiBcIifjg5Ljg6njgq7jg47op5LjgrQgUHJvIFczJywgJ0hpcmFnaW5vIEtha3UgR290aGljIFBybycsICfjg6HjgqTjg6rjgqonLCAnTWVpcnlvJywgJ++8re+8syDvvLDjgrTjgrfjg4Pjgq8nLCAnTVMgUEdvdGhpYycsIHNhbnMtc2VyaWZcIixcclxuICAgIH07XHJcblxyXG59KSgpO1xyXG5cclxuXHJcblxyXG5cclxuLypcclxuICogbWVudWRpYWxvZy5qc1xyXG4gKi9cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0udWkuTWVudURpYWxvZ1xyXG4gICAgICog44Oh44OL44Ol44O844OA44Kk44Ki44Ot44KwXHJcbiAgICAgKiBAZXh0ZW5kcyB0bS5hcHAuU2NlbmVcclxuICAgICAqL1xyXG4gICAgdG0uZGVmaW5lKFwidG0udWkuTWVudURpYWxvZ1wiLCB7XHJcbiAgICAgICAgc3VwZXJDbGFzczogdG0uYXBwLlNjZW5lLFxyXG5cclxuICAgICAgICAvKiogQHR5cGUge3N0cmluZ30g44K/44Kk44OI44OrICovXHJcbiAgICAgICAgdGl0bGVUZXh0OiBudWxsLFxyXG4gICAgICAgIC8qKiBAdHlwZSB7QXJyYXkuPHN0cmluZz59IOODoeODi+ODpeODvOWQjeODquOCueODiCAqL1xyXG4gICAgICAgIG1lbnU6IG51bGwsXHJcbiAgICAgICAgLyoqIEB0eXBlIHtBcnJheS48c3RyaW5nPn0g44Oh44OL44Ol44O86Kmz57Sw44Oq44K544OIICovXHJcbiAgICAgICAgZGVzY3JpcHRpb25zOiBudWxsLFxyXG4gICAgICAgIC8qKiBAdHlwZSB7Ym9vbGVhbn0gZXhpdCDjga7ooajnpLov6Z2e6KGo56S6ICovXHJcbiAgICAgICAgc2hvd0V4aXQ6IGZhbHNlLFxyXG5cclxuICAgICAgICAvKiogQHR5cGUge3RtLmRpc3BsYXkuTGFiZWx9IGR1bW15ICovXHJcbiAgICAgICAgdGl0bGU6IG51bGwsXHJcbiAgICAgICAgLyoqIEB0eXBlIHtBcnJheS48dG0udWkuTGFiZWxCdXR0b24+fSBkdW1teSAqL1xyXG4gICAgICAgIHNlbGVjdGlvbnM6IFtdLFxyXG4gICAgICAgIC8qKiBAdHlwZSB7dG0uZGlzcGxheS5MYWJlbH0gZHVtbXkgKi9cclxuICAgICAgICBkZXNjcmlwdGlvbjogbnVsbCxcclxuICAgICAgICAvKiogQHR5cGUge3RtLmRpc3BsYXkuUmVjdGFuZ2xlU2hhcGV9IGR1bW15ICovXHJcbiAgICAgICAgYm94OiBudWxsLFxyXG4gICAgICAgIC8qKiBAdHlwZSB7dG0uZGlzcGxheS5SZWN0YW5nbGVTaGFwZX0gZHVtbXkgKi9cclxuICAgICAgICBjdXJzb3I6IG51bGwsXHJcblxyXG4gICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xyXG4gICAgICAgIF9zZWxlY3RlZDogMCxcclxuICAgICAgICAvKiogQHByaXZhdGUgKi9cclxuICAgICAgICBfb3BlbmVkOiBmYWxzZSxcclxuICAgICAgICAvKiogQHByaXZhdGUgKi9cclxuICAgICAgICBfZmluaXNoZWQ6IGZhbHNlLFxyXG5cclxuICAgICAgICAvKiogQHByaXZhdGUgKi9cclxuICAgICAgICBfc2NyZWVuV2lkdGg6IDAsXHJcbiAgICAgICAgLyoqIEBwcml2YXRlICovXHJcbiAgICAgICAgX3NjcmVlbkhlaWdodDogMCxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtc1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKHBhcmFtcykge1xyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdCgpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fc2NyZWVuV2lkdGggPSBwYXJhbXMuc2NyZWVuV2lkdGg7XHJcbiAgICAgICAgICAgIHRoaXMuX3NjcmVlbkhlaWdodCA9IHBhcmFtcy5zY3JlZW5IZWlnaHQ7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnRpdGxlVGV4dCA9IHBhcmFtcy50aXRsZTtcclxuICAgICAgICAgICAgdGhpcy5tZW51ID0gW10uY29uY2F0KHBhcmFtcy5tZW51KTtcclxuICAgICAgICAgICAgdGhpcy5fc2VsZWN0ZWQgPSB+fnBhcmFtcy5kZWZhdWx0U2VsZWN0ZWQ7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd0V4aXQgPSAhIXBhcmFtcy5zaG93RXhpdDtcclxuICAgICAgICAgICAgaWYgKHBhcmFtcy5tZW51RGVzY3RpcHRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRlc2NyaXB0aW9ucyA9IHBhcmFtcy5tZW51RGVzY3RpcHRpb25zO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZXNjcmlwdGlvbnMgPSBbXS5jb25jYXQocGFyYW1zLm1lbnUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5zaG93RXhpdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tZW51LnB1c2goXCJleGl0XCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZXNjcmlwdGlvbnMucHVzaChcIuWJjeOBrueUu+mdouOBuOaIu+OCiuOBvuOBmVwiKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIGhlaWdodCA9IE1hdGgubWF4KCgxK3RoaXMubWVudS5sZW5ndGgpKjUwLCA1MCkgKyA0MDtcclxuICAgICAgICAgICAgdGhpcy5ib3ggPSB0bS5kaXNwbGF5LlJlY3RhbmdsZVNoYXBlKHRoaXMuX3NjcmVlbldpZHRoICogMC44LCBoZWlnaHQsIHtcclxuICAgICAgICAgICAgICAgIHN0cm9rZVN0eWxlOiBcInJnYmEoMCwwLDAsMClcIixcclxuICAgICAgICAgICAgICAgIGZpbGxTdHlsZTogXCJyZ2JhKDQzLDE1NiwyNTUsIDAuOClcIixcclxuICAgICAgICAgICAgfSkuc2V0UG9zaXRpb24odGhpcy5fc2NyZWVuV2lkdGgqMC41LCB0aGlzLl9zY3JlZW5IZWlnaHQqMC41KTtcclxuICAgICAgICAgICAgdGhpcy5ib3gud2lkdGggPSAxO1xyXG4gICAgICAgICAgICB0aGlzLmJveC5oZWlnaHQgPSAxO1xyXG4gICAgICAgICAgICB0aGlzLmJveC5zZXRCb3VuZGluZ1R5cGUoXCJyZWN0XCIpO1xyXG4gICAgICAgICAgICB0aGlzLmJveC50d2VlbmVyXHJcbiAgICAgICAgICAgICAgICAudG8oeyB3aWR0aDogdGhpcy5fc2NyZWVuV2lkdGgqMC44LCBoZWlnaHQ6IGhlaWdodCB9LCAyMDAsIFwiZWFzZU91dEV4cG9cIilcclxuICAgICAgICAgICAgICAgIC5jYWxsKHRoaXMuX29uT3Blbi5iaW5kKHRoaXMpKTtcclxuICAgICAgICAgICAgdGhpcy5ib3guYWRkQ2hpbGRUbyh0aGlzKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSB0bS5kaXNwbGF5LkxhYmVsKFwiXCIsIDE0KVxyXG4gICAgICAgICAgICAgICAgLnNldEFsaWduKFwiY2VudGVyXCIpXHJcbiAgICAgICAgICAgICAgICAuc2V0QmFzZWxpbmUoXCJtaWRkbGVcIilcclxuICAgICAgICAgICAgICAgIC5zZXRQb3NpdGlvbih0aGlzLl9zY3JlZW5XaWR0aCowLjUsIHRoaXMuX3NjcmVlbkhlaWdodC0xMClcclxuICAgICAgICAgICAgICAgIC5hZGRDaGlsZFRvKHRoaXMpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX29uT3BlbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIHkgPSB0aGlzLl9zY3JlZW5IZWlnaHQqMC41IC0gdGhpcy5tZW51Lmxlbmd0aCAqIDI1O1xyXG5cclxuICAgICAgICAgICAgdGhpcy50aXRsZSA9IHRtLmRpc3BsYXkuTGFiZWwodGhpcy50aXRsZVRleHQsIDMwKVxyXG4gICAgICAgICAgICAgICAgLnNldEFsaWduKFwiY2VudGVyXCIpXHJcbiAgICAgICAgICAgICAgICAuc2V0QmFzZWxpbmUoXCJtaWRkbGVcIilcclxuICAgICAgICAgICAgICAgIC5zZXRQb3NpdGlvbih0aGlzLl9zY3JlZW5XaWR0aCowLjUsIHkpXHJcbiAgICAgICAgICAgICAgICAuYWRkQ2hpbGRUbyh0aGlzKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY3Vyc29yID0gdGhpcy5fY3JlYXRlQ3Vyc29yKCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvbnMgPSB0aGlzLm1lbnUubWFwKGZ1bmN0aW9uKHRleHQsIGkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgICAgIHkgKz0gNTA7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0aW9uID0gdG0udWkuTGFiZWxCdXR0b24odGV4dClcclxuICAgICAgICAgICAgICAgICAgICAuc2V0UG9zaXRpb24odGhpcy5fc2NyZWVuV2lkdGgqMC41LCB5KVxyXG4gICAgICAgICAgICAgICAgICAgIC5hZGRDaGlsZFRvKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uLmludGVyYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHNlbGVjdGlvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuX3NlbGVjdGVkID09PSBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY2xvc2VEaWFsb2coc2VsZi5fc2VsZWN0ZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3NlbGVjdGVkID0gaTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSB0bS5ldmVudC5FdmVudChcIm1lbnVzZWxlY3RcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuc2VsZWN0VmFsdWUgPSBzZWxmLm1lbnVbc2VsZi5fc2VsZWN0ZWRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnNlbGVjdEluZGV4ID0gaTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uLndpZHRoID0gdGhpcy5fc2NyZWVuV2lkdGggKiAwLjc7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0aW9uO1xyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jdXJzb3IueSA9IHRoaXMuc2VsZWN0aW9uc1t0aGlzLl9zZWxlY3RlZF0ueTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX29wZW5lZCA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAvLyBjbG9zZSB3aW5kb3cgd2hlbiB0b3VjaCBiZyBvdXRzaWRlXHJcbiAgICAgICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50aW5nZW5kXCIsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwID0gZS5hcHAucG9pbnRpbmc7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXNlbGYuYm94LmlzSGl0UG9pbnQocC54LCBwLnkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jbG9zZURpYWxvZyhzZWxmLl9zZWxlY3RlZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gZGlzcGF0Y2ggb3BlbmVkIGV2ZW50XHJcbiAgICAgICAgICAgIHZhciBlID0gdG0uZXZlbnQuRXZlbnQoXCJtZW51b3BlbmVkXCIpO1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfY3JlYXRlQ3Vyc29yOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGN1cnNvciA9IHRtLmRpc3BsYXkuUmVjdGFuZ2xlU2hhcGUodGhpcy5fc2NyZWVuV2lkdGgqMC43LCAzMCwge1xyXG4gICAgICAgICAgICAgICAgc3Ryb2tlU3R5bGU6IFwicmdiYSgwLDAsMCwwKVwiLFxyXG4gICAgICAgICAgICAgICAgZmlsbFN0eWxlOiBcInJnYmEoMTIsNzksMTM4LDEpXCJcclxuICAgICAgICAgICAgfSkuYWRkQ2hpbGRUbyh0aGlzKTtcclxuICAgICAgICAgICAgY3Vyc29yLnggPSB0aGlzLl9zY3JlZW5XaWR0aCowLjU7XHJcbiAgICAgICAgICAgIGN1cnNvci50YXJnZXQgPSB0aGlzLl9zZWxlY3RlZDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGN1cnNvci51cGRhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnRhcmdldCAhPT0gdGhpcy5wYXJlbnQuX3NlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50YXJnZXQgPSB0aGlzLnBhcmVudC5fc2VsZWN0ZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50d2VlbmVyLmNsZWFyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50d2VlbmVyLnRvKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTogdGhpcy5wYXJlbnQuc2VsZWN0aW9uc1t0aGlzLnBhcmVudC5fc2VsZWN0ZWRdLnlcclxuICAgICAgICAgICAgICAgICAgICB9LCAyMDAsIFwiZWFzZU91dEV4cG9cIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gY3Vyc29yO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOabtOaWsFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHVwZGF0ZTogZnVuY3Rpb24oYXBwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGVzY3JpcHRpb24udGV4dCA9IHRoaXMuZGVzY3JpcHRpb25zW3RoaXMuX3NlbGVjdGVkXTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDplonjgZjjgotcclxuICAgICAgICAgKi9cclxuICAgICAgICBjbG9zZURpYWxvZzogZnVuY3Rpb24ocmVzdWx0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2ZpbmlzaGVkID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgIHZhciBlID0gdG0uZXZlbnQuRXZlbnQoXCJtZW51c2VsZWN0ZWRcIik7XHJcbiAgICAgICAgICAgIGUuc2VsZWN0SW5kZXggPSByZXN1bHQ7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChlKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMudHdlZW5lclxyXG4gICAgICAgICAgICAgICAgLmNsZWFyKClcclxuICAgICAgICAgICAgICAgIC53YWl0KDIwMClcclxuICAgICAgICAgICAgICAgIC5jYWxsKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3Vyc29yLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGl0bGUucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zLmVhY2goZnVuY3Rpb24oc2VsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbC5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJveC50d2VlbmVyLmNsZWFyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ib3gudHdlZW5lclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudG8oeyB3aWR0aDogMSwgaGVpZ2h0OiAxIH0sIDIwMCwgXCJlYXNlSW5FeHBvXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYWxsKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAucG9wU2NlbmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlID0gdG0uZXZlbnQuRXZlbnQoXCJtZW51Y2xvc2VkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zZWxlY3RJbmRleCA9IHJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgICAgIHRoaXMuY3Vyc29yLnR3ZWVuZXJcclxuICAgICAgICAgICAgICAgIC5jbGVhcigpXHJcbiAgICAgICAgICAgICAgICAuY2FsbChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZpc2libGUgPSAhdGhpcy52aXNpYmxlO1xyXG4gICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMuY3Vyc29yKSlcclxuICAgICAgICAgICAgICAgIC5zZXRMb29wKHRydWUpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaPj+eUu1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGRyYXc6IGZ1bmN0aW9uKGNhbnZhcykge1xyXG4gICAgICAgICAgICBjYW52YXMuZmlsbFN0eWxlID0gXCJyZ2JhKDAsMCwwLDAuOClcIjtcclxuICAgICAgICAgICAgY2FudmFzLmZpbGxSZWN0KDAsMCx0aGlzLl9zY3JlZW5XaWR0aCx0aGlzLl9zY3JlZW5IZWlnaHQpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgfSk7XHJcblxyXG59KSgpO1xyXG5cclxuLypcclxuICogc2tldGNoLmpzXHJcbiAqL1xyXG5cclxuOyhmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgdmFyIERFRkFVTFRfUEFSQU0gPSB7XHJcbiAgICAgICAgYmdDb2xvcjogXCJyZ2JhKDI1NSwgMjU1LCAyNTUsIDEuMClcIixcclxuICAgICAgICBwZW5Db2xvcjogXCJyZ2JhKDAsIDAsIDAsIDEuMClcIixcclxuICAgICAgICBsaW5lV2lkdGg6IDE2LFxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0udWkuU2tldGNoXHJcbiAgICAgKiBTa2V0Y2hcclxuICAgICAqIEBleHRlbmRzIHRtLmRpc3BsYXkuU2hhcGVcclxuICAgICAqL1xyXG4gICAgdG0uZGVmaW5lKFwidG0udWkuU2tldGNoXCIsIHtcclxuICAgICAgICBzdXBlckNsYXNzOiBcInRtLmRpc3BsYXkuU2hhcGVcIixcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihwYXJhbSkge1xyXG4gICAgICAgICAgICBwYXJhbSA9IHRoaXMuX2RpcnR5Q2hlY2tQYXJhbS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICBwYXJhbS4kc2FmZShERUZBVUxUX1BBUkFNKTtcclxuICAgICAgICAgICAgdGhpcy5zdXBlckluaXQocGFyYW0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5hdXRvUmVuZGVyID0gZmFsc2U7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLl9zZXR1cChwYXJhbSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICBfc2V0dXA6IGZ1bmN0aW9uKHBhcmFtKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIHNldHVwIHRoaXNcclxuICAgICAgICAgICAgdGhpcy5ib3VuZGluZ1R5cGUgPSBcInJlY3RcIjtcclxuICAgICAgICAgICAgdGhpcy5zZXRJbnRlcmFjdGl2ZSh0cnVlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIHNldHVwIGNhbnZhc1xyXG4gICAgICAgICAgICB2YXIgYyA9IHRoaXMuY2FudmFzLmNvbnRleHQ7XHJcbiAgICAgICAgICAgIGMubGluZUNhcCAgPSBcInJvdW5kXCI7XHJcbiAgICAgICAgICAgIGMubGluZUpvaW4gPSBcInJvdW5kXCI7XHJcbiAgICAgICAgICAgIGMubWl0ZXJMaW1pdCA9IDEwLjA7XHJcbiAgICAgICAgICAgIHRoaXMuYmdDb2xvciA9IHBhcmFtLmJnQ29sb3I7XHJcbiAgICAgICAgICAgIHRoaXMucGVuQ29sb3IgPSBwYXJhbS5wZW5Db2xvcjtcclxuICAgICAgICAgICAgdGhpcy5saW5lV2lkdGggPSBwYXJhbS5saW5lV2lkdGg7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBzZXR1cCBldmVudFxyXG4gICAgICAgICAgICB0aGlzLm9uKFwicG9pbnRpbmdzdGFydFwiLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcCA9IGUuYXBwLnBvaW50aW5nO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBzZWxmLl9kcmF3UG9pbnQocC5wb3NpdGlvbik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLm9uKFwicG9pbnRpbmdtb3ZlXCIsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwID0gZS5hcHAucG9pbnRpbmc7XHJcbiAgICAgICAgICAgICAgICBzZWxmLl9kcmF3TGluZShwLnByZXZQb3NpdGlvbiwgcC5wb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnBvaW50cy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB4OiBwLngtdGhpcy5sZWZ0LFxyXG4gICAgICAgICAgICAgICAgICAgIHk6IHAueS10aGlzLnRvcCxcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5vbihcInBvaW50aW5nZW5kXCIsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYucG9pbnRzTGlzdC5wdXNoKHNlbGYucG9pbnRzKTtcclxuICAgICAgICAgICAgICAgIHNlbGYucG9pbnRzID0gW107XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8g44Od44Kk44Oz44OI44K544K/44OD44KvXHJcbiAgICAgICAgICAgIHRoaXMucG9pbnRzTGlzdCA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLnBvaW50cyA9IFtdO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog55S76Z2i44KSYmdDb2xvcuiJsuOBp+OCr+ODquOCouOBmeOCi1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGNsZWFyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5jYW52YXMuY2xlYXIoKTtcclxuICAgICAgICAgICAgdGhpcy5jYW52YXMuY2xlYXJDb2xvcih0aGlzLmJnQ29sb3IpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5wb2ludHNMaXN0ID0gW107XHJcbiAgICAgICAgICAgIHRoaXMucG9pbnRzID0gW107XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIF9kcmF3UG9pbnQ6IGZ1bmN0aW9uKHApIHtcclxuICAgICAgICAgICAgdGhpcy5jYW52YXMuZHJhd1BvaW50KHAueC10aGlzLmxlZnQsIHAueS10aGlzLnRvcCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICBfZHJhd0xpbmU6IGZ1bmN0aW9uKHAsIHByZXYpIHtcclxuICAgICAgICAgICAgdGhpcy5jYW52YXMuZHJhd0xpbmUoXHJcbiAgICAgICAgICAgICAgICBwLngtdGhpcy5sZWZ0LCBwLnktdGhpcy50b3AsXHJcbiAgICAgICAgICAgICAgICBwcmV2LngtdGhpcy5sZWZ0LCBwcmV2LnktdGhpcy50b3BcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgfSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgcGVuQ29sb3JcclxuICAgICAqIHBlbkNvbG9yXHJcbiAgICAgKi9cclxuICAgIHRtLnVpLlNrZXRjaC5wcm90b3R5cGUuYWNjZXNzb3IoXCJwZW5Db2xvclwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMuX3BlbkNvbG9yOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7XHJcbiAgICAgICAgICAgIHRoaXMuX3BlbkNvbG9yID0gdjtcclxuICAgICAgICAgICAgdGhpcy5jYW52YXMuc3Ryb2tlU3R5bGUgPSB2O1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBiZ0NvbG9yXHJcbiAgICAgKiBiZ0NvbG9yXHJcbiAgICAgKi9cclxuICAgIHRtLnVpLlNrZXRjaC5wcm90b3R5cGUuYWNjZXNzb3IoXCJiZ0NvbG9yXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5fYmdDb2xvcjsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSAge1xyXG4gICAgICAgICAgICB0aGlzLl9iZ0NvbG9yID0gdjtcclxuICAgICAgICAgICAgdGhpcy5jbGVhcigpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBsaW5lV2lkdGhcclxuICAgICAqIGxpbmVXaWR0aFxyXG4gICAgICovXHJcbiAgICB0bS51aS5Ta2V0Y2gucHJvdG90eXBlLmFjY2Vzc29yKFwibGluZVdpZHRoXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpICAgeyByZXR1cm4gdGhpcy5fbGluZVdpZHRoOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpICB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xpbmVXaWR0aCA9IHY7XHJcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLmxpbmVXaWR0aCA9IHY7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuLypcclxuICogIGdhdWdlLmpzXHJcbiAqL1xyXG5cclxuXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0udWkuR2F1Z2VcclxuICAgICAqIOOCsuODvOODoOeUqOOCsuODvOOCuOOCr+ODqeOCuVxyXG4gICAgICogQGV4dGVuZHMgdG0uZGlzcGxheS5DYW52YXNFbGVtZW50XHJcbiAgICAgKi9cclxuICAgIHRtLnVpLkdhdWdlID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IHRtLmRpc3BsYXkuQ2FudmFzRWxlbWVudCxcclxuICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgqLjg4vjg6Hjg7zjgrfjg6fjg7PjgZXjgZvjgovjgYvjganjgYbjgYvjga7jg5Xjg6njgrBcclxuICAgICAgICAgKi9cclxuICAgICAgICBhbmltYXRpb25GbGFnOiB0cnVlLFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIDB+MTAwIOOBq+WkieWMluOBmeOCi+mam+OBq+OBi+OBi+OCi+aZgumWk1xyXG4gICAgICAgICAqIOOBpOOBvuOCijEwKjEwMDAg44Gg44Gj44Gf5aC05ZCI44GvLCAwfjEw44Gr5aSJ5YyW44GZ44KL44GV44GE44Gr44CAMeenkuOBi+OBi+OCi1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGFuaW1hdGlvblRpbWU6IDEwKjEwMDAsIC8vIDEwIOenklxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihwYXJhbSkge1xyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdCgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcGFyYW0gPSBwYXJhbSB8fCB7fTtcclxuICAgICAgICAgICAgcGFyYW0uJHNhZmUoe1xyXG4gICAgICAgICAgICAgICAgd2lkdGg6IDMwMCxcclxuICAgICAgICAgICAgICAgIGhlaWdodDogMjUsXHJcbiAgICAgICAgICAgICAgICBjb2xvcjogXCJoc2woMjIwLCAxMDAlLCA1MCUpXCIsXHJcbiAgICAgICAgICAgICAgICBiZ0NvbG9yOiBcIiM0NDRcIixcclxuICAgICAgICAgICAgICAgIGJvcmRlckNvbG9yOiBcIndoaXRlXCIsXHJcbiAgICAgICAgICAgICAgICBib3JkZXJXaWR0aDogNCxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLiRleHRlbmQocGFyYW0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5fcmVzZXQoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmuoDjgr/jg7PjgYvjgpLjg4Hjgqfjg4Pjgq9cclxuICAgICAgICAgKi9cclxuICAgICAgICBpc0Z1bGw6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWUgPT09IHRoaXMuX21heFZhbHVlO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOepuuOBo+OBveOBi+OCkuODgeOCp+ODg+OCr1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGlzRW1wdHk6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWUgPT0gMDtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9yZXNldDogZnVuY3Rpb24oZGlyZWN0aW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMub3JpZ2luWCA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuX3ZhbHVlID0gMTAwO1xyXG4gICAgICAgICAgICB0aGlzLl92YWx1ZSA9IHRoaXMuX21heFZhbHVlID0gMTAwO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWApOOCkuOCu+ODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFZhbHVlOiBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICAgICAgICB2YWx1ZT0gTWF0aC5jbGFtcCh2YWx1ZSwgMCwgdGhpcy5fbWF4VmFsdWUpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fcmVhbFZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBlbmQgd2hlbiBub3cgdmFsdWUgZXF1YWwgdmFsdWUgb2YgYXJndW1lbnRcclxuICAgICAgICAgICAgaWYgKHRoaXMuX3ZhbHVlID09PSB2YWx1ZSkgcmV0dXJuIDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIGZpcmUgdmFsdWUgY2hhbmdlIGV2ZW50XHJcbiAgICAgICAgICAgIHRoaXMuZmlyZSh0bS5ldmVudC5FdmVudChcImNoYW5nZVwiKSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAodGhpcy5pc0FuaW1hdGlvbigpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnR3ZWVuZXIuY2xlYXIoKTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgdGltZSA9IChNYXRoLmFicyh0aGlzLl92YWx1ZS12YWx1ZSkvMTAwKSp0aGlzLmFuaW1hdGlvblRpbWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnR3ZWVuZXIuY2xlYXIoKVxyXG4gICAgICAgICAgICAgICAgICAgIC50byh7IFwiX3ZhbHVlXCI6dmFsdWUgfSwgdGltZSlcclxuICAgICAgICAgICAgICAgICAgICAuY2FsbChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maXJlKHRtLmV2ZW50LkV2ZW50KFwiY2hhbmdlZFwiKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0VtcHR5KCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlyZSh0bS5ldmVudC5FdmVudChcImVtcHR5XCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLmlzRnVsbCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcmUodG0uZXZlbnQuRXZlbnQoXCJmdWxsXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl92YWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5maXJlKHRtLmV2ZW50LkV2ZW50KFwiY2hhbmdlZFwiKSk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzRW1wdHkoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlyZSh0bS5ldmVudC5FdmVudChcImVtcHR5XCIpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuaXNGdWxsKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcmUodG0uZXZlbnQuRXZlbnQoXCJmdWxsXCIpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5YCk44KS44Ky44OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlgKTjgpLvvIXjgafjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRQZXJjZW50OiBmdW5jdGlvbihwZXJjZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldFZhbHVlKHRoaXMuX21heFZhbHVlKnBlcmNlbnQqMC4wMSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5YCk44KS77yF44Gn44Ky44OD44OIXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0UGVyY2VudDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5fdmFsdWUvdGhpcy5fbWF4VmFsdWUpKjEwMDtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlgKTjgpLmr5Tnjofjgafjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRSYXRpbzogZnVuY3Rpb24ocmF0aW8pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0VmFsdWUodGhpcy5fbWF4VmFsdWUqcmF0aW8pO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWApOOCkuavlOeOh+OBp+OCsuODg+ODiFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldFJhdGlvOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlL3RoaXMuX21heFZhbHVlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgaXNBbmltYXRpb246IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hbmltYXRpb25GbGFnO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgZHJhdzogZnVuY3Rpb24oY2FudmFzKSB7XHJcbiAgICAgICAgICAgIGNhbnZhcy5zYXZlKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBiZ1xyXG4gICAgICAgICAgICBjYW52YXMuZmlsbFN0eWxlID0gdGhpcy5iZ0NvbG9yO1xyXG4gICAgICAgICAgICBjYW52YXMuZmlsbFJlY3QoMCwgMCwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gYmFyXHJcbiAgICAgICAgICAgIGNhbnZhcy5maWxsU3R5bGUgPSB0aGlzLmNvbG9yO1xyXG4gICAgICAgICAgICBjYW52YXMuZmlsbFJlY3QoMCwgMCwgdGhpcy53aWR0aCp0aGlzLmdldFJhdGlvKCksIHRoaXMuaGVpZ2h0KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIGJvcmRlclxyXG4gICAgICAgICAgICBjYW52YXMuc3Ryb2tlU3R5bGUgPSB0aGlzLmJvcmRlckNvbG9yO1xyXG4gICAgICAgICAgICBjYW52YXMubGluZVdpZHRoID0gdGhpcy5ib3JkZXJXaWR0aDtcclxuICAgICAgICAgICAgY2FudmFzLnN0cm9rZVJlY3QoMCwgMCwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY2FudmFzLnJlc3RvcmUoKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgdmFsdWVcclxuICAgICAqIOWApFxyXG4gICAgICovXHJcbiAgICB0bS51aS5HYXVnZS5wcm90b3R5cGUuYWNjZXNzb3IoXCJ2YWx1ZVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0VmFsdWUodik7XHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIHBlcmNlbnRcclxuICAgICAqIOODkeODvOOCu+ODs+ODiFxyXG4gICAgICovXHJcbiAgICB0bS51aS5HYXVnZS5wcm90b3R5cGUuYWNjZXNzb3IoXCJwZXJjZW50XCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRQZXJjZW50KCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRQZXJjZW50KHYpO1xyXG4gICAgICAgIH0sXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICByYXRpb1xyXG4gICAgICog5q+U546HXHJcbiAgICAgKi9cclxuICAgIHRtLnVpLkdhdWdlLnByb3RvdHlwZS5hY2Nlc3NvcihcInJhdGlvXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRSYXRpbygpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0UmF0aW8odik7XHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuOyhmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0udWkuRmxhdEdhdWdlXHJcbiAgICAgKiDjgrLjg7zjg6DnlKjjgrLjg7zjgrjjgq/jg6njgrlcclxuICAgICAqIEBleHRlbmRzIHRtLnVpLkdhdWdlXHJcbiAgICAgKi9cclxuICAgIHRtLmRlZmluZShcInRtLnVpLkZsYXRHYXVnZVwiLCB7XHJcbiAgICAgICAgc3VwZXJDbGFzczogXCJ0bS51aS5HYXVnZVwiLFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKHBhcmFtKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3VwZXJJbml0KHBhcmFtKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIGRyYXc6IGZ1bmN0aW9uKGNhbnZhcykge1xyXG4gICAgICAgICAgICBjYW52YXMuc2F2ZSgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY2FudmFzLnNhdmUoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNhbnZhcy5yb3VuZFJlY3QoMCwgMCwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQsIHRoaXMuaGVpZ2h0LzIpO1xyXG4gICAgICAgICAgICBjYW52YXMuY2xpcCgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gYmdcclxuICAgICAgICAgICAgY2FudmFzLmZpbGxTdHlsZSA9IHRoaXMuYmdDb2xvcjtcclxuICAgICAgICAgICAgY2FudmFzLmZpbGxSZWN0KDAsIDAsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIGJhclxyXG4gICAgICAgICAgICBjYW52YXMuZmlsbFN0eWxlID0gdGhpcy5jb2xvcjtcclxuICAgICAgICAgICAgY2FudmFzLmZpbGxSZWN0KDAsIDAsIHRoaXMud2lkdGgqdGhpcy5nZXRSYXRpbygpLCB0aGlzLmhlaWdodCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjYW52YXMucmVzdG9yZSgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gYm9yZGVyXHJcbiAgICAgICAgICAgIGNhbnZhcy5zdHJva2VTdHlsZSA9IHRoaXMuYm9yZGVyQ29sb3I7XHJcbiAgICAgICAgICAgIGNhbnZhcy5saW5lV2lkdGggPSB0aGlzLmJvcmRlcldpZHRoO1xyXG4gICAgICAgICAgICBjYW52YXMuc3Ryb2tlUm91bmRSZWN0KDAsIDAsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCB0aGlzLmhlaWdodC8yKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNhbnZhcy5yZXN0b3JlKCk7XHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuXHJcbjsoZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLnVpLkdsb3NzeUdhdWdlXHJcbiAgICAgKiDjgrLjg7zjg6DnlKjjgrLjg7zjgrjjgq/jg6njgrlcclxuICAgICAqIEBleHRlbmRzIHRtLnVpLkdhdWdlXHJcbiAgICAgKi9cclxuICAgIHRtLmRlZmluZShcInRtLnVpLkdsb3NzeUdhdWdlXCIsIHtcclxuICAgICAgICBzdXBlckNsYXNzOiBcInRtLnVpLkdhdWdlXCIsXHJcbiAgICAgICAgXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24ocGFyYW0pIHtcclxuICAgICAgICAgICAgcGFyYW0gPSBwYXJhbSB8fCB7fTtcclxuICAgICAgICAgICAgcGFyYW0uYm9yZGVyV2lkdGggPSBwYXJhbS5ib3JkZXJXaWR0aCB8fCAyO1xyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdChwYXJhbSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBkcmF3OiBmdW5jdGlvbihjKSB7XHJcbiAgICAgICAgICAgIGMuc2F2ZSgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gY2xpcFxyXG4gICAgICAgICAgICBjLnJvdW5kUmVjdCgwLCAwLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCwgdGhpcy5oZWlnaHQvMik7XHJcbiAgICAgICAgICAgIGMuY2xpcCgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gYmdcclxuICAgICAgICAgICAgYy5maWxsU3R5bGUgPSB0aGlzLmJnQ29sb3I7XHJcbiAgICAgICAgICAgIGMuZmlsbFJlY3QoMCwgMCwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gYmFyXHJcbiAgICAgICAgICAgIGMuZmlsbFN0eWxlID0gdGhpcy5jb2xvcjtcclxuICAgICAgICAgICAgYy5maWxsUmVjdCgwLCAwLCB0aGlzLndpZHRoKnRoaXMuZ2V0UmF0aW8oKSwgdGhpcy5oZWlnaHQpO1xyXG4gICAgICAgICAgICB2YXIgZ3JhZCA9IHRtLmdyYXBoaWNzLkxpbmVhckdyYWRpZW50KDAsIDAsIDAsIHRoaXMuaGVpZ2h0KTtcclxuICAgICAgICAgICAgZ3JhZC5hZGRDb2xvclN0b3AoMC4wLCAgXCJyZ2JhKDI1NSwyNTUsMjU1LDAuOSlcIik7XHJcbiAgICAgICAgICAgIGdyYWQuYWRkQ29sb3JTdG9wKDAuNSwgIFwicmdiYSgyNTUsMjU1LDI1NSwwLjUpXCIpO1xyXG4gICAgICAgICAgICBncmFkLmFkZENvbG9yU3RvcCgwLjUxLCBcInJnYmEoMjU1LDI1NSwyNTUsMC4yKVwiKTtcclxuICAgICAgICAgICAgZ3JhZC5hZGRDb2xvclN0b3AoMS4wLCAgXCJyZ2JhKDI1NSwyNTUsMjU1LDAuMClcIik7XHJcbiAgICAgICAgICAgIGMuc2V0R3JhZGllbnQoZ3JhZCk7XHJcbiAgICAgICAgICAgIGMuZmlsbFJlY3QoMCwgMCwgdGhpcy53aWR0aCp0aGlzLmdldFJhdGlvKCksIHRoaXMuaGVpZ2h0KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGMucmVzdG9yZSgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gYm9yZGVyXHJcbiAgICAgICAgICAgIGMubGluZVdpZHRoID0gdGhpcy5ib3JkZXJXaWR0aDtcclxuICAgICAgICAgICAgYy5zdHJva2VTdHlsZSA9IHRoaXMuYm9yZGVyQ29sb3I7XHJcbiAgICAgICAgICAgIGMuc3Ryb2tlUm91bmRSZWN0KDAsIDAsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCB0aGlzLmhlaWdodC8yKTtcclxuICAgICAgICB9LFxyXG4gICAgfSk7XHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG5cclxuXHJcbjsoZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLnVpLkxhYmVsQXJlYVxyXG4gICAgICogQGV4dGVuZHMgdG0uZGlzcGxheS5TaGFwZVxyXG4gICAgICog44Op44OZ44Or44Ko44Oq44Ki44Kv44Op44K5XHJcbiAgICAgKi9cclxuICAgIHRtLmRlZmluZShcInRtLnVpLkxhYmVsQXJlYVwiLCB7XHJcbiAgICAgICAgc3VwZXJDbGFzczogXCJ0bS5kaXNwbGF5LlNoYXBlXCIsXHJcbiAgICAgICAgXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24ocGFyYW0pIHtcclxuICAgICAgICAgICAgcGFyYW0gPSBwYXJhbSB8fCB7fTtcclxuICAgICAgICAgICAgdGhpcy5zdXBlckluaXQocGFyYW0ud2lkdGggfHwgMTUwLCBwYXJhbS5oZWlnaHQgfHwgNjApO1xyXG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5jbGVhckNvbG9yKFwicmVkXCIpO1xyXG4gICAgICAgICAgICB0aGlzLiRleHRlbmQoe1xyXG4gICAgICAgICAgICAgICAgbW9kZTogICAgICAgICBwYXJhbS5tb2RlICAgICAgIHx8IFwiaG9yaXpvblwiLFxyXG4gICAgICAgICAgICAgICAgX2ZpbGxTdHlsZTogICBwYXJhbS5maWxsU3R5bGUgIHx8IFwiI2FhYVwiLFxyXG4gICAgICAgICAgICAgICAgX2JnQ29sb3I6ICAgICBwYXJhbS5iZ0NvbG9yICAgIHx8IFwidHJhbnNwYXJlbnRcIixcclxuICAgICAgICAgICAgICAgIF9mb250U2l6ZTogICAgcGFyYW0uZm9udFNpemUgICB8fCAyNCxcclxuICAgICAgICAgICAgICAgIF9mb250RmFtaWx5OiAgcGFyYW0uZm9udEZhbWlseSB8fCBcIidDb25zb2xhcycsICdNb25hY28nLCAn77yt77yzIOOCtOOCt+ODg+OCrydcIixcclxuICAgICAgICAgICAgICAgIF9mb250V2VpZ2h0OiAgcGFyYW0uZm9udFdlaWdodCB8fCBcIlwiLFxyXG4gICAgICAgICAgICAgICAgbGluZVNwYWNlOiAgICBwYXJhbS5saW5lU3BhY2UgIHx8IDEsIC8vIOihjOmWkywg5paH5a2X44K144Kk44K6KHB4KeOBq+WvvuOBmeOCi+WAjeeOh1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5fdXBkYXRlRm9udCgpO1xyXG4gICAgICAgICAgICB0aGlzLnNldFRleHQocGFyYW0udGV4dCB8fCBcIuOBk+OCk+OBq+OBoeOBryzkuJbnlYwhXCIpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgc2V0VGV4dDogZnVuY3Rpb24odGV4dCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fdGV4dCA9PT0gdGV4dCkgeyByZXR1cm4gOyB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLl90ZXh0ID0gIHRleHQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJUZXh0KCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICBfcmVuZGVyVGV4dDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLndpZHRoICA9dGhpcy53aWR0aDtcclxuICAgICAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID10aGlzLmhlaWdodDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLmNsZWFyQ29sb3IodGhpcy5iZ0NvbG9yKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLmZvbnQgPSB0aGlzLmZvbnRTdHlsZTtcclxuICAgICAgICAgICAgdGhpcy5jYW52YXMuZmlsbFN0eWxlID0gdGhpcy5maWxsU3R5bGU7XHJcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLmZpbGxMYWJlbEFyZWEoe1xyXG4gICAgICAgICAgICAgICAgdGV4dDogdGhpcy5fdGV4dCxcclxuICAgICAgICAgICAgICAgIHg6IDAsXHJcbiAgICAgICAgICAgICAgICB5OiAwLFxyXG4gICAgICAgICAgICAgICAgd2lkdGg6IHRoaXMud2lkdGgsXHJcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IHRoaXMuaGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgbW9kZTogdGhpcy5tb2RlLFxyXG4gICAgICAgICAgICAgICAgbGluZVNwYWNlOiB0aGlzLmxpbmVTcGFjZSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfdXBkYXRlRm9udDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZm9udFN0eWxlID0gXCJ7Zm9udFdlaWdodH0ge2ZvbnRTaXplfXB4IHtmb250RmFtaWx5fVwiLmZvcm1hdCh0aGlzKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMudGV4dCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyVGV4dCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIHRleHRcclxuICAgICAqIOaWh+Wtl1xyXG4gICAgICovXHJcbiAgICB0bS51aS5MYWJlbEFyZWEucHJvdG90eXBlLmFjY2Vzc29yKFwidGV4dFwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzLl90ZXh0OyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpe1xyXG4gICAgICAgICAgICB0aGlzLnNldFRleHQodik7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGZvbnRTaXplXHJcbiAgICAgKiDjg5Xjgqnjg7Pjg4jjgrXjgqTjgrpcclxuICAgICAqL1xyXG4gICAgdG0udWkuTGFiZWxBcmVhLnByb3RvdHlwZS5hY2Nlc3NvcihcImZvbnRTaXplXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXMuX2ZvbnRTaXplOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpeyB0aGlzLl9mb250U2l6ZSA9IHY7IHRoaXMuX3VwZGF0ZUZvbnQoKTsgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGZvbnRGYW1pbHlcclxuICAgICAqIOODleOCqeODs+ODiFxyXG4gICAgICovXHJcbiAgICB0bS51aS5MYWJlbEFyZWEucHJvdG90eXBlLmFjY2Vzc29yKFwiZm9udEZhbWlseVwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzLl9mb250RmFtaWx5OyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpeyB0aGlzLl9mb250RmFtaWx5ID0gdjsgdGhpcy5fdXBkYXRlRm9udCgpOyB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAcHJvcGVydHkgICAgZm9udFdlaWdodFxyXG4gICAgICovXHJcbiAgICB0bS51aS5MYWJlbEFyZWEucHJvdG90eXBlLmFjY2Vzc29yKFwiZm9udFdlaWdodFwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzLl9mb250V2VpZ2h0OyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgdGhpcy5fZm9udFdlaWdodCA9IHY7IHRoaXMuX3VwZGF0ZUZvbnQoKTtcclxuICAgICAgICB9LFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGZpbGxTdHlsZVxyXG4gICAgICovXHJcbiAgICB0bS51aS5MYWJlbEFyZWEucHJvdG90eXBlLmFjY2Vzc29yKFwiZmlsbFN0eWxlXCIsIHtcclxuICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXMuX2ZpbGxTdHlsZTsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2ZpbGxTdHlsZSA9IHY7IHRoaXMuX3VwZGF0ZUZvbnQoKTtcclxuICAgICAgICB9LFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGJnQ29sb3JcclxuICAgICAqL1xyXG4gICAgdG0udWkuTGFiZWxBcmVhLnByb3RvdHlwZS5hY2Nlc3NvcihcImJnQ29sb3JcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpcy5fYmdDb2xvcjsgfSxcclxuICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2JnQ29sb3IgPSB2OyB0aGlzLl91cGRhdGVGb250KCk7XHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIHdpZHRoXHJcbiAgICAgKiBkdW1teVxyXG4gICAgICovXHJcbiAgICB0bS51aS5MYWJlbEFyZWEucHJvdG90eXBlLmFjY2Vzc29yKFwid2lkdGhcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpcy5fd2lkdGg7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odil7XHJcbiAgICAgICAgICAgIHRoaXMuX3dpZHRoID0gdjtcclxuICAgICAgICAgICAgaWYgKHRoaXMudGV4dCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyVGV4dCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGhlaWdodFxyXG4gICAgICogZHVtbXlcclxuICAgICAqL1xyXG4gICAgdG0udWkuTGFiZWxBcmVhLnByb3RvdHlwZS5hY2Nlc3NvcihcImhlaWdodFwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzLl9oZWlnaHQ7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odil7XHJcbiAgICAgICAgICAgIHRoaXMuX2hlaWdodCA9IHY7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnRleHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlclRleHQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIFxyXG59KSgpO1xyXG5cclxuXHJcbjsoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgdG0uZ2FtZSA9IHRtLmdhbWUgfHwge307XHJcblxyXG5cclxuICAgIHRtLmdhbWUuc2V0dXAgPSBmdW5jdGlvbihwYXJhbSkge1xyXG4gICAgICAgIHBhcmFtLiRzYWZlKHtcclxuICAgICAgICAgICAgcXVlcnk6IFwiI3dvcmxkXCIsXHJcbiAgICAgICAgICAgIHRpdGxlOiBcIlRpdGxlXCIsXHJcbiAgICAgICAgICAgIGJhY2tncm91bmQ6IFwicmdiYSgyNTAsIDI1MCwgMjUwLCAxLjApXCIsXHJcbiAgICAgICAgICAgIHdpZHRoOiA2NDAsXHJcbiAgICAgICAgICAgIGhlaWdodDogOTYwLFxyXG4gICAgICAgICAgICBzdGFydExhYmVsOiAndGl0bGUnLFxyXG4gICAgICAgICAgICBmaXR0aW5nOiB0cnVlLFxyXG4gICAgICAgICAgICBmcHM6IDMwLFxyXG4gICAgICAgICAgICBhc3NldHM6IHdpbmRvdy5BU1NFVFMgfHwgbnVsbCxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdG0uZ2xvYmFsaXplKCk7XHJcblxyXG4gICAgICAgIHRoaXMuZXhwYW5kKHBhcmFtKTtcclxuXHJcbiAgICAgICAgdmFyIHNjZW5lcyA9IFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcIlNwbGFzaFNjZW5lXCIsXHJcbiAgICAgICAgICAgICAgICBhcmd1bWVudHM6IHtcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogcGFyYW0ud2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBwYXJhbS5oZWlnaHQsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgbGFiZWw6IFwic3BsYXNoXCIsXHJcbiAgICAgICAgICAgICAgICBuZXh0TGFiZWw6IFwidGl0bGVcIixcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBcIlRpdGxlU2NlbmVcIixcclxuICAgICAgICAgICAgICAgIGFyZ3VtZW50czoge1xyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBwYXJhbS50aXRsZSxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBsYWJlbDogXCJ0aXRsZVwiLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwiR2FtZVNjZW5lXCIsXHJcbiAgICAgICAgICAgICAgICBsYWJlbDogXCJnYW1lXCIsXHJcbiAgICAgICAgICAgICAgICBuZXh0TGFiZWw6IFwicmVzdWx0XCIsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJSZXN1bHRTY2VuZVwiLFxyXG4gICAgICAgICAgICAgICAgYXJndW1lbnRzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogcGFyYW0udGl0bGUsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgbGFiZWw6IFwicmVzdWx0XCIsXHJcbiAgICAgICAgICAgICAgICBuZXh0TGFiZWw6IFwidGl0bGVcIixcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJQYXVzZVNjZW5lXCIsXHJcbiAgICAgICAgICAgICAgICBsYWJlbDogXCJwYXVzZVwiLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgIF07XHJcblxyXG4gICAgICAgIHRtLm1haW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBhcHAgPSB0bS5hcHAuQ2FudmFzQXBwKHBhcmFtLnF1ZXJ5KTsgICAgLy8g55Sf5oiQXHJcbiAgICAgICAgICAgIGFwcC5yZXNpemUoU0NSRUVOX1dJRFRILCBTQ1JFRU5fSEVJR0hUKTsgICAgLy8g44K144Kk44K6KOino+WDj+W6pinoqK3lrppcclxuICAgICAgICAgICAgaWYgKHBhcmFtLmZpdHRpbmcpIHsgYXBwLmZpdFdpbmRvdygpOyB9ICAgICAvLyDoh6rli5Xjg5XjgqPjg4Pjg4bjgqPjg7PjgrDmnInlirlcclxuICAgICAgICAgICAgYXBwLmJhY2tncm91bmQgPSBwYXJhbS5iYWNrZ3JvdW5kOyAgICAgICAgICAvLyDog4zmma/oibJcclxuICAgICAgICAgICAgYXBwLmZwcyA9IHBhcmFtLmZwczsgICAgICAgICAgICAgICAgICAgICAgICAvLyBmcHNcclxuXHJcbiAgICAgICAgICAgIGlmIChwYXJhbS5hc3NldHMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBsb2FkaW5nID0gdG0uZ2FtZS5Mb2FkaW5nU2NlbmUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGFzc2V0czogcGFyYW0uYXNzZXRzLFxyXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiBTQ1JFRU5fV0lEVEgsXHJcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBTQ1JFRU5fSEVJR0hULFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBsb2FkaW5nLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFwcC5yZXBsYWNlU2NlbmUodG0uZ2FtZS5NYW5hZ2VyU2NlbmUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydExhYmVsOiBwYXJhbS5zdGFydExhYmVsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2VuZXM6IHNjZW5lcyxcclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgYXBwLnJlcGxhY2VTY2VuZShsb2FkaW5nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGFwcC5yZXBsYWNlU2NlbmUodG0uZ2FtZS5NYW5hZ2VyU2NlbmUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0TGFiZWw6IHBhcmFtLnN0YXJ0TGFiZWwsXHJcbiAgICAgICAgICAgICAgICAgICAgc2NlbmVzOiBzY2VuZXMsXHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGFwcC5ydW4oKTtcclxuXHJcbiAgICAgICAgICAgIHRtLmdhbWUuYXBwID0gYXBwO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICB0bS5nYW1lLmV4cGFuZCA9IGZ1bmN0aW9uKHBhcmFtKSB7XHJcbiAgICAgICAgdG0uZ2xvYmFsLiRleHRlbmQoe1xyXG4gICAgICAgICAgICBTQ1JFRU5fV0lEVEg6IHBhcmFtLndpZHRoLFxyXG4gICAgICAgICAgICBTQ1JFRU5fSEVJR0hUOiBwYXJhbS5oZWlnaHQsXHJcbiAgICAgICAgICAgIFNDUkVFTl9DRU5URVJfWDogcGFyYW0ud2lkdGgvMixcclxuICAgICAgICAgICAgU0NSRUVOX0NFTlRFUl9ZOiBwYXJhbS5oZWlnaHQvMixcclxuICAgICAgICAgICAgU0NSRUVOX0dSSURfWDogR3JpZFN5c3RlbShwYXJhbS53aWR0aCwgMTYpLFxyXG4gICAgICAgICAgICBTQ1JFRU5fR1JJRF9ZOiBHcmlkU3lzdGVtKHBhcmFtLmhlaWdodCwgMTYpLFxyXG4gICAgICAgICAgICBRVUVSWTogdG0udXRpbC5RdWVyeVN0cmluZy5wYXJzZShsb2NhdGlvbi5zZWFyY2guc3Vic3RyKDEpKSxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9O1xyXG5cclxufSkoKTtcclxuXHJcbi8qXHJcbiAqIFRpdGxlU2NlbmVcclxuICovXHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIHRtLmRlZmluZShcInRtLmdhbWUuVGl0bGVTY2VuZVwiLCB7XHJcbiAgICAgICAgc3VwZXJDbGFzczogXCJ0bS5hcHAuU2NlbmVcIixcclxuXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24ocGFyYW0pIHtcclxuICAgICAgICAgICAgdGhpcy5zdXBlckluaXQoKTtcclxuXHJcbiAgICAgICAgICAgIHBhcmFtID0ge30uJGV4dGVuZCh0bS5nYW1lLlRpdGxlU2NlbmVbXCJkZWZhdWx0XCJdLCBwYXJhbSk7XHJcbiAgICAgICAgICAgIHRoaXMucGFyYW0gPSBwYXJhbTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZnJvbUpTT04oe1xyXG4gICAgICAgICAgICAgICAgY2hpbGRyZW46IHtcclxuICAgICAgICAgICAgICAgICAgICBiZzoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInRtLmRpc3BsYXkuUmVjdGFuZ2xlU2hhcGVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5pdDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHBhcmFtLndpZHRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBwYXJhbS5oZWlnaHQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxsU3R5bGU6IHBhcmFtLmJnQ29sb3IsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJva2VTdHlsZTogXCJ0cmFuc3BhcmVudFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5YOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5ZOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAocGFyYW0uYmdJbWFnZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mcm9tSlNPTih7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmdJbWFnZToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJ0bS5kaXNwbGF5LlNwcml0ZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5pdDogW3BhcmFtLmJnSW1hZ2VdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luWDogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpblk6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5mcm9tSlNPTih7XHJcbiAgICAgICAgICAgICAgICBjaGlsZHJlbjoge1xyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlTGFiZWw6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJMYWJlbFwiLCBuYW1lOiBcInRpdGxlTGFiZWxcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogcGFyYW0udGl0bGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRoaXMuX3RvR3JpZFgoNiksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHRoaXMuX3RvR3JpZFkoMyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxTdHlsZTogcGFyYW0uZm9udENvbG9yLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogcGFyYW0uZm9udFNpemUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRGYW1pbHk6IFwiJ0hlbHZldGljYS1MaWdodCcgJ01laXJ5bycgc2Fucy1zZXJpZlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGlnbjogXCJjZW50ZXJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZWxpbmU6IFwibWlkZGxlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlTGFiZWw6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJMYWJlbFwiLCBuYW1lOiBcIm5leHRMYWJlbFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBwYXJhbS5tZXNzYWdlIHx8IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRoaXMuX3RvR3JpZFgoNiksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHRoaXMuX3RvR3JpZFkoNiksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxTdHlsZTogcGFyYW0uZm9udENvbG9yLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogcGFyYW0uZm9udFNpemUqMC4zNixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9udEZhbWlseTogXCInSGVsdmV0aWNhLUxpZ2h0JyAnTWVpcnlvJyBzYW5zLXNlcmlmXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsaWduOiBcImNlbnRlclwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlbGluZTogXCJtaWRkbGVcIixcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHRvdWNoTGFiZWw6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJMYWJlbFwiLCBuYW1lOiBcIm5leHRMYWJlbFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcIlRPVUNIIFNUQVJUXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRoaXMuX3RvR3JpZFgoNiksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHRoaXMuX3RvR3JpZFkoOSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxTdHlsZTogcGFyYW0uZm9udENvbG9yLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogcGFyYW0uZm9udFNpemUqMC40LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250RmFtaWx5OiBcIidIZWx2ZXRpY2EtTGlnaHQnICdNZWlyeW8nIHNhbnMtc2VyaWZcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxpZ246IFwiY2VudGVyXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VsaW5lOiBcIm1pZGRsZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnRvdWNoTGFiZWwudHdlZW5lclxyXG4gICAgICAgICAgICAgICAgLmZhZGVPdXQoNTAwKVxyXG4gICAgICAgICAgICAgICAgLmZhZGVJbigxMDAwKVxyXG4gICAgICAgICAgICAgICAgLnNldExvb3AodHJ1ZSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmF1dG9wb3AgPSBwYXJhbS5hdXRvcG9wO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIF90b0dyaWRYOiBmdW5jdGlvbihpbmRleCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJhbS53aWR0aC8xMippbmRleDtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfdG9HcmlkWTogZnVuY3Rpb24oaW5kZXgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyYW0uaGVpZ2h0LzEyKmluZGV4O1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIG9ucG9pbnRpbmdzdGFydDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmxhcmUoXCJmaW5pc2hcIik7XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5hdXRvcG9wKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC5wb3BTY2VuZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIHRtLmdhbWUuVGl0bGVTY2VuZVtcImRlZmF1bHRcIl0gPSB7XHJcbiAgICAgICAgdGl0bGU6IFwiVGltZSBpcyBtb25leVwiLFxyXG4gICAgICAgIG1lc3NhZ2U6IFwiXCIsXHJcbiAgICAgICAgZm9udFNpemU6IDcyLFxyXG4gICAgICAgIGZvbnRDb2xvcjogXCIjNDQ0XCIsXHJcbiAgICAgICAgd2lkdGg6IDY0MCxcclxuICAgICAgICBoZWlnaHQ6IDk2MCxcclxuICAgICAgICBiZ0NvbG9yOiBcInJnYigyNDAsMjQwLDI0MClcIixcclxuICAgICAgICBiZ0ltYWdlOiBudWxsLFxyXG4gICAgICAgIGF1dG9wb3A6IHRydWUsXHJcbiAgICB9O1xyXG5cclxufSkoKTtcclxuXHJcblxyXG4vKlxyXG4gKiBSZXN1bHRTY2VuZVxyXG4gKi9cclxuXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgdG0uZGVmaW5lKFwidG0uZ2FtZS5SZXN1bHRTY2VuZVwiLCB7XHJcbiAgICAgICAgc3VwZXJDbGFzczogXCJ0bS5hcHAuU2NlbmVcIixcclxuXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24ocGFyYW0pIHtcclxuICAgICAgICAgICAgdGhpcy5zdXBlckluaXQoKTtcclxuXHJcbiAgICAgICAgICAgIHBhcmFtID0ge30uJGV4dGVuZCh0bS5nYW1lLlJlc3VsdFNjZW5lW1wiZGVmYXVsdFwiXSwgcGFyYW0pO1xyXG4gICAgICAgICAgICB0aGlzLnBhcmFtID0gcGFyYW07XHJcblxyXG4gICAgICAgICAgICB2YXIgdXNlckRhdGEgPSB0aGlzLl9nZXRVc2VyRGF0YSgpO1xyXG4gICAgICAgICAgICB2YXIgYmVzdFNjb3JlID0gKHVzZXJEYXRhLmJlc3RTY29yZSkgPyB1c2VyRGF0YS5iZXN0U2NvcmUgOiAwO1xyXG4gICAgICAgICAgICB2YXIgaGlnaFNjb3JlRmxhZyA9IChwYXJhbS5zY29yZSA+IGJlc3RTY29yZSk7XHJcblxyXG4gICAgICAgICAgICBpZiAocGFyYW0ucmVjb3JkKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaGlnaFNjb3JlRmxhZykge1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJEYXRhLmJlc3RTY29yZSA9IHBhcmFtLnNjb3JlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlY29yZCh1c2VyRGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuZnJvbUpTT04oe1xyXG4gICAgICAgICAgICAgICAgY2hpbGRyZW46IHtcclxuICAgICAgICAgICAgICAgICAgICBiZzoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInRtLmRpc3BsYXkuUmVjdGFuZ2xlU2hhcGVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5pdDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHBhcmFtLndpZHRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBwYXJhbS5oZWlnaHQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxsU3R5bGU6IHBhcmFtLmJnQ29sb3IsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJva2VTdHlsZTogXCJ0cmFuc3BhcmVudFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5YOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5ZOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAocGFyYW0uYmdJbWFnZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mcm9tSlNPTih7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmdJbWFnZToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJ0bS5kaXNwbGF5LlNwcml0ZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5pdDogW3BhcmFtLmJnSW1hZ2VdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luWDogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpblk6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIGJhc2VMYWJlbFBhcmFtID0ge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogXCJMYWJlbFwiLFxyXG4gICAgICAgICAgICAgICAgZmlsbFN0eWxlOiBwYXJhbS5mb250Q29sb3IsXHJcbiAgICAgICAgICAgICAgICBmb250RmFtaWx5OiBcIidIZWx2ZXRpY2EtTGlnaHQnICdNZWlyeW8nIHNhbnMtc2VyaWZcIixcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZnJvbUpTT04oe1xyXG4gICAgICAgICAgICAgICAgY2hpbGRyZW46IHtcclxuICAgICAgICAgICAgICAgICAgICBzY29yZVRleHQ6IGJhc2VMYWJlbFBhcmFtLiRleHRlbmQoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcInNjb3JlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRoaXMuX3RvR3JpZFgoNCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHRoaXMuX3RvR3JpZFkoMyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiBwYXJhbS5mb250U2l6ZSowLjUsXHJcbiAgICAgICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcmVMYWJlbDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIkxhYmVsXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHBhcmFtLnNjb3JlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB4OiB0aGlzLl90b0dyaWRYKDQpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB5OiB0aGlzLl90b0dyaWRZKDQpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxsU3R5bGU6IHBhcmFtLmZvbnRDb2xvcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9udFNpemU6IHBhcmFtLmZvbnRTaXplLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250RmFtaWx5OiBcIidIZWx2ZXRpY2EtTGlnaHQnICdNZWlyeW8nIHNhbnMtc2VyaWZcIixcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGJlc3RUZXh0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiTGFiZWxcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogXCJiZXN0XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRoaXMuX3RvR3JpZFgoOCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHRoaXMuX3RvR3JpZFkoMyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxTdHlsZTogcGFyYW0uZm9udENvbG9yLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogcGFyYW0uZm9udFNpemUqMC41LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250RmFtaWx5OiBcIidIZWx2ZXRpY2EtTGlnaHQnICdNZWlyeW8nIHNhbnMtc2VyaWZcIixcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGJlc3RMYWJlbDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIkxhYmVsXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IGJlc3RTY29yZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeDogdGhpcy5fdG9HcmlkWCg4KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTogdGhpcy5fdG9HcmlkWSg0KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsbFN0eWxlOiBwYXJhbS5mb250Q29sb3IsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiBwYXJhbS5mb250U2l6ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9udEZhbWlseTogXCInSGVsdmV0aWNhLUxpZ2h0JyAnTWVpcnlvJyBzYW5zLXNlcmlmXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgbmV3UmVjb3JkVGV4dDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIkxhYmVsXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IFwibmV3IHJlY29yZCFcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgeDogdGhpcy5fdG9HcmlkWCg2KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTogdGhpcy5fdG9HcmlkWSg2KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsbFN0eWxlOiBwYXJhbS5mb250Q29sb3IsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiBwYXJhbS5mb250U2l6ZSowLjUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRGYW1pbHk6IFwiJ0hlbHZldGljYS1MaWdodCcgJ01laXJ5bycgc2Fucy1zZXJpZlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlVGV4dDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIkxhYmVsXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHBhcmFtLm1lc3NhZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRoaXMuX3RvR3JpZFgoNiksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHRoaXMuX3RvR3JpZFkoNyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxTdHlsZTogcGFyYW0uZm9udENvbG9yLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogcGFyYW0uZm9udFNpemUqMC41LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250RmFtaWx5OiBcIidIZWx2ZXRpY2EtTGlnaHQnICdNZWlyeW8nIHNhbnMtc2VyaWZcIixcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgICAgICAgICBzaGFyZUJ1dHRvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIkZsYXRCdXR0b25cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5pdDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogXCJTaGFyZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDIwMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxTdHlsZTogXCJoc2woMjQwLCAxMDAlLCA2NCUpXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHRoaXMuX3RvR3JpZFgoNCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHRoaXMuX3RvR3JpZFkoOSksXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBiYWNrQnV0dG9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiRmxhdEJ1dHRvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbml0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcIkJhY2tcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiAyMDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxsU3R5bGU6IFwiaHNsKDI0MCwgODAlLCAwJSlcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeDogdGhpcy5fdG9HcmlkWCg4KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeTogdGhpcy5fdG9HcmlkWSg5KSxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gc2V0dXAgdHdlZXRcclxuICAgICAgICAgICAgdmFyIHRleHQgPSBcIlNDT1JFOiB7c2NvcmV9LCB7bWVzc2FnZX1cIi5mb3JtYXQocGFyYW0pO1xyXG4gICAgICAgICAgICB2YXIgdHdpdHRlclVSTCA9IHRtLnNvY2lhbC5Ud2l0dGVyLmNyZWF0ZVVSTCh7XHJcbiAgICAgICAgICAgICAgICB0eXBlICAgIDogXCJ0d2VldFwiLFxyXG4gICAgICAgICAgICAgICAgdGV4dCAgICA6IHRleHQsXHJcbiAgICAgICAgICAgICAgICBoYXNodGFnczogcGFyYW0uaGFzaHRhZ3MsXHJcbiAgICAgICAgICAgICAgICB1cmwgICAgIDogcGFyYW0udXJsLCAvLyBvciB3aW5kb3cuZG9jdW1lbnQubG9jYXRpb24uaHJlZlxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5zaGFyZUJ1dHRvbi5vbmNsaWNrID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cub3Blbih0d2l0dGVyVVJMLCAnc2hhcmUgd2luZG93JywgJ3dpZHRoPTQwMCwgaGVpZ2h0PTMwMCcpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgLy8gc2V0dXAgYmFja1xyXG4gICAgICAgICAgICB0aGlzLmJhY2tCdXR0b24ub25wb2ludGluZ3N0YXJ0ID0gdGhpcy5fYmFjay5iaW5kKHRoaXMpO1xyXG4gICAgICAgICAgICB0aGlzLmF1dG9wb3AgPSBwYXJhbS5hdXRvcG9wO1xyXG5cclxuICAgICAgICAgICAgLy8gc2V0dXAgcmVjb3JkXHJcbiAgICAgICAgICAgIGlmIChoaWdoU2NvcmVGbGFnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5ld1JlY29yZFRleHQuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5uZXdSZWNvcmRUZXh0LnR3ZWVuZXJcclxuICAgICAgICAgICAgICAgICAgICAuc2V0KHthbHBoYTowLjB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5mYWRlSW4oMjAwMClcclxuICAgICAgICAgICAgICAgICAgICAuc2V0TG9vcCh0cnVlKVxyXG4gICAgICAgICAgICAgICAgICAgIDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIF9nZXRVc2VyRGF0YTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBrZXkgPSBsb2NhdGlvbi5wYXRobmFtZS50b0NSQzMyKCk7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KTtcclxuICAgICAgICAgICAgcmV0dXJuIChkYXRhKSA/IEpTT04ucGFyc2UoZGF0YSkgOiB7fTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfcmVjb3JkOiBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBrZXkgPSBsb2NhdGlvbi5wYXRobmFtZS50b0NSQzMyKCk7XHJcbiAgICAgICAgICAgIHZhciBkYXRhU3RyaW5nID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XHJcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgZGF0YVN0cmluZyk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIF90b0dyaWRYOiBmdW5jdGlvbihpbmRleCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJhbS53aWR0aC8xMippbmRleDtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfdG9HcmlkWTogZnVuY3Rpb24oaW5kZXgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyYW0uaGVpZ2h0LzEyKmluZGV4O1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIF9iYWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5mbGFyZShcImZpbmlzaFwiKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmF1dG9wb3ApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnBvcFNjZW5lKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgdG0uZ2FtZS5SZXN1bHRTY2VuZVtcImRlZmF1bHRcIl0gPSB7XHJcbiAgICAgICAgc2NvcmU6IDAsXHJcbiAgICAgICAgbWVzc2FnZTogXCJ0aGlzIGlzIHRtbGliLmpzIHByb2plY3QuXCIsXHJcbiAgICAgICAgaGFzaHRhZ3M6IFwidG1saWJqcyxnYW1lXCIsXHJcbiAgICAgICAgcmVsYXRlZDogXCJ0bWxpYi5qcyB0bWxpZmUgamF2YXNjcmlwdFwiLFxyXG4gICAgICAgIHVybDogXCJodHRwOi8vcGhpLWpwLmdpdGh1Yi5pby90bWxpYi5qcy9cIixcclxuXHJcbiAgICAgICAgd2lkdGg6IDY0MCxcclxuICAgICAgICBoZWlnaHQ6IDk2MCxcclxuICAgICAgICBmb250Q29sb3I6IFwiIzQ0NFwiLFxyXG4gICAgICAgIGZvbnRTaXplOiA5MCxcclxuICAgICAgICBiZ0NvbG9yOiBcInJnYmEoMjU1LDI1NSwyNTUsIDAuOSlcIixcclxuICAgICAgICBiZ0ltYWdlOiBudWxsLFxyXG4gICAgICAgIHJlY29yZDogdHJ1ZSxcclxuICAgICAgICBhdXRvcG9wOiB0cnVlLFxyXG4gICAgfTtcclxuXHJcbn0pKCk7XHJcblxyXG5cclxuLypcclxuICogbG9hZGluZ3NjZW5lLmpzXHJcbiAqL1xyXG5cclxuXHJcbjsoZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIHZhciBERUZBVUxUX1BBUkFNID0ge1xyXG4gICAgICAgIHdpZHRoOiA0NjUsXHJcbiAgICAgICAgaGVpZ2h0OiA0NjUsXHJcbiAgICAgICAgYmdDb2xvcjogXCJ0cmFuc3BhcmVudFwiLFxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdG0uZGVmaW5lKFwidG0uZ2FtZS5Mb2FkaW5nU2NlbmVcIiwge1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IFwidG0uYXBwLlNjZW5lXCIsXHJcbiAgICAgICAgXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24ocGFyYW0pIHtcclxuICAgICAgICAgICAgdGhpcy5zdXBlckluaXQoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMucGFyYW0gPSBwYXJhbSA9IHt9LiRleHRlbmQoREVGQVVMVF9QQVJBTSwgcGFyYW0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5mcm9tSlNPTih7XHJcbiAgICAgICAgICAgICAgICBjaGlsZHJlbjoge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YWdlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwidG0uZGlzcGxheS5DYW52YXNFbGVtZW50XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnN0YWdlLmZyb21KU09OKHtcclxuICAgICAgICAgICAgICAgIGNoaWxkcmVuOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYmc6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJ0bS5kaXNwbGF5LlNoYXBlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluaXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBwYXJhbS53aWR0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogcGFyYW0uaGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5YOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5ZOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgcGl5b0xheWVyOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwidG0uZGlzcGxheS5DYW52YXNFbGVtZW50XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBsYWJlbDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInRtLmRpc3BsYXkuTGFiZWxcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogXCJMT0FESU5HXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHBhcmFtLndpZHRoLzIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHBhcmFtLmhlaWdodC8yLTIwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGlnbjogXCJjZW50ZXJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzZWxpbmU6IFwibWlkZGxlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiA0NixcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2hhZG93Qmx1cjogNCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2hhZG93Q29sb3I6IFwiaHNsKDE5MCwgMTAwJSwgNTAlKVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcGl5bzoge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICB0eXBlOiBcInRtLmRpc3BsYXkuU2hhcGVcIixcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgaW5pdDogWzg0LCA4NF0sXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gfSxcclxuICAgICAgICAgICAgICAgICAgICBiYXI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJ0bS51aS5HYXVnZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbml0OiBbe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHBhcmFtLndpZHRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAxMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBcImhzbCgyMDAsIDEwMCUsIDgwJSlcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJnQ29sb3I6IFwidHJhbnNwYXJlbnRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlckNvbG9yOiBcInRyYW5zcGFyZW50XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3JkZXJXaWR0aDogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfV0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBiZ1xyXG4gICAgICAgICAgICB2YXIgYmcgPSB0aGlzLnN0YWdlLmJnO1xyXG4gICAgICAgICAgICBiZy5jYW52YXMuY2xlYXJDb2xvcihwYXJhbS5iZ0NvbG9yKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGxhYmVsXHJcbiAgICAgICAgICAgIHZhciBsYWJlbCA9IHRoaXMuc3RhZ2UubGFiZWw7XHJcbiAgICAgICAgICAgIGxhYmVsLnR3ZWVuZXJcclxuICAgICAgICAgICAgICAgIC50byh7YWxwaGE6MX0sIDEwMDApXHJcbiAgICAgICAgICAgICAgICAudG8oe2FscGhhOjAuNX0sIDEwMDApXHJcbiAgICAgICAgICAgICAgICAuc2V0TG9vcCh0cnVlKVxyXG5cclxuICAgICAgICAgICAgLy8gYmFyXHJcbiAgICAgICAgICAgIHZhciBiYXIgPSB0aGlzLnN0YWdlLmJhcjtcclxuICAgICAgICAgICAgYmFyLmFuaW1hdGlvbkZsYWcgPSBmYWxzZTtcclxuICAgICAgICAgICAgYmFyLnZhbHVlID0gMDtcclxuICAgICAgICAgICAgYmFyLmFuaW1hdGlvbkZsYWcgPSB0cnVlO1xyXG4gICAgICAgICAgICBiYXIuYW5pbWF0aW9uVGltZSA9IDEwMDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIOOBsuOCiOOBk+OBleOCk1xyXG4gICAgICAgICAgICB0aGlzLl9jcmVhdGVIaXlva28ocGFyYW0pLmFkZENoaWxkVG8odGhpcy5zdGFnZS5waXlvTGF5ZXIpO1xyXG5cclxuICAgICAgICAgICAgLy8gbG9hZFxyXG4gICAgICAgICAgICB2YXIgc3RhZ2UgPSB0aGlzLnN0YWdlO1xyXG4gICAgICAgICAgICBzdGFnZS5hbHBoYSA9IDAuMDtcclxuICAgICAgICAgICAgc3RhZ2UudHdlZW5lci5jbGVhcigpLmZhZGVJbigxMDApLmNhbGwoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocGFyYW0uYXNzZXRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvYWRlciA9IHRtLmFzc2V0LkxvYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxvYWRlci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhZ2UudHdlZW5lci5jbGVhcigpLndhaXQoMjAwKS5mYWRlT3V0KDIwMCkuY2FsbChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbS5uZXh0U2NlbmUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcC5yZXBsYWNlU2NlbmUocGFyYW0ubmV4dFNjZW5lKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSB0bS5ldmVudC5FdmVudChcImxvYWRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcmUoZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtLmF1dG9wb3AgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLnBvcFNjZW5lKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGxvYWRlci5vbnByb2dyZXNzID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB1cGRhdGUgYmFyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhci52YWx1ZSA9IGUucHJvZ3Jlc3MqMTAwO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZGlzcGF0Y2ggZXZlbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV2ZW50ID0gdG0uZXZlbnQuRXZlbnQoXCJwcm9ncmVzc1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJvZ3Jlc3MgPSBlLnByb2dyZXNzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcmUoZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBsb2FkZXIubG9hZChwYXJhbS5hc3NldHMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIG9ucG9pbnRpbmdzdGFydDogZnVuY3Rpb24oYXBwKSB7XHJcbiAgICAgICAgICAgIC8vIOOBsuOCiOOBk+OBleOCk+eUn+aIkFxyXG4gICAgICAgICAgICB2YXIgcCA9IGFwcC5wb2ludGluZztcclxuICAgICAgICAgICAgdmFyIHBpeW8gPSB0aGlzLl9jcmVhdGVIaXlva28odGhpcy5wYXJhbSkuYWRkQ2hpbGRUbyh0aGlzLnN0YWdlLnBpeW9MYXllcik7XHJcbiAgICAgICAgICAgIHBpeW8ueCA9IHAueDtcclxuICAgICAgICAgICAgcGl5by55ID0gcC55O1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIF9jcmVhdGVIaXlva286IGZ1bmN0aW9uKHBhcmFtKSB7XHJcbiAgICAgICAgICAgIC8vIOOBsuOCiOOBk+OBleOCk1xyXG4gICAgICAgICAgICB2YXIgcGl5byA9IHRtLmRpc3BsYXkuU2hhcGUoe1xyXG4gICAgICAgICAgICAgICAgd2lkdGg6IDg0LFxyXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiA4NCxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHBpeW8ueCA9IHRtLnV0aWwuUmFuZG9tLnJhbmRpbnQoMCwgcGFyYW0ud2lkdGgpO1xyXG4gICAgICAgICAgICBwaXlvLnkgPSB0bS51dGlsLlJhbmRvbS5yYW5kaW50KDAsIHBhcmFtLmhlaWdodCk7XHJcbiAgICAgICAgICAgIHBpeW8uY2FudmFzLnNldENvbG9yU3R5bGUoXCJ3aGl0ZVwiLCBcInllbGxvd1wiKS5maWxsQ2lyY2xlKDQyLCA0MiwgMzIpO1xyXG4gICAgICAgICAgICBwaXlvLmNhbnZhcy5zZXRDb2xvclN0eWxlKFwid2hpdGVcIiwgXCJibGFja1wiKS5maWxsQ2lyY2xlKDI3LCAyNywgMik7XHJcbiAgICAgICAgICAgIHBpeW8uY2FudmFzLnNldENvbG9yU3R5bGUoXCJ3aGl0ZVwiLCBcImJyb3duXCIpLmZpbGxSZWN0KDQwLCA3MCwgNCwgMTUpLmZpbGxUcmlhbmdsZSgwLCA0MCwgMTEsIDM1LCAxMSwgNDUpO1xyXG4gICAgICAgICAgICBwaXlvLmRpciA9IHRtLmdlb20uVmVjdG9yMi5yYW5kb20oMCwgMzYwLCA0KTtcclxuICAgICAgICAgICAgdmFyIHJlY3QgPSB0bS5nZW9tLlJlY3QoMCwgMCwgcGFyYW0ud2lkdGgsIHBhcmFtLmhlaWdodCk7XHJcbiAgICAgICAgICAgIHJlY3QucGFkZGluZyg0Mik7XHJcbiAgICAgICAgICAgIHBpeW8udXBkYXRlID0gZnVuY3Rpb24oYXBwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uLmFkZCh0aGlzLmRpcik7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMueCA8IHJlY3QubGVmdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMueCA9IHJlY3QubGVmdDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpci54Kj0tMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMueCA+IHJlY3QucmlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnggPSByZWN0LnJpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlyLngqPS0xO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMueSA8IHJlY3QudG9wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy55ID0gcmVjdC50b3A7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXIueSo9LTE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLnkgPiByZWN0LmJvdHRvbSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMueSA9IHJlY3QuYm90dG9tO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlyLnkqPS0xO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRpci54PDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJvdGF0aW9uIC09IDc7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2FsZVggPSAxO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yb3RhdGlvbiArPSA3O1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2NhbGVYID0gLTE7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gLy8g5ZCR44GN5pu05pawXHJcbiAgICAgICAgICAgICAgICAvLyBpZiAoYXBwLnBvaW50aW5nLmdldFBvaW50aW5nU3RhcnQoKSkge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIHZhciBwID0gYXBwLnBvaW50aW5nLnBvc2l0aW9uO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIHZhciB2ID0gdG0uZ2VvbS5WZWN0b3IyLnN1YihwLCB0aGlzLnBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgIC8vICAgICB0aGlzLmRpciA9IHYubm9ybWFsaXplKCkubXVsKDQpO1xyXG4gICAgICAgICAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBwaXlvO1xyXG4gICAgICAgIH0sXHJcbiAgICB9KTtcclxuICAgIFxyXG59KSgpO1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4vKlxyXG4gKiBzcGxhc2hcclxuICovXHJcblxyXG47KGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIFNQTEFTSF9JTUFHRV9QQVRIID0gXCJodHRwczovL2ZpbGVzLmdpdHRlci5pbS9waGktanAvdG1saWIuanMvdDVGNy9zcGxhc2gucG5nXCI7XHJcblxyXG4gICAgdG0uZGVmaW5lKFwiU3BsYXNoU2NlbmVcIiwge1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IFwidG0uYXBwLlNjZW5lXCIsXHJcblxyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKHBhcmFtKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3VwZXJJbml0KCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnBhcmFtID0gcGFyYW07XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNwbGFzaEltYWdlID0gdG0uYXNzZXQuVGV4dHVyZShwYXJhbS5wYXRoIHx8IFNQTEFTSF9JTUFHRV9QQVRIKTtcclxuICAgICAgICAgICAgdGhpcy5zcGxhc2hJbWFnZS5vbmxvYWQgPSB0aGlzLl9pbml0LmJpbmQodGhpcyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX2luaXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgd2lkdGggPSB0aGlzLnBhcmFtLndpZHRoO1xyXG4gICAgICAgICAgICB2YXIgaGVpZ2h0ID0gdGhpcy5wYXJhbS5oZWlnaHQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0bS5kaXNwbGF5LlNoYXBlKHtcclxuICAgICAgICAgICAgICAgIHdpZHRoOiB3aWR0aCxcclxuICAgICAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgYmdDb2xvcjogXCJ3aGl0ZVwiXHJcbiAgICAgICAgICAgIH0pLnNldE9yaWdpbigwLCAwKS5hZGRDaGlsZFRvKHRoaXMpO1xyXG5cclxuICAgICAgICAgICAgdG0uZGlzcGxheS5TcHJpdGUodGhpcy5zcGxhc2hJbWFnZSwgd2lkdGgsIGhlaWdodClcclxuICAgICAgICAgICAgICAgIC5zZXRPcmlnaW4oMCwgMClcclxuICAgICAgICAgICAgICAgIC5zZXRBbHBoYSgwKVxyXG4gICAgICAgICAgICAgICAgLmFkZENoaWxkVG8odGhpcylcclxuICAgICAgICAgICAgICAgIC50d2VlbmVyXHJcbiAgICAgICAgICAgICAgICAgICAgLmNsZWFyKClcclxuICAgICAgICAgICAgICAgICAgICAud2FpdCgyNTApXHJcbiAgICAgICAgICAgICAgICAgICAgLmZhZGVJbig1MDApXHJcbiAgICAgICAgICAgICAgICAgICAgLndhaXQoMTAwMClcclxuICAgICAgICAgICAgICAgICAgICAuZmFkZU91dCg1MDApXHJcbiAgICAgICAgICAgICAgICAgICAgLndhaXQoMjUwKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcC5wb3BTY2VuZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG59KSgpO1xyXG5cclxuXHJcbi8qXHJcbiAqXHJcbiAqL1xyXG5cclxuOyhmdW5jdGlvbigpIHtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS5nYW1lLk1hbmFnZXJTY2VuZVxyXG4gICAgICog44Oe44ON44O844K444Oj44O844K344O844OzXHJcbiAgICAgKiBAZXh0ZW5kcyB0bS5hcHAuU2NlbmVcclxuICAgICAqL1xyXG4gICAgdG0uZGVmaW5lKFwidG0uZ2FtZS5NYW5hZ2VyU2NlbmVcIiwge1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IFwidG0uYXBwLlNjZW5lXCIsXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKHBhcmFtKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3VwZXJJbml0KCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNldFNjZW5lcyhwYXJhbS5zY2VuZXMpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5vbihcImVudGVyXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nb3RvU2NlbmUocGFyYW0uc3RhcnRMYWJlbCB8fCAwKTtcclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMub24oXCJyZXN1bWVcIiwgdGhpcy5vbm5leHQuYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmNvbW1vbkFyZ3VtZW50cyA9IHt9O1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIHNjZW5lcyDjgpLjgrvjg4Pjg4hcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRTY2VuZXM6IGZ1bmN0aW9uKHNjZW5lcykge1xyXG4gICAgICAgICAgICB0aGlzLnNjZW5lcyA9IHNjZW5lcztcclxuICAgICAgICAgICAgdGhpcy5zY2VuZUluZGV4ID0gMDtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIGluZGV4KG9yIGxhYmVsKSDjga7jgrfjg7zjg7Pjgbjpo5vjgbZcclxuICAgICAgICAgKi9cclxuICAgICAgICBnb3RvU2NlbmU6IGZ1bmN0aW9uKGluZGV4LCBhcmdzKSB7XHJcbiAgICAgICAgICAgIGluZGV4ID0gKHR5cGVvZiBpbmRleCA9PSAnc3RyaW5nJykgPyB0aGlzLmxhYmVsVG9JbmRleChpbmRleCkgOiBpbmRleHx8MDtcclxuXHJcbiAgICAgICAgICAgIC8vIOOCpOODmeODs+ODiOeZuueBq1xyXG4gICAgICAgICAgICB2YXIgZSA9IHRtLmV2ZW50LkV2ZW50KFwicHJlcGFyZVwiKTtcclxuICAgICAgICAgICAgdGhpcy5maXJlKGUpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGRhdGEgPSB0aGlzLnNjZW5lc1tpbmRleF07XHJcbiAgICAgICAgICAgIHZhciBrbGFzcyA9IHRtLnVzaW5nKGRhdGEuY2xhc3NOYW1lKTtcclxuICAgICAgICAgICAgdmFyIGluaXRBcmd1bWVudHMgPSBkYXRhLmFyZ3VtZW50cztcclxuICAgICAgICAgICAgdmFyIGluaXRBcmd1bWVudHMgPSB7fS4kZXh0ZW5kKGluaXRBcmd1bWVudHMsIGFyZ3MpO1xyXG4gICAgICAgICAgICB2YXIgc2NlbmUgPSBrbGFzcy5jYWxsKG51bGwsIGluaXRBcmd1bWVudHMpO1xyXG4gICAgICAgICAgICBpZiAoIXNjZW5lLm5leHRMYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgc2NlbmUubmV4dExhYmVsID0gZGF0YS5uZXh0TGFiZWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCFzY2VuZS5uZXh0QXJndW1lbnRzKSB7XHJcbiAgICAgICAgICAgICAgICBzY2VuZS5uZXh0QXJndW1lbnRzID0gZGF0YS5uZXh0QXJndW1lbnRzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuYXBwLnB1c2hTY2VuZShzY2VuZSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNjZW5lSW5kZXggPSBpbmRleDtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50U2NlbmUgPSBzY2VuZTtcclxuXHJcbiAgICAgICAgICAgIC8vIOOCpOODmeODs+ODiOeZuueBq1xyXG4gICAgICAgICAgICB2YXIgZSA9IHRtLmV2ZW50LkV2ZW50KFwiZ290b1wiKTtcclxuICAgICAgICAgICAgZS5zY2VuZSA9IHNjZW5lO1xyXG4gICAgICAgICAgICB0aGlzLmZpcmUoZSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmrKHjga7jgrfjg7zjg7Pjgbjpo5vjgbZcclxuICAgICAgICAgKi9cclxuICAgICAgICBnb3RvTmV4dDogZnVuY3Rpb24oYXJncykge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHRoaXMuc2NlbmVzW3RoaXMuc2NlbmVJbmRleF07XHJcbiAgICAgICAgICAgIHZhciBuZXh0SW5kZXggPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgLy8g5qyh44Gu44Op44OZ44Or44GM6Kit5a6a44GV44KM44Gm44GE44Gf5aC05ZCIXHJcbiAgICAgICAgICAgIGlmIChkYXRhLm5leHRMYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgbmV4dEluZGV4ID0gdGhpcy5sYWJlbFRvSW5kZXgoZGF0YS5uZXh0TGFiZWwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOasoeOBruOCt+ODvOODs+OBq+mBt+enu1xyXG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLnNjZW5lSW5kZXgrMSA8IHRoaXMuc2NlbmVzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgbmV4dEluZGV4ID0gdGhpcy5zY2VuZUluZGV4KzE7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChuZXh0SW5kZXggIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ290b1NjZW5lKG5leHRJbmRleCwgYXJncyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpcmUodG0uZXZlbnQuRXZlbnQoXCJmaW5pc2hcIikpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgrfjg7zjg7PjgqTjg7Pjg4fjg4Pjgq/jgrnjgpLlj5blvpdcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRDdXJyZW50SW5kZXg6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zY2VuZUluZGV4O1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOOCt+ODvOODs+ODqeODmeODq+OCkuWPluW+l1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldEN1cnJlbnRMYWJlbDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNjZW5lc1t0aGlzLnNjZW5lSW5kZXhdLmxhYmVsO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODqeODmeODq+OBi+OCieOCpOODs+ODh+ODg+OCr+OCueOBq+WkieaPm1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGxhYmVsVG9JbmRleDogZnVuY3Rpb24obGFiZWwpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSB0aGlzLnNjZW5lcy5maWx0ZXIoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEubGFiZWwgPT0gbGFiZWw7XHJcbiAgICAgICAgICAgIH0pWzBdO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2NlbmVzLmluZGV4T2YoZGF0YSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Kk44Oz44OH44OD44Kv44K544GL44KJ44Op44OZ44Or44Gr5aSJ5o+bXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5kZXhUb0xhYmVsOiBmdW5jdGlvbihpbmRleCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zY2VuZXNbaW5kZXhdLmxhYmVsO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIG9ubmV4dDogZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICB2YXIgbmV4dExhYmVsID0gZS5wcmV2U2NlbmUubmV4dExhYmVsO1xyXG4gICAgICAgICAgICB2YXIgbmV4dEFyZ3VtZW50cyA9IGUucHJldlNjZW5lLm5leHRBcmd1bWVudHM7XHJcbiAgICAgICAgICAgIGlmIChuZXh0TGFiZWwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ290b1NjZW5lKG5leHRMYWJlbCwgbmV4dEFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdvdG9OZXh0KG5leHRBcmd1bWVudHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxufSkoKTtcclxuXHJcblxyXG47KGZ1bmN0aW9uKCkge1xyXG5cclxuXHR0bS5kZWZpbmUoXCJ0bS5nYW1lLk51bWVyaWNhbElucHV0U2NlbmVcIiwge1xyXG5cdFx0c3VwZXJDbGFzczogXCJ0bS5hcHAuU2NlbmVcIixcclxuXHJcblx0XHRpbml0OiBmdW5jdGlvbihwYXJhbSkge1xyXG5cdFx0XHR0aGlzLnN1cGVySW5pdCgpO1xyXG5cclxuXHRcdFx0dGhpcy5mcm9tSlNPTih7XHJcblx0XHRcdFx0Y2hpbGRyZW46IHtcclxuXHRcdFx0XHRcdGlucHV0TGFiZWw6IHtcclxuXHRcdFx0XHRcdFx0dHlwZTogXCJ0bS5kaXNwbGF5LkxhYmVsXCIsXHJcblx0XHRcdFx0XHRcdGZpbGxTdHlsZTogXCJ3aGl0ZVwiLFxyXG5cdFx0XHRcdFx0XHR0ZXh0OiBcIlwiLFxyXG5cdFx0XHRcdFx0XHRmb250U2l6ZTogNjQsXHJcblx0XHRcdFx0XHRcdHg6IDMyMCxcclxuXHRcdFx0XHRcdFx0eTogMTIwLFxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdGJ1dHRvbkdyb3VwOiB7XHJcblx0XHRcdFx0XHRcdHR5cGU6IFwidG0uZGlzcGxheS5DYW52YXNFbGVtZW50XCIsXHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdH0pO1xyXG5cclxuXHJcblx0XHRcdFsxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAnQycsIDAsICdPSyddLmVhY2goZnVuY3Rpb24obiwgaSkge1xyXG5cdFx0XHRcdHZhciBidXR0b24gPSB0aGlzLl9jcmVhdGVCdXR0b24obi50b1N0cmluZygpKS5hZGRDaGlsZFRvKHRoaXMuYnV0dG9uR3JvdXApO1xyXG5cdFx0XHRcdHZhciB4SW5kZXggPSBpJTM7XHJcblx0XHRcdFx0dmFyIHlJbmRleCA9IChpLzMpfDA7XHJcblx0XHRcdFx0YnV0dG9uLnggPSAxOTAqeEluZGV4ICsgMTMwO1xyXG5cdFx0XHRcdGJ1dHRvbi55ID0gMTc3KnlJbmRleCArIDI4MDtcclxuXHRcdFx0fSwgdGhpcyk7XHJcblxyXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XHJcblx0XHRcdHZhciBidXR0b25zID0gdGhpcy5idXR0b25Hcm91cC5jaGlsZHJlbjtcclxuXHRcdFx0YnV0dG9ucy5lYWNoKGZ1bmN0aW9uKGJ1dHRvbikge1xyXG5cdFx0XHRcdGJ1dHRvbi5zZXRJbnRlcmFjdGl2ZSh0cnVlKS5zZXRCb3VuZGluZ1R5cGUoXCJjaXJjbGVcIik7XHJcblx0XHRcdFx0YnV0dG9uLnJhZGl1cyA9IDE0NS8yO1xyXG5cdFx0XHRcdGJ1dHRvbi5vbnBvaW50aW5nc3RhcnQgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdGlmICh0aGlzLmxhYmVsLnRleHQgPT0gJ09LJykge1xyXG5cdFx0XHRcdFx0XHR2YXIgZSA9IHRtLmV2ZW50LkV2ZW50KFwiZGVjaWRlZFwiKTtcclxuXHRcdFx0XHRcdFx0ZS52YWx1ZSA9IE51bWJlcihzZWxmLmlucHV0TGFiZWwudGV4dCk7XHJcblx0XHRcdFx0XHRcdHNlbGYuZmlyZShlKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGVsc2UgaWYgKHRoaXMubGFiZWwudGV4dCA9PSAnQycpIHtcclxuXHRcdFx0XHRcdFx0dmFyIGUgPSB0bS5ldmVudC5FdmVudChcInB1c2hcIik7XHJcblx0XHRcdFx0XHRcdHNlbGYuaW5wdXRMYWJlbC50ZXh0ID0gXCJcIjtcclxuXHRcdFx0XHRcdFx0c2VsZi5mbGFyZShcImNsZWFyXCIpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0XHRcdHNlbGYuaW5wdXRMYWJlbC50ZXh0ICs9IHRoaXMubGFiZWwudGV4dDtcclxuXHRcdFx0XHRcdFx0c2VsZi5mbGFyZShcInB1c2hcIiwge1xyXG5cdFx0XHRcdFx0XHRcdHNlbGVjdDogdGhpcy5sYWJlbC50ZXh0LFxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fSxcclxuXHJcblx0XHRfY3JlYXRlQnV0dG9uOiBmdW5jdGlvbihuKSB7XHJcblx0XHRcdHZhciBidXR0b24gPSB0bS5kaXNwbGF5LkNhbnZhc0VsZW1lbnQoKTtcclxuXHJcblx0XHRcdGJ1dHRvbi5mcm9tSlNPTih7XHJcblx0XHRcdFx0Y2hpbGRyZW46IHtcclxuXHRcdFx0XHRcdGJnOiB7XHJcblx0XHRcdFx0XHRcdHR5cGU6IFwidG0uZGlzcGxheS5DaXJjbGVTaGFwZVwiLFxyXG5cdFx0XHRcdFx0XHRpbml0OiBbMTQ1LCAxNDUsIHtcclxuXHRcdFx0XHRcdFx0XHRmaWxsU3R5bGU6IFwidHJhbnNwYXJlbnRcIixcclxuXHRcdFx0XHRcdFx0XHRzdHJva2VTdHlsZTogXCJ3aGl0ZVwiLFxyXG5cdFx0XHRcdFx0XHR9XSxcclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRsYWJlbDoge1xyXG5cdFx0XHRcdFx0XHR0eXBlOiBcInRtLmRpc3BsYXkuTGFiZWxcIixcclxuXHRcdFx0XHRcdFx0dGV4dDogbixcclxuXHRcdFx0XHRcdFx0Zm9udFNpemU6IDY0LFxyXG5cdFx0XHRcdFx0XHRmaWxsU3R5bGU6IFwid2hpdGVcIixcclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRyZXR1cm4gYnV0dG9uO1xyXG5cdFx0fSxcclxuXHR9KTtcclxuXHJcbn0pKCk7XHJcblxyXG4vKlxyXG4gKiBjb3VudHNjZW5lLmpzXHJcbiAqL1xyXG5cclxuOyhmdW5jdGlvbigpIHtcclxuXHJcbiAgICB0bS5kZWZpbmUoXCJ0bS5nYW1lLkNvdW50U2NlbmVcIiwge1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IFwidG0uYXBwLlNjZW5lXCIsXHJcblxyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKHBhcmFtKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3VwZXJJbml0KCk7XHJcblxyXG4gICAgICAgICAgICBwYXJhbSA9IHBhcmFtLiRzYWZlKHtcclxuICAgICAgICAgICAgICAgIHdpZHRoOiA2NDAsXHJcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDk2MCxcclxuICAgICAgICAgICAgICAgIGJnQ29sb3I6ICcjNDQ0JyxcclxuICAgICAgICAgICAgICAgIGNvdW50OiAzLFxyXG4gICAgICAgICAgICAgICAgYXV0b3BvcDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGZvbnRTaXplOiAxODAsXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcGFyYW0gPSBwYXJhbSB8fCB7fTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZnJvbUpTT04oe1xyXG4gICAgICAgICAgICAgICAgY2hpbGRyZW46IHtcclxuICAgICAgICAgICAgICAgICAgICBiZzoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInRtLmRpc3BsYXkuU2hhcGVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHBhcmFtLndpZHRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHBhcmFtLmhlaWdodCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmdDb2xvcjogcGFyYW0uYmdDb2xvcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luWDogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luWTogMCxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwidG0uZGlzcGxheS5MYWJlbFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxsU3R5bGU6IFwid2hpdGVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9udFNpemU6IHBhcmFtLmZvbnRTaXplLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB4OiBTQ1JFRU5fQ0VOVEVSX1gsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IFNDUkVFTl9DRU5URVJfWSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChwYXJhbS5jb3VudCBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvdW50TGlzdCA9IHBhcmFtLmNvdW50LnJldmVyc2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY291bnRMaXN0ID0gQXJyYXkucmFuZ2UoMSwgcGFyYW0uY291bnQrMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5jb3VudGVyID0gdGhpcy5jb3VudExpc3QubGVuZ3RoO1xyXG4gICAgICAgICAgICB0aGlzLmF1dG9wb3AgPSBwYXJhbS5hdXRvcG9wO1xyXG4gICAgICAgICAgICB0aGlzLl91cGRhdGVDb3VudCgpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIF91cGRhdGVDb3VudDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBlbmRGbGFnID0gdGhpcy5jb3VudGVyIDw9IDA7XHJcbiAgICAgICAgICAgIHZhciBpbmRleCA9IC0tdGhpcy5jb3VudGVyO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5sYWJlbC50ZXh0ID0gdGhpcy5jb3VudExpc3RbaW5kZXhdO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5sYWJlbC5zY2FsZS5zZXQoMSwgMSk7XHJcbiAgICAgICAgICAgIHRoaXMubGFiZWwudHdlZW5lclxyXG4gICAgICAgICAgICAgICAgLmNsZWFyKClcclxuICAgICAgICAgICAgICAgIC50byh7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NhbGVYOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgIHNjYWxlWTogMSxcclxuICAgICAgICAgICAgICAgICAgICBhbHBoYTogMSxcclxuICAgICAgICAgICAgICAgIH0sIDI1MClcclxuICAgICAgICAgICAgICAgIC53YWl0KDUwMClcclxuICAgICAgICAgICAgICAgIC50byh7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NhbGVYOiAxLjUsXHJcbiAgICAgICAgICAgICAgICAgICAgc2NhbGVZOiAxLjUsXHJcbiAgICAgICAgICAgICAgICAgICAgYWxwaGE6IDAuMFxyXG4gICAgICAgICAgICAgICAgfSwgMjUwKVxyXG4gICAgICAgICAgICAgICAgLmNhbGwoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY291bnRlciA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmxhcmUoJ2ZpbmlzaCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5hdXRvcG9wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcC5wb3BTY2VuZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVDb3VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIHRoaXMpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgfSk7XHJcblxyXG59KSgpO1xyXG4vKlxyXG4gKiB0aHJlZS5qc1xyXG4gKi9cclxuXHJcbnRtLnRocmVlID0gdG0udGhyZWUgfHwge307XHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIGlmICghdG0uZ2xvYmFsLlRIUkVFKSByZXR1cm4gO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS50aHJlZS5UaHJlZUFwcFxyXG4gICAgICogM0Tjg6njgqTjg5bjg6njg6ogLSBUaHJlZS5qc+OCknRtbGliLmpz44Gn5a++5b+cXHJcbiAgICAgKiBAZXh0ZW5kcyB0bS5hcHAuQmFzZUFwcFxyXG4gICAgICovXHJcbiAgICB0bS50aHJlZS5UaHJlZUFwcCA9IHRtLmNyZWF0ZUNsYXNzKHtcclxuICAgICAgICBzdXBlckNsYXNzOiB0bS5hcHAuQmFzZUFwcCxcclxuICAgICAgICBcclxuICAgICAgICAvKiogY2FudmFzICovXHJcbiAgICAgICAgY2FudmFzICAgICAgOiBudWxsLFxyXG4gICAgICAgIC8qKiBjYW52YXMgKi9cclxuICAgICAgICBiYWNrZ3JvdW5kICA6IG51bGwsXHJcbiAgICAgICAgLyoqIEBwcml2YXRlIGNhbnZhcyAqL1xyXG4gICAgICAgIF9zY2VuZXMgICAgICA6IG51bGwsXHJcbiAgICAgICAgLyoqIEBwcml2YXRlIGNhbnZhcyAqL1xyXG4gICAgICAgIF9zY2VuZUluZGV4ICA6IDAsXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oY2FudmFzKSB7XHJcbiAgICAgICAgICAgIGlmIChjYW52YXMgaW5zdGFuY2VvZiBIVE1MQ2FudmFzRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gY2FudmFzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBjYW52YXMgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihjYW52YXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5lbGVtZW50KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8g6Kaq44Gu5Yid5pyf5YyWXHJcbiAgICAgICAgICAgIHRoaXMuc3VwZXJJbml0KHRoaXMuZWxlbWVudCk7XHJcblxyXG4gICAgICAgICAgICAvLyDjg6zjg7Pjg4Djg6njg7zjgpLnlJ/miJBcclxuLy8gICAgICAgICAgICB0aGlzLnJlbmRlcmVyID0gbmV3IFRIUkVFLkNhbnZhc1JlbmRlcmVyKHsgY2FudmFzOiB0aGlzLmVsZW1lbnQgfSk7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJlcih7IGNhbnZhczogdGhpcy5lbGVtZW50LCBjbGVhckNvbG9yOiAweDIyMjIyMiwgY2xlYXJBbHBoYTogMS4wIH0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTaXplKHRoaXMuZWxlbWVudC53aWR0aCwgdGhpcy5lbGVtZW50LmhlaWdodCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDjgrfjg7zjg7PlkajjgopcclxuICAgICAgICAgICAgdGhpcy5fc2NlbmVzID0gWyB0bS50aHJlZS5TY2VuZSgpIF07XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAVE9ETyA/XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcmVzaXplOiBmdW5jdGlvbih3aWR0aCwgaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcclxuICAgICAgICAgICAgdGhpcy5oZWlnaHQ9IGhlaWdodDtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTaXplKHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBUT0RPID9cclxuICAgICAgICAgKi9cclxuICAgICAgICByZXNpemVXaW5kb3c6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLndpZHRoID0gaW5uZXJXaWR0aDtcclxuICAgICAgICAgICAgdGhpcy5oZWlnaHQ9IGlubmVySGVpZ2h0O1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFNpemUodGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDnlLvpnaLjgavjg5XjgqPjg4Pjg4jjgZXjgZvjgotcclxuICAgICAgICAgKi9cclxuICAgICAgICBmaXRXaW5kb3c6IGZ1bmN0aW9uKGV2ZXJGbGFnKSB7XHJcbiAgICAgICAgICAgIC8vIOeUu+mdouOBq+ODleOCo+ODg+ODiFxyXG4gICAgICAgICAgICB2YXIgX2ZpdEZ1bmMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGV2ZXJGbGFnID0gZXZlckZsYWcgPT09IHVuZGVmaW5lZCA/IHRydWUgOiBldmVyRmxhZztcclxuICAgICAgICAgICAgICAgIHZhciBlID0gdGhpcy5lbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgdmFyIHMgPSBlLnN0eWxlO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBzLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xyXG4gICAgICAgICAgICAgICAgcy5sZWZ0ID0gXCIwcHhcIjtcclxuICAgICAgICAgICAgICAgIHMudG9wICA9IFwiMHB4XCI7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHZhciByYXRlV2lkdGggPSBlLndpZHRoL3dpbmRvdy5pbm5lcldpZHRoO1xyXG4gICAgICAgICAgICAgICAgdmFyIHJhdGVIZWlnaHQ9IGUuaGVpZ2h0L3dpbmRvdy5pbm5lckhlaWdodDtcclxuICAgICAgICAgICAgICAgIHZhciByYXRlID0gZS5oZWlnaHQvZS53aWR0aDtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKHJhdGVXaWR0aCA+IHJhdGVIZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBzLndpZHRoICA9IGlubmVyV2lkdGgrXCJweFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIHMuaGVpZ2h0ID0gaW5uZXJXaWR0aCpyYXRlK1wicHhcIjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHMud2lkdGggID0gaW5uZXJIZWlnaHQvcmF0ZStcInB4XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgcy5oZWlnaHQgPSBpbm5lckhlaWdodCtcInB4XCI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIOS4gOW6puWun+ihjOOBl+OBpuOBiuOBj1xyXG4gICAgICAgICAgICBfZml0RnVuYygpO1xyXG4gICAgICAgICAgICAvLyDjg6rjgrXjgqTjgrrmmYLjga7jg6rjgrnjg4rjgajjgZfjgabnmbvpjLLjgZfjgabjgYrjgY9cclxuICAgICAgICAgICAgaWYgKGV2ZXJGbGFnKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCBfZml0RnVuYywgZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyDjg57jgqbjgrnjgajjgr/jg4Pjg4Hjga7luqfmqJnmm7TmlrDplqLmlbDjgpLjg5Hjg6/jg7zjgqLjg4Pjg5dcclxuICAgICAgICAgICAgdGhpcy5tb3VzZS5fbW91c2Vtb3ZlID0gdGhpcy5tb3VzZS5fbW91c2Vtb3ZlU2NhbGU7XHJcbiAgICAgICAgICAgIHRoaXMudG91Y2guX3RvdWNobW92ZSA9IHRoaXMudG91Y2guX3RvdWNobW92ZVNjYWxlO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBUT0RPID9cclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9kcmF3OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgLy8g5o+P55S744Gv5YWo44Gm44Gu44K344O844Oz6KGM44GGXHJcbiAgICAgICAgICAgIGZvciAodmFyIGk9MCwgbGVuPXRoaXMuX3NjZW5lcy5sZW5ndGg7IGk8bGVuOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIucmVuZGVyKHRoaXMuY3VycmVudFNjZW5lLCB0aGlzLmN1cnJlbnRTY2VuZS5jYW1lcmEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIHdpZHRoXHJcbiAgICAgKiDluYVcclxuICAgICAqL1xyXG4gICAgdG0udGhyZWUuVGhyZWVBcHAucHJvdG90eXBlLmFjY2Vzc29yKFwid2lkdGhcIiwge1xyXG4gICAgICAgIFwiZ2V0XCI6IGZ1bmN0aW9uKCkgICB7IHJldHVybiB0aGlzLmVsZW1lbnQud2lkdGg7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5lbGVtZW50LndpZHRoID0gdjsgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGhlaWdodFxyXG4gICAgICog6auY44GVXHJcbiAgICAgKi9cclxuICAgIHRtLnRocmVlLlRocmVlQXBwLnByb3RvdHlwZS5hY2Nlc3NvcihcImhlaWdodFwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSAgIHsgcmV0dXJuIHRoaXMuZWxlbWVudC5oZWlnaHQ7IH0sXHJcbiAgICAgICAgXCJzZXRcIjogZnVuY3Rpb24odikgIHsgdGhpcy5lbGVtZW50LmhlaWdodCA9IHY7IH1cclxuICAgIH0pO1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICBpZiAoIXRtLmdsb2JhbC5USFJFRSkgcmV0dXJuIDtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS50aHJlZS5FbGVtZW50XHJcbiAgICAgKiBAVE9ETyA/XHJcbiAgICAgKi9cclxuICAgIHRtLnRocmVlLkVsZW1lbnQgPSB0bS5jcmVhdGVDbGFzcyh7XHJcbiAgICAgICAgc3VwZXJDbGFzczogVEhSRUUuT2JqZWN0M0QsXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyBUSFJFRS5PYmplY3QzRCDjga7liJ3mnJ/ljJYgXHJcbiAgICAgICAgICAgIFRIUkVFLk9iamVjdDNELmNhbGwodGhpcyk7XHJcblxyXG4gICAgICAgICAgICB0bS5ldmVudC5FdmVudERpc3BhdGNoZXIucHJvdG90eXBlLmluaXQuY2FsbCh0aGlzKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOabtOaWsOWHpueQhlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHVwZGF0ZTogZnVuY3Rpb24oKSB7fSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQFRPRE8gP1xyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3VwZGF0ZTogZnVuY3Rpb24oYXBwKSB7XHJcbiAgICAgICAgICAgIC8vIOabtOaWsOacieWKueODgeOCp+ODg+OCr1xyXG4gICAgICAgICAgICBpZiAodGhpcy5hd2FrZSA9PSBmYWxzZSkgcmV0dXJuIDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKGFwcCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgZSA9IHRtLmV2ZW50LkV2ZW50KFwiZW50ZXJmcmFtZVwiKTtcclxuICAgICAgICAgICAgZS5hcHAgPSBhcHA7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChlKTtcclxuICAgICAgICAgICAgLy8g5a2Q5L6b6YGU44KC5a6f6KGMXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHZhciB0ZW1wQ2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuLnNsaWNlKCk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpPTAsbGVuPXRlbXBDaGlsZHJlbi5sZW5ndGg7IGk8bGVuOyArK2kpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGQgPSB0ZW1wQ2hpbGRyZW5baV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGQuX3VwZGF0ZSAmJiBjaGlsZC5fdXBkYXRlKGFwcCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvL3RoaXMuZXhlY0NoaWxkcmVuKGFyZ3VtZW50cy5jYWxsZWUsIGFwcCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIHRtLmV2ZW50LkV2ZW50RGlzcGF0Y2hlciDjgpLntpnmib9cclxuICAgIHRtLnRocmVlLkVsZW1lbnQucHJvdG90eXBlLiRzYWZlKHRtLmV2ZW50LkV2ZW50RGlzcGF0Y2hlci5wcm90b3R5cGUpO1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIGlmICghdG0uZ2xvYmFsLlRIUkVFKSByZXR1cm4gO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLnRocmVlLk1lc2hFbGVtZW50XHJcbiAgICAgKiBAVE9ETyA/XHJcbiAgICAgKi9cclxuICAgIHRtLnRocmVlLk1lc2hFbGVtZW50ID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IFRIUkVFLk1lc2gsXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oZ2VvbWV0cnksIG1hdGVyaWFsKSB7XHJcbiAgICAgICAgICAgIG1hdGVyaWFsID0gbWF0ZXJpYWwgfHwgbmV3IFRIUkVFLk1lc2hOb3JtYWxNYXRlcmlhbCgpO1xyXG4gICAgICAgICAgICAvLyBUSFJFRS5NZXNoIOOBruWIneacn+WMllxyXG4gICAgICAgICAgICBUSFJFRS5NZXNoLmNhbGwodGhpcywgZ2VvbWV0cnksIG1hdGVyaWFsKTtcclxuXHJcbiAgICAgICAgICAgIHRtLnRocmVlLkVsZW1lbnQucHJvdG90eXBlLmluaXQuY2FsbCh0aGlzKTtcclxuICAgICAgICB9LFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIHRtLnRocmVlLkVsZW1lbnQg44KS57aZ5om/XHJcbiAgICB0bS50aHJlZS5NZXNoRWxlbWVudC5wcm90b3R5cGUuJHNhZmUodG0udGhyZWUuRWxlbWVudC5wcm90b3R5cGUpO1xyXG5cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0udGhyZWUuQ3ViZUVsZW1lbnRcclxuICAgICAqIEBUT0RPID9cclxuICAgICAqIEBleHRlbmRzIHRtLnRocmVlLk1lc2hFbGVtZW50XHJcbiAgICAgKi9cclxuICAgIHRtLnRocmVlLkN1YmVFbGVtZW50ID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IHRtLnRocmVlLk1lc2hFbGVtZW50LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbih3aWR0aCwgaGVpZ2h0LCBkZXB0aCkge1xyXG4gICAgICAgICAgICB3aWR0aCAgPSB3aWR0aCB8fCAxMDA7XHJcbiAgICAgICAgICAgIGhlaWdodCA9IGhlaWdodCB8fCAxMDA7XHJcbiAgICAgICAgICAgIGRlcHRoICA9IGRlcHRoIHx8IDEwMDtcclxuXHJcbiAgICAgICAgICAgIHZhciBnZW9tZXRyeSA9IG5ldyBUSFJFRS5DdWJlR2VvbWV0cnkod2lkdGgsIGhlaWdodCwgZGVwdGgpO1xyXG4gICAgICAgICAgICB2YXIgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaE5vcm1hbE1hdGVyaWFsKCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdChnZW9tZXRyeSwgbWF0ZXJpYWwpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS50aHJlZS5TcGhlcmVFbGVtZW50XHJcbiAgICAgKiBAVE9ETyA/XHJcbiAgICAgKiBAZXh0ZW5kcyB0bS50aHJlZS5NZXNoRWxlbWVudFxyXG4gICAgICovXHJcbiAgICB0bS50aHJlZS5TcGhlcmVFbGVtZW50ID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IHRtLnRocmVlLk1lc2hFbGVtZW50LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihyYWRpdXMsIHdpZHRoU2VnbWVudHMsIGhlaWdodFNlZ21lbnRzKSB7XHJcbiAgICAgICAgICAgIHJhZGl1cyAgICAgICAgICA9IHJhZGl1cyB8fCA0NTtcclxuICAgICAgICAgICAgd2lkdGhTZWdtZW50cyAgID0gd2lkdGhTZWdtZW50cyB8fCAxNjtcclxuICAgICAgICAgICAgaGVpZ2h0U2VnbWVudHMgID0gaGVpZ2h0U2VnbWVudHMgfHwgMTI7XHJcblxyXG4gICAgICAgICAgICB2YXIgZ2VvbWV0cnkgPSBuZXcgVEhSRUUuU3BoZXJlR2VvbWV0cnkocmFkaXVzLCB3aWR0aFNlZ21lbnRzLCBoZWlnaHRTZWdtZW50cyk7XHJcbiAgICAgICAgICAgIHZhciBtYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoTm9ybWFsTWF0ZXJpYWwoKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc3VwZXJJbml0KGdlb21ldHJ5LCBtYXRlcmlhbCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0udGhyZWUuUGxhbmVFbGVtZW50XHJcbiAgICAgKiBAVE9ETyA/XHJcbiAgICAgKiBAZXh0ZW5kcyB0bS50aHJlZS5NZXNoRWxlbWVudFxyXG4gICAgICovXHJcbiAgICB0bS50aHJlZS5QbGFuZUVsZW1lbnQgPSB0bS5jcmVhdGVDbGFzcyh7XHJcbiAgICAgICAgc3VwZXJDbGFzczogdG0udGhyZWUuTWVzaEVsZW1lbnQsXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKHdpZHRoLCBoZWlnaHQpIHtcclxuICAgICAgICAgICAgdmFyIGdlb21ldHJ5ID0gbmV3IFRIUkVFLlBsYW5lR2VvbWV0cnkod2lkdGgsIGhlaWdodCk7XHJcbiAgICAgICAgICAgIHZhciBtYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoTm9ybWFsTWF0ZXJpYWwoKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc3VwZXJJbml0KGdlb21ldHJ5LCBtYXRlcmlhbCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLnRocmVlLkZsb29yRWxlbWVudFxyXG4gICAgICogQFRPRE8gP1xyXG4gICAgICogQGV4dGVuZHMgdG0udGhyZWUuTWVzaEVsZW1lbnRcclxuICAgICAqL1xyXG4gICAgdG0udGhyZWUuRmxvb3JFbGVtZW50ID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IHRtLnRocmVlLk1lc2hFbGVtZW50LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbih3aWR0aCwgaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHdpZHRoICA9IHdpZHRoIHx8IDEwMDA7XHJcbiAgICAgICAgICAgIGhlaWdodCA9IGhlaWdodCB8fCAxMDAwO1xyXG4gICAgICAgICAgICB2YXIgZ2VvbWV0cnkgPSBuZXcgVEhSRUUuUGxhbmVHZW9tZXRyeSh3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICAgICAgdmFyIG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdChnZW9tZXRyeSwgbWF0ZXJpYWwpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5yb3RhdGlvbi54ID0gLU1hdGguUEkvMjtcclxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQFRPRE8gP1xyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3JlbmRlcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gdG0uZ3JhcGhpY3MuQ2FudmFzKCk7XHJcbiAgICAgICAgICAgIGMucmVzaXplKDEyOCwgMTI4KTtcclxuICAgICAgICAgICAgYy5jbGVhckNvbG9yKFwiIzQ0NFwiKTtcclxuICAgICAgICAgICAgYy5zZXRGaWxsU3R5bGUoXCJ3aGl0ZVwiKTtcclxuICAgICAgICAgICAgYy5maWxsUmVjdCgwLCAwLCA2NCwgNjQpO1xyXG4gICAgICAgICAgICBjLmZpbGxSZWN0KDY0LCA2NCwgNjQsIDY0KTtcclxuXHJcbiAgICAgICAgICAgIHZhciB0ZXh0dXJlID0gbmV3IFRIUkVFLlRleHR1cmUoYy5lbGVtZW50KTtcclxuICAgICAgICAgICAgdGV4dHVyZS53cmFwUyA9IHRleHR1cmUud3JhcFQgPSBUSFJFRS5SZXBlYXRXcmFwcGluZztcclxuICAgICAgICAgICAgdGV4dHVyZS5yZXBlYXQuc2V0KDEwLCAxMCk7XHJcbiAgICAgICAgICAgIHRleHR1cmUubmVlZHNVcGRhdGUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLm1hdGVyaWFsLm1hcCA9IHRleHR1cmU7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0udGhyZWUuVGV4dEVsZW1lbnRcclxuICAgICAqIEBUT0RPID9cclxuICAgICAqIEBleHRlbmRzIHRtLnRocmVlLk1lc2hFbGVtZW50XHJcbiAgICAgKi9cclxuICAgIHRtLnRocmVlLlRleHRFbGVtZW50ID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IHRtLnRocmVlLk1lc2hFbGVtZW50LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbih0ZXh0LCBwYXJhbSkge1xyXG4gICAgICAgICAgICB2YXIgZ2VvbWV0cnkgPSBuZXcgVEhSRUUuVGV4dEdlb21ldHJ5KHRleHQsIHBhcmFtKTtcclxuICAgICAgICAgICAgdmFyIG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hOb3JtYWxNYXRlcmlhbCgpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zdXBlckluaXQoZ2VvbWV0cnksIG1hdGVyaWFsKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBjbGFzcyB0bS50aHJlZS5DYW52YXNUZXh0dXJlXHJcbiAgICAgKiBAVE9ETyA/XHJcbiAgICAgKi9cclxuICAgIHRtLnRocmVlLkNhbnZhc1RleHR1cmUgPSB0bS5jcmVhdGVDbGFzcyh7XHJcbiAgICAgICAgc3VwZXJDbGFzczogVEhSRUUuVGV4dHVyZSxcclxuXHJcbiAgICAgICAgLyoqIGNhbnZhcyAqL1xyXG4gICAgICAgIGNhbnZhczogbnVsbCxcclxuICAgICAgICAvKiogQHByb3BlcnR5IG5lZWRzVXBkYXRlICovXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbnZhcyA9IHRtLmdyYXBoaWNzLkNhbnZhcygpO1xyXG5cclxuICAgICAgICAgICAgVEhSRUUuVGV4dHVyZS5jYWxsKHRoaXMsIHRoaXMuY2FudmFzLmVsZW1lbnQpO1xyXG4gICAgICAgICAgICB0aGlzLm5lZWRzVXBkYXRlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfSk7XHJcblxyXG5cclxufSkoKTtcclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgaWYgKCF0bS5nbG9iYWwuVEhSRUUpIHJldHVybiA7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0udGhyZWUuU2NlbmVcclxuICAgICAqIOOCt+ODvOODs1xyXG4gICAgICovXHJcbiAgICB0bS50aHJlZS5TY2VuZSA9IHRtLmNyZWF0ZUNsYXNzKHtcclxuICAgICAgICBzdXBlckNsYXNzOiBUSFJFRS5TY2VuZSxcclxuICAgICAgICBcclxuICAgICAgICAvKiogQHByb3BlcnR5IGNhbWVyYSAgICDjgqvjg6Hjg6kgKi9cclxuICAgICAgICAvKiogQHByb3BlcnR5IFByb2plY3RvciDjg5fjg63jgrjjgqfjgq/jgr/jg7wgKi9cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oZm92LCBhc3BlY3QpIHtcclxuICAgICAgICAgICAgZm92ID0gZm92IHx8IDYwO1xyXG4gICAgICAgICAgICBhc3BlY3QgPSBhc3BlY3QgfHwgNjQwLzQ4MDtcclxuICAgICAgICAgICAgLy8gVEhSRUUuU2NlbmUg44Gu5Yid5pyf5YyWXHJcbiAgICAgICAgICAgIFRIUkVFLlNjZW5lLmNhbGwodGhpcyk7XHJcblxyXG4gICAgICAgICAgICAvLyB0bS50aHJlZS5FbGVtZW50IOOCkue2meaJv1xyXG4gICAgICAgICAgICB0bS50aHJlZS5FbGVtZW50LnByb3RvdHlwZS5pbml0LmNhbGwodGhpcyk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYShmb3YsIGFzcGVjdCwgMSwgMTAwMDApO1xyXG4gICAgICAgICAgICB0aGlzLmNhbWVyYS5wb3NpdGlvbi55ID0gMTAwO1xyXG4gICAgICAgICAgICB0aGlzLmNhbWVyYS5wb3NpdGlvbi56ID0gNTAwO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5wcm9qZWN0b3IgPSBuZXcgVEhSRUUuUHJvamVjdG9yKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQFRPRE8gP1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGludGVyc2VjdDogZnVuY3Rpb24ob2JqZWN0cykge1xyXG4gICAgICAgICAgICBvYmplY3RzID0gb2JqZWN0cyB8fCB0aGlzLmNoaWxkcmVuO1xyXG4gICAgICAgICAgICB2YXIgbW91c2VYID0gdGhpcy5hcHAucG9pbnRpbmcueDtcclxuICAgICAgICAgICAgdmFyIG1vdXNlWSA9IHRoaXMuYXBwLnBvaW50aW5nLnk7XHJcblxyXG4gICAgICAgICAgICBtb3VzZVggPSAobW91c2VYL3RoaXMuYXBwLndpZHRoKSAqMi0xO1xyXG4gICAgICAgICAgICBtb3VzZVkgPS0obW91c2VZL3RoaXMuYXBwLmhlaWdodCkqMisxO1xyXG5cclxuICAgICAgICAgICAgdmFyIHZlY3RvciA9IG5ldyBUSFJFRS5WZWN0b3IzKG1vdXNlWCwgbW91c2VZLCAwLjUpO1xyXG4gICAgICAgICAgICB0aGlzLnByb2plY3Rvci51bnByb2plY3RWZWN0b3IodmVjdG9yLCB0aGlzLmNhbWVyYSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgcmF5Y2FzdGVyID0gbmV3IFRIUkVFLlJheWNhc3RlcihcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FtZXJhLnBvc2l0aW9uLCB2ZWN0b3Iuc3ViKHRoaXMuY2FtZXJhLnBvc2l0aW9uKS5ub3JtYWxpemUoKVxyXG4gICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHJheWNhc3Rlci5pbnRlcnNlY3RPYmplY3RzKG9iamVjdHMpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvLyB0bS50aHJlZS5FbGVtZW50IOOCkue2meaJv1xyXG4gICAgdG0udGhyZWUuU2NlbmUucHJvdG90eXBlLiRzYWZlKHRtLnRocmVlLkVsZW1lbnQucHJvdG90eXBlKTtcclxufSkoKTtcclxuXHJcblxyXG5cclxuXHJcblxyXG4vKlxyXG4gKiBzb3VuZC5qc1xyXG4gKi9cclxuXHJcbnRtLnNvdW5kID0gdG0uc291bmQgfHwge307XHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICB0bS5zb3VuZC5nbG9iYWxWb2x1bWUgPSAxLjA7XHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLnNvdW5kLlNvdW5kXHJcbiAgICAgKiDjgrXjgqbjg7Pjg4njgq/jg6njgrlcclxuICAgICAqL1xyXG4gICAgdG0uc291bmQuU291bmQgPSB0bS5jcmVhdGVDbGFzcyh7XHJcbiAgICAgICAgc3VwZXJDbGFzczogdG0uZXZlbnQuRXZlbnREaXNwYXRjaGVyLFxyXG5cclxuICAgICAgICAvKiogZWxlbWVudCAqL1xyXG4gICAgICAgIGVsZW1lbnQgICAgIDogbnVsbCxcclxuICAgICAgICAvKiogbG9hZGVkICovXHJcbiAgICAgICAgbG9hZGVkICAgICAgOiBmYWxzZSxcclxuICAgICAgICAvKiogaXNQbGF5ICovXHJcbiAgICAgICAgaXNQbGF5ICAgICAgOiBmYWxzZSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihzcmMpIHtcclxuICAgICAgICAgICAgdGhpcy5zdXBlckluaXQoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IG5ldyBBdWRpbygpO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuc3JjID0gc3JjO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQubG9hZCgpO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwicHJlbG9hZFwiLCBcImF1dG9cIik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2FucGxheXRocm91Z2hcIiwgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIHNlbGYubG9hZGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHNlbGYuZmlyZSh0bS5ldmVudC5FdmVudChcImxvYWRcIikpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJlbmRlZFwiLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgc2VsZi5pc1BsYXkgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2Fybih0aGlzLnNyYyArIFwi44Gu6Kqt44G/6L6844G/44Gr5aSx5pWX44GX44G+44GX44GfXCIpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC52b2x1bWUgPSAxLjA7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLz8g44Oi44OQ44Kk44Or57O744Gv6Z+z44GM5LiN5a6J5a6a44Gq44Gu44Gn5LiA5pmC5a++5b+cXHJcbiAgICAgICAgICAgIGlmICh0bS5pc01vYmlsZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlho3nlJ9cclxuICAgICAgICAgKi9cclxuICAgICAgICBwbGF5OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnBsYXkoKTtcclxuICAgICAgICAgICAgdGhpcy5pc1BsYXkgPSB0cnVlO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOWBnOatolxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHN0b3A6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQucGF1c2UoKTtcclxuICAgICAgICAgICAgLy8/IOOCueODnuODm+OBoOOBqOatouOBvuOCi+OBruOBp+W/nOaApeWvvuW/nFxyXG4gICAgICAgICAgICBpZiAoIXRtLmlzTW9iaWxlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuY3VycmVudFRpbWUgPSAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuaXNQbGF5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5LiA5pmC5YGc5q2iXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcGF1c2U6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQucGF1c2UoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjgq/jg63jg7zjg7NcclxuICAgICAgICAgKi9cclxuICAgICAgICBjbG9uZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0bS5zb3VuZC5Tb3VuZCggdGhpcy5lbGVtZW50LnNyYyApO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgXHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIHZvbHVtZVxyXG4gICAgICog44Oc44Oq44Ol44O844OgXHJcbiAgICAgKi9cclxuICAgIHRtLnNvdW5kLlNvdW5kLnByb3RvdHlwZS5hY2Nlc3NvcihcInZvbHVtZVwiLCB7XHJcbiAgICAgICAgXCJnZXRcIjogZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzLmVsZW1lbnQudm9sdW1lOyB9LFxyXG4gICAgICAgIFwic2V0XCI6IGZ1bmN0aW9uKHYpeyB0aGlzLmVsZW1lbnQudm9sdW1lID0gdjsgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIFxyXG4gICAgaWYgKChuZXcgQXVkaW8oKSkubG9vcCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICBcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJvcGVydHkgICAgbG9vcFxyXG4gICAgICAgICAqIOODq+ODvOODl+ODleODqeOCsFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRtLnNvdW5kLlNvdW5kLnByb3RvdHlwZS5hY2Nlc3NvcihcImxvb3BcIiwge1xyXG4gICAgICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXMuZWxlbWVudC5sb29wOyB9LFxyXG4gICAgICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KXsgdGhpcy5lbGVtZW50Lmxvb3AgPSB2OyB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvLyBmaXJlZm94IOWvvuW/nFxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdmFyIG9uTG9vcEZ1bmMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5wbGF5KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRtLnNvdW5kLlNvdW5kLnByb3RvdHlwZS5hY2Nlc3NvcihcImxvb3BcIiwge1xyXG4gICAgICAgICAgICBcImdldFwiOiBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXMuZWxlbWVudC5sb29wOyB9LFxyXG4gICAgICAgICAgICBcInNldFwiOiBmdW5jdGlvbih2KXtcclxuICAgICAgICAgICAgICAgIC8vIOODq+ODvOODl+OBjCBmYWxzZSDjga7nirbmhYvjgacgdHVyZSDjgYzmnaXjgZ/loLTlkIjjg6vjg7zjg5fnlKjplqLmlbDjgpLnmbvpjLLjgZnjgotcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnQubG9vcCAhPSB0cnVlICYmIHYgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiZW5kZWRcIiwgb25Mb29wRnVuYywgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8g6Zai5pWw44GM55m76Yyy44GV44KM44Gm44GE44GmIGZhbHNlIOOBjOioreWumuOBleOCjOOBn+WgtOWQiOODq+ODvOODl+eUqOmWouaVsOOCkuino+mZpOOBmeOCi1xyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5lbGVtZW50Lmxvb3AgPT0gdHJ1ZSAmJiB2ID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJlbmRlZFwiLCBvbkxvb3BGdW5jLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQubG9vcCA9IHY7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIOOCteODneODvOODiOOBl+OBpuOBhOOCi+aLoeW8teWtkFxyXG4gICAgICovXHJcbiAgICB0bS5zb3VuZC5Tb3VuZC5TVVBQT1JUX0VYVCA9IChmdW5jdGlvbigpe1xyXG4gICAgICAgIHZhciBleHQgICAgID0gXCJcIjtcclxuICAgICAgICB2YXIgYXVkaW8gICA9IG5ldyBBdWRpbygpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICAgICAgKGF1ZGlvLmNhblBsYXlUeXBlKFwiYXVkaW8vd2F2XCIpID09ICdtYXliZScpIHsgZXh0PVwid2F2XCI7IH1cclxuICAgICAgICBlbHNlIGlmIChhdWRpby5jYW5QbGF5VHlwZShcImF1ZGlvL21wM1wiKSA9PSAnbWF5YmUnKSB7IGV4dD1cIm1wM1wiOyB9XHJcbiAgICAgICAgZWxzZSBpZiAoYXVkaW8uY2FuUGxheVR5cGUoXCJhdWRpby9vZ2dcIikgPT0gJ21heWJlJykgeyBleHQ9XCJvZ2dcIjsgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBleHQ7XHJcbiAgICB9KSgpO1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG4vKlxyXG4gKiB3ZWJhdWRpby5qc1xyXG4gKi9cclxuXHJcbnRtLnNvdW5kID0gdG0uc291bmQgfHwge307XHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgdmFyIGNvbnRleHQgPSBudWxsO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLnNvdW5kLldlYkF1ZGlvXHJcbiAgICAgKiBXZWJBdWRpb+OCr+ODqeOCuVxyXG4gICAgICogQGV4dGVuZHMgdG0uZXZlbnQuRXZlbnREaXNwYXRjaGVyXHJcbiAgICAgKi9cclxuICAgIHRtLnNvdW5kLldlYkF1ZGlvID0gdG0uY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIHN1cGVyQ2xhc3M6IHRtLmV2ZW50LkV2ZW50RGlzcGF0Y2hlcixcclxuXHJcbiAgICAgICAgLyoqIGxvYWRlZCAqL1xyXG4gICAgICAgIGxvYWRlZDogZmFsc2UsXHJcbiAgICAgICAgLyoqIGNvbnRleHQgKi9cclxuICAgICAgICBjb250ZXh0OiBudWxsLFxyXG4gICAgICAgIC8qKiBwYW5uZXIgKi9cclxuICAgICAgICBwYW5uZXI6IG51bGwsXHJcbiAgICAgICAgLyoqIHZvbHVtZSAqL1xyXG4gICAgICAgIHZvbHVtZTogMC44LFxyXG4gICAgICAgIC8qKiBwbGF5aW5nICoqL1xyXG4gICAgICAgIHBsYXlpbmc6IGZhbHNlLFxyXG5cclxuICAgICAgICBfcGFubmVyRW5hYmxlZDogdHJ1ZSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oc3JjX29yX2J1ZmZlcikge1xyXG4gICAgICAgICAgICB0aGlzLnN1cGVySW5pdCgpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcclxuICAgICAgICAgICAgdmFyIHR5cGUgPSB0eXBlb2Yoc3JjX29yX2J1ZmZlcik7XHJcblxyXG4gICAgICAgICAgICBpZiAodHlwZT09PVwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubG9hZGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9sb2FkKHNyY19vcl9idWZmZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGU9PT1cIm9iamVjdFwiKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zZXR1cCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5idWZmZXIgPSBzcmNfb3JfYnVmZmVyO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KCB0bS5ldmVudC5FdmVudChcImxvYWRcIikgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NldHVwKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5YaN55SfXHJcbiAgICAgICAgICogLSBub3RlR3JhaW5PbiAuLi4gaHR0cDovL3d3dy5odG1sNXJvY2tzLmNvbS9lbi90dXRvcmlhbHMvY2FzZXN0dWRpZXMvbXVua2Fkb29fYm91bmN5bW91c2UvXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcGxheTogZnVuY3Rpb24odGltZSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5wbGF5aW5nID09IHRydWUpIHsgcmV0dXJuIDsgfVxyXG4gICAgICAgICAgICB0aGlzLnBsYXlpbmcgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRpbWUgPT09IHVuZGVmaW5lZCkgdGltZSA9IDA7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNvdXJjZS5zdGFydCh0aGlzLmNvbnRleHQuY3VycmVudFRpbWUgKyB0aW1lKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIHRpbWUgPSAodGhpcy5zb3VyY2UuYnVmZmVyLmR1cmF0aW9uL3RoaXMuc291cmNlLnBsYXliYWNrUmF0ZS52YWx1ZSkqMTAwMDtcclxuICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IHRtLmV2ZW50LkV2ZW50KFwiZW5kZWRcIik7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmZpcmUoZSk7XHJcbiAgICAgICAgICAgIH0sIHRpbWUpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5YGc5q2iXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc3RvcDogZnVuY3Rpb24odGltZSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5wbGF5aW5nID09IGZhbHNlKSB7IHJldHVybiA7IH1cclxuICAgICAgICAgICAgdGhpcy5wbGF5aW5nID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBpZiAodGltZSA9PT0gdW5kZWZpbmVkKSB0aW1lID0gMDtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc291cmNlLnBsYXliYWNrU3RhdGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnNvdXJjZS5zdG9wKHRoaXMuY29udGV4dC5jdXJyZW50VGltZSArIHRpbWUpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGJ1ZmZlciA9IHRoaXMuYnVmZmVyO1xyXG4gICAgICAgICAgICB2YXIgdm9sdW1lID0gdGhpcy52b2x1bWU7XHJcbiAgICAgICAgICAgIHZhciBsb29wICAgPSB0aGlzLmxvb3A7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNvdXJjZSA9IHRoaXMuY29udGV4dC5jcmVhdGVCdWZmZXJTb3VyY2UoKTtcclxuICAgICAgICAgICAgdGhpcy5zb3VyY2UuY29ubmVjdCh0aGlzLmdhaW5Ob2RlKTtcclxuICAgICAgICAgICAgdGhpcy5idWZmZXIgPSBidWZmZXI7XHJcbiAgICAgICAgICAgIHRoaXMudm9sdW1lID0gdm9sdW1lO1xyXG4gICAgICAgICAgICB0aGlzLmxvb3AgPSBsb29wO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog44Od44O844K6XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcGF1c2U6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLnNvdXJjZS5kaXNjb25uZWN0KCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg6zjgrjjg6Xjg7zjg6BcclxuICAgICAgICAgKi9cclxuICAgICAgICByZXN1bWU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLnNvdXJjZS5jb25uZWN0KHRoaXMuZ2Fpbk5vZGUpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6KSH6KO9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY2xvbmU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgd2ViQXVkaW8gPSB0bS5zb3VuZC5XZWJBdWRpbyh0aGlzLmJ1ZmZlcik7XHJcbiAgICAgICAgICAgIHdlYkF1ZGlvLnZvbHVtZSA9IHRoaXMudm9sdW1lO1xyXG4gICAgICAgICAgICByZXR1cm4gd2ViQXVkaW87XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBkdW1teVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFBvc2l0aW9uOiBmdW5jdGlvbih4LCB5LCB6KSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFubmVyLnNldFBvc2l0aW9uKHgsIHl8fDAsIHp8fDApO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBkdW1teVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFZlbG9jaXR5OiBmdW5jdGlvbih4LCB5LCB6KSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFubmVyLnNldFZlbG9jaXR5KHgsIHl8fDAsIHp8fDApO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBkdW1teVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldE9yaWVudGF0aW9uOiBmdW5jdGlvbih4LCB5LCB6KSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFubmVyLnNldE9yaWVudGF0aW9uKHgsIHl8fDAsIHp8fDApO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogZHVtbXlcclxuICAgICAgICAgKiDjg4Hjgqfjg7zjg7Pjg6Hjgr3jg4Pjg4nnlKhcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRCdWZmZXI6IGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgdGhpcy5idWZmZXIgPSB2O1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogZHVtbXlcclxuICAgICAgICAgKiDjg4Hjgqfjg7zjg7Pjg6Hjgr3jg4Pjg4nnlKhcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRMb29wOiBmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9vcCA9IHY7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBkdW1teVxyXG4gICAgICAgICAqIOODgeOCp+ODvOODs+ODoeOCveODg+ODieeUqFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldFZvbHVtZTogZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICB0aGlzLnZvbHVtZSA9IHY7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcblxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg4Hjgqfjg7zjg7Pjg6Hjgr3jg4Pjg4nnlKhcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRQbGF5YmFja1JhdGU6IGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgdGhpcy5wbGF5YmFja1JhdGUgPSB2O1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF9sb2FkOiBmdW5jdGlvbihzcmMpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmNvbnRleHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIuacrOeSsOWig+OBr1dlYkF1ZGlv5pyq5a++5b+c44Gn44GZ44CCKFwiICsgc3JjICsgXCIpXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIHRtLnV0aWwuQWpheC5sb2FkKHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IFwiR0VUXCIsXHJcbiAgICAgICAgICAgICAgICB1cmw6IHNyYyxcclxuICAgICAgICAgICAgICAgIHJlc3BvbnNlVHlwZTogXCJhcnJheWJ1ZmZlclwiLFxyXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoXCJXZWJBdWRpbyBhamF4IGxvYWQgc3VjY2Vzc1wiKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbnRleHQuZGVjb2RlQXVkaW9EYXRhKGRhdGEsIGZ1bmN0aW9uKGJ1ZmZlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmRlYnVnKFwiV2ViQXVkaW8gZGVjb2RlQXVkaW9EYXRhIHN1Y2Nlc3NcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3NldHVwKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYnVmZmVyID0gYnVmZmVyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxvYWRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCggdG0uZXZlbnQuRXZlbnQoXCJsb2FkXCIpICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIumfs+WjsOODleOCoeOCpOODq+OBruODh+OCs+ODvOODieOBq+WkseaVl+OBl+OBvuOBl+OBn+OAgihcIiArIHNyYyArIFwiKVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fc2V0dXAoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5idWZmZXIgPSBjb250ZXh0LmNyZWF0ZUJ1ZmZlcigxLCAxLCAyMjA1MCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubG9hZGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCB0bS5ldmVudC5FdmVudChcImxvYWRcIikgKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfc2V0dXA6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLnNvdXJjZSAgICAgPSB0aGlzLmNvbnRleHQuY3JlYXRlQnVmZmVyU291cmNlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuZ2Fpbk5vZGUgICA9IHRoaXMuY29udGV4dC5jcmVhdGVHYWluKCk7XHJcbiAgICAgICAgICAgIC8vIHRoaXMucGFubmVyICAgICA9IHRoaXMuY29udGV4dC5jcmVhdGVQYW5uZXIoKTtcclxuICAgICAgICAgICAgdGhpcy5hbmFseXNlciAgID0gdGhpcy5jb250ZXh0LmNyZWF0ZUFuYWx5c2VyKCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNvdXJjZS5jb25uZWN0KHRoaXMuZ2Fpbk5vZGUpO1xyXG4gICAgICAgICAgICAvLyB0aGlzLmdhaW5Ob2RlLmNvbm5lY3QodGhpcy5wYW5uZXIpO1xyXG4gICAgICAgICAgICAvLyB0aGlzLnBhbm5lci5jb25uZWN0KHRoaXMuYW5hbHlzZXIpO1xyXG4gICAgICAgICAgICB0aGlzLmdhaW5Ob2RlLmNvbm5lY3QodGhpcy5hbmFseXNlcik7XHJcbiAgICAgICAgICAgIHRoaXMuYW5hbHlzZXIuY29ubmVjdCh0aGlzLmNvbnRleHQuZGVzdGluYXRpb24pO1xyXG5cclxuICAgICAgICAgICAgLy8gVE9ETyDmmqvlrprnmoTlr77lv5xcclxuICAgICAgICAgICAgaWYgKHRtLkJST1dTRVIgPT09IFwiRmlyZWZveFwiKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhbm5lckVuYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOODiOODvOODs1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRvbmU6IGZ1bmN0aW9uKGhlcnR6LCBzZWNvbmRzKSB7XHJcbiAgICAgICAgICAgIC8vIGhhbmRsZSBwYXJhbWV0ZXJcclxuICAgICAgICAgICAgaGVydHogICA9IGhlcnR6ICE9PSB1bmRlZmluZWQgPyBoZXJ0eiA6IDIwMDtcclxuICAgICAgICAgICAgc2Vjb25kcyA9IHNlY29uZHMgIT09IHVuZGVmaW5lZCA/IHNlY29uZHMgOiAxO1xyXG4gICAgICAgICAgICAvLyBzZXQgZGVmYXVsdCB2YWx1ZVxyXG4gICAgICAgICAgICB2YXIgbkNoYW5uZWxzICAgPSAxO1xyXG4gICAgICAgICAgICB2YXIgc2FtcGxlUmF0ZSAgPSA0NDEwMDtcclxuICAgICAgICAgICAgdmFyIGFtcGxpdHVkZSAgID0gMjtcclxuICAgICAgICAgICAgLy8gY3JlYXRlIHRoZSBidWZmZXJcclxuICAgICAgICAgICAgdmFyIGJ1ZmZlciAgPSB0aGlzLmNvbnRleHQuY3JlYXRlQnVmZmVyKG5DaGFubmVscywgc2Vjb25kcypzYW1wbGVSYXRlLCBzYW1wbGVSYXRlKTtcclxuICAgICAgICAgICAgdmFyIGZBcnJheSAgPSBidWZmZXIuZ2V0Q2hhbm5lbERhdGEoMCk7XHJcbiAgICAgICAgICAgIC8vIGZpbGwgdGhlIGJ1ZmZlclxyXG4gICAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgZkFycmF5Lmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgICAgIHZhciB0aW1lICAgID0gaSAvIGJ1ZmZlci5zYW1wbGVSYXRlO1xyXG4gICAgICAgICAgICAgICAgdmFyIGFuZ2xlICAgPSBoZXJ0eiAqIHRpbWUgKiBNYXRoLlBJO1xyXG4gICAgICAgICAgICAgICAgZkFycmF5W2ldICAgPSBNYXRoLnNpbihhbmdsZSkqYW1wbGl0dWRlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIHNldCB0aGUgYnVmZmVyXHJcbiAgICAgICAgICAgIHRoaXMuYnVmZmVyID0gYnVmZmVyO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpczsgICAgLy8gZm9yIGNoYWluZWQgQVBJXHJcbiAgICAgICAgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGJ1ZmZlclxyXG4gICAgICog44OQ44OD44OV44Kh44O8XHJcbiAgICAgKi9cclxuICAgIHRtLnNvdW5kLldlYkF1ZGlvLnByb3RvdHlwZS5hY2Nlc3NvcihcImJ1ZmZlclwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpICB7IHJldHVybiB0aGlzLnNvdXJjZS5idWZmZXI7IH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbih2KSB7IHRoaXMuc291cmNlLmJ1ZmZlciA9IHY7IH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHByb3BlcnR5ICAgIGxvb3BcclxuICAgICAqIOODq+ODvOODl+ODleODqeOCsFxyXG4gICAgICovXHJcbiAgICB0bS5zb3VuZC5XZWJBdWRpby5wcm90b3R5cGUuYWNjZXNzb3IoXCJsb29wXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgIHsgcmV0dXJuIHRoaXMuc291cmNlLmxvb3A7IH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbih2KSB7IHRoaXMuc291cmNlLmxvb3AgPSB2OyB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICB2YWx1bWVcclxuICAgICAqIOODnOODquODpeODvOODoFxyXG4gICAgICovXHJcbiAgICB0bS5zb3VuZC5XZWJBdWRpby5wcm90b3R5cGUuYWNjZXNzb3IoXCJ2b2x1bWVcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24oKSAgeyByZXR1cm4gdGhpcy5nYWluTm9kZS5nYWluLnZhbHVlOyB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24odikgeyB0aGlzLmdhaW5Ob2RlLmdhaW4udmFsdWUgPSB2OyB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBwbGF5YmFja1JhdGVcclxuICAgICAqIOODl+ODrOOCpOODkOODg+OCr+ODrOODvOODiFxyXG4gICAgICovXHJcbiAgICB0bS5zb3VuZC5XZWJBdWRpby5wcm90b3R5cGUuYWNjZXNzb3IoXCJwbGF5YmFja1JhdGVcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24oKSAgeyByZXR1cm4gdGhpcy5zb3VyY2UucGxheWJhY2tSYXRlLnZhbHVlOyB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24odikgeyB0aGlzLnNvdXJjZS5wbGF5YmFja1JhdGUudmFsdWUgPSB2OyB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBwYW5uZXJFbmFibGVkXHJcbiAgICAgKiBwYW5uZXLmnInlirlcclxuICAgICAqL1xyXG4gICAgdG0uc291bmQuV2ViQXVkaW8ucHJvdG90eXBlLmFjY2Vzc29yKFwicGFubmVyRW5hYmxlZFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpICB7IHJldHVybiB0aGlzLl9wYW5uZXJFbmFibGVkOyB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICB0aGlzLmdhaW5Ob2RlLmRpc2Nvbm5lY3QoKTtcclxuICAgICAgICAgICAgdGhpcy5wYW5uZXIuZGlzY29ubmVjdCgpO1xyXG4gICAgICAgICAgICBpZiAodikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nYWluTm9kZS5jb25uZWN0KHRoaXMucGFubmVyKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFubmVyLmNvbm5lY3QodGhpcy5hbmFseXNlcik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdhaW5Ob2RlLmNvbm5lY3QodGhpcy5hbmFseXNlcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5fcGFubmVyRW5hYmxlZCA9IHY7XHJcblxyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmRlYnVnKFwiV2ViQXVkaW8gcGFubmVyRW5hYmxlZDogXCIgKyB2KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBsb29wU3RhcnRcclxuICAgICAqIOODq+ODvOODl+mWi+Wni+S9jee9ru+8iOenku+8iVxyXG4gICAgICovXHJcbiAgICB0bS5zb3VuZC5XZWJBdWRpby5wcm90b3R5cGUuYWNjZXNzb3IoXCJsb29wU3RhcnRcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24oKSAgeyByZXR1cm4gdGhpcy5zb3VyY2UubG9vcFN0YXJ0OyB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24odikgeyB0aGlzLnNvdXJjZS5sb29wU3RhcnQgPSB2OyB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBwcm9wZXJ0eSAgICBsb29wRW5kXHJcbiAgICAgKiDjg6vjg7zjg5fntYLkuobkvY3nva7vvIjnp5LvvIlcclxuICAgICAqL1xyXG4gICAgdG0uc291bmQuV2ViQXVkaW8ucHJvdG90eXBlLmFjY2Vzc29yKFwibG9vcEVuZFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpICB7IHJldHVybiB0aGlzLnNvdXJjZS5sb29wRW5kOyB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24odikgeyB0aGlzLnNvdXJjZS5sb29wRW5kID0gdjsgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLyoqIEBzdGF0aWMgQHByb3BlcnR5ICovXHJcbiAgICB0bS5zb3VuZC5XZWJBdWRpby5pc0F2YWlsYWJsZSA9ICh0bS5nbG9iYWwuQXVkaW9Db250ZXh0IHx8IHRtLmdsb2JhbC53ZWJraXRBdWRpb0NvbnRleHQgfHwgdG0uZ2xvYmFsLm1vekF1ZGlvQ29udGV4dCkgPyB0cnVlIDogZmFsc2U7XHJcblxyXG4gICAgdG0uc291bmQuV2ViQXVkaW8uY3JlYXRlQ29udGV4dCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICh0bS5nbG9iYWwuQXVkaW9Db250ZXh0KSB7XHJcbiAgICAgICAgICAgIGNvbnRleHQgPSBuZXcgQXVkaW9Db250ZXh0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHRtLmdsb2JhbC53ZWJraXRBdWRpb0NvbnRleHQpIHtcclxuICAgICAgICAgICAgY29udGV4dCA9IG5ldyB3ZWJraXRBdWRpb0NvbnRleHQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodG0uZ2xvYmFsLm1vekF1ZGlvQ29udGV4dCkge1xyXG4gICAgICAgICAgICBjb250ZXh0ID0gbmV3IG1vekF1ZGlvQ29udGV4dCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdG0uc291bmQuV2ViQXVkaW8uY29udGV4dCA9IGNvbnRleHQ7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogaU9T44GnV2ViQXVkaW/jgpLkvb/jgYbloLTlkIjjgIF3aW5kb3cub250b3VjaGVuZOetieOBp+OBk+OBrumWouaVsOOCkuWun+ihjOOBmeOCi1xyXG4gICAgICovXHJcbiAgICB0bS5zb3VuZC5XZWJBdWRpby51bmxvY2sgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgdW5sb2NrQnVmZmVyID0gY29udGV4dC5jcmVhdGVCdWZmZXIoMSwgMSwgMjIwNTApO1xyXG4gICAgICAgIHZhciB1bmxvY2tTcmMgPSBjb250ZXh0LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpO1xyXG4gICAgICAgIHVubG9ja1NyYy5idWZmZXIgPSB1bmxvY2tCdWZmZXI7XHJcbiAgICAgICAgdW5sb2NrU3JjLmNvbm5lY3QoY29udGV4dC5kZXN0aW5hdGlvbik7XHJcbiAgICAgICAgdW5sb2NrU3JjLnN0YXJ0KDApO1xyXG4gICAgfTtcclxuXHJcbiAgICB0bS5zb3VuZC5XZWJBdWRpby5jcmVhdGVDb250ZXh0KCk7XHJcbn0pKCk7XHJcblxyXG5cclxuXHJcblxyXG4vKlxyXG4gKiBzb3VuZG1hbmFnZXIuanNcclxuICovXHJcblxyXG47KGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIC8qXHJcbiAgICAgKiB0bS5zb3VuZC5Tb3VuZE1hbmFnZXJcclxuICAgICAqICMjIyBSZWZcclxuICAgICAqIC0gaHR0cDovL2V2b2x2ZS5yZWludHJvZHVjaW5nLmNvbS9fc291cmNlL2NsYXNzZXMvYXMzL1NvdW5kTWFuYWdlci9Tb3VuZE1hbmFnZXIuaHRtbFxyXG4gICAgICogLSBodHRwczovL2dpdGh1Yi5jb20vbmlja2xvY2t3b29kL1NvdW5kTWFuYWdlclxyXG4gICAgICovXHJcbiAgICB0bS5zb3VuZC5Tb3VuZE1hbmFnZXIgPSB7XHJcbiAgICAgICAgdm9sdW1lOiAwLjgsXHJcbiAgICAgICAgbXVzaWNWb2x1bWU6IDAuOCxcclxuICAgICAgICBtdXRlRmxhZzogZmFsc2UsXHJcbiAgICAgICAgY3VycmVudE11c2ljOiBudWxsLFxyXG5cclxuICAgICAgICAvKlxyXG4gICAgICAgICAqIOWGjeeUn1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHBsYXk6IGZ1bmN0aW9uKG5hbWUsIHZvbHVtZSwgc3RhcnRUaW1lLCBsb29wKSB7XHJcbiAgICAgICAgICAgIHZhciBvcmlnaW4gPSB0bS5hc3NldC5NYW5hZ2VyLmdldChuYW1lKTtcclxuICAgICAgICAgICAgaWYgKG9yaWdpbiA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ25vdCBmb3VuZCAnICsgbmFtZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBzb3VuZCA9IG9yaWdpbi5jbG9uZSgpO1xyXG5cclxuICAgICAgICAgICAgc291bmQudm9sdW1lID0gdGhpcy5nZXRWb2x1bWUoKTtcclxuICAgICAgICAgICAgc291bmQucGxheSgpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHNvdW5kO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc3RvcDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcGF1c2U6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyBUT0RPOiBcclxuICAgICAgICB9LFxyXG4gICAgICAgIGZhZGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyBUT0RPOiBcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldFZvbHVtZTogZnVuY3Rpb24odm9sdW1lKSB7XHJcbiAgICAgICAgICAgIHRoaXMudm9sdW1lID0gdm9sdW1lO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2V0Vm9sdW1lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXNNdXRlKCkgPyAwIDogdGhpcy52b2x1bWU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKlxyXG4gICAgICAgICAqIOODn+ODpeODvOODiCh0b2dnbGUpXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbXV0ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMubXV0ZUZsYWcgPSAodGhpcy5tdXRlRmxhZyA9PT0gdHJ1ZSkgPyBmYWxzZSA6IHRydWU7XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50TXVzaWMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudE11c2ljLnZvbHVtZSA9IHRoaXMuZ2V0Vm9sdW1lTXVzaWMoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBpc011dGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tdXRlRmxhZztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKlxyXG4gICAgICAgICAqIOmfs+alveOCkuWGjeeUn1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHBsYXlNdXNpYzogZnVuY3Rpb24obmFtZSwgZmFkZVRpbWUsIGxvb3ApIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudE11c2ljKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BNdXNpYyhmYWRlVGltZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBvcmlnaW4gPSB0bS5hc3NldC5NYW5hZ2VyLmdldChuYW1lKTtcclxuICAgICAgICAgICAgaWYgKG9yaWdpbiA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ25vdCBmb3VuZCAnICsgbmFtZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBtdXNpYyA9IG9yaWdpbi5jbG9uZSgpO1xyXG5cclxuICAgICAgICAgICAgbXVzaWMuc2V0TG9vcCh0cnVlKTtcclxuICAgICAgICAgICAgbXVzaWMudm9sdW1lID0gdGhpcy5nZXRWb2x1bWVNdXNpYygpO1xyXG4gICAgICAgICAgICBtdXNpYy5wbGF5KCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoZmFkZVRpbWUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY291bnQgPSAzMjtcclxuICAgICAgICAgICAgICAgIHZhciBjb3VudGVyID0gMDtcclxuICAgICAgICAgICAgICAgIHZhciB1bml0VGltZSA9IGZhZGVUaW1lL2NvdW50O1xyXG4gICAgICAgICAgICAgICAgdmFyIHZvbHVtZSA9IHRoaXMuZ2V0Vm9sdW1lTXVzaWMoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBtdXNpYy52b2x1bWUgPSAwO1xyXG4gICAgICAgICAgICAgICAgdmFyIGlkID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY291bnRlciArPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByYXRlID0gY291bnRlci9jb3VudDtcclxuICAgICAgICAgICAgICAgICAgICBtdXNpYy52b2x1bWUgPSByYXRlKnZvbHVtZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJhdGUgPj0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGlkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICB9LCB1bml0VGltZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBtdXNpYy52b2x1bWUgPSB0aGlzLmdldFZvbHVtZU11c2ljKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudE11c2ljID0gbXVzaWM7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50TXVzaWM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLypcclxuICAgICAgICAgKiDpn7Pmpb3jgpLlgZzmraJcclxuICAgICAgICAgKi9cclxuICAgICAgICBzdG9wTXVzaWM6IGZ1bmN0aW9uKGZhZGVUaW1lKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5jdXJyZW50TXVzaWMpIHsgcmV0dXJuIDsgfVxyXG5cclxuICAgICAgICAgICAgdmFyIG11c2ljID0gdGhpcy5jdXJyZW50TXVzaWM7XHJcblxyXG4gICAgICAgICAgICBpZiAoZmFkZVRpbWUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY291bnQgPSAzMjtcclxuICAgICAgICAgICAgICAgIHZhciBjb3VudGVyID0gMDtcclxuICAgICAgICAgICAgICAgIHZhciB1bml0VGltZSA9IGZhZGVUaW1lL2NvdW50O1xyXG4gICAgICAgICAgICAgICAgdmFyIHZvbHVtZSA9IHRoaXMuZ2V0Vm9sdW1lTXVzaWMoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBtdXNpYy52b2x1bWUgPSAwO1xyXG4gICAgICAgICAgICAgICAgdmFyIGlkID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY291bnRlciArPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByYXRlID0gY291bnRlci9jb3VudDtcclxuICAgICAgICAgICAgICAgICAgICBtdXNpYy52b2x1bWUgPSB2b2x1bWUqKDEtcmF0ZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyYXRlID49IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbXVzaWMuc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGlkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICB9LCB1bml0VGltZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRNdXNpYy5zdG9wKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qXHJcbiAgICAgICAgICog6Z+z5qW944KS5LiA5pmC5YGc5q2iXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcGF1c2VNdXNpYzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5jdXJyZW50TXVzaWMpIHsgcmV0dXJuIDsgfVxyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRNdXNpYy5wYXVzZSgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLypcclxuICAgICAgICAgKiDpn7Pmpb3jgpLlho3plotcclxuICAgICAgICAgKi9cclxuICAgICAgICByZXN1bWVNdXNpYzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5jdXJyZW50TXVzaWMpIHsgcmV0dXJuIDsgfVxyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRNdXNpYy5yZXN1bWUoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qXHJcbiAgICAgICAgICog6Z+z5qW944Gu44Oc44Oq44Ol44O844Og44KS6Kit5a6aXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0Vm9sdW1lTXVzaWM6IGZ1bmN0aW9uKHZvbHVtZSkge1xyXG4gICAgICAgICAgICB0aGlzLm11c2ljVm9sdW1lID0gdm9sdW1lO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50TXVzaWMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudE11c2ljLnZvbHVtZSA9IHZvbHVtZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKlxyXG4gICAgICAgICAqIOmfs+alveOBruODnOODquODpeODvOODoOOCkuWPluW+l1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldFZvbHVtZU11c2ljOiBmdW5jdGlvbih2b2x1bWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXNNdXRlKCkgPyAwIDogdGhpcy5tdXNpY1ZvbHVtZTtcclxuICAgICAgICB9LFxyXG4gICAgfTtcclxuXHJcbn0pKCk7XHJcblxyXG5cclxuLypcclxuICogdHdpdHRlci5qc1xyXG4gKi9cclxuXHJcbnRtLnNvY2lhbCA9IHRtLnNvY2lhbCB8fCB7fTtcclxuXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIHRtLnNvY2lhbC5Ud2l0dGVyXHJcbiAgICAgKiDjg4TjgqTjg4Pjgr/jg7zplqLpgKPjg43jg7zjg6Djgrnjg5rjg7zjgrlcclxuICAgICAqL1xyXG4gICAgdG0uc29jaWFsLlR3aXR0ZXIgPSB0bS5zb2NpYWwuVHdpdHRlciB8fCB7fTtcclxuICAgIFxyXG4gICAgdG0uc29jaWFsLlR3aXR0ZXIuQVBJX1VSTCA9IFwiaHR0cDovL2FwaS50d2l0dGVyLmNvbS8xXCI7ICAgIC8vIHZlcnNpb24gMSDjga/lu4PmraLkuojlrprjgonjgZfjgYRcclxuICAgIHZhciBCQVNFX1VSTCA9IFwiaHR0cDovL3R3aXR0ZXIuY29tL2ludGVudFwiO1xyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBtZW1iZXIgICAgICB0bS5zb2NpYWwuVHdpdHRlclxyXG4gICAgICogVHdlZXQg44GZ44KLXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gcHJvcFxyXG4gICAgICogIyMjIFJlZmVyZW5jZVxyXG4gICAgICogLSA8aHR0cHM6Ly9kZXYudHdpdHRlci5jb20vZG9jcy9pbnRlbnRzPlxyXG4gICAgICogIyMjIEV4YW1wbGVcclxuICAgICAqICAgICAgdG0uc29jaWFsLlR3aXR0ZXIuY3JlYXRlVVJMKHtcclxuICAgICAqICAgICAgICAgIHR5cGUgICAgICAgIDogXCJ0d2VldFwiLCAgICAgICAgICAgICAgLy8g44K/44Kk44OXKHR3ZWV0L3JldHdlZXQvZmF2b3JpdGUvdXNlcilcclxuICAgICAqICAgICAgICAgIHR3ZWV0X2lkICAgIDogXCIyMTAyMTk0ODM5NTkyNjMyMzJcIiwgLy8g5a++6LGh44Go44Gq44KLIFR3ZWV0XHJcbiAgICAgKiAgICAgICAgICBpbl9yZXBseV90byA6IFwiMjEwMjE5NDgzOTU5MjYzMjMyXCIsIC8vIOi/lOS/oeOBmeOCi+WvvuixoeOBqOOBquOCiyBUd2VldFxyXG4gICAgICogICAgICAgICAgdGV4dCAgICAgICAgOiBcIlRlc3RcIiwgICAgICAgICAgICAgICAvLyDjg4bjgq3jgrnjg4hcclxuICAgICAqICAgICAgICAgIHNjcmVlbl9uYW1lIDogXCJwaGlfanBcIiwgICAgICAgICAgICAgLy8g44K544Kv44Oq44O844Oz44ON44O844OgXHJcbiAgICAgKiAgICAgICAgICBoYXNodGFncyAgICA6IFwiamF2YXNjcmlwdCx0bWxpYmpzXCIsIC8vIOODj+ODg+OCt+ODpeOCv+OCsFxyXG4gICAgICogICAgICAgICAgdXJsICAgICAgICAgOiBcImh0dHA6Ly90bWxpZmUubmV0XCIsICAvLyB1cmxcclxuICAgICAqICAgICAgICAgIHZpYSAgICAgICAgIDogXCJwaGlfanBcIiwgICAgICAgICAgICAgLy8g772e44GL44KJXHJcbiAgICAgKiAgICAgICAgICByZWxhdGVkICAgICA6IFwidG1saWIuanMgdG1saWZlXCIsICAgIC8vIOmWoumAo+ODr+ODvOODiVxyXG4gICAgICogICAgICB9KTtcclxuICAgICAqL1xyXG4gICAgdG0uc29jaWFsLlR3aXR0ZXIuY3JlYXRlVVJMID0gZnVuY3Rpb24ocHJvcCkge1xyXG4gICAgICAgIHZhciBwYXJhbV9zdHJpbmdfbGlzdCA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGtleSBpbiBwcm9wKSB7XHJcbiAgICAgICAgICAgIGlmIChrZXkgPT0gXCJ0eXBlXCIpIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBlbmNvZGVVUklDb21wb25lbnQocHJvcFtrZXldKTtcclxuICAgICAgICAgICAgdmFyIHBhcmFtX3N0cmluZyA9IGtleStcIj1cIit2YWx1ZTtcclxuICAgICAgICAgICAgcGFyYW1fc3RyaW5nX2xpc3QucHVzaChwYXJhbV9zdHJpbmcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICB2YXIgdXJsID0gXCJ7YmFzZVVSTH0ve3R5cGV9P3twYXJhbX1cIi5mb3JtYXQoe1xyXG4gICAgICAgICAgICBiYXNlVVJMIDogQkFTRV9VUkwsXHJcbiAgICAgICAgICAgIHR5cGUgICAgOiBwcm9wLnR5cGUsXHJcbiAgICAgICAgICAgIHBhcmFtICAgOiBwYXJhbV9zdHJpbmdfbGlzdC5qb2luKCcmJyksXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHVybDtcclxuICAgIH07XHJcbiAgICBcclxuICAgIFxyXG59KSgpO1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICB2YXIgQkFTRV9VUkwgPSBcImh0dHA6Ly9hcGkudHdpdHRlci5jb20vMS97dHlwZX0ve2tpbmR9Lmpzb25cIjtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBtZW1iZXIgICAgICB0bS5zb2NpYWwuVHdpdHRlclxyXG4gICAgICovXHJcbiAgICB0bS5zb2NpYWwuVHdpdHRlci5hcGkgPSBmdW5jdGlvbih0eXBlLCBraW5kLCBwYXJhbSwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgdXJsID0gQkFTRV9VUkwuZm9ybWF0KHsgdHlwZTp0eXBlLCBraW5kOmtpbmQgfSk7XHJcbiAgICAgICAgdmFyIHFzICA9IHRtLnV0aWwuUXVlcnlTdHJpbmcuc3RyaW5naWZ5KHBhcmFtKTtcclxuICAgICAgICBcclxuICAgICAgICB0bS51dGlsLkFqYXgubG9hZEpTT05QKHVybCArIFwiP1wiICsgcXMsIGNhbGxiYWNrKTtcclxuICAgIH07XHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICB2YXIgQkFTRV9VUkwgPSBcImh0dHA6Ly9zZWFyY2gudHdpdHRlci5jb20vc2VhcmNoLmpzb25cIjtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBtZW1iZXIgICAgICB0bS5zb2NpYWwuVHdpdHRlclxyXG4gICAgICovXHJcbiAgICB0bS5zb2NpYWwuVHdpdHRlci5zZWFyY2ggPSBmdW5jdGlvbihwYXJhbSwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgdXJsID0gQkFTRV9VUkw7XHJcbiAgICAgICAgdmFyIHFzICA9IHRtLnV0aWwuUXVlcnlTdHJpbmcuc3RyaW5naWZ5KHBhcmFtKTtcclxuICAgICAgICBcclxuICAgICAgICB0bS51dGlsLkFqYXgubG9hZEpTT05QKHVybCArIFwiP1wiICsgcXMsIGNhbGxiYWNrKTtcclxuICAgIH07XHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIC8qXHJcbiAgICAgKiBmb3JtYXQgPSB4bWwgb3IganNvblxyXG4gICAgICovXHJcbiAgICB2YXIgQkFTRV9VUkwgPSBcImh0dHA6Ly9hcGkudHdpdHRlci5jb20vMS9zdGF0dXNlcy9mb2xsb3dlcnMuanNvblwiO1xyXG4gICAgLy9odHRwOi8vYXBpLnR3aXR0ZXIuY29tLzEvc3RhdHVzZXMvZm9sbG93ZXJzLmpzb24/aWQ9dG1saWZlX2pwXHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQG1lbWJlciAgICAgIHRtLnNvY2lhbC5Ud2l0dGVyXHJcbiAgICAgKiBcclxuICAgICAqIHVzZXJfaWQgICAgICDjg6bjg7zjgrbjg7xJRFxyXG4gICAgICogc2NyZWVuX25hbWUgIHNjcmVlbl9uYW1lXHJcbiAgICAgKiBjdXJzb3IgICAgICAgLTEg44KS5oyH5a6a44GZ44KL44Go5YWI6aCt44GL44KJIDEwMFxyXG4gICAgICogaW5jbHVkZV9lbnRpdGllcyAgICAgdHJ1ZSDjgpLmjIflrprjgZnjgovjgaggZW50aXRpZXMg44KS5Y+W5b6X44Gn44GN44KLXHJcbiAgICAgKiBcclxuICAgICAqL1xyXG4gICAgdG0uc29jaWFsLlR3aXR0ZXIuZ2V0Rm9sbG93ZXJzID0gZnVuY3Rpb24ocGFyYW0sIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdG0uc29jaWFsLlR3aXR0ZXIuYXBpKFwic3RhdHVzZXNcIiwgXCJmb2xsb3dlcnNcIiwgcGFyYW0sIGNhbGxiYWNrKTtcclxuICAgICAgICBcclxuICAgICAgICAvKlxyXG4gICAgICAgIHRtLnNvY2lhbC5Ud2l0dGVyLmFwaShcInN0YXR1c2VzXCIsIFwicHVibGljX3RpbWVsaW5lXCIsIHBhcmFtLCBjYWxsYmFjayk7XHJcbiAgICAgICAgdG0uc29jaWFsLlR3aXR0ZXIuYXBpKFwic3RhdHVzZXNcIiwgXCJob21lX3RpbWVsaW5lXCIsIHBhcmFtLCBjYWxsYmFjayk7XHJcbiAgICAgICAgdG0uc29jaWFsLlR3aXR0ZXIuYXBpKFwic3RhdHVzZXNcIiwgXCJmcmllbmRzX3RpbWVsaW5lXCIsIHBhcmFtLCBjYWxsYmFjayk7XHJcbiAgICAgICAgdG0uc29jaWFsLlR3aXR0ZXIuYXBpKFwic3RhdHVzZXNcIiwgXCJ1c2VyX3RpbWVsaW5lXCIsIHBhcmFtLCBjYWxsYmFjayk7XHJcbiAgICAgICAgdG0uc29jaWFsLlR3aXR0ZXIuYXBpKFwic3RhdHVzZXNcIiwgXCJyZXBsaWVzXCIsIHBhcmFtLCBjYWxsYmFjayk7XHJcbiAgICAgICAgdG0uc29jaWFsLlR3aXR0ZXIuYXBpKFwic3RhdHVzZXNcIiwgXCJtZW50aW9uc1wiLCBwYXJhbSwgY2FsbGJhY2spO1xyXG4gICAgICAgICovXHJcbiAgICB9O1xyXG4gICAgXHJcbn0pKCk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4vKlxyXG4gKiBuaW5lbGVhcC5qc1xyXG4gKi9cclxuXHJcbnRtLnNvY2lhbCA9IHRtLnNvY2lhbCB8fCB7fTtcclxuXHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uc29jaWFsLk5pbmVMZWFwXHJcbiAgICAgKiA5bGVhcCDjg43jg7zjg6Djgrnjg5rjg7zjgrlcclxuICAgICAqL1xyXG4gICAgdG0uc29jaWFsLk5pbmVsZWFwID0gdG0uc29jaWFsLk5pbmVsZWFwIHx8IHt9O1xyXG5cclxuICAgIHZhciBCQVNFX1VSTCA9IFwiaHR0cDovLzlsZWFwLm5ldC9nYW1lcy97aWR9L3Jlc3VsdD9zY29yZT17c2NvcmV9JnJlc3VsdD17cmVzdWx0fVwiO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQG1lbWJlciAgICAgIHRtLnNvY2lhbC5OaW5lbGVhcFxyXG4gICAgICovXHJcbiAgICB0bS5zb2NpYWwuTmluZWxlYXAuREVCVUdfR0FNRV9JRCA9IFwiMFwiO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQG1lbWJlciAgICAgIHRtLnNvY2lhbC5OaW5lbGVhcFxyXG4gICAgICogQG1ldGhvZCAgICAgIGNyZWF0ZVVSTFxyXG4gICAgICogOWxlYXAg55So44GuIFVSTCDjgpLnlJ/miJBcclxuICAgICAqL1xyXG4gICAgdG0uc29jaWFsLk5pbmVsZWFwLmNyZWF0ZVVSTCA9IGZ1bmN0aW9uKGlkLCBzY29yZSwgcmVzdWx0KSB7XHJcbiAgICAgICAgcmV0dXJuIEJBU0VfVVJMLmZvcm1hdCh7XHJcbiAgICAgICAgICAgIGlkICAgICAgOiBpZCxcclxuICAgICAgICAgICAgc2NvcmUgICA6IHNjb3JlLFxyXG4gICAgICAgICAgICByZXN1bHQgIDogcmVzdWx0XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQG1lbWJlciAgICAgIHRtLnNvY2lhbC5OaW5lbGVhcFxyXG4gICAgICogQG1ldGhvZCAgICAgIHBvc3RSYW5raW5nXHJcbiAgICAgKiA5bGVhcCDjgafjg6njg7Pjgq3jg7PjgrDjgpIgUE9TVFxyXG4gICAgICovXHJcbiAgICB0bS5zb2NpYWwuTmluZWxlYXAucG9zdFJhbmtpbmcgPSBmdW5jdGlvbihzY29yZSwgcmVzdWx0KSB7XHJcbiAgICAgICAgaWYgKGxvY2F0aW9uLmhvc3RuYW1lID09ICdyLmpzZ2FtZXMuanAnKSB7XHJcbiAgICAgICAgICAgIHZhciBpZCA9IGxvY2F0aW9uLnBhdGhuYW1lLm1hdGNoKC9eXFwvZ2FtZXNcXC8oXFxkKykvKVsxXTtcclxuICAgICAgICAgICAgbG9jYXRpb24ucmVwbGFjZSggdGhpcy5jcmVhdGVVUkwoaWQsIHNjb3JlLCByZXN1bHQpICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXCI5bGVhcCDjgavmipXnqL/jgZXjgozjgabjgYTjgb7jgZvjgpMhXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAbWVtYmVyICAgICAgdG0uc29jaWFsLk5pbmVsZWFwXHJcbiAgICAgKiBAbWV0aG9kICAgICAgZ290b0xvZ2luXHJcbiAgICAgKiA5bGVhcOODreOCsOOCpOODs+ODmuODvOOCuOODmOmBt+enu+OBmeOCiy5cclxuICAgICAqL1xyXG4gICAgdG0uc29jaWFsLk5pbmVsZWFwLmdvdG9Mb2dpbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKFwiaHR0cDovLzlsZWFwLm5ldC9hcGkvbG9naW5cIik7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQG1lbWJlciAgICAgIHRtLnNvY2lhbC5OaW5lbGVhcFxyXG4gICAgICogQG1ldGhvZCAgICAgIGlzT245bGVhcFxyXG4gICAgICog44Ki44OX44Oq44Kx44O844K344On44Oz44GMOWxlYXDkuIrjgavjg4fjg5fjg63jgqTjgZXjgozjgabjgYTjgovjgYtcclxuICAgICAqL1xyXG4gICAgdG0uc29jaWFsLk5pbmVsZWFwLmlzT245bGVhcCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUgPT09IFwici5qc2dhbWVzLmpwXCI7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQG1lbWJlciAgICAgIHRtLnNvY2lhbC5OaW5lbGVhcFxyXG4gICAgICogQG1ldGhvZCAgICAgIGdldEdhbWVJZFxyXG4gICAgICogOWxlYXDjga7jgrLjg7zjg6BJROOCkuWPluW+l+OBmeOCi1xyXG4gICAgICovXHJcbiAgICB0bS5zb2NpYWwuTmluZWxlYXAuZ2V0R2FtZUlkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHRtLnNvY2lhbC5OaW5lbGVhcC5pc09uOWxlYXAoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLm1hdGNoKC9eXFwvZ2FtZXNcXC8oXFxkKykvKVsxXTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdG0uc29jaWFsLk5pbmVsZWFwLkRFQlVHX0dBTUVfSUQ7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBtZW1iZXIgICAgICB0bS5zb2NpYWwuTmluZWxlYXBcclxuICAgICAqIEBtZXRob2QgICAgICBnZXRNeURhdGFcclxuICAgICAqIOODl+ODrOOCpOODpOODvOOBruOCsuODvOODoOODh+ODvOOCv+OCkuWPluW+l+OBmeOCi1xyXG4gICAgICovXHJcbiAgICB0bS5zb2NpYWwuTmluZWxlYXAuZ2V0TXlEYXRhID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcclxuICAgICAgICB0bS51dGlsLkFqYXgubG9hZEpTT05QKHRtLnNvY2lhbC5OaW5lbGVhcC5jcmVhdGVNeURhdGFVUkwoKSwgY2FsbGJhY2spO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBtZW1iZXIgICAgICB0bS5zb2NpYWwuTmluZWxlYXBcclxuICAgICAqIEBtZXRob2QgICAgICBwb3N0TXlEYXRhXHJcbiAgICAgKiDjg5fjg6zjgqTjg6Tjg7zjga7jgrLjg7zjg6Djg4fjg7zjgr/jgpLkv53lrZjjgZnjgotcclxuICAgICAqL1xyXG4gICAgdG0uc29jaWFsLk5pbmVsZWFwLnBvc3RNeURhdGEgPSBmdW5jdGlvbihkYXRhLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHRtLnV0aWwuQWpheC5sb2FkKHtcclxuICAgICAgICAgICAgdHlwZTogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgIHVybDogdG0uc29jaWFsLk5pbmVsZWFwLmNyZWF0ZU1lbW9yeVVSTChcInVzZXJfbWVtb3J5Lmpzb25cIiksXHJcbiAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcclxuICAgICAgICAgICAgZGF0YTogXCJqc29uPVwiICsgSlNPTi5zdHJpbmdpZnkoZGF0YSksXHJcbiAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDtjaGFyc2V0PVVURi04XCIsXHJcbiAgICAgICAgICAgIGFzeW5jOiBmYWxzZSxcclxuICAgICAgICAgICAgYmVmb3JlU2VuZDogZnVuY3Rpb24oeGhyKSB7XHJcbiAgICAgICAgICAgICAgICB4aHIud2l0aENyZWRlbnRpYWxzID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc3VjY2VzczogY2FsbGJhY2ssXHJcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXNwb25zZVRleHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IocmVzcG9uc2VUZXh0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBtZW1iZXIgICAgICB0bS5zb2NpYWwuTmluZWxlYXBcclxuICAgICAqIEBtZXRob2QgICAgICBjcmVhdGVNZW1vcnlVUkxcclxuICAgICAqIDlsZWFwIE1lbW9yeSBBUEkg44G444Ki44Kv44K744K544GZ44KLVVJM44KS55Sf5oiQXHJcbiAgICAgKi9cclxuICAgIHRtLnNvY2lhbC5OaW5lbGVhcC5jcmVhdGVNZW1vcnlVUkwgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgdXJsID0gW1xyXG4gICAgICAgICAgICBcImh0dHA6Ly85bGVhcC5uZXQvYXBpL21lbW9yeS9cIixcclxuICAgICAgICAgICAgdG0uc29jaWFsLk5pbmVsZWFwLmdldEdhbWVJZCgpICsgXCIvXCIsXHJcbiAgICAgICAgXTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHVybC5wdXNoKGFyZ3VtZW50c1tpXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdXJsLmpvaW4oXCJcIik7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAbWVtYmVyICAgICAgdG0uc29jaWFsLk5pbmVsZWFwXHJcbiAgICAgKiBAbWV0aG9kICAgICAgY3JlYXRlTXlEYXRhVVJMXHJcbiAgICAgKiDjg6bjg7zjgrbjg4fjg7zjgr9VUkzjgpLnlJ/miJBcclxuICAgICAqL1xyXG4gICAgdG0uc29jaWFsLk5pbmVsZWFwLmNyZWF0ZU15RGF0YVVSTCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0bS5zb2NpYWwuTmluZWxlYXAuY3JlYXRlTWVtb3J5VVJMKFwidXNlcl9tZW1vcnkuanNvblwiKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEBtZW1iZXIgICAgICB0bS5zb2NpYWwuTmluZWxlYXBcclxuICAgICAqIEBtZXRob2QgICAgICBjcmVhdGVVc2VyRGF0YVVSTFxyXG4gICAgICog5LuW44Gu44Om44O844K244Gu44OX44Os44Kk44OH44O844K/VVJM44KS55Sf5oiQXHJcbiAgICAgKi9cclxuICAgIHRtLnNvY2lhbC5OaW5lbGVhcC5jcmVhdGVVc2VyRGF0YVVSTCA9IGZ1bmN0aW9uKHNjcmVlbk5hbWUpIHtcclxuICAgICAgICByZXR1cm4gdG0uc29jaWFsLk5pbmVsZWFwLmNyZWF0ZU1lbW9yeVVSTChcInUvXCIsIHNjcmVlbk5hbWUgKyBcIi5qc29uXCIpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQG1lbWJlciAgICAgIHRtLnNvY2lhbC5OaW5lbGVhcFxyXG4gICAgICogQG1ldGhvZCAgICAgIGNyZWF0ZVJlY2VudERhdGFVUkxcclxuICAgICAqIOacgOi/keODl+ODrOOCpOOBl+OBn+ODpuODvOOCtuOBruODl+ODrOOCpOODh+ODvOOCv1VSTOOCkueUn+aIkFxyXG4gICAgICovXHJcbiAgICB0bS5zb2NpYWwuTmluZWxlYXAuY3JlYXRlUmVjZW50RGF0YVVSTCA9IGZ1bmN0aW9uKG1heCkge1xyXG4gICAgICAgIG1heCA9IG1heCB8fCAzMDtcclxuICAgICAgICByZXR1cm4gdG0uc29jaWFsLk5pbmVsZWFwLmNyZWF0ZU1lbW9yeVVSTChcInJlY2VudF9tZW1vcmllcy5qc29uXCIsIFwiP21heD1cIiArIG1heCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAbWVtYmVyICAgICAgdG0uc29jaWFsLk5pbmVsZWFwXHJcbiAgICAgKiBAbWV0aG9kICAgICAgY3JlYXRlRnJpZW5kRGF0YVVSTFxyXG4gICAgICogVHdpdHRlcuOBp+ODleOCqeODreODvOOBl+OBpuOBhOOCi+ODpuODvOOCtuOBruODl+ODrOOCpOODh+ODvOOCv1VSTOOCkueUn+aIkFxyXG4gICAgICovXHJcbiAgICB0bS5zb2NpYWwuTmluZWxlYXAuY3JlYXRlRnJpZW5kRGF0YVVSTCA9IGZ1bmN0aW9uKG1heCkge1xyXG4gICAgICAgIG1heCA9IG1heCB8fCAzMDtcclxuICAgICAgICByZXR1cm4gdG0uc29jaWFsLk5pbmVsZWFwLmNyZWF0ZU1lbW9yeVVSTChcImZyaWVuZHNfbWVtb3JpZXMuanNvblwiLCBcIj9tYXg9XCIgKyBtYXgpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQG1lbWJlciAgICAgIHRtLnNvY2lhbC5OaW5lbGVhcFxyXG4gICAgICogQG1ldGhvZCAgICAgIGNyZWF0ZVJhbmtpbmdEYXRhVVJMXHJcbiAgICAgKiDjgrnjgrPjgqLjg6njg7Pjgq3jg7PjgrDkuIrkvY3jga7jg6bjg7zjgrbjga7jg5fjg6zjgqTjg4fjg7zjgr9VUkzjgpLnlJ/miJBcclxuICAgICAqL1xyXG4gICAgdG0uc29jaWFsLk5pbmVsZWFwLmNyZWF0ZVJhbmtpbmdEYXRhVVJMID0gZnVuY3Rpb24obWF4KSB7XHJcbiAgICAgICAgbWF4ID0gbWF4IHx8IDMwO1xyXG4gICAgICAgIHJldHVybiB0bS5zb2NpYWwuTmluZWxlYXAuY3JlYXRlTWVtb3J5VVJMKFwicmFua2luZ19tZW1vcmllcy5qc29uXCIsIFwiP21heD1cIiArIG1heCk7XHJcbiAgICB9O1xyXG59KSgpO1xyXG5cclxuXHJcbi8qXHJcbiAqIGNoYXJ0LmpzXHJcbiAqL1xyXG5cclxudG0uZ29vZ2xlID0gdG0uZ29vZ2xlIHx8IHt9O1xyXG5cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgdG0uZ29vZ2xlLkNoYXJ0XHJcbiAgICAgKiDjg4Hjg6Pjg7zjg4jjg43jg7zjg6Djgrnjg5rjg7zjgrlcclxuICAgICAqL1xyXG4gICAgdG0uZ29vZ2xlLkNoYXJ0ID0gdG0uZ29vZ2xlLkNoYXJ0IHx8IHt9O1xyXG4gICAgXHJcbiAgICB2YXIgRFlOQU1JQ19JQ09OU19CQVNFX1VSTCAgPSBcImh0dHBzOi8vY2hhcnQuZ29vZ2xlYXBpcy5jb20vY2hhcnQ/Y2hzdD17dHlwZX0mY2hsZD17ZGF0YX1cIjtcclxuICAgIHZhciBRUl9DT0RFX0JBU0VfVVJMICAgICAgICA9IFwiaHR0cHM6Ly9jaGFydC5nb29nbGVhcGlzLmNvbS9jaGFydD9jaHM9e3NpemV9JmNodD17dHlwZX0mY2hsPXt0ZXh0fSZjaGNvPXtjb2xvcn1cIjtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiDjg4DjgqTjg4rjg5/jg4Pjgq/jgqLjgqTjgrPjg7NcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSAgdHlwZSAgICBkX2J1YmJsZV90ZXh0X3NtYWxsIE9SIGRfZm5vdGVfdGl0bGUgT1IgY2hzdD1kX2Zub3RlIGV0Yy4uLlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9ICBkYXRhICAgIFxyXG4gICAgICogIyMjIEV4YW1wbGVcclxuICAgICAqICAgICAgdG0uZ29vZ2xlLkNoYXJ0LmNyZWF0ZUR5bmFtaWNJY29ucyhcImRfYnViYmxlX2ljb25fdGV4dF9zbWFsbFwiLCBcInNraXxiYnxIZWxsbywgd29ybGQhfEZGRkZGRnwwMDAwMDBcIik7XHJcbiAgICAgKiAgICAgIHRtLmdvb2dsZS5DaGFydC5jcmVhdGVEeW5hbWljSWNvbnMoXCJkX2Zub3RlXCIsIFwiYmFsbG9vbnwxfDAwMDAwMHxsfEhlbGxvLCB3b3JsZCFcIik7XHJcbiAgICAgKiAgICAgIHRtLmdvb2dsZS5DaGFydC5jcmVhdGVEeW5hbWljSWNvbnMoXCJkX2Zub3RlXCIsIFwicGlubmVkX2N8MXwwMDAwMDB8bHxIZWxsbywgd29ybGQhXCIpO1xyXG4gICAgICogICAgICB0bS5nb29nbGUuQ2hhcnQuY3JlYXRlRHluYW1pY0ljb25zKFwiZF93ZWF0aGVyXCIsIFwidGFwZWRfeXxzdW5ueXxCYXJjZWxvbmF8bWF4KzI1wrBDfG1pbisxNcKwQ1wiKTtcclxuICAgICAqICAgICAgdG0uZ29vZ2xlLkNoYXJ0LmNyZWF0ZUR5bmFtaWNJY29ucyhcImRfc2ltcGxlX3RleHRfaWNvbl9sZWZ0XCIsIFwiZmxhZ19qcHwxNHwwMDB8ZmxhZ19qcHwyNHwwMDB8RkZGXCIpO1xyXG4gICAgICovXHJcbiAgICB0bS5nb29nbGUuQ2hhcnQuY3JlYXRlRHluYW1pY0ljb25zID0gZnVuY3Rpb24odHlwZSwgZGF0YSkge1xyXG4gICAgICAgIC8vIGRhdGEgPSBlbmNvZGVVUklDb21wb25lbnQoZGF0YSk7XHJcbiAgICAgICAgcmV0dXJuIERZTkFNSUNfSUNPTlNfQkFTRV9VUkwuZm9ybWF0KHtcclxuICAgICAgICAgICAgdHlwZTp0eXBlLFxyXG4gICAgICAgICAgICBkYXRhOmRhdGFcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogUVJDb2RlIOeUn+aIkFxyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHByb3BcclxuICAgICAqICMjIyBSZWZlcmVuY2VcclxuICAgICAqIC0gPGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL2NoYXJ0Lz9obD1qYSNxcmNvZGVzPlxyXG4gICAgICogLSA8aHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vY2hhcnQvaW5mb2dyYXBoaWNzLz9obD1qYT5cclxuICAgICAqIC0gPGh0dHBzOi8vZ29vZ2xlLWRldmVsb3BlcnMuYXBwc3BvdC5jb20vY2hhcnQvaW5mb2dyYXBoaWNzL2RvY3Mvb3ZlcnZpZXc+XHJcbiAgICAgKiAjIyMgRXhhbXBsZVxyXG4gICAgICogICAgICB0bS5nb29nbGUuQ2hhcnQuY3JlYXRlUVJDb2RlKFwiMTYweDE2MFwiLCBcImh0dHA6Ly90bWxpZmUubmV0XCIpO1xyXG4gICAgICogICAgICB0bS5nb29nbGUuQ2hhcnQuY3JlYXRlUVJDb2RlKFwiMTYweDE2MFwiLCBcIkhlbGxvLCB3b3JsZFwiKTtcclxuICAgICAqL1xyXG4gICAgdG0uZ29vZ2xlLkNoYXJ0LmNyZWF0ZVFSQ29kZSA9IGZ1bmN0aW9uKHNpemUsIHRleHQsIGNvbG9yKSB7XHJcbiAgICAgICAgdGV4dCA9IGVuY29kZVVSSUNvbXBvbmVudCh0ZXh0KTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gUVJfQ09ERV9CQVNFX1VSTC5mb3JtYXQoe1xyXG4gICAgICAgICAgICB0eXBlOlwicXJcIixcclxuICAgICAgICAgICAgc2l6ZTpzaXplLFxyXG4gICAgICAgICAgICB0ZXh0OnRleHQsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIFRleCDnlJ/miJBcclxuICAgICAqL1xyXG4gICAgdG0uZ29vZ2xlLkNoYXJ0LmNyZWF0ZVRlWCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIC8vJmNoY289ZmYwMDAwZmZcclxuICAgIH07XHJcbiAgICBcclxufSkoKTtcclxuXHJcblxyXG47KGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEBtZW1iZXIgICAgICB0bS5hcHAuRWxlbWVudFxyXG4gICAgICogQHByb3BlcnR5ICAgIGludGVyYWN0aW9uXHJcbiAgICAgKiDjgqTjg7Pjgr/jg6njgq/jgrfjg6fjg7NcclxuICAgICAqL1xyXG4gICAgdG0uYXBwLkVsZW1lbnQucHJvdG90eXBlLmdldHRlcihcImludGVyYWN0aW9uXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNvbnNvbGUuYXNzZXJ0KGZhbHNlLCBcImludGVyYWN0aW9uIOOBryBPYmplY3QyZCDjgavntbHlkIjjgZXjgozjgb7jgZfjgZ8uIG9iai5zZXRJbnRlcmFjdGl2ZSh0cnVlKTsg44Go44GZ44KM44Gw44K/44OD44OB5Yik5a6a44GM5pyJ5Yq544Gr44Gq44KK44G+44GZLlwiKTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBcclxuICAgIHZhciBkaXJ0eUNsYXNzID0ge1xyXG4gICAgICAgIFwiZGlzcGxheVwiOiBbXHJcbiAgICAgICAgICAgIFwiU3ByaXRlXCIsXHJcbiAgICAgICAgICAgIFwiU2hhcGVcIixcclxuICAgICAgICAgICAgXCJDaXJjbGVTaGFwZVwiLFxyXG4gICAgICAgICAgICBcIlRyaWFuZ2xlU2hhcGVcIixcclxuICAgICAgICAgICAgXCJSZWN0YW5nbGVTaGFwZVwiLFxyXG4gICAgICAgICAgICBcIlJvdW5kUmVjdGFuZ2xlU2hhcGVcIixcclxuICAgICAgICAgICAgXCJTdGFyU2hhcGVcIixcclxuICAgICAgICAgICAgXCJQb2x5Z29uU2hhcGVcIixcclxuICAgICAgICAgICAgXCJIZWFydFNoYXBlXCIsXHJcbiAgICAgICAgICAgIFwiVGV4dFNoYXBlXCIsXHJcbiAgICAgICAgICAgIFwiQ2FudmFzUmVuZGVyZXJcIixcclxuICAgICAgICAgICAgXCJCb3VuZGluZ1JlY3RSZW5kZXJlclwiLFxyXG4gICAgICAgICAgICBcIkxhYmVsXCIsXHJcbiAgICAgICAgICAgIFwiTWFwU3ByaXRlXCIsXHJcbiAgICAgICAgICAgIFwiQ2FudmFzRWxlbWVudFwiLFxyXG4gICAgICAgICAgICBcIkNhbnZhc0FwcFwiLFxyXG4gICAgICAgICAgICBcIkFuaW1hdGlvblNwcml0ZVwiLFxyXG4gICAgICAgICAgICBcIlNwcml0ZVNoZWV0XCIsXHJcbiAgICAgICAgXSxcclxuICAgICAgICBcInVpXCI6IFtcclxuICAgICAgICAgICAgXCJMYWJlbEJ1dHRvblwiLFxyXG4gICAgICAgICAgICBcIkljb25CdXR0b25cIixcclxuICAgICAgICAgICAgXCJHbG9zc3lCdXR0b25cIixcclxuICAgICAgICAgICAgXCJGbGF0QnV0dG9uXCIsXHJcbiAgICAgICAgICAgIFwiTG9hZGluZ1NjZW5lXCIsXHJcbiAgICAgICAgXSxcclxuICAgIH07XHJcbiAgICBcclxuICAgIGZvciAodmFyIGtleSBpbiBkaXJ0eUNsYXNzKSB7XHJcbiAgICAgICAgdmFyIG5hbWVzcGFjZSA9IGRpcnR5Q2xhc3Nba2V5XTtcclxuICAgICAgICBuYW1lc3BhY2UuZWFjaChmdW5jdGlvbihjbGFzc05hbWUpIHtcclxuICAgICAgICAgICAgdG0uYXBwW2NsYXNzTmFtZV0gPSB0bVtrZXldW2NsYXNzTmFtZV07XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHRtLmFzc2V0LkFzc2V0TWFuYWdlciA9IHRtLmFzc2V0Lk1hbmFnZXI7XHJcblxyXG4gICAgdG0udXRpbC5nZXR0ZXIoJ1NjcmlwdCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNvbnNvbGUud2FybignYHRtLnV0aWwuU2NyaXB0YCDjga8gYHRtLmFzc2V0LlNjcmlwdGAg44Gr44Gq44KK44G+44GX44GfIScpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdG0udWkuTG9hZGluZ1NjZW5lID0gZnVuY3Rpb24ocGFyYW0pIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oJ2B0bS51aS5Mb2FkaW5nU2NlbmVgIOOBryBgdG0uZ2FtZS5Mb2FkaW5nU2NlbmVgIOOBq+OBquOCiuOBvuOBl+OBnyEnKTtcclxuICAgICAgICByZXR1cm4gdG0uZ2FtZS5Mb2FkaW5nU2NlbmUocGFyYW0pO1xyXG4gICAgfTtcclxuXHJcbiAgICB0bS5zY2VuZSA9IHRtLnNjZW5lIHx8IHt9O1xyXG4gICAgdG0uc2NlbmUuTWFuYWdlclNjZW5lID0gdG0uZ2FtZS5NYW5hZ2VyU2NlbmU7XHJcbiAgICB0bS5zY2VuZS5Mb2FkaW5nU2NlbmUgPSB0bS5nYW1lLkxvYWRpbmdTY2VuZTtcclxuICAgIHRtLnNjZW5lLlRpdGxlU2NlbmUgPSB0bS5nYW1lLlRpdGxlU2NlbmU7XHJcbiAgICB0bS5zY2VuZS5SZXN1bHRTY2VuZSA9IHRtLmdhbWUuUmVzdWx0U2NlbmU7XHJcbiAgICB0bS5zY2VuZS5OdW1lcmljYWxJbnB1dFNjZW5lID0gdG0uZ2FtZS5OdW1lcmljYWxJbnB1dFNjZW5lO1xyXG4gICAgXHJcbiAgICB0bS5nZXR0ZXIoJ3NjZW5lJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgZGVidWdnZXI7XHJcbiAgICAgICAgY29uc29sZS53YXJuKCd0bS5zY2VuZSDjga8gdG0uZ2FtZSDjgavlpInmm7TjgZXjgozjgb7jgZfjgZ8nKTtcclxuICAgICAgICByZXR1cm4gdG0uZ2FtZTtcclxuICAgIH0pO1xyXG5cclxufSkoKTtcclxuIiwidmFyIHRtID0gcmVxdWlyZShcIi4uL2xpYnMvdG1saWJcIik7XHJcbnZhciBHYW1lU2NlbmUgPSByZXF1aXJlKFwiLi9zY2VuZXMvR2FtZVNjZW5lXCIpO1xyXG5cclxudG0ubWFpbihmdW5jdGlvbigpIHtcclxuXHR2YXIgYXBwID0gdG0uZGlzcGxheS5DYW52YXNBcHAoXCIjYXBwXCIpO1xyXG5cdGFwcC5yZXNpemUoNTAwLCA1MDApLmZpdFdpbmRvdygpO1xyXG5cclxuXHRhcHAucmVwbGFjZVNjZW5lKEdhbWVTY2VuZShcIjEyM1wiKSk7XHJcblxyXG5cdGFwcC5ydW4oKTtcclxufSk7XHJcbiIsInZhciB0bSA9IHJlcXVpcmUoXCIuLi8uLi9saWJzL3RtbGliXCIpO1xyXG5cclxudmFyIEdhbWVTY2VuZSA9IHRtLmNyZWF0ZUNsYXNzKHtcclxuXHRzdXBlckNsYXNzOiB0bS5hcHAuU2NlbmUsXHJcblx0aW5pdDogZnVuY3Rpb24oKSB7XHJcblx0XHR0aGlzLnN1cGVySW5pdCgpO1xyXG5cdFx0dGhpcy5mcm9tSlNPTih7XHJcblx0XHRcdGNoaWxkcmVuOiB7XHJcblx0XHRcdFx0dGl0bGU6IHtcclxuXHRcdFx0XHRcdHR5cGU6IFwidG0uZGlzcGxheS5MYWJlbFwiLFxyXG5cdFx0XHRcdFx0aW5pdDogW1wiaGVsbG8gd29ybGRcIl0sXHJcblx0XHRcdFx0XHR4OiAyNTAsXHJcblx0XHRcdFx0XHR5OiAyNTAsXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn0pO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBHYW1lU2NlbmU7XHJcbiJdfQ==
